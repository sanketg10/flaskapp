/*!
 * jQuery JavaScript Library v2.1.0
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-01-23T21:10Z
 */
!function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>=0!==not})}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function completed(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Math.random()}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$1").toLowerCase(),data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}data_user.set(elem,key,data)}else data=void 0;return data}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;l>i;i++)data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(data_priv.hasData(src)&&(pdataOld=data_priv.access(src),pdataCur=data_priv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}data_user.hasData(src)&&(udataOld=data_user.access(src),udataCur=jQuery.extend({},udataOld),data_user.set(dest,udataCur))}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle?window.getDefaultComputedStyle(elem[0]).display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=iframe[0].contentDocument,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name]),computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?(delete this.get,void 0):(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name[0].toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=data_priv.get(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=data_priv.access(elem,"olddisplay",defaultDisplay(elem.nodeName)))):values[index]||(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),"none"===display&&(display=defaultDisplay(elem.nodeName)),"inline"===display&&"none"===jQuery.css(elem,"float")&&(style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if(!jQuery.isEmptyObject(orig)){dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=data_priv.access(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&elem.defaultView}var arr=[],slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,trim="".trim,support={},document=window.document,version="2.1.0",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?0>num?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray,isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){return obj-parseFloat(obj)>=0},isPlainObject:function(obj){if("object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(1===code.indexOf("use strict")?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:function(text){return null==text?"":trim.call(text)},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):void 0},now:Date.now,support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=/*!
 * Sizzle CSS Selector Engine v1.10.16
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-01-13
 */
function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}function setFilters(){}function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed&&1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results}var i,support,Expr,getText,isXML,compile,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},strundefined="undefined",MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",function(){setDocument()},!1):parent.attachEvent&&parent.attachEvent("onunload",function(){setDocument()})),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){return div.innerHTML="<div class='a'></div><div class='a i'></div>",div.firstChild.className="i",2===div.getElementsByClassName("i").length}),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return typeof context.getElementsByClassName!==strundefined&&documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select t=''><option selected=''></option></select>",div.querySelectorAll("[t^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),!(!support.matchesSelector||!documentIsHTML||rbuggyMatches&&rbuggyMatches.test(expr)||rbuggyQSA&&rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]&&void 0!==match[4]?match[2]=match[4]:unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(group||(group=tokenize(selector)),i=group.length;i--;)cached=matcherFromTokens(group[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&elem.parentNode&&(this.length=1,this[0]=elem),this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?"undefined"!=typeof rootjQuery.ready?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},sibling:function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched}}),jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;l>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1
},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.unique(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){(wait===!0?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready")))}}),jQuery.ready.promise=function(obj){return readyList||(readyList=jQuery.Deferred(),"complete"===document.readyState?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(obj)},jQuery.ready.promise();var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;len>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet};jQuery.acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType},Data.uid=1,Data.accepts=jQuery.acceptData,Data.prototype={key:function(owner){if(!Data.accepts(owner))return 0;var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock},Object.defineProperties(owner,descriptor)}catch(e){descriptor[this.expando]=unlock,jQuery.extend(owner,descriptor)}}return this.cache[unlock]||(this.cache[unlock]={}),unlock},set:function(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if("string"==typeof data)cache[data]=value;else if(jQuery.isEmptyObject(cache))jQuery.extend(this.cache[unlock],data);else for(prop in data)cache[prop]=data[prop];return cache},get:function(owner,key){var cache=this.cache[this.key(owner)];return void 0===key?cache:cache[key]},access:function(owner,key,value){var stored;return void 0===key||key&&"string"==typeof key&&void 0===value?(stored=this.get(owner,key),void 0!==stored?stored:this.get(owner,jQuery.camelCase(key))):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(void 0===key)this.cache[unlock]={};else{jQuery.isArray(key)?name=key.concat(key.map(jQuery.camelCase)):(camel=jQuery.camelCase(key),key in cache?name=[key,camel]:(name=camel,name=name in cache?[name]:name.match(rnotwhite)||[])),i=name.length;for(;i--;)delete cache[name[i]]}},hasData:function(owner){return!jQuery.isEmptyObject(this.cache[owner[this.expando]]||{})},discard:function(owner){owner[this.expando]&&delete this.cache[owner[this.expando]]}};var data_priv=new Data,data_user=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({hasData:function(elem){return data_user.hasData(elem)||data_priv.hasData(elem)},data:function(elem,name,data){return data_user.access(elem,name,data)},removeData:function(elem,name){data_user.remove(elem,name)},_data:function(elem,name,data){return data_priv.access(elem,name,data)},_removeData:function(elem,name){data_priv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=data_user.get(elem),1===elem.nodeType&&!data_priv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name]));data_priv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){data_user.set(this,key)}):access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&void 0===value){if(data=data_user.get(elem,key),void 0!==data)return data;if(data=data_user.get(elem,camelKey),void 0!==data)return data;if(data=dataAttr(elem,camelKey,void 0),void 0!==data)return data}else this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value),-1!==key.indexOf("-")&&void 0!==data&&data_user.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){data_user.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=data_priv.get(elem,type),data&&(!queue||jQuery.isArray(data)?queue=data_priv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=data_priv.get(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},rcheckableType=/^(?:checkbox|radio)$/i;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div"));div.innerHTML="<input type='radio' checked='checked' name='t'/>",support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var strundefined="undefined";support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||elem.addEventListener&&elem.addEventListener(type,eventHandle,!1)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,data_priv.remove(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&special._default.apply(eventPath.pop(),data)!==!1||!jQuery.acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!==this;cur=cur.parentNode||this)if(cur.disabled!==!0||"click"!==event.type){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=document),3===event.target.nodeType&&(event.target=event.target.parentNode),fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==safeActiveElement()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&jQuery.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),this[jQuery.expando]=!0,void 0):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),data_priv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix)-1;attaches?data_priv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),data_priv.remove(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;l>i;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;l>i;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},buildFragment:function(elems,context,scripts,selection){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment},cleanData:function(elems){for(var data,elem,events,type,key,j,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++){if(jQuery.acceptData(elem)&&(key=elem[data_priv.expando],key&&(data=data_priv.cache[key]))){if(events=Object.keys(data.events||{}),events.length)for(j=0;void 0!==(type=events[j]);j++)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);data_priv.cache[key]&&delete data_priv.cache[key]}delete data_user.cache[elem[data_user.expando]]}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=value)})},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval(node.textContent.replace(rcleanScript,"")))}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={},rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)};!function(){function computePixelPositionAndBoxSizingReliable(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",docElem.appendChild(container);
var divStyle=window.getComputedStyle(div,null);pixelPositionVal="1%"!==divStyle.top,boxSizingReliableVal="4px"===divStyle.width,docElem.removeChild(container)}var pixelPositionVal,boxSizingReliableVal,divReset="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",docElem=document.documentElement,container=document.createElement("div"),div=document.createElement("div");div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",container.appendChild(div),window.getComputedStyle&&jQuery.extend(support,{pixelPosition:function(){return computePixelPositionAndBoxSizingReliable(),pixelPositionVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computePixelPositionAndBoxSizingReliable(),boxSizingReliableVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));return marginDiv.style.cssText=div.style.cssText=divReset,marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",docElem.appendChild(container),ret=!parseFloat(window.getComputedStyle(marginDiv,null).marginRight),docElem.removeChild(container),div.innerHTML="",ret}})}(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value?hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name]:(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(style[name]="",style[name]=value)),void 0)}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?0===elem.offsetWidth&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.pos=eased=this.options.duration?jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||data_priv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):(jQuery.removeAttr(elem,name),void 0))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)&&(elem[propName]=!1),elem.removeAttribute(name)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1}}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed="string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=0===arguments.length||"string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}):this.each(function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(type===strundefined||"boolean"===type)&&(this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||value===!1?"":data_priv.get(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],!(!option.selected&&i!==index||(support.optDisabled?option.disabled:null!==option.getAttribute("disabled"))||option.parentNode.disabled&&jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery(option).val(),values)>=0)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")}catch(e){xml=void 0}return(!xml||xml.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+data),xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapAll(html.call(this,i))}):(this[0]&&(wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this)},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();window.ActiveXObject&&jQuery(window).on("unload",function(){for(var key in xhrCallbacks)xhrCallbacks[key]()}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback;return support.cors||xhrSupported&&!options.crossDomain?{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(delete xhrCallbacks[id],callback=xhr.onload=xhr.onerror=null,"abort"===type?xhr.abort():"error"===type?complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"string"==typeof xhr.responseText?{text:xhr.responseText}:void 0,xhr.getAllResponseHeaders()))}},xhr.onload=callback(),xhr.onerror=callback("error"),callback=xhrCallbacks[id]=callback("abort"),xhr.send(options.hasContent&&options.data||null)},abort:function(){callback&&callback()}}:void 0}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({async:!0,charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback
}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"):void 0}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,type,response,self=this,off=url.indexOf(" ");return off>=0&&(selector=url.slice(off),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}):box},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?win[prop]:elem[method]:(win?win.scrollTo(top?window.pageXOffset:val,top?val:window.pageYOffset):elem[method]=val,void 0)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),function($,undefined){$.rails!==undefined&&$.error("jquery-ujs has already been loaded!");var rails,$document=$(document);$.rails=rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(xhr){var token=$('meta[name="csrf-token"]').attr("content");token&&xhr.setRequestHeader("X-CSRF-Token",token)},refreshCSRFTokens:function(){var csrfToken=$("meta[name=csrf-token]").attr("content"),csrfParam=$("meta[name=csrf-param]").attr("content");$('form input[name="'+csrfParam+'"]').val(csrfToken)},fire:function(obj,name,data){var event=$.Event(name);return obj.trigger(event,data),event.result!==!1},confirm:function(message){return confirm(message)},ajax:function(options){return $.ajax(options)},href:function(element){return element.attr("href")},handleRemote:function(element){var method,url,data,elCrossDomain,crossDomain,withCredentials,dataType,options;if(rails.fire(element,"ajax:before")){if(elCrossDomain=element.data("cross-domain"),crossDomain=elCrossDomain===undefined?null:elCrossDomain,withCredentials=element.data("with-credentials")||null,dataType=element.data("type")||$.ajaxSettings&&$.ajaxSettings.dataType,element.is("form")){method=element.attr("method"),url=element.attr("action"),data=element.serializeArray();var button=element.data("ujs:submit-button");button&&(data.push(button),element.data("ujs:submit-button",null))}else element.is(rails.inputChangeSelector)?(method=element.data("method"),url=element.data("url"),data=element.serialize(),element.data("params")&&(data=data+"&"+element.data("params"))):element.is(rails.buttonClickSelector)?(method=element.data("method")||"get",url=element.data("url"),data=element.serialize(),element.data("params")&&(data=data+"&"+element.data("params"))):(method=element.data("method"),url=rails.href(element),data=element.data("params")||null);options={type:method||"GET",data:data,dataType:dataType,beforeSend:function(xhr,settings){return settings.dataType===undefined&&xhr.setRequestHeader("accept","*/*;q=0.5, "+settings.accepts.script),rails.fire(element,"ajax:beforeSend",[xhr,settings])},success:function(data,status,xhr){element.trigger("ajax:success",[data,status,xhr])},complete:function(xhr,status){element.trigger("ajax:complete",[xhr,status])},error:function(xhr,status,error){element.trigger("ajax:error",[xhr,status,error])},crossDomain:crossDomain},withCredentials&&(options.xhrFields={withCredentials:withCredentials}),url&&(options.url=url);var jqxhr=rails.ajax(options);return element.trigger("ajax:send",jqxhr),jqxhr}return!1},handleMethod:function(link){var href=rails.href(link),method=link.data("method"),target=link.attr("target"),csrfToken=$("meta[name=csrf-token]").attr("content"),csrfParam=$("meta[name=csrf-param]").attr("content"),form=$('<form method="post" action="'+href+'"></form>'),metadataInput='<input name="_method" value="'+method+'" type="hidden" />';csrfParam!==undefined&&csrfToken!==undefined&&(metadataInput+='<input name="'+csrfParam+'" value="'+csrfToken+'" type="hidden" />'),target&&form.attr("target",target),form.hide().append(metadataInput).appendTo("body"),form.submit()},disableFormElements:function(form){form.find(rails.disableSelector).each(function(){var element=$(this),method=element.is("button")?"html":"val";element.data("ujs:enable-with",element[method]()),element[method](element.data("disable-with")),element.prop("disabled",!0)})},enableFormElements:function(form){form.find(rails.enableSelector).each(function(){var element=$(this),method=element.is("button")?"html":"val";element.data("ujs:enable-with")&&element[method](element.data("ujs:enable-with")),element.prop("disabled",!1)})},allowAction:function(element){var callback,message=element.data("confirm"),answer=!1;return message?(rails.fire(element,"confirm")&&(answer=rails.confirm(message),callback=rails.fire(element,"confirm:complete",[answer])),answer&&callback):!0},blankInputs:function(form,specifiedSelector,nonBlank){var input,valueToCheck,inputs=$(),selector=specifiedSelector||"input,textarea",allInputs=form.find(selector);return allInputs.each(function(){if(input=$(this),valueToCheck=input.is("input[type=checkbox],input[type=radio]")?input.is(":checked"):input.val(),!valueToCheck==!nonBlank){if(input.is("input[type=radio]")&&allInputs.filter('input[type=radio]:checked[name="'+input.attr("name")+'"]').length)return!0;inputs=inputs.add(input)}}),inputs.length?inputs:!1},nonBlankInputs:function(form,specifiedSelector){return rails.blankInputs(form,specifiedSelector,!0)},stopEverything:function(e){return $(e.target).trigger("ujs:everythingStopped"),e.stopImmediatePropagation(),!1},disableElement:function(element){element.data("ujs:enable-with",element.html()),element.html(element.data("disable-with")),element.bind("click.railsDisable",function(e){return rails.stopEverything(e)})},enableElement:function(element){element.data("ujs:enable-with")!==undefined&&(element.html(element.data("ujs:enable-with")),element.removeData("ujs:enable-with")),element.unbind("click.railsDisable")}},rails.fire($document,"rails:attachBindings")&&($.ajaxPrefilter(function(options,originalOptions,xhr){options.crossDomain||rails.CSRFProtection(xhr)}),$document.delegate(rails.linkDisableSelector,"ajax:complete",function(){rails.enableElement($(this))}),$document.delegate(rails.linkClickSelector,"click.rails",function(e){var link=$(this),method=link.data("method"),data=link.data("params"),metaClick=e.metaKey||e.ctrlKey;if(!rails.allowAction(link))return rails.stopEverything(e);if(!metaClick&&link.is(rails.linkDisableSelector)&&rails.disableElement(link),link.data("remote")!==undefined){if(metaClick&&(!method||"GET"===method)&&!data)return!0;var handleRemote=rails.handleRemote(link);return handleRemote===!1?rails.enableElement(link):handleRemote.error(function(){rails.enableElement(link)}),!1}return link.data("method")?(rails.handleMethod(link),!1):void 0}),$document.delegate(rails.buttonClickSelector,"click.rails",function(e){var button=$(this);return rails.allowAction(button)?(rails.handleRemote(button),!1):rails.stopEverything(e)}),$document.delegate(rails.inputChangeSelector,"change.rails",function(e){var link=$(this);return rails.allowAction(link)?(rails.handleRemote(link),!1):rails.stopEverything(e)}),$document.delegate(rails.formSubmitSelector,"submit.rails",function(e){var form=$(this),remote=form.data("remote")!==undefined,blankRequiredInputs=rails.blankInputs(form,rails.requiredInputSelector),nonBlankFileInputs=rails.nonBlankInputs(form,rails.fileInputSelector);if(!rails.allowAction(form))return rails.stopEverything(e);if(blankRequiredInputs&&form.attr("novalidate")==undefined&&rails.fire(form,"ajax:aborted:required",[blankRequiredInputs]))return rails.stopEverything(e);if(remote){if(nonBlankFileInputs){setTimeout(function(){rails.disableFormElements(form)},13);var aborted=rails.fire(form,"ajax:aborted:file",[nonBlankFileInputs]);return aborted||setTimeout(function(){rails.enableFormElements(form)},13),aborted}return rails.handleRemote(form),!1}setTimeout(function(){rails.disableFormElements(form)},13)}),$document.delegate(rails.formInputClickSelector,"click.rails",function(event){var button=$(this);if(!rails.allowAction(button))return rails.stopEverything(event);var name=button.attr("name"),data=name?{name:name,value:button.val()}:null;button.closest("form").data("ujs:submit-button",data)}),$document.delegate(rails.formSubmitSelector,"ajax:beforeSend.rails",function(event){this==event.target&&rails.disableFormElements($(this))}),$document.delegate(rails.formSubmitSelector,"ajax:complete.rails",function(event){this==event.target&&rails.enableFormElements($(this))}),$(function(){rails.refreshCSRFTokens()}))}(jQuery),/*!
 * jQuery replaceText - v1.1 - 11/21/2009
 * http://benalman.com/projects/jquery-replacetext-plugin/
 * 
 * Copyright (c) 2009 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
// Copyright (c) 2009 "Cowboy" Ben Alman,
function($){"$:nomunge";$.fn.replaceText=function(search,replace,text_only){return this.each(function(){var val,new_val,node=this.firstChild,remove=[];if(node)do 3===node.nodeType&&(val=node.nodeValue,new_val=val.replace(search,replace),new_val!==val&&(!text_only&&/</.test(new_val)?($(node).before(new_val),remove.push(node)):node.nodeValue=new_val));while(node=node.nextSibling);remove.length&&$(remove).remove()})}}(jQuery),function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.Abecedary=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){function sanitize(obj){return JSON.stringify(obj)}function Abecedary(iframeUrl,template,options){var generateElement=function(){var element=document.createElement("div");return element.style.cssText="display:none;",document.body.appendChild(element),element};this.options=options||{},this.iframeUrl=iframeUrl,this.template=template,this.options=extend({ui:"bdd",bail:!0,ignoreLeaks:!0},this.options),this.element=this.options.element||generateElement(),delete this.options.element,this.systemjs=this.options.systemjs,delete this.options.systemjs,this.sandbox=new Promise(function(resolve){var _this=this;stuff(this.iframeUrl,{el:this.element},function(context){context.on("finished",runComplete.bind(this)),context.on("error",error.bind(this)),context.on("loaded",function(){var runner,setupCode;runner=_this.systemjs?systemJsRunner.toString():legacyRunner.toString(),setupCode=["var Runner = "+runner+";","var runner = new Runner();","runner.setup("+sanitize(_this.options)+");"],context.evaljs(setupCode.join("\n")),resolve(context)}),context.load(this.template)}.bind(this))}.bind(this));var runComplete=function(report){this.emit("complete",report)},error=function(error){this.emit("error",error,this)}}var systemJsRunner=require("./systemjs-runner.js"),legacyRunner=require("./legacy-runner.js"),stuff=require("stuff.js"),EventEmitter=require("events").EventEmitter,Promise=require("promise/lib/es6-extensions"),extend=require("extend"),inherits=require("inherits");inherits(Abecedary,EventEmitter),Abecedary.prototype.run=function(code,tests,globals){var _this=this;this.sandbox.then(function(context){try{context.evaljs("runner.run("+sanitize(code)+", "+sanitize(tests)+", "+sanitize(globals)+");")}catch(e){_this.emit("error",e)}})},Abecedary.prototype.close=function(){this.element.parentElement.removeChild(this.element)},module.exports=Abecedary},{"./legacy-runner.js":2,"./systemjs-runner.js":3,events:5,extend:7,inherits:8,"promise/lib/es6-extensions":10,"stuff.js":12}],2:[function(require,module){module.exports=function(){function setupGlobals(code,globals){window.code=code;for(var property in globals)window[property]=globals[property]}function tearDownGlobals(code,globals){delete window.code;for(var property in globals)delete window[property]}this.setup=function(options){mocha.setup(options)},this.run=function(code,tests,globals){mocha.suite.suites.splice(0,mocha.suite.suites.length),mocha.suite.tests.splice(0,mocha.suite.tests.length),setupGlobals(code,globals);try{var tests=Function("require","code","globals",tests);tests(window.require,code,globals),mocha.run(function(){tearDownGlobals(code,globals)})}catch(error){tearDownGlobals(code,globals),rethrow(error)}}}},{}],3:[function(require,module){module.exports=function(){function deleteModule(name){System.delete(System.normalizeSync(name))}function tearDown(){deleteModule("code"),deleteModule("globals"),deleteModule("tests")}var _this=this;this.setup=function(options){var systemFetch=System.fetch;System.fetch=function(load){return System.normalizeSync("tests")==load.name?new Promise(function(resolve){resolve(_this._tests)}):systemFetch.apply(this,arguments)},System.registerDynamic(System.normalizeSync("options"),[],!1,function(require,exports,module){module.exports=options})},this.run=function(code,tests,globals){_this._tests=tests,System.registerDynamic(System.normalizeSync("code"),[],!1,function(require,exports,module){module.exports=code}),System.registerDynamic(System.normalizeSync("globals"),[],!1,function(require,exports,module){module.exports=globals}),Promise.all([System.import("options"),System.import("runner")]).then(function(modules){var options=modules[0],runner=modules[1];return runner(options,code,globals)}).then(tearDown).catch(function(error){tearDown(),systemjsError(error)})}}},{}],4:[function(require,module){module.exports=function(){var events=require("events"),domain={};return domain.createDomain=domain.create=function(){function emitError(e){d.emit("error",e)}var d=new events.EventEmitter;return d.add=function(emitter){emitter.on("error",emitError)},d.remove=function(emitter){emitter.removeListener("error",emitError)},d.bind=function(fn){return function(){var args=Array.prototype.slice.call(arguments);try{fn.apply(null,args)}catch(err){emitError(err)}}},d.intercept=function(fn){return function(err){if(err)emitError(err);else{var args=Array.prototype.slice.call(arguments,1);try{fn.apply(null,args)}catch(err){emitError(err)}}}},d.run=function(fn){try{fn()}catch(err){emitError(err)}return this},d.dispose=function(){return this.removeAllListeners(),this},d.enter=d.exit=function(){return this},d},domain}.call(this)},{events:5}],5:[function(require,module){// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||0>n||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(er=arguments[1],er instanceof Error)throw er;throw TypeError('Uncaught, unspecified "error" event.')}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];handler.apply(this,args)}else if(isObject(handler)){for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];for(listeners=handler.slice(),len=listeners.length,i=0;len>i;i++)listeners[i].apply(this,args)}return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned){var m;m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-->0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(0>position)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.listenerCount=function(emitter,type){var ret;return ret=emitter._events&&emitter._events[type]?isFunction(emitter._events[type])?1:emitter._events[type].length:0}},{}],6:[function(require,module){function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var timeout=setTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,clearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var currentQueue,process=module.exports={},queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],7:[function(require,module){"use strict";var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,isArray=function(arr){return"function"==typeof Array.isArray?Array.isArray(arr):"[object Array]"===toStr.call(arr)},isPlainObject=function(obj){if(!obj||"[object Object]"!==toStr.call(obj))return!1;var hasOwnConstructor=hasOwn.call(obj,"constructor"),hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf)return!1;var key;for(key in obj);return"undefined"==typeof key||hasOwn.call(obj,key)};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=!1;for("boolean"==typeof target?(deep=target,target=arguments[1]||{},i=2):("object"!=typeof target&&"function"!=typeof target||null==target)&&(target={});length>i;++i)if(options=arguments[i],null!=options)for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&isArray(src)?src:[]):clone=src&&isPlainObject(src)?src:{},target[name]=extend(deep,clone,copy)):"undefined"!=typeof copy&&(target[name]=copy));return target}},{}],8:[function(require,module){module.exports="function"==typeof Object.create?function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],9:[function(require,module){"use strict";function noop(){}function getThen(obj){try{return obj.then}catch(ex){return LAST_ERROR=ex,IS_ERROR}}function tryCallOne(fn,a){try{return fn(a)}catch(ex){return LAST_ERROR=ex,IS_ERROR}}function tryCallTwo(fn,a,b){try{fn(a,b)}catch(ex){return LAST_ERROR=ex,IS_ERROR}}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._37=0,this._12=null,this._59=[],fn!==noop&&doResolve(fn,this)}function safeThen(self,onFulfilled,onRejected){return new self.constructor(function(resolve,reject){var res=new Promise(noop);res.then(resolve,reject),handle(self,new Handler(onFulfilled,onRejected,res))})}function handle(self,deferred){for(;3===self._37;)self=self._12;return 0===self._37?(self._59.push(deferred),void 0):(asap(function(){var cb=1===self._37?deferred.onFulfilled:deferred.onRejected;if(null===cb)return 1===self._37?resolve(deferred.promise,self._12):reject(deferred.promise,self._12),void 0;var ret=tryCallOne(cb,self._12);ret===IS_ERROR?reject(deferred.promise,LAST_ERROR):resolve(deferred.promise,ret)}),void 0)}function resolve(self,newValue){if(newValue===self)return reject(self,new TypeError("A promise cannot be resolved with itself."));if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=getThen(newValue);if(then===IS_ERROR)return reject(self,LAST_ERROR);if(then===self.then&&newValue instanceof Promise)return self._37=3,self._12=newValue,finale(self),void 0;if("function"==typeof then)return doResolve(then.bind(newValue),self),void 0}self._37=1,self._12=newValue,finale(self)}function reject(self,newValue){self._37=2,self._12=newValue,finale(self)}function finale(self){for(var i=0;i<self._59.length;i++)handle(self,self._59[i]);self._59=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,promise){var done=!1,res=tryCallTwo(fn,function(value){done||(done=!0,resolve(promise,value))},function(reason){done||(done=!0,reject(promise,reason))});done||res!==IS_ERROR||(done=!0,reject(promise,LAST_ERROR))}var asap=require("asap/raw"),LAST_ERROR=null,IS_ERROR={};module.exports=Promise,Promise._99=noop,Promise.prototype.then=function(onFulfilled,onRejected){if(this.constructor!==Promise)return safeThen(this,onFulfilled,onRejected);var res=new Promise(noop);return handle(this,new Handler(onFulfilled,onRejected,res)),res}},{"asap/raw":11}],10:[function(require,module){"use strict";function valuePromise(value){var p=new Promise(Promise._99);return p._37=1,p._12=value,p}var Promise=require("./core.js");module.exports=Promise;var TRUE=valuePromise(!0),FALSE=valuePromise(!1),NULL=valuePromise(null),UNDEFINED=valuePromise(void 0),ZERO=valuePromise(0),EMPTYSTRING=valuePromise("");Promise.resolve=function(value){if(value instanceof Promise)return value;if(null===value)return NULL;if(void 0===value)return UNDEFINED;if(value===!0)return TRUE;if(value===!1)return FALSE;if(0===value)return ZERO;if(""===value)return EMPTYSTRING;if("object"==typeof value||"function"==typeof value)try{var then=value.then;if("function"==typeof then)return new Promise(then.bind(value))}catch(ex){return new Promise(function(resolve,reject){reject(ex)})}return valuePromise(value)},Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){function res(i,val){if(val&&("object"==typeof val||"function"==typeof val)){if(val instanceof Promise&&val.then===Promise.prototype.then){for(;3===val._37;)val=val._12;return 1===val._37?res(i,val._12):(2===val._37&&reject(val._12),val.then(function(val){res(i,val)},reject),void 0)}var then=val.then;if("function"==typeof then){var p=new Promise(then.bind(val));return p.then(function(val){res(i,val)},reject),void 0}}args[i]=val,0===--remaining&&resolve(args)}if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){values.forEach(function(value){Promise.resolve(value).then(resolve,reject)})})},Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)}},{"./core.js":9}],11:[function(require,module){(function(process){"use strict";function rawAsap(task){queue.length||(requestFlush(),flushing=!0),queue[queue.length]=task}function flush(){for(;index<queue.length;){var currentIndex=index;if(index+=1,queue[currentIndex].call(),index>capacity){for(var scan=0,newLength=queue.length-index;newLength>scan;scan++)queue[scan]=queue[scan+index];queue.length-=index,index=0}}queue.length=0,index=0,flushing=!1}function requestFlush(){var parentDomain=process.domain;parentDomain&&(domain||(domain=require("domain")),domain.active=process.domain=null),flushing&&hasSetImmediate?setImmediate(flush):process.nextTick(flush),parentDomain&&(domain.active=process.domain=parentDomain)}var domain,hasSetImmediate="function"==typeof setImmediate;module.exports=rawAsap;var queue=[],flushing=!1,index=0,capacity=1024;rawAsap.requestFlush=requestFlush}).call(this,require("_process"))},{_process:6,domain:4}],12:[function(require,module){(function(global){(function(module,exports,require,define,browserify_shim__define__module__export__){!function(global){"use strict";function stuff(url,options,cb){function init(){context.handshake(),once||(cb(context),once=!0)}"function"==typeof options&&(cb=options,options={}),cb||(cb=noop);var el=options&&1===options.nodeType?options:options.el||document.querySelector("body");options.el=null;var iframe=document.createElement("iframe"),context=new Context(iframe,options);global.addEventListener("message",context.messageHandler.bind(context),!1),iframes.push(iframe),iframe.setAttribute("scrolling","no"),iframe.setAttribute("src",url);var once=!1;iframe.addEventListener("load",init,!1),el.appendChild(iframe)}function Context(iframe,options){if(this.iframe=iframe,this.callbacks={},this.eventQ={load:[],evaljs:[],html:[]},options.sandbox===!0)this.sandbox="allow-scripts allow-same-origin";else if("string"==typeof options.sandbox){var sandbox=options.sandbox;-1===sandbox.indexOf("allow-scripts")&&(sandbox+=" allow-scripts"),-1===sandbox.indexOf("allow-same-origin")&&(sandbox+=" allow-same-origin"),this.sandbox=sandbox}else this.sandbox=null;this.secret=Math.ceil(999999999*Math.random())+1}var iframes=[],noop=function(){};stuff.clear=function(){iframes.forEach(function(iframe){var parent=iframe.parentElement;parent&&parent.removeChild(iframe)}),iframes=[]},Context.prototype.handle=function(type,data){var callbacks,that=this;if("custom"===type){var msg=data;callbacks=this.callbacks[msg.type]||[],callbacks.forEach(function(cb){"function"==typeof cb&&cb.call(cb.thisArg||that,msg.data)})}else{if(callbacks=this.eventQ[type],!callbacks)return;var cb=callbacks.shift();"function"==typeof cb&&cb.call(cb.thisArg||that,data)}},Context.prototype.messageHandler=function(e){var msg;try{msg=JSON.parse(e.data)}catch(err){return}if(msg.secret===this.secret){var data=msg.data,type=msg.type;this.handle(type,data)}},Context.prototype.post=function(type,data){this.iframe.contentWindow.postMessage(JSON.stringify({type:type,data:data,secret:this.secret}),"*")},Context.prototype.evaljs=function(js,cb,thisArg){var callback=function(d){var Type,e=d.error,error=e;e&&(Type=global[e.__errorType__])&&(error=new Type(e.message),error.stack=e.stack,error.type=e.type,error.arguments=e.arguments),(cb||noop).call(this,error,d.result)};callback.thisArg=thisArg,this.eventQ.evaljs.push(callback),this.post("evaljs",js)},Context.prototype.load=function(html,cb,thisArg){cb=cb||noop,cb.thisArg=thisArg,this.eventQ.load.push(cb),this.post("load",html)},Context.prototype.html=function(cb,thisArg){cb=cb||noop,cb.thisArg=thisArg,this.eventQ.html.push(cb),this.post("html",null)},Context.prototype.handshake=function(){this.post("handshake",this.sandbox)},Context.prototype.on=function(event,cb,thisArg){cb=cb||noop,cb.thisArg=thisArg,this.callbacks[event]?this.callbacks[event].push(cb):this.callbacks[event]=[cb]},Context.prototype.off=function(event,cb){var callbacks=this.callbacks[event];if(callbacks){var i=callbacks.indexOf(cb);-1!==i&&callbacks.splice(i,1)}else this.callbacks[event]=[]},stuff.Context=Context,global.stuff=stuff}(this),browserify_shim__define__module__export__("undefined"!=typeof stuff?stuff:window.stuff)}).call(global,void 0,void 0,void 0,void 0,function(ex){module.exports=ex})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}),/*!
 * Modernizr v2.7.1
 * www.modernizr.com
 *
 * Copyright (c) Faruk Ates, Paul Irish, Alex Sexton
 * Available under the BSD and MIT licenses: www.modernizr.com/license/
 */
window.Modernizr=function(window,document,undefined){function setCss(str){mStyle.cssText=str}function setCssAll(str1,str2){return setCss(prefixes.join(str1+";")+(str2||""))}function is(obj,type){return typeof obj===type}function contains(str,substr){return!!~(""+str).indexOf(substr)}function testProps(props,prefixed){for(var i in props){var prop=props[i];if(!contains(prop,"-")&&mStyle[prop]!==undefined)return"pfx"==prefixed?prop:!0}return!1}function testDOMProps(props,obj,elem){for(var i in props){var item=obj[props[i]];if(item!==undefined)return elem===!1?props[i]:is(item,"function")?item.bind(elem||obj):item}return!1}function testPropsAll(prop,prefixed,elem){var ucProp=prop.charAt(0).toUpperCase()+prop.slice(1),props=(prop+" "+cssomPrefixes.join(ucProp+" ")+ucProp).split(" ");return is(prefixed,"string")||is(prefixed,"undefined")?testProps(props,prefixed):(props=(prop+" "+domPrefixes.join(ucProp+" ")+ucProp).split(" "),testDOMProps(props,prefixed,elem))}function webforms(){Modernizr.input=function(props){for(var i=0,len=props.length;len>i;i++)attrs[props[i]]=!!(props[i]in inputElem);return attrs.list&&(attrs.list=!(!document.createElement("datalist")||!window.HTMLDataListElement)),attrs}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),Modernizr.inputtypes=function(props){for(var bool,inputElemType,defaultView,i=0,len=props.length;len>i;i++)inputElem.setAttribute("type",inputElemType=props[i]),bool="text"!==inputElem.type,bool&&(inputElem.value=smile,inputElem.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(inputElemType)&&inputElem.style.WebkitAppearance!==undefined?(docElement.appendChild(inputElem),defaultView=document.defaultView,bool=defaultView.getComputedStyle&&"textfield"!==defaultView.getComputedStyle(inputElem,null).WebkitAppearance&&0!==inputElem.offsetHeight,docElement.removeChild(inputElem)):/^(search|tel)$/.test(inputElemType)||(bool=/^(url|email)$/.test(inputElemType)?inputElem.checkValidity&&inputElem.checkValidity()===!1:inputElem.value!=smile)),inputs[props[i]]=!!bool;return inputs}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var featureName,hasOwnProp,version="2.7.1",Modernizr={},enableClasses=!0,docElement=document.documentElement,mod="modernizr",modElem=document.createElement(mod),mStyle=modElem.style,inputElem=document.createElement("input"),smile=":)",toString={}.toString,prefixes=" -webkit- -moz- -o- -ms- ".split(" "),omPrefixes="Webkit Moz O ms",cssomPrefixes=omPrefixes.split(" "),domPrefixes=omPrefixes.toLowerCase().split(" "),ns={svg:"http://www.w3.org/2000/svg"},tests={},inputs={},attrs={},classes=[],slice=classes.slice,injectElementWithStyles=function(rule,callback,nodes,testnames){var style,ret,node,docOverflow,div=document.createElement("div"),body=document.body,fakeBody=body||document.createElement("body");if(parseInt(nodes,10))for(;nodes--;)node=document.createElement("div"),node.id=testnames?testnames[nodes]:mod+(nodes+1),div.appendChild(node);return style=["&#173;",'<style id="s',mod,'">',rule,"</style>"].join(""),div.id=mod,(body?div:fakeBody).innerHTML+=style,fakeBody.appendChild(div),body||(fakeBody.style.background="",fakeBody.style.overflow="hidden",docOverflow=docElement.style.overflow,docElement.style.overflow="hidden",docElement.appendChild(fakeBody)),ret=callback(div,rule),body?div.parentNode.removeChild(div):(fakeBody.parentNode.removeChild(fakeBody),docElement.style.overflow=docOverflow),!!ret},testMediaQuery=function(mq){var matchMedia=window.matchMedia||window.msMatchMedia;if(matchMedia)return matchMedia(mq).matches;var bool;return injectElementWithStyles("@media "+mq+" { #"+mod+" { position: absolute; } }",function(node){bool="absolute"==(window.getComputedStyle?getComputedStyle(node,null):node.currentStyle).position}),bool},isEventSupported=function(){function isEventSupported(eventName,element){element=element||document.createElement(TAGNAMES[eventName]||"div"),eventName="on"+eventName;var isSupported=eventName in element;return isSupported||(element.setAttribute||(element=document.createElement("div")),element.setAttribute&&element.removeAttribute&&(element.setAttribute(eventName,""),isSupported=is(element[eventName],"function"),is(element[eventName],"undefined")||(element[eventName]=undefined),element.removeAttribute(eventName))),element=null,isSupported}var TAGNAMES={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return isEventSupported}(),_hasOwnProperty={}.hasOwnProperty;hasOwnProp=is(_hasOwnProperty,"undefined")||is(_hasOwnProperty.call,"undefined")?function(object,property){return property in object&&is(object.constructor.prototype[property],"undefined")}:function(object,property){return _hasOwnProperty.call(object,property)},Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError;var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F,result=target.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}return target.apply(that,args.concat(slice.call(arguments)))};return bound}),tests.flexbox=function(){return testPropsAll("flexWrap")},tests.flexboxlegacy=function(){return testPropsAll("boxDirection")},tests.canvas=function(){var elem=document.createElement("canvas");return!(!elem.getContext||!elem.getContext("2d"))},tests.canvastext=function(){return!(!Modernizr.canvas||!is(document.createElement("canvas").getContext("2d").fillText,"function"))},tests.webgl=function(){return!!window.WebGLRenderingContext},tests.touch=function(){var bool;return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?bool=!0:injectElementWithStyles(["@media (",prefixes.join("touch-enabled),("),mod,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(node){bool=9===node.offsetTop}),bool},tests.geolocation=function(){return"geolocation"in navigator},tests.postmessage=function(){return!!window.postMessage},tests.websqldatabase=function(){return!!window.openDatabase},tests.indexedDB=function(){return!!testPropsAll("indexedDB",window)},tests.hashchange=function(){return isEventSupported("hashchange",window)&&(document.documentMode===undefined||document.documentMode>7)},tests.history=function(){return!(!window.history||!history.pushState)},tests.draganddrop=function(){var div=document.createElement("div");return"draggable"in div||"ondragstart"in div&&"ondrop"in div},tests.websockets=function(){return"WebSocket"in window||"MozWebSocket"in window},tests.rgba=function(){return setCss("background-color:rgba(150,255,150,.5)"),contains(mStyle.backgroundColor,"rgba")},tests.hsla=function(){return setCss("background-color:hsla(120,40%,100%,.5)"),contains(mStyle.backgroundColor,"rgba")||contains(mStyle.backgroundColor,"hsla")},tests.multiplebgs=function(){return setCss("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(mStyle.background)},tests.backgroundsize=function(){return testPropsAll("backgroundSize")},tests.borderimage=function(){return testPropsAll("borderImage")},tests.borderradius=function(){return testPropsAll("borderRadius")},tests.boxshadow=function(){return testPropsAll("boxShadow")},tests.textshadow=function(){return""===document.createElement("div").style.textShadow},tests.opacity=function(){return setCssAll("opacity:.55"),/^0.55$/.test(mStyle.opacity)},tests.cssanimations=function(){return testPropsAll("animationName")},tests.csscolumns=function(){return testPropsAll("columnCount")},tests.cssgradients=function(){var str1="background-image:",str2="gradient(linear,left top,right bottom,from(#9f9),to(white));",str3="linear-gradient(left top,#9f9, white);";return setCss((str1+"-webkit- ".split(" ").join(str2+str1)+prefixes.join(str3+str1)).slice(0,-str1.length)),contains(mStyle.backgroundImage,"gradient")},tests.cssreflections=function(){return testPropsAll("boxReflect")},tests.csstransforms=function(){return!!testPropsAll("transform")},tests.csstransforms3d=function(){var ret=!!testPropsAll("perspective");return ret&&"webkitPerspective"in docElement.style&&injectElementWithStyles("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(node){ret=9===node.offsetLeft&&3===node.offsetHeight}),ret},tests.csstransitions=function(){return testPropsAll("transition")},tests.fontface=function(){var bool;return injectElementWithStyles('@font-face {font-family:"font";src:url("https://")}',function(node,rule){var style=document.getElementById("smodernizr"),sheet=style.sheet||style.styleSheet,cssText=sheet?sheet.cssRules&&sheet.cssRules[0]?sheet.cssRules[0].cssText:sheet.cssText||"":"";bool=/src/i.test(cssText)&&0===cssText.indexOf(rule.split(" ")[0])}),bool},tests.generatedcontent=function(){var bool;return injectElementWithStyles(["#",mod,"{font:0/0 a}#",mod,':after{content:"',smile,'";visibility:hidden;font:3px/1 a}'].join(""),function(node){bool=node.offsetHeight>=3}),bool},tests.video=function(){var elem=document.createElement("video"),bool=!1;try{(bool=!!elem.canPlayType)&&(bool=new Boolean(bool),bool.ogg=elem.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),bool.h264=elem.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),bool.webm=elem.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(e){}return bool},tests.audio=function(){var elem=document.createElement("audio"),bool=!1;try{(bool=!!elem.canPlayType)&&(bool=new Boolean(bool),bool.ogg=elem.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),bool.mp3=elem.canPlayType("audio/mpeg;").replace(/^no$/,""),bool.wav=elem.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),bool.m4a=(elem.canPlayType("audio/x-m4a;")||elem.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(e){}return bool},tests.localstorage=function(){try{return localStorage.setItem(mod,mod),localStorage.removeItem(mod),!0}catch(e){return!1}},tests.sessionstorage=function(){try{return sessionStorage.setItem(mod,mod),sessionStorage.removeItem(mod),!0}catch(e){return!1}},tests.webworkers=function(){return!!window.Worker},tests.applicationcache=function(){return!!window.applicationCache},tests.svg=function(){return!!document.createElementNS&&!!document.createElementNS(ns.svg,"svg").createSVGRect},tests.inlinesvg=function(){var div=document.createElement("div");return div.innerHTML="<svg/>",(div.firstChild&&div.firstChild.namespaceURI)==ns.svg},tests.smil=function(){return!!document.createElementNS&&/SVGAnimate/.test(toString.call(document.createElementNS(ns.svg,"animate")))},tests.svgclippaths=function(){return!!document.createElementNS&&/SVGClipPath/.test(toString.call(document.createElementNS(ns.svg,"clipPath")))};for(var feature in tests)hasOwnProp(tests,feature)&&(featureName=feature.toLowerCase(),Modernizr[featureName]=tests[feature](),classes.push((Modernizr[featureName]?"":"no-")+featureName));return Modernizr.input||webforms(),Modernizr.addTest=function(feature,test){if("object"==typeof feature)for(var key in feature)hasOwnProp(feature,key)&&Modernizr.addTest(key,feature[key]);else{if(feature=feature.toLowerCase(),Modernizr[feature]!==undefined)return Modernizr;test="function"==typeof test?test():test,"undefined"!=typeof enableClasses&&enableClasses&&(docElement.className+=" "+(test?"":"no-")+feature),Modernizr[feature]=test}return Modernizr},setCss(""),modElem=inputElem=null,function(window,document){function addStyleSheet(ownerDocument,cssText){var p=ownerDocument.createElement("p"),parent=ownerDocument.getElementsByTagName("head")[0]||ownerDocument.documentElement;return p.innerHTML="x<style>"+cssText+"</style>",parent.insertBefore(p.lastChild,parent.firstChild)}function getElements(){var elements=html5.elements;return"string"==typeof elements?elements.split(" "):elements}function getExpandoData(ownerDocument){var data=expandoData[ownerDocument[expando]];return data||(data={},expanID++,ownerDocument[expando]=expanID,expandoData[expanID]=data),data}function createElement(nodeName,ownerDocument,data){if(ownerDocument||(ownerDocument=document),supportsUnknownElements)return ownerDocument.createElement(nodeName);data||(data=getExpandoData(ownerDocument));var node;return node=data.cache[nodeName]?data.cache[nodeName].cloneNode():saveClones.test(nodeName)?(data.cache[nodeName]=data.createElem(nodeName)).cloneNode():data.createElem(nodeName),!node.canHaveChildren||reSkip.test(nodeName)||node.tagUrn?node:data.frag.appendChild(node)}function createDocumentFragment(ownerDocument,data){if(ownerDocument||(ownerDocument=document),supportsUnknownElements)return ownerDocument.createDocumentFragment();data=data||getExpandoData(ownerDocument);for(var clone=data.frag.cloneNode(),i=0,elems=getElements(),l=elems.length;l>i;i++)clone.createElement(elems[i]);return clone}function shivMethods(ownerDocument,data){data.cache||(data.cache={},data.createElem=ownerDocument.createElement,data.createFrag=ownerDocument.createDocumentFragment,data.frag=data.createFrag()),ownerDocument.createElement=function(nodeName){return html5.shivMethods?createElement(nodeName,ownerDocument,data):data.createElem(nodeName)},ownerDocument.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+getElements().join().replace(/[\w\-]+/g,function(nodeName){return data.createElem(nodeName),data.frag.createElement(nodeName),'c("'+nodeName+'")'})+");return n}")(html5,data.frag)}function shivDocument(ownerDocument){ownerDocument||(ownerDocument=document);var data=getExpandoData(ownerDocument);return!html5.shivCSS||supportsHtml5Styles||data.hasCSS||(data.hasCSS=!!addStyleSheet(ownerDocument,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),supportsUnknownElements||shivMethods(ownerDocument,data),ownerDocument}var supportsHtml5Styles,supportsUnknownElements,version="3.7.0",options=window.html5||{},reSkip=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,saveClones=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,expando="_html5shiv",expanID=0,expandoData={};!function(){try{var a=document.createElement("a");a.innerHTML="<xyz></xyz>",supportsHtml5Styles="hidden"in a,supportsUnknownElements=1==a.childNodes.length||function(){document.createElement("a");var frag=document.createDocumentFragment();return"undefined"==typeof frag.cloneNode||"undefined"==typeof frag.createDocumentFragment||"undefined"==typeof frag.createElement}()}catch(e){supportsHtml5Styles=!0,supportsUnknownElements=!0}}();var html5={elements:options.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:version,shivCSS:options.shivCSS!==!1,supportsUnknownElements:supportsUnknownElements,shivMethods:options.shivMethods!==!1,type:"default",shivDocument:shivDocument,createElement:createElement,createDocumentFragment:createDocumentFragment};window.html5=html5,shivDocument(document)}(this,document),Modernizr._version=version,Modernizr._prefixes=prefixes,Modernizr._domPrefixes=domPrefixes,Modernizr._cssomPrefixes=cssomPrefixes,Modernizr.mq=testMediaQuery,Modernizr.hasEvent=isEventSupported,Modernizr.testProp=function(prop){return testProps([prop])},Modernizr.testAllProps=testPropsAll,Modernizr.testStyles=injectElementWithStyles,Modernizr.prefixed=function(prop,obj,elem){return obj?testPropsAll(prop,obj,elem):testPropsAll(prop,"pfx")},docElement.className=docElement.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(enableClasses?" js "+classes.join(" "):""),Modernizr}(this,this.document),function(window,document,undefined){"use strict";function minErr(module,ErrorConstructor){return ErrorConstructor=ErrorConstructor||Error,function(){var paramPrefix,i,SKIP_INDEXES=2,templateArgs=arguments,code=templateArgs[0],message="["+(module?module+":":"")+code+"] ",template=templateArgs[1];for(message+=template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1),shiftedIndex=index+SKIP_INDEXES;return shiftedIndex<templateArgs.length?toDebugString(templateArgs[shiftedIndex]):match}),message+="\nhttp://errors.angularjs.org/1.4.7/"+(module?module+"/":"")+code,i=SKIP_INDEXES,paramPrefix="?";i<templateArgs.length;i++,paramPrefix="&")message+=paramPrefix+"p"+(i-SKIP_INDEXES)+"="+encodeURIComponent(toDebugString(templateArgs[i]));return new ErrorConstructor(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length="length"in Object(obj)&&obj.length;return obj.nodeType===NODE_TYPE_ELEMENT&&length?!0:isString(obj)||isArray(obj)||0===length||"number"==typeof length&&length>0&&length-1 in obj}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;length>key;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else if(isBlankObject(obj))for(key in obj)iterator.call(context,obj[key],key,obj);else if("function"==typeof obj.hasOwnProperty)for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);else for(key in obj)hasOwnProperty.call(obj,key)&&iterator.call(context,obj[key],key,obj);return obj}function forEachSorted(obj,iterator,context){for(var keys=Object.keys(obj).sort(),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){return++uid}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function baseExtend(dst,objs,deep){for(var h=dst.$$hashKey,i=0,ii=objs.length;ii>i;++i){var obj=objs[i];if(isObject(obj)||isFunction(obj))for(var keys=Object.keys(obj),j=0,jj=keys.length;jj>j;j++){var key=keys[j],src=obj[key];deep&&isObject(src)?isDate(src)?dst[key]=new Date(src.valueOf()):isRegExp(src)?dst[key]=new RegExp(src):(isObject(dst[key])||(dst[key]=isArray(src)?[]:{}),baseExtend(dst[key],[src],!0)):dst[key]=src}}return setHashKey(dst,h),dst}function extend(dst){return baseExtend(dst,slice.call(arguments,1),!1)}function merge(dst){return baseExtend(dst,slice.call(arguments,1),!0)}function toInt(str){return parseInt(str,10)}function inherit(parent,extra){return extend(Object.create(parent),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function hasCustomToString(obj){return isFunction(obj.toString)&&obj.toString!==Object.prototype.toString}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!==value&&"object"==typeof value}function isBlankObject(value){return null!==value&&"object"==typeof value&&!getPrototypeOf(value)}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isFormData(obj){return"[object FormData]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isBoolean(value){return"boolean"==typeof value}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isTypedArray(value){return TYPED_ARRAY_REGEXP.test(toString.call(value))}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function nodeName_(element){return lowercase(element.nodeName||element[0]&&element[0].nodeName)}function arrayRemove(array,value){var index=array.indexOf(value);return index>=0&&array.splice(index,1),index}function copy(source,destination,stackSource,stackDest){if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(isTypedArray(destination))throw ngMinErr("cpta","Can't copy! TypedArray destination cannot be mutated.");if(destination){if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");stackSource=stackSource||[],stackDest=stackDest||[],isObject(source)&&(stackSource.push(source),stackDest.push(destination));var key;if(isArray(source)){destination.length=0;for(var i=0;i<source.length;i++)destination.push(copy(source[i],null,stackSource,stackDest))}else{var h=destination.$$hashKey;if(isArray(destination)?destination.length=0:forEach(destination,function(value,key){delete destination[key]}),isBlankObject(source))for(key in source)destination[key]=copy(source[key],null,stackSource,stackDest);else if(source&&"function"==typeof source.hasOwnProperty)for(key in source)source.hasOwnProperty(key)&&(destination[key]=copy(source[key],null,stackSource,stackDest));else for(key in source)hasOwnProperty.call(source,key)&&(destination[key]=copy(source[key],null,stackSource,stackDest));setHashKey(destination,h)}}else if(destination=source,isObject(source)){var index;if(stackSource&&-1!==(index=stackSource.indexOf(source)))return stackDest[index];if(isArray(source))return copy(source,[],stackSource,stackDest);if(isTypedArray(source))destination=new source.constructor(source);else if(isDate(source))destination=new Date(source.getTime());else if(isRegExp(source))destination=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]),destination.lastIndex=source.lastIndex;else{if(!isFunction(source.cloneNode)){var emptyObject=Object.create(getPrototypeOf(source));return copy(source,emptyObject,stackSource,stackDest)}destination=source.cloneNode(!0)}stackDest&&(stackSource.push(source),stackDest.push(destination))}return destination}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;ii>i;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)("$"!==key.charAt(0)||"$"!==key.charAt(1))&&(dst[key]=src[key])}return dst||src}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)?equals(o1.getTime(),o2.getTime()):!1;if(isRegExp(o1))return isRegExp(o2)?o1.toString()==o2.toString():!1;if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2)||isDate(o2)||isRegExp(o2))return!1;keySet=createMap();for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!(key in keySet)&&"$"!==key.charAt(0)&&isDefined(o2[key])&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,concat(curryArgs,arguments,0)):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return"undefined"==typeof obj?undefined:(isNumber(pretty)||(pretty=pretty?2:null),JSON.stringify(obj,toJsonReplacer,pretty))}function fromJson(json){return isString(json)?JSON.parse(json):json}function timezoneToOffset(timezone,fallback){var requestedTimezoneOffset=Date.parse("Jan 01, 1970 00:00:00 "+timezone)/6e4;return isNaN(requestedTimezoneOffset)?fallback:requestedTimezoneOffset}function addDateMinutes(date,minutes){return date=new Date(date.getTime()),date.setMinutes(date.getMinutes()+minutes),date}function convertTimezoneToLocal(date,timezone,reverse){reverse=reverse?-1:1;var timezoneOffset=timezoneToOffset(timezone,date.getTimezoneOffset());return addDateMinutes(date,reverse*(timezoneOffset-date.getTimezoneOffset()))}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===NODE_TYPE_TEXT?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var obj={};return forEach((keyValue||"").split("&"),function(keyValue){var splitPoint,key,val;keyValue&&(key=keyValue=keyValue.replace(/\+/g,"%20"),splitPoint=keyValue.indexOf("="),-1!==splitPoint&&(key=keyValue.substring(0,splitPoint),val=keyValue.substring(splitPoint+1)),key=tryDecodeURIComponent(key),isDefined(key)&&(val=isDefined(val)?tryDecodeURIComponent(val):!0,hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val))}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function getNgAttribute(element,ngAttr){var attr,i,ii=ngAttrPrefixes.length;for(i=0;ii>i;++i)if(attr=ngAttrPrefixes[i]+ngAttr,isString(attr=element.getAttribute(attr)))return attr;return null}function angularInit(element,bootstrap){var appElement,module,config={};forEach(ngAttrPrefixes,function(prefix){var name=prefix+"app";!appElement&&element.hasAttribute&&element.hasAttribute(name)&&(appElement=element,module=element.getAttribute(name))}),forEach(ngAttrPrefixes,function(prefix){var candidate,name=prefix+"app";!appElement&&(candidate=element.querySelector("["+name.replace(":","\\:")+"]"))&&(appElement=candidate,module=candidate.getAttribute(name))}),appElement&&(config.strictDi=null!==getNgAttribute(appElement,"strict-di"),bootstrap(appElement,module?[module]:[],config))}function bootstrap(element,modules,config){isObject(config)||(config={});var defaultConfig={strictDi:!1};config=extend(defaultConfig,config);var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App Already Bootstrapped with this Element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),config.debugInfoEnabled&&modules.push(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!0)}]),modules.unshift("ng");var injector=createInjector(modules,config.strictDi);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_ENABLE_DEBUG_INFO=/^NG_ENABLE_DEBUG_INFO!/,NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&NG_ENABLE_DEBUG_INFO.test(window.name)&&(config.debugInfoEnabled=!0,window.name=window.name.replace(NG_ENABLE_DEBUG_INFO,"")),window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){return forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},isFunction(angular.resumeDeferredBootstrap)&&angular.resumeDeferredBootstrap(),void 0)}function reloadWithDebugInfo(){window.name="NG_ENABLE_DEBUG_INFO!"+window.name,window.location.reload()}function getTestability(rootElement){var injector=angular.element(rootElement).injector();if(!injector)throw ngMinErr("test","no injector found for element argument to getTestability");return injector.get("$$testability")}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){var originalCleanData;if(!bindJQueryFired){var jqName=jq();jQuery=isUndefined(jqName)?window.jQuery:jqName?window[jqName]:undefined,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),originalCleanData=jQuery.cleanData,jQuery.cleanData=function(elems){var events;if(skipDestroyOnNextJQueryCleanData)skipDestroyOnNextJQueryCleanData=!1;else for(var elem,i=0;null!=(elem=elems[i]);i++)events=jQuery._data(elem,"events"),events&&events.$destroy&&jQuery(elem).triggerHandler("$destroy");originalCleanData(elems)}):jqLite=JQLite,angular.element=jqLite,bindJQueryFired=!0}}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockNodes(nodes){for(var blockNodes,node=nodes[0],endNode=nodes[nodes.length-1],i=1;node!==endNode&&(node=node.nextSibling);i++)(blockNodes||nodes[i]!==node)&&(blockNodes||(blockNodes=jqLite(slice.call(nodes,0,i))),blockNodes.push(node));return blockNodes||nodes}function createMap(){return Object.create(null)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod,queue){return queue||(queue=invokeQueue),function(){return queue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}function invokeLaterAndSetModuleName(provider,method){return function(recipeName,factoryFunction){return factoryFunction&&isFunction(factoryFunction)&&(factoryFunction.$$moduleName=name),invokeQueue.push([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],configBlocks=[],runBlocks=[],config=invokeLater("$injector","invoke","push",configBlocks),moduleInstance={_invokeQueue:invokeQueue,_configBlocks:configBlocks,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLaterAndSetModuleName("$provide","provider"),factory:invokeLaterAndSetModuleName("$provide","factory"),service:invokeLaterAndSetModuleName("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),decorator:invokeLaterAndSetModuleName("$provide","decorator"),animation:invokeLaterAndSetModuleName("$animateProvider","register"),filter:invokeLaterAndSetModuleName("$filterProvider","register"),controller:invokeLaterAndSetModuleName("$controllerProvider","register"),directive:invokeLaterAndSetModuleName("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this
}};return configFn&&config(configFn),moduleInstance})}})}function serializeObject(obj){var seen=[];return JSON.stringify(obj,function(key,val){if(val=toJsonReplacer(key,val),isObject(val)){if(seen.indexOf(val)>=0)return"...";seen.push(val)}return val})}function toDebugString(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):isUndefined(obj)?"undefined":"string"!=typeof obj?serializeObject(obj):obj}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,merge:merge,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0},getTestability:getTestability,$$minErr:minErr,$$csp:csp,reloadWithDebugInfo:reloadWithDebugInfo}),(angularModule=setupModuleLoader(window))("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,pattern:patternDirective,ngPattern:patternDirective,required:requiredDirective,ngRequired:requiredDirective,minlength:minlengthDirective,ngMinlength:minlengthDirective,maxlength:maxlengthDirective,ngMaxlength:maxlengthDirective,ngValue:ngValueDirective,ngModelOptions:ngModelOptionsDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$animateCss:$CoreAnimateCssProvider,$$animateQueue:$$CoreAnimateQueueProvider,$$AnimateRunner:$$CoreAnimateRunnerProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$$forceReflow:$$ForceReflowProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpParamSerializer:$HttpParamSerializerProvider,$httpParamSerializerJQLike:$HttpParamSerializerJQLikeProvider,$httpBackend:$HttpBackendProvider,$xhrFactory:$xhrFactoryProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$$q:$$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$templateRequest:$TemplateRequestProvider,$$testability:$$TestabilityProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$jqLite:$$jqLiteProvider,$$HashMap:$$HashMapProvider,$$cookieReader:$$CookieReaderProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteAcceptsData(node){var nodeType=node.nodeType;return nodeType===NODE_TYPE_ELEMENT||!nodeType||nodeType===NODE_TYPE_DOCUMENT}function jqLiteHasData(node){for(var key in jqCache[node.ng339])return!0;return!1}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],i=wrap[0];i--;)tmp=tmp.lastChild;nodes=concat(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",forEach(nodes,function(node){fragment.appendChild(node)}),fragment}function jqLiteParseHTML(html,context){context=context||document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:(parsed=jqLiteBuildFragment(html,context))?parsed.childNodes:[]}function JQLite(element){if(element instanceof JQLite)return element;var argIsString;if(isString(element)&&(element=trim(element),argIsString=!0),!(this instanceof JQLite)){if(argIsString&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}argIsString?jqLiteAddNodes(this,jqLiteParseHTML(element)):jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element,onlyDescendants){if(onlyDescendants||jqLiteRemoveData(element),element.querySelectorAll)for(var descendants=element.querySelectorAll("*"),i=0,l=descendants.length;l>i;i++)jqLiteRemoveData(descendants[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,handle=expandoStore&&expandoStore.handle;if(handle)if(type)forEach(type.split(" "),function(type){if(isDefined(fn)){var listenerFns=events[type];if(arrayRemove(listenerFns||[],fn),listenerFns&&listenerFns.length>0)return}removeEventListenerFn(element,type,handle),delete events[type]});else for(type in events)"$destroy"!==type&&removeEventListenerFn(element,type,handle),delete events[type]}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];if(expandoStore){if(name)return delete expandoStore.data[name],void 0;expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=undefined}}function jqLiteExpandoStore(element,createIfNecessary){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];return createIfNecessary&&!expandoStore&&(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={events:{},data:{},handle:undefined}),expandoStore}function jqLiteData(element,key,value){if(jqLiteAcceptsData(element)){var isSimpleSetter=isDefined(value),isSimpleGetter=!isSimpleSetter&&key&&!isObject(key),massGetter=!key,expandoStore=jqLiteExpandoStore(element,!isSimpleGetter),data=expandoStore&&expandoStore.data;if(isSimpleSetter)data[key]=value;else{if(massGetter)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements)if(elements.nodeType)root[root.length++]=elements;else{var length=elements.length;if("number"==typeof length&&elements.window!==elements){if(length)for(var i=0;length>i;i++)root[root.length++]=elements[i]}else root[root.length++]=elements}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element.nodeType==NODE_TYPE_DOCUMENT&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;ii>i;i++)if(isDefined(value=jqLite.data(element,names[i])))return value;element=element.parentNode||element.nodeType===NODE_TYPE_DOCUMENT_FRAGMENT&&element.host}}function jqLiteEmpty(element){for(jqLiteDealoc(element,!0);element.firstChild;)element.removeChild(element.firstChild)}function jqLiteRemove(element,keepData){keepData||jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)}function jqLiteDocumentLoaded(action,win){win=win||window,"complete"===win.document.readyState?win.setTimeout(action):jqLite(win).on("load",action)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[nodeName_(element)]&&booleanAttr}function getAliasedAttrName(name){return ALIASED_ATTR[name]}function createEventHandler(element,events){var eventHandler=function(event,type){event.isDefaultPrevented=function(){return event.defaultPrevented};var eventFns=events[type||event.type],eventFnsLength=eventFns?eventFns.length:0;if(eventFnsLength){if(isUndefined(event.immediatePropagationStopped)){var originalStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){event.immediatePropagationStopped=!0,event.stopPropagation&&event.stopPropagation(),originalStopImmediatePropagation&&originalStopImmediatePropagation.call(event)}}event.isImmediatePropagationStopped=function(){return event.immediatePropagationStopped===!0},eventFnsLength>1&&(eventFns=shallowCopy(eventFns));for(var i=0;eventFnsLength>i;i++)event.isImmediatePropagationStopped()||eventFns[i].call(element,event)}};return eventHandler.elem=element,eventHandler}function $$jqLiteProvider(){this.$get=function(){return extend(JQLite,{hasClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteHasClass(node,classes)},addClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteAddClass(node,classes)},removeClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteRemoveClass(node,classes)}})}}function hashKey(obj,nextUidFn){var key=obj&&obj.$$hashKey;if(key)return"function"==typeof key&&(key=obj.$$hashKey()),key;var objType=typeof obj;return key="function"==objType||"object"==objType&&null!==obj?obj.$$hashKey=objType+":"+(nextUidFn||nextUid)():objType+":"+obj}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function anonFn(fn){var fnText=fn.toString().replace(STRIP_COMMENTS,""),args=fnText.match(FN_ARGS);return args?"function("+(args[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function annotate(fn,strictDi,name){var $inject,fnText,argDecl,last;if("function"==typeof fn){if(!($inject=fn.$inject)){if($inject=[],fn.length){if(strictDi)throw isString(name)&&name||(name=fn.name||anonFn(fn)),$injectorMinErr("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",name);fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})}fn.$inject=$inject}}else isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0);return $inject}function createInjector(modulesToLoad,strictDi){function supportObject(delegate){return function(key,value){return isObject(key)?(forEach(key,reverseParams(delegate)),void 0):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function enforceReturnValue(name,factory){return function(){var result=instanceInjector.invoke(factory,this);if(isUndefined(result))throw $injectorMinErr("undef","Provider '{0}' must return a value from $get factory method.",name);return result}}function factory(name,factoryFn,enforce){return provider(name,{$get:enforce!==!1?enforceReturnValue(name,factoryFn):factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val),!1)}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){assertArg(isUndefined(modulesToLoad)||isArray(modulesToLoad),"modulesToLoad","not an array");var moduleFn,runBlocks=[];return forEach(modulesToLoad,function(module){function runInvokeQueue(queue){var i,ii;for(i=0,ii=queue.length;ii>i;i++){var invokeArgs=queue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}if(!loadedModules.get(module)){loadedModules.put(module,!0);try{isString(module)?(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),runInvokeQueue(moduleFn._invokeQueue),runInvokeQueue(moduleFn._configBlocks)):isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName,caller){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName,caller)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function invoke(fn,self,locals,serviceName){"string"==typeof locals&&(serviceName=locals,locals=null);var length,i,key,args=[],$inject=createInjector.$$annotate(fn,strictDi,serviceName);for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key,serviceName))}return isArray(fn)&&(fn=fn[length]),fn.apply(self,args)}function instantiate(Type,locals,serviceName){var instance=Object.create((isArray(Type)?Type[Type.length-1]:Type).prototype||null),returnedValue=invoke(Type,instance,locals,serviceName);return isObject(returnedValue)||isFunction(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:createInjector.$$annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}strictDi=strictDi===!0;var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],!0),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(serviceName,caller){throw angular.isString(caller)&&path.push(caller),$injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(serviceName,caller){var provider=providerInjector.get(serviceName+providerSuffix,caller);return instanceInjector.invoke(provider.$get,provider,undefined,serviceName)});return forEach(loadModules(modulesToLoad),function(fn){fn&&instanceInjector.invoke(fn)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return Array.prototype.some.call(list,function(element){return"a"===nodeName_(element)?(result=element,!0):void 0}),result}function getYOffset(){var offset=scroll.yOffset;if(isFunction(offset))offset=offset();else if(isElement(offset)){var elem=offset[0],style=$window.getComputedStyle(elem);offset="fixed"!==style.position?0:elem.getBoundingClientRect().bottom}else isNumber(offset)||(offset=0);return offset}function scrollTo(elem){if(elem){elem.scrollIntoView();var offset=getYOffset();if(offset){var elemTop=elem.getBoundingClientRect().top;$window.scrollBy(0,elemTop-offset)}}else $window.scrollTo(0,0)}function scroll(hash){hash=isString(hash)?hash:$location.hash();var elm;hash?(elm=document.getElementById(hash))?scrollTo(elm):(elm=getFirstAnchor(document.getElementsByName(hash)))?scrollTo(elm):"top"===hash&&scrollTo(null):scrollTo(null)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(newVal,oldVal){(newVal!==oldVal||""!==newVal)&&jqLiteDocumentLoaded(function(){$rootScope.$evalAsync(scroll)})}),scroll}]}function mergeClasses(a,b){return a||b?a?b?(isArray(a)&&(a=a.join(" ")),isArray(b)&&(b=b.join(" ")),a+" "+b):a:b:""}function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType===ELEMENT_NODE)return elm}}function splitClasses(classes){isString(classes)&&(classes=classes.split(" "));var obj=createMap();return forEach(classes,function(klass){klass.length&&(obj[klass]=!0)}),obj}function prepareAnimateOptions(options){return isObject(options)?options:{}}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function getHash(url){var index=url.indexOf("#");return-1===index?"":url.substr(index)}function cacheStateAndFireUrlChange(){pendingLocation=null,cacheState(),fireUrlChange()}function getCurrentState(){try{return history.state}catch(e){}}function cacheState(){cachedState=getCurrentState(),cachedState=isUndefined(cachedState)?null:cachedState,equals(cachedState,lastCachedState)&&(cachedState=lastCachedState),lastCachedState=cachedState}function fireUrlChange(){(lastBrowserUrl!==self.url()||lastHistoryState!==cachedState)&&(lastBrowserUrl=self.url(),lastHistoryState=cachedState,forEach(urlChangeListeners,function(listener){listener(self.url(),cachedState)}))}var self=this,location=(document[0],window.location),history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var cachedState,lastHistoryState,lastBrowserUrl=location.href,baseElement=document.find("base"),pendingLocation=null;cacheState(),lastHistoryState=cachedState,self.url=function(url,replace,state){if(isUndefined(state)&&(state=null),location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){var sameState=lastHistoryState===state;if(lastBrowserUrl===url&&(!$sniffer.history||sameState))return self;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,lastHistoryState=state,!$sniffer.history||sameBase&&sameState?((!sameBase||pendingLocation)&&(pendingLocation=url),replace?location.replace(url):sameBase?location.hash=getHash(url):location.href=url,location.href!==url&&(pendingLocation=url)):(history[replace?"replaceState":"pushState"](state,"",url),cacheState(),lastHistoryState=cachedState),self}return pendingLocation||location.href.replace(/%27/g,"'")},self.state=function(){return cachedState};var urlChangeListeners=[],urlChangeInit=!1,lastCachedState=null;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",cacheStateAndFireUrlChange),jqLite(window).on("hashchange",cacheStateAndFireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$applicationDestroyed=function(){jqLite(window).off("hashchange popstate",cacheStateAndFireUrlChange)},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(!isUndefined(value)){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value}},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}delete data[key],size--},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide,$$sanitizeUriProvider){function parseIsolateBindings(scope,directiveName,isController){var LOCAL_REGEXP=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,bindings={};return forEach(scope,function(definition,scopeName){var match=definition.match(LOCAL_REGEXP);if(!match)throw $compileMinErr("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",directiveName,scopeName,definition,isController?"controller bindings definition":"isolate scope definition");bindings[scopeName]={mode:match[1][0],collection:"*"===match[2],optional:"?"===match[3],attrName:match[4]||scopeName}}),bindings}function parseDirectiveBindings(directive,directiveName){var bindings={isolateScope:null,bindToController:null};if(isObject(directive.scope)&&(directive.bindToController===!0?(bindings.bindToController=parseIsolateBindings(directive.scope,directiveName,!0),bindings.isolateScope={}):bindings.isolateScope=parseIsolateBindings(directive.scope,directiveName,!1)),isObject(directive.bindToController)&&(bindings.bindToController=parseIsolateBindings(directive.bindToController,directiveName,!0)),isObject(bindings.bindToController)){var controller=directive.controller,controllerAs=directive.controllerAs;if(!controller)throw $compileMinErr("noctrl","Cannot bind to controller without directive '{0}'s controller.",directiveName);if(!identifierForController(controller,controllerAs))throw $compileMinErr("noident","Cannot bind to controller without identifier for directive '{0}'.",directiveName)}return bindings}function assertValidDirectiveName(name){var letter=name.charAt(0);if(!letter||letter!==lowercase(letter))throw $compileMinErr("baddir","Directive name '{0}' is invalid. The first character must be a lowercase letter",name);if(name!==name.trim())throw $compileMinErr("baddir","Directive name '{0}' is invalid. The name should not contain leading or trailing whitespaces",name)}var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\w\-]+)(?:\:([^;]+))?;?)/,ALL_OR_NOTHING_ATTRS=makeMap("ngSrc,ngSrcset,src,srcset"),REQUIRE_PREFIX_REGEXP=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/;this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertValidDirectiveName(name),assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"EA";var bindings=directive.$$bindings=parseDirectiveBindings(directive,directive.name);isObject(bindings.isolateScope)&&(directive.$$isolateBindings=bindings.isolateScope),directive.$$moduleName=directiveFactory.$$moduleName,directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()};var debugInfoEnabled=!0;this.debugInfoEnabled=function(enabled){return isDefined(enabled)?(debugInfoEnabled=enabled,this):debugInfoEnabled},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$templateRequest,$parse,$controller,$rootScope,$document,$sce,$animate,$$sanitizeUri){function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){node.nodeType==NODE_TYPE_TEXT&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);compile.$$addScopeClass($compileNodes);var namespace=null;return function(scope,cloneConnectFn,options){assertArg(scope,"scope"),options=options||{};var parentBoundTranscludeFn=options.parentBoundTranscludeFn,transcludeControllers=options.transcludeControllers,futureParentElement=options.futureParentElement;parentBoundTranscludeFn&&parentBoundTranscludeFn.$$boundTransclude&&(parentBoundTranscludeFn=parentBoundTranscludeFn.$$boundTransclude),namespace||(namespace=detectNamespaceForChildElements(futureParentElement));var $linkNode;if($linkNode="html"!==namespace?jqLite(wrapTemplate(namespace,jqLite("<div>").append($compileNodes).html())):cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,transcludeControllers)for(var controllerName in transcludeControllers)$linkNode.data("$"+controllerName+"Controller",transcludeControllers[controllerName].instance);return compile.$$addScopeInfo($linkNode,scope),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function detectNamespaceForChildElements(parentElement){var node=parentElement&&parentElement[0];return node?"foreignobject"!==nodeName_(node)&&node.toString().match(/SVG/)?"svg":"html":"html"}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,idx,childBoundTranscludeFn,stableNodeList;if(nodeLinkFnFound){var nodeListLength=nodeList.length;for(stableNodeList=new Array(nodeListLength),i=0;i<linkFns.length;i+=3)idx=linkFns[i],stableNodeList[idx]=nodeList[idx]}else stableNodeList=nodeList;for(i=0,ii=linkFns.length;ii>i;)if(node=stableNodeList[linkFns[i++]],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn){if(nodeLinkFn.scope){childScope=scope.$new(),compile.$$addScopeInfo(jqLite(node),childScope);var destroyBindings=nodeLinkFn.$$destroyBindings;destroyBindings&&(nodeLinkFn.$$destroyBindings=null,childScope.$on("$destroyed",destroyBindings))}else childScope=scope;childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn,nodeLinkFn)}else childLinkFn&&childLinkFn(scope,node.childNodes,undefined,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,nodeLinkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&compile.$$addScopeClass(attrs.$$element),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),(nodeLinkFn||childLinkFn)&&(linkFns.push(i,nodeLinkFn,childLinkFn),linkFnFound=!0,nodeLinkFnFound=nodeLinkFnFound||nodeLinkFn),previousCompileContext=null;
return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){var boundTranscludeFn=function(transcludedScope,cloneFn,controllers,futureParentElement,containingScope){return transcludedScope||(transcludedScope=scope.$new(!1,containingScope),transcludedScope.$$transcluded=!0),transcludeFn(transcludedScope,cloneFn,{parentBoundTranscludeFn:previousBoundTranscludeFn,transcludeControllers:controllers,futureParentElement:futureParentElement})};return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case NODE_TYPE_ELEMENT:addDirective(directives,directiveNormalize(nodeName_(node)),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;attr=nAttrs[j],name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=name.replace(PREFIX_REGEXP,"").substr(8).replace(/_(.)/g,function(match,letter){return letter.toUpperCase()}));var directiveNName=ngAttrName.replace(/(Start|End)$/,"");directiveIsMultiElement(directiveNName)&&ngAttrName===directiveNName+"Start"&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,(isNgAttr||!attrs.hasOwnProperty(nName))&&(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName,isNgAttr),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}if(className=node.className,isObject(className)&&(className=className.animVal),isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case NODE_TYPE_TEXT:if(11===msie)for(;node.parentNode&&node.nextSibling&&node.nextSibling.nodeType===NODE_TYPE_TEXT;)node.nodeValue=node.nodeValue+node.nextSibling.nodeValue,node.parentNode.removeChild(node.nextSibling);addTextInterpolateDirective(directives,node.nodeValue);break;case NODE_TYPE_COMMENT:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);node.nodeType==NODE_TYPE_ELEMENT&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function getControllers(directiveName,require,$element,elementControllers){var value;if(isString(require)){var match=require.match(REQUIRE_PREFIX_REGEXP),name=require.substring(match[0].length),inheritType=match[1]||match[3],optional="?"===match[2];if("^^"===inheritType?$element=$element.parent():(value=elementControllers&&elementControllers[name],value=value&&value.instance),!value){var dataName="$"+name+"Controller";value=inheritType?$element.inheritedData(dataName):$element.data(dataName)}if(!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",name,directiveName)}else if(isArray(require)){value=[];for(var i=0,ii=require.length;ii>i;i++)value[i]=getControllers(directiveName,require[i],$element,elementControllers)}return value||null}function setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope){var elementControllers=createMap();for(var controllerKey in controllerDirectives){var directive=controllerDirectives[controllerKey],locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn},controller=directive.controller;"@"==controller&&(controller=attrs[directive.name]);var controllerInstance=$controller(controller,locals,!0,directive.controllerAs);elementControllers[directive.name]=controllerInstance,hasElementTranscludeDirective||$element.data("$"+directive.name+"Controller",controllerInstance.instance)}return elementControllers}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn,thisLinkFn){function controllersBoundTransclude(scope,cloneAttachFn,futureParentElement){var transcludeControllers;return isScope(scope)||(futureParentElement=cloneAttachFn,cloneAttachFn=scope,scope=undefined),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),futureParentElement||(futureParentElement=hasElementTranscludeDirective?$element.parent():$element),boundTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild)}var i,ii,linkFn,controller,isolateScope,elementControllers,transcludeFn,$element,attrs;if(compileNode===linkNode?(attrs=templateAttrs,$element=templateAttrs.$$element):($element=jqLite(linkNode),attrs=new Attributes($element,templateAttrs)),newIsolateScopeDirective&&(isolateScope=scope.$new(!0)),boundTranscludeFn&&(transcludeFn=controllersBoundTransclude,transcludeFn.$$boundTransclude=boundTranscludeFn),controllerDirectives&&(elementControllers=setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope)),newIsolateScopeDirective&&(compile.$$addScopeInfo($element,isolateScope,!0,!(templateDirective&&(templateDirective===newIsolateScopeDirective||templateDirective===newIsolateScopeDirective.$$originalDirective))),compile.$$addScopeClass($element,!0),isolateScope.$$isolateBindings=newIsolateScopeDirective.$$isolateBindings,initializeDirectiveBindings(scope,attrs,isolateScope,isolateScope.$$isolateBindings,newIsolateScopeDirective,isolateScope)),elementControllers){var bindings,controllerForBindings,scopeDirective=newIsolateScopeDirective||newScopeDirective;scopeDirective&&elementControllers[scopeDirective.name]&&(bindings=scopeDirective.$$bindings.bindToController,controller=elementControllers[scopeDirective.name],controller&&controller.identifier&&bindings&&(controllerForBindings=controller,thisLinkFn.$$destroyBindings=initializeDirectiveBindings(scope,attrs,controller.instance,bindings,scopeDirective)));for(i in elementControllers){controller=elementControllers[i];var controllerResult=controller();controllerResult!==controller.instance&&(controller.instance=controllerResult,$element.data("$"+i+"Controller",controllerResult),controller===controllerForBindings&&(thisLinkFn.$$destroyBindings(),thisLinkFn.$$destroyBindings=initializeDirectiveBindings(scope,attrs,controllerResult,bindings,scopeDirective)))}}for(i=0,ii=preLinkFns.length;ii>i;i++)linkFn=preLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,undefined,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)linkFn=postLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}previousCompileContext=previousCompileContext||{};for(var directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,newScopeDirective=previousCompileContext.newScopeDirective,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(directive.templateUrl||(isObject(directiveValue)?(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective||newScopeDirective,directive,$compileNode),newIsolateScopeDirective=directive):assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode)),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||createMap(),assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue?(hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective})):($template=jqLite(jqLiteClone(compileNode)).contents(),$compileNode.empty(),childTranscludeFn=compile($template,transcludeFn))),directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:removeComments(wrapTemplate(directive.templateNamespace,trim(directiveValue))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));newIsolateScopeDirective&&markDirectivesAsIsolate(templateDirectives),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newScopeDirective:newScopeDirective!==directive&&newScopeDirective,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function markDirectivesAsIsolate(directives){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:!0})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(isUndefined(maxPriority)||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),tDirectives.push(directive),match=directive)}catch(e){$exceptionHandler(e)}return match}function directiveIsMultiElement(name){if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)if(directive=directives[i],directive.multiElement)return!0;return!1}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?($element.attr("style",$element.attr("style")+";"+value),dst.style=(dst.style?dst.style+";":"")+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=inherit(origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl,templateNamespace=origAsyncDirective.templateNamespace;return $compileNode.empty(),$templateRequest(templateUrl).then(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:removeComments(wrapTemplate(templateNamespace,trim(content))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectivesAsIsolate(templateDirectives),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(!scope.$$destroyed){if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn,afterTemplateNodeLinkFn)}}linkQueue=null}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;scope.$$destroyed||(linkQueue?linkQueue.push(scope,node,rootElement,childBoundTranscludeFn):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn,afterTemplateNodeLinkFn)))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){function wrapModuleNameIfDefined(moduleName){return moduleName?" (module: "+moduleName+")":""}if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",previousDirective.name,wrapModuleNameIfDefined(previousDirective.$$moduleName),directive.name,wrapModuleNameIfDefined(directive.$$moduleName),what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var templateNodeParent=templateNode.parent(),hasCompileParent=!!templateNodeParent.length;return hasCompileParent&&compile.$$addBindingClass(templateNodeParent),function(scope,node){var parent=node.parent();hasCompileParent||compile.$$addBindingClass(parent),compile.$$addBindingInfo(parent,interpolateFn.expressions),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function wrapTemplate(type,template){switch(type=lowercase(type||"html")){case"svg":case"math":var wrapper=document.createElement("div");return wrapper.innerHTML="<"+type+">"+template+"</"+type+">",wrapper.childNodes[0].childNodes;default:return template}}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"form"==tag&&"action"==attrNormalizedName||"img"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name,allOrNothing){var trustedContext=getTrustedContext(node,name);allOrNothing=ALL_OR_NOTHING_ATTRS[name]||allOrNothing;var interpolateFn=$interpolate(value,!0,trustedContext,allOrNothing);if(interpolateFn){if("multiple"===name&&"select"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers=createMap());if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var newValue=attr[name];newValue!==value&&(interpolateFn=newValue&&$interpolate(newValue,!0,trustedContext,allOrNothing),value=newValue),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1,$rootElement.context===firstElementToRemove&&($rootElement.context=newNode);break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),jqLite.hasData(firstElementToRemove)&&(jqLite(newNode).data(jqLite(firstElementToRemove).data()),jQuery?(skipDestroyOnNextJQueryCleanData=!0,jQuery.cleanData([firstElementToRemove])):delete jqLite.cache[firstElementToRemove[jqLite.expando]]);for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}function invokeLinkFn(linkFn,scope,$element,attrs,controllers,transcludeFn){try{linkFn(scope,$element,attrs,controllers,transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}function initializeDirectiveBindings(scope,attrs,destination,bindings,directive,newScope){var onNewScopeDestroyed;forEach(bindings,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,attrName=definition.attrName,optional=definition.optional,mode=definition.mode;switch(mode){case"@":optional||hasOwnProperty.call(attrs,attrName)||(destination[scopeName]=attrs[attrName]=void 0),attrs.$observe(attrName,function(value){isString(value)&&(destination[scopeName]=value)}),attrs.$$observers[attrName].$$scope=scope,isString(attrs[attrName])&&(destination[scopeName]=$interpolate(attrs[attrName])(scope));break;case"=":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=destination[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",attrs[attrName],directive.name)},lastValue=destination[scopeName]=parentGet(scope);var parentValueWatch=function(parentValue){return compare(parentValue,destination[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=destination[scopeName]):destination[scopeName]=parentValue),lastValue=parentValue};parentValueWatch.$stateful=!0;var unwatch;unwatch=definition.collection?scope.$watchCollection(attrs[attrName],parentValueWatch):scope.$watch($parse(attrs[attrName],parentValueWatch),null,parentGet.literal),onNewScopeDestroyed=onNewScopeDestroyed||[],onNewScopeDestroyed.push(unwatch);break;case"&":if(parentGet=attrs.hasOwnProperty(attrName)?$parse(attrs[attrName]):noop,parentGet===noop&&optional)break;destination[scopeName]=function(locals){return parentGet(scope,locals)}}});var destroyBindings=onNewScopeDestroyed?function(){for(var i=0,ii=onNewScopeDestroyed.length;ii>i;++i)onNewScopeDestroyed[i]()}:noop;return newScope&&destroyBindings!==noop?(newScope.$on("$destroy",destroyBindings),noop):destroyBindings}var Attributes=function(element,attributesToCopy){if(attributesToCopy){var i,l,key,keys=Object.keys(attributesToCopy);for(i=0,l=keys.length;l>i;i++)key=keys[i],this[key]=attributesToCopy[key]}else this.$attr={};this.$$element=element};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses);toAdd&&toAdd.length&&$animate.addClass(this.$$element,toAdd);var toRemove=tokenDifference(oldClasses,newClasses);toRemove&&toRemove.length&&$animate.removeClass(this.$$element,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,node=this.$$element[0],booleanKey=getBooleanAttrName(node,key),aliasedKey=getAliasedAttrName(key),observer=key;if(booleanKey?(this.$$element.prop(key,value),attrName=booleanKey):aliasedKey&&(this[aliasedKey]=value,observer=aliasedKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),"a"===nodeName&&"href"===key||"img"===nodeName&&"src"===key)this[key]=value=$$sanitizeUri(value,"src"===key);else if("img"===nodeName&&"srcset"===key){for(var result="",trimmedSrcset=trim(value),srcPattern=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,pattern=/\s/.test(trimmedSrcset)?srcPattern:/(,)/,rawUris=trimmedSrcset.split(pattern),nbrUrisWith2parts=Math.floor(rawUris.length/2),i=0;nbrUrisWith2parts>i;i++){var innerIdx=2*i;result+=$$sanitizeUri(trim(rawUris[innerIdx]),!0),result+=" "+trim(rawUris[innerIdx+1])}var lastTuple=trim(rawUris[2*i]).split(/\s/);result+=$$sanitizeUri(trim(lastTuple[0]),!0),2===lastTuple.length&&(result+=" "+trim(lastTuple[1])),this[key]=value=result}writeAttr!==!1&&(null===value||isUndefined(value)?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[observer],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers=createMap()),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||!attrs.hasOwnProperty(key)||isUndefined(attrs[key])||fn(attrs[key])}),function(){arrayRemove(listeners,fn)}}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/;return compile.$$addBindingInfo=debugInfoEnabled?function($element,binding){var bindings=$element.data("$binding")||[];isArray(binding)?bindings=bindings.concat(binding):bindings.push(binding),$element.data("$binding",bindings)}:noop,compile.$$addBindingClass=debugInfoEnabled?function($element){safeAddClass($element,"ng-binding")}:noop,compile.$$addScopeInfo=debugInfoEnabled?function($element,scope,isolated,noTemplate){var dataName=isolated?noTemplate?"$isolateScopeNoTemplate":"$isolateScope":"$scope";$element.data(dataName,scope)}:noop,compile.$$addScopeClass=debugInfoEnabled?function($element,isolated){safeAddClass($element,isolated?"ng-isolate-scope":"ng-scope")}:noop,compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function removeComments(jqNodes){jqNodes=jqLite(jqNodes);var i=jqNodes.length;if(1>=i)return jqNodes;for(;i--;){var node=jqNodes[i];node.nodeType===NODE_TYPE_COMMENT&&splice.call(jqNodes,i,1)}return jqNodes}function identifierForController(controller,ident){if(ident&&isString(ident))return ident;if(isString(controller)){var match=CNTRL_REG.exec(controller);if(match)return match[3]}}function $ControllerProvider(){var controllers={},globals=!1;this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.allowGlobals=function(){globals=!0},this.$get=["$injector","$window",function($injector,$window){function addIdentifier(locals,identifier,instance,name){if(!locals||!isObject(locals.$scope))throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",name,identifier);locals.$scope[identifier]=instance}return function(expression,locals,later,ident){var instance,match,constructor,identifier;if(later=later===!0,ident&&isString(ident)&&(identifier=ident),isString(expression)){if(match=expression.match(CNTRL_REG),!match)throw $controllerMinErr("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",expression);constructor=match[1],identifier=identifier||match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||(globals?getter($window,constructor,!0):undefined),assertArgFn(expression,constructor,!0)}if(later){var controllerPrototype=(isArray(expression)?expression[expression.length-1]:expression).prototype;instance=Object.create(controllerPrototype||null),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name);var instantiate;return instantiate=extend(function(){var result=$injector.invoke(expression,instance,locals,constructor);return result!==instance&&(isObject(result)||isFunction(result))&&(instance=result,identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name)),instance},{instance:instance,identifier:identifier})}return instance=$injector.instantiate(expression,locals,constructor),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(){$log.error.apply($log,arguments)}}]}function serializeValue(v){return isObject(v)?isDate(v)?v.toISOString():toJson(v):v}function $HttpParamSerializerProvider(){this.$get=function(){return function(params){if(!params)return"";var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)?forEach(value,function(v){parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(v)))}):parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(value))))}),parts.join("&")}}}function $HttpParamSerializerJQLikeProvider(){this.$get=function(){return function(params){function serialize(toSerialize,prefix,topLevel){null===toSerialize||isUndefined(toSerialize)||(isArray(toSerialize)?forEach(toSerialize,function(value,index){serialize(value,prefix+"["+(isObject(value)?index:"")+"]")}):isObject(toSerialize)&&!isDate(toSerialize)?forEachSorted(toSerialize,function(value,key){serialize(value,prefix+(topLevel?"":"[")+key+(topLevel?"":"]"))}):parts.push(encodeUriQuery(prefix)+"="+encodeUriQuery(serializeValue(toSerialize))))}if(!params)return"";var parts=[];return serialize(params,"",!0),parts.join("&")}}}function defaultHttpResponseTransform(data,headers){if(isString(data)){var tempData=data.replace(JSON_PROTECTION_PREFIX,"").trim();
if(tempData){var contentType=headers("Content-Type");(contentType&&0===contentType.indexOf(APPLICATION_JSON)||isJsonLike(tempData))&&(data=fromJson(tempData))}}return data}function isJsonLike(str){var jsonStart=str.match(JSON_START);return jsonStart&&JSON_ENDS[jsonStart[0]].test(str)}function parseHeaders(headers){function fillInParsed(key,val){key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}var i,parsed=createMap();return isString(headers)?forEach(headers.split("\n"),function(line){i=line.indexOf(":"),fillInParsed(lowercase(trim(line.substr(0,i))),trim(line.substr(i+1)))}):isObject(headers)&&forEach(headers,function(headerVal,headerKey){fillInParsed(lowercase(headerKey),trim(headerVal))}),parsed}function headersGetter(headers){var headersObj;return function(name){if(headersObj||(headersObj=parseHeaders(headers)),name){var value=headersObj[lowercase(name)];return void 0===value&&(value=null),value}return headersObj}}function transformData(data,headers,status,fns){return isFunction(fns)?fns(data,headers,status):(forEach(fns,function(fn){data=fn(data,headers,status)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var defaults=this.defaults={transformResponse:[defaultHttpResponseTransform],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)||isFormData(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},useApplyAsync=!1;this.useApplyAsync=function(value){return isDefined(value)?(useApplyAsync=!!value,this):useApplyAsync};var useLegacyPromise=!0;this.useLegacyPromiseExtensions=function(value){return isDefined(value)?(useLegacyPromise=!!value,this):useLegacyPromise};var interceptorFactories=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$$cookieReader,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function transformResponse(response){var resp=extend({},response);return resp.data=response.data?transformData(response.data,response.headers,response.status,config.transformResponse):response.data,isSuccess(response.status)?resp:$q.reject(resp)}function executeHeaderFns(headers,config){var headerContent,processedHeaders={};return forEach(headers,function(headerFn,header){isFunction(headerFn)?(headerContent=headerFn(config),null!=headerContent&&(processedHeaders[header]=headerContent)):processedHeaders[header]=headerFn}),processedHeaders}function mergeHeaders(config){var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return executeHeaderFns(reqHeaders,shallowCopy(config))}if(!angular.isObject(requestConfig))throw minErr("$http")("badreq","Http request configuration must be an object.  Received: {0}",requestConfig);var config=extend({method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse,paramSerializer:defaults.paramSerializer},requestConfig);config.headers=mergeHeaders(requestConfig),config.method=uppercase(config.method),config.paramSerializer=isString(config.paramSerializer)?$injector.get(config.paramSerializer):config.paramSerializer;var serverRequest=function(config){var headers=config.headers,reqData=transformData(config.data,headersGetter(headers),undefined,config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return useLegacyPromise?(promise.success=function(fn){return assertArgFn(fn,"fn"),promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return assertArgFn(fn,"fn"),promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise}):(promise.success=$httpMinErrLegacyFn("success"),promise.error=$httpMinErrLegacyFn("error")),promise}function createShortMethods(){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend({},config||{},{method:name,url:url}))}})}function createShortMethodsWithData(){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend({},config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData){function done(status,response,headersString,statusText){function resolveHttpPromise(){resolvePromise(response,status,headersString,statusText)}cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),useApplyAsync?$rootScope.$applyAsync(resolveHttpPromise):(resolveHttpPromise(),$rootScope.$$phase||$rootScope.$apply())}function resolvePromise(response,status,headers,statusText){status=status>=-1?status:0,(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function resolvePromiseWithResult(result){resolvePromise(result.data,result.status,shallowCopy(result.headers()),result.statusText)}function removePendingReq(){var idx=$http.pendingRequests.indexOf(config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,reqHeaders=config.headers,url=buildUrl(config.url,config.paramSerializer(config.params));if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache&&(cachedResp=cache.get(url),isDefined(cachedResp)?isPromiseLike(cachedResp)?cachedResp.then(resolvePromiseWithResult,resolvePromiseWithResult):isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK"):cache.put(url,promise)),isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$$cookieReader()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType)}return promise}function buildUrl(url,serializedParams){return serializedParams.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+serializedParams),url}var defaultCache=$cacheFactory("$http");defaults.paramSerializer=isString(defaults.paramSerializer)?$injector.get(defaults.paramSerializer):defaults.paramSerializer;var reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function $xhrFactoryProvider(){this.$get=function(){return function(){return new window.XMLHttpRequest}}}function $HttpBackendProvider(){this.$get=["$browser","$window","$document","$xhrFactory",function($browser,$window,$document,$xhrFactory){return createHttpBackend($browser,$xhrFactory,$browser.defer,$window.angular.callbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),rawDocument.body.appendChild(script),callback}return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){isDefined(timeoutId)&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=noop})}else{var xhr=createXhr(method,url);xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onload=function(){var statusText=xhr.statusText||"",response="response"in xhr?xhr.response:xhr.responseText,status=1223===xhr.status?204:xhr.status;0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),completeRequest(callback,status,response,xhr.getAllResponseHeaders(),statusText)};var requestError=function(){completeRequest(callback,-1,null,null,"")};if(xhr.onerror=requestError,xhr.onabort=requestError,withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(isUndefined(post)?null:post)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function escape(ch){return"\\\\\\"+ch}function unescapeText(text){return text.replace(escapedStartRegexp,startSymbol).replace(escapedEndRegexp,endSymbol)}function stringify(value){if(null==value)return"";switch(typeof value){case"string":break;case"number":value=""+value;break;default:value=toJson(value)}return value}function $interpolate(text,mustHaveExpression,trustedContext,allOrNothing){function parseStringifyInterceptor(value){try{return value=getValue(value),allOrNothing&&!isDefined(value)?value:stringify(value)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}}allOrNothing=!!allOrNothing;for(var startIndex,endIndex,exp,index=0,expressions=[],parseFns=[],textLength=text.length,concat=[],expressionPositions=[];textLength>index;){if(-1==(startIndex=text.indexOf(startSymbol,index))||-1==(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))){index!==textLength&&concat.push(unescapeText(text.substring(index)));break}index!==startIndex&&concat.push(unescapeText(text.substring(index,startIndex))),exp=text.substring(startIndex+startSymbolLength,endIndex),expressions.push(exp),parseFns.push($parse(exp,parseStringifyInterceptor)),index=endIndex+endSymbolLength,expressionPositions.push(concat.length),concat.push("")}if(trustedContext&&concat.length>1&&$interpolateMinErr.throwNoconcat(text),!mustHaveExpression||expressions.length){var compute=function(values){for(var i=0,ii=expressions.length;ii>i;i++){if(allOrNothing&&isUndefined(values[i]))return;concat[expressionPositions[i]]=values[i]}return concat.join("")},getValue=function(value){return trustedContext?$sce.getTrusted(trustedContext,value):$sce.valueOf(value)};return extend(function(context){var i=0,ii=expressions.length,values=new Array(ii);try{for(;ii>i;i++)values[i]=parseFns[i](context);return compute(values)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}},{exp:text,expressions:expressions,$$watchDelegate:function(scope,listener){var lastValue;return scope.$watchGroup(parseFns,function(values,oldValues){var currValue=compute(values);isFunction(listener)&&listener.call(this,currValue,values!==oldValues?lastValue:currValue,scope),lastValue=currValue})}})}}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length,escapedStartRegexp=new RegExp(startSymbol.replace(/./g,escape),"g"),escapedEndRegexp=new RegExp(endSymbol.replace(/./g,escape),"g");return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q","$$q",function($rootScope,$window,$q,$$q){function interval(fn,delay,count,invokeApply){var hasParams=arguments.length>4,args=hasParams?sliceArgs(arguments,4):[],setInterval=$window.setInterval,clearInterval=$window.clearInterval,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return count=isDefined(count)?count:0,promise.then(null,null,hasParams?function(){fn.apply(null,args)}:fn),promise.$$intervalId=setInterval(function(){deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj){var parsedUrl=urlResolve(absoluteUrl);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=toInt(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function beginsWith(begin,whole){return 0===whole.indexOf(begin)?whole.substr(begin.length):void 0}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function trimEmptyHash(url){return url.replace(/(#.+)|#$/,"$1")}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,appBaseNoFile,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"",parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var appUrl,prevAppUrl,rewrittenUrl;return isDefined(appUrl=beginsWith(appBase,url))?(prevAppUrl=appUrl,rewrittenUrl=isDefined(appUrl=beginsWith(basePrefix,appUrl))?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):isDefined(appUrl=beginsWith(appBaseNoFile,url))?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,appBaseNoFile,hashPrefix){parseAbsoluteUrl(appBase,this),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return 0===url.indexOf(base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutHashUrl,withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url);isUndefined(withoutBaseUrl)||"#"!==withoutBaseUrl.charAt(0)?this.$$html5?withoutHashUrl=withoutBaseUrl:(withoutHashUrl="",isUndefined(withoutBaseUrl)&&(appBase=url,this.replace())):(withoutHashUrl=beginsWith(hashPrefix,withoutBaseUrl),isUndefined(withoutHashUrl)&&(withoutHashUrl=withoutBaseUrl)),parseAppUrl(withoutHashUrl,this),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url){return stripHash(appBase)==stripHash(url)?(this.$$parse(url),!0):!1}}function LocationHashbangInHtml5Url(appBase,appBaseNoFile,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments),this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=beginsWith(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isBoolean(mode)?(html5Mode.enabled=mode,this):isObject(mode)?(isBoolean(mode.enabled)&&(html5Mode.enabled=mode.enabled),isBoolean(mode.requireBase)&&(html5Mode.requireBase=mode.requireBase),isBoolean(mode.rewriteLinks)&&(html5Mode.rewriteLinks=mode.rewriteLinks),this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function($rootScope,$browser,$sniffer,$rootElement,$window){function setBrowserUrlWithFallback(url,replace,state){var oldUrl=$location.url(),oldState=$location.$$state;try{$browser.url(url,replace,state),$location.$$state=$browser.state()}catch(e){throw $location.url(oldUrl),$location.$$state=oldState,e}}function afterLocationChange(oldUrl,oldState){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl,$location.$$state,oldState)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();if(html5Mode.enabled){if(!baseHref&&html5Mode.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url}else appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl;var appBaseNoFile=stripFile(appBase);$location=new LocationMode(appBase,appBaseNoFile,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl),$location.$$state=$browser.state();var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(html5Mode.rewriteLinks&&!event.ctrlKey&&!event.metaKey&&!event.shiftKey&&2!=event.which&&2!=event.button){for(var elm=jqLite(event.target);"a"!==nodeName_(elm[0]);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),$window.angular["ff-684208-preventDefault"]=!0))}}),trimEmptyHash($location.absUrl())!=trimEmptyHash(initialUrl)&&$browser.url($location.absUrl(),!0);var initializing=!0;return $browser.onUrlChange(function(newUrl,newState){return isUndefined(beginsWith(appBaseNoFile,newUrl))?($window.location.href=newUrl,void 0):($rootScope.$evalAsync(function(){var defaultPrevented,oldUrl=$location.absUrl(),oldState=$location.$$state;$location.$$parse(newUrl),$location.$$state=newState,defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,newState,oldState).defaultPrevented,$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState,setBrowserUrlWithFallback(oldUrl,!1,oldState)):(initializing=!1,afterLocationChange(oldUrl,oldState)))}),$rootScope.$$phase||$rootScope.$digest(),void 0)}),$rootScope.$watch(function(){var oldUrl=trimEmptyHash($browser.url()),newUrl=trimEmptyHash($location.absUrl()),oldState=$browser.state(),currentReplace=$location.$$replace,urlOrStateChanged=oldUrl!==newUrl||$location.$$html5&&$sniffer.history&&oldState!==$location.$$state;(initializing||urlOrStateChanged)&&(initializing=!1,$rootScope.$evalAsync(function(){var newUrl=$location.absUrl(),defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,$location.$$state,oldState).defaultPrevented;$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState):(urlOrStateChanged&&setBrowserUrlWithFallback(newUrl,currentReplace,oldState===$location.$$state?null:$location.$$state),afterLocationChange(oldUrl,oldState)))})),$location.$$replace=!1}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function getStringValue(name,fullExpression){if(name+="",!isString(name))throw $parseMinErr("iseccst","Cannot convert object to primitive value! Expression: {0}",fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.window===obj)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function ensureSafeAssignContext(obj,fullExpression){if(obj&&(obj===0..constructor||obj===(!1).constructor||obj==="".constructor||obj==={}.constructor||obj===[].constructor||obj===Function.constructor))throw $parseMinErr("isecaf","Assigning to a constructor is disallowed! Expression: {0}",fullExpression)}function ifDefined(v,d){return"undefined"!=typeof v?v:d}function plusFn(l,r){return"undefined"==typeof l?r:"undefined"==typeof r?l:l+r}function isStateless($filter,filterName){var fn=$filter(filterName);return!fn.$stateful}function findConstantAndWatchExpressions(ast,$filter){var allConstants,argsToWatch;switch(ast.type){case AST.Program:allConstants=!0,forEach(ast.body,function(expr){findConstantAndWatchExpressions(expr.expression,$filter),allConstants=allConstants&&expr.expression.constant}),ast.constant=allConstants;break;case AST.Literal:ast.constant=!0,ast.toWatch=[];break;case AST.UnaryExpression:findConstantAndWatchExpressions(ast.argument,$filter),ast.constant=ast.argument.constant,ast.toWatch=ast.argument.toWatch;break;case AST.BinaryExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.left.toWatch.concat(ast.right.toWatch);break;case AST.LogicalExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.ConditionalExpression:findConstantAndWatchExpressions(ast.test,$filter),findConstantAndWatchExpressions(ast.alternate,$filter),findConstantAndWatchExpressions(ast.consequent,$filter),ast.constant=ast.test.constant&&ast.alternate.constant&&ast.consequent.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.Identifier:ast.constant=!1,ast.toWatch=[ast];break;case AST.MemberExpression:findConstantAndWatchExpressions(ast.object,$filter),ast.computed&&findConstantAndWatchExpressions(ast.property,$filter),ast.constant=ast.object.constant&&(!ast.computed||ast.property.constant),ast.toWatch=[ast];break;case AST.CallExpression:allConstants=ast.filter?isStateless($filter,ast.callee.name):!1,argsToWatch=[],forEach(ast.arguments,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=ast.filter&&isStateless($filter,ast.callee.name)?argsToWatch:[ast];break;case AST.AssignmentExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=[ast];break;case AST.ArrayExpression:allConstants=!0,argsToWatch=[],forEach(ast.elements,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ObjectExpression:allConstants=!0,argsToWatch=[],forEach(ast.properties,function(property){findConstantAndWatchExpressions(property.value,$filter),allConstants=allConstants&&property.value.constant,property.value.constant||argsToWatch.push.apply(argsToWatch,property.value.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ThisExpression:ast.constant=!1,ast.toWatch=[]}}function getInputs(body){if(1==body.length){var lastExpression=body[0].expression,candidate=lastExpression.toWatch;return 1!==candidate.length?candidate:candidate[0]!==lastExpression?candidate:undefined}}function isAssignable(ast){return ast.type===AST.Identifier||ast.type===AST.MemberExpression}function assignableAST(ast){return 1===ast.body.length&&isAssignable(ast.body[0].expression)?{type:AST.AssignmentExpression,left:ast.body[0].expression,right:{type:AST.NGValueParameter},operator:"="}:void 0}function isLiteral(ast){return 0===ast.body.length||1===ast.body.length&&(ast.body[0].expression.type===AST.Literal||ast.body[0].expression.type===AST.ArrayExpression||ast.body[0].expression.type===AST.ObjectExpression)}function isConstant(ast){return ast.constant}function ASTCompiler(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function ASTInterpreter(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function isPossiblyDangerousMemberName(name){return"constructor"==name}function getValueOf(value){return isFunction(value.valueOf)?value.valueOf():objectValueOf.call(value)}function $ParseProvider(){var cacheDefault=createMap(),cacheExpensive=createMap();this.$get=["$filter",function($filter){function expressionInputDirtyCheck(newValue,oldValueOfValue){return null==newValue||null==oldValueOfValue?newValue===oldValueOfValue:"object"==typeof newValue&&(newValue=getValueOf(newValue),"object"==typeof newValue)?!1:newValue===oldValueOfValue||newValue!==newValue&&oldValueOfValue!==oldValueOfValue}function inputsWatchDelegate(scope,listener,objectEquality,parsedExpression,prettyPrintExpression){var lastResult,inputExpressions=parsedExpression.inputs;if(1===inputExpressions.length){var oldInputValueOf=expressionInputDirtyCheck;return inputExpressions=inputExpressions[0],scope.$watch(function(scope){var newInputValue=inputExpressions(scope);return expressionInputDirtyCheck(newInputValue,oldInputValueOf)||(lastResult=parsedExpression(scope,undefined,undefined,[newInputValue]),oldInputValueOf=newInputValue&&getValueOf(newInputValue)),lastResult},listener,objectEquality,prettyPrintExpression)}for(var oldInputValueOfValues=[],oldInputValues=[],i=0,ii=inputExpressions.length;ii>i;i++)oldInputValueOfValues[i]=expressionInputDirtyCheck,oldInputValues[i]=null;return scope.$watch(function(scope){for(var changed=!1,i=0,ii=inputExpressions.length;ii>i;i++){var newInputValue=inputExpressions[i](scope);(changed||(changed=!expressionInputDirtyCheck(newInputValue,oldInputValueOfValues[i])))&&(oldInputValues[i]=newInputValue,oldInputValueOfValues[i]=newInputValue&&getValueOf(newInputValue))}return changed&&(lastResult=parsedExpression(scope,undefined,undefined,oldInputValues)),lastResult},listener,objectEquality,prettyPrintExpression)}function oneTimeWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.apply(this,arguments),isDefined(value)&&scope.$$postDigest(function(){isDefined(lastValue)&&unwatch()})},objectEquality)}function oneTimeLiteralWatchDelegate(scope,listener,objectEquality,parsedExpression){function isAllDefined(value){var allDefined=!0;
return forEach(value,function(val){isDefined(val)||(allDefined=!1)}),allDefined}var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.call(this,value,old,scope),isAllDefined(value)&&scope.$$postDigest(function(){isAllDefined(lastValue)&&unwatch()})},objectEquality)}function constantWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(){isFunction(listener)&&listener.apply(this,arguments),unwatch()},objectEquality)}function addInterceptor(parsedExpression,interceptorFn){if(!interceptorFn)return parsedExpression;var watchDelegate=parsedExpression.$$watchDelegate,regularWatch=watchDelegate!==oneTimeLiteralWatchDelegate&&watchDelegate!==oneTimeWatchDelegate,fn=regularWatch?function(scope,locals,assign,inputs){var value=parsedExpression(scope,locals,assign,inputs);return interceptorFn(value,scope,locals)}:function(scope,locals,assign,inputs){var value=parsedExpression(scope,locals,assign,inputs),result=interceptorFn(value,scope,locals);return isDefined(value)?result:value};return parsedExpression.$$watchDelegate&&parsedExpression.$$watchDelegate!==inputsWatchDelegate?fn.$$watchDelegate=parsedExpression.$$watchDelegate:interceptorFn.$stateful||(fn.$$watchDelegate=inputsWatchDelegate,fn.inputs=parsedExpression.inputs?parsedExpression.inputs:[parsedExpression]),fn}var noUnsafeEval=csp().noUnsafeEval,$parseOptions={csp:noUnsafeEval,expensiveChecks:!1},$parseOptionsExpensive={csp:noUnsafeEval,expensiveChecks:!0};return function(exp,interceptorFn,expensiveChecks){var parsedExpression,oneTime,cacheKey;switch(typeof exp){case"string":exp=exp.trim(),cacheKey=exp;var cache=expensiveChecks?cacheExpensive:cacheDefault;if(parsedExpression=cache[cacheKey],!parsedExpression){":"===exp.charAt(0)&&":"===exp.charAt(1)&&(oneTime=!0,exp=exp.substring(2));var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);parsedExpression=parser.parse(exp),parsedExpression.constant?parsedExpression.$$watchDelegate=constantWatchDelegate:oneTime?parsedExpression.$$watchDelegate=parsedExpression.literal?oneTimeLiteralWatchDelegate:oneTimeWatchDelegate:parsedExpression.inputs&&(parsedExpression.$$watchDelegate=inputsWatchDelegate),cache[cacheKey]=parsedExpression}return addInterceptor(parsedExpression,interceptorFn);case"function":return addInterceptor(exp,interceptorFn);default:return noop}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function $$QProvider(){this.$get=["$browser","$exceptionHandler",function($browser,$exceptionHandler){return qFactory(function(callback){$browser.defer(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function callOnce(self,resolveFn,rejectFn){function wrap(fn){return function(value){called||(called=!0,fn.call(self,value))}}var called=!1;return[wrap(resolveFn),wrap(rejectFn)]}function Promise(){this.$$state={status:0}}function simpleBind(context,fn){return function(value){fn.call(context,value)}}function processQueue(state){var fn,deferred,pending;pending=state.pending,state.processScheduled=!1,state.pending=undefined;for(var i=0,ii=pending.length;ii>i;++i){deferred=pending[i][0],fn=pending[i][state.status];try{isFunction(fn)?deferred.resolve(fn(state.value)):1===state.status?deferred.resolve(state.value):deferred.reject(state.value)}catch(e){deferred.reject(e),exceptionHandler(e)}}}function scheduleProcessQueue(state){!state.processScheduled&&state.pending&&(state.processScheduled=!0,nextTick(function(){processQueue(state)}))}function Deferred(){this.promise=new Promise,this.resolve=simpleBind(this,this.resolve),this.reject=simpleBind(this,this.reject),this.notify=simpleBind(this,this.notify)}function all(promises){var deferred=new Deferred,counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,when(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}var $qMinErr=minErr("$q",TypeError),defer=function(){return new Deferred};extend(Promise.prototype,{then:function(onFulfilled,onRejected,progressBack){if(isUndefined(onFulfilled)&&isUndefined(onRejected)&&isUndefined(progressBack))return this;var result=new Deferred;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([result,onFulfilled,onRejected,progressBack]),this.$$state.status>0&&scheduleProcessQueue(this.$$state),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback,progressBack){return this.then(function(value){return handleCallback(value,!0,callback)},function(error){return handleCallback(error,!1,callback)},progressBack)}}),extend(Deferred.prototype,{resolve:function(val){this.promise.$$state.status||(val===this.promise?this.$$reject($qMinErr("qcycle","Expected promise to be resolved with value other than itself '{0}'",val)):this.$$resolve(val))},$$resolve:function(val){var then,fns;fns=callOnce(this,this.$$resolve,this.$$reject);try{(isObject(val)||isFunction(val))&&(then=val&&val.then),isFunction(then)?(this.promise.$$state.status=-1,then.call(val,fns[0],fns[1],this.notify)):(this.promise.$$state.value=val,this.promise.$$state.status=1,scheduleProcessQueue(this.promise.$$state))}catch(e){fns[1](e),exceptionHandler(e)}},reject:function(reason){this.promise.$$state.status||this.$$reject(reason)},$$reject:function(reason){this.promise.$$state.value=reason,this.promise.$$state.status=2,scheduleProcessQueue(this.promise.$$state)},notify:function(progress){var callbacks=this.promise.$$state.pending;this.promise.$$state.status<=0&&callbacks&&callbacks.length&&nextTick(function(){for(var callback,result,i=0,ii=callbacks.length;ii>i;i++){result=callbacks[i][0],callback=callbacks[i][3];try{result.notify(isFunction(callback)?callback(progress):progress)}catch(e){exceptionHandler(e)}}})}});var reject=function(reason){var result=new Deferred;return result.reject(reason),result.promise},makePromise=function(value,resolved){var result=new Deferred;return resolved?result.resolve(value):result.reject(value),result.promise},handleCallback=function(value,isResolved,callback){var callbackOutput=null;try{isFunction(callback)&&(callbackOutput=callback())}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)},when=function(value,callback,errback,progressBack){var result=new Deferred;return result.resolve(value),result.promise.then(callback,errback,progressBack)},resolve=when,$Q=function Q(resolver){function resolveFn(value){deferred.resolve(value)}function rejectFn(reason){deferred.reject(reason)}if(!isFunction(resolver))throw $qMinErr("norslvr","Expected resolverFn, got '{0}'",resolver);if(!(this instanceof Q))return new Q(resolver);var deferred=new Deferred;return resolver(resolveFn,rejectFn),deferred.promise};return $Q.defer=defer,$Q.reject=reject,$Q.when=when,$Q.resolve=resolve,$Q.all=all,$Q}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){function createChildScopeClass(parent){function ChildScope(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=nextUid(),this.$$ChildScope=null}return ChildScope.prototype=parent,ChildScope}var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null,applyAsyncId=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse","$browser",function($injector,$exceptionHandler,$parse,$browser){function destroyChildScope($event){$event.currentScope.$$destroyed=!0}function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function incrementWatchersCount(current,count){do current.$$watchersCount+=count;while(current=current.$parent)}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}function flushApplyAsync(){for(;applyAsyncQueue.length;)try{applyAsyncQueue.shift()()}catch(e){$exceptionHandler(e)}applyAsyncId=null}function scheduleApplyAsync(){null===applyAsyncId&&(applyAsyncId=$browser.defer(function(){$rootScope.$apply(flushApplyAsync)}))}Scope.prototype={constructor:Scope,$new:function(isolate,parent){var child;return parent=parent||this,isolate?(child=new Scope,child.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=createChildScopeClass(this)),child=new this.$$ChildScope),child.$parent=parent,child.$$prevSibling=parent.$$childTail,parent.$$childHead?(parent.$$childTail.$$nextSibling=child,parent.$$childTail=child):parent.$$childHead=parent.$$childTail=child,(isolate||parent!=this)&&child.$on("$destroy",destroyChildScope),child},$watch:function(watchExp,listener,objectEquality,prettyPrintExpression){var get=$parse(watchExp);if(get.$$watchDelegate)return get.$$watchDelegate(this,listener,objectEquality,get,watchExp);var scope=this,array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:prettyPrintExpression||watchExp,eq:!!objectEquality};return lastDirtyWatch=null,isFunction(listener)||(watcher.fn=noop),array||(array=scope.$$watchers=[]),array.unshift(watcher),incrementWatchersCount(this,1),function(){arrayRemove(array,watcher)>=0&&incrementWatchersCount(scope,-1),lastDirtyWatch=null}},$watchGroup:function(watchExpressions,listener){function watchGroupAction(){changeReactionScheduled=!1,firstRun?(firstRun=!1,listener(newValues,newValues,self)):listener(newValues,oldValues,self)}var oldValues=new Array(watchExpressions.length),newValues=new Array(watchExpressions.length),deregisterFns=[],self=this,changeReactionScheduled=!1,firstRun=!0;if(!watchExpressions.length){var shouldCall=!0;return self.$evalAsync(function(){shouldCall&&listener(newValues,newValues,self)}),function(){shouldCall=!1}}return 1===watchExpressions.length?this.$watch(watchExpressions[0],function(value,oldValue,scope){newValues[0]=value,oldValues[0]=oldValue,listener(newValues,value===oldValue?newValues:oldValues,scope)}):(forEach(watchExpressions,function(expr,i){var unwatchFn=self.$watch(expr,function(value,oldValue){newValues[i]=value,oldValues[i]=oldValue,changeReactionScheduled||(changeReactionScheduled=!0,self.$evalAsync(watchGroupAction))});deregisterFns.push(unwatchFn)}),function(){for(;deregisterFns.length;)deregisterFns.shift()()})},$watchCollection:function(obj,listener){function $watchCollectionInterceptor(_value){newValue=_value;var newLength,key,bothNaN,newItem,oldItem;if(!isUndefined(newValue)){if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)oldItem=oldValue[i],newItem=newValue[i],bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[i]=newItem)}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)hasOwnProperty.call(newValue,key)&&(newLength++,newItem=newValue[key],oldItem=oldValue[key],key in oldValue?(bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[key]=newItem)):(oldLength++,oldValue[key]=newItem,changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)hasOwnProperty.call(newValue,key)||(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}$watchCollectionInterceptor.$stateful=!0;var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,changeDetector=$parse(obj,$watchCollectionInterceptor),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch(changeDetector,$watchCollectionAction)},$digest:function(){var watch,value,last,watchers,length,dirty,next,current,logIdx,asyncTask,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),this===$rootScope&&null!==applyAsyncId&&($browser.defer.cancel(applyAsyncId),flushApplyAsync()),lastDirtyWatch=null;do{for(dirty=!1,current=target;asyncQueue.length;){try{asyncTask=asyncQueue.shift(),asyncTask.scope.$eval(asyncTask.expression,asyncTask.locals)}catch(e){$exceptionHandler(e)}lastDirtyWatch=null}traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if((value=watch.get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),watchLog[logIdx].push({msg:isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,newVal:value,oldVal:last}))}catch(e){$exceptionHandler(e)}if(!(next=current.$$watchersCount&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,watchLog)}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueue.length;)try{postDigestQueue.shift()()}catch(e){$exceptionHandler(e)}},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===$rootScope&&$browser.$$applicationDestroyed(),incrementWatchersCount(this,-this.$$watchersCount);for(var eventName in this.$$listenerCount)decrementListenerCount(this,this.$$listenerCount[eventName],eventName);parent&&parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent&&parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=noop,this.$on=this.$watch=this.$watchGroup=function(){return noop},this.$$listeners={},this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=this.$$watchers=null}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr,locals){$rootScope.$$phase||asyncQueue.length||$browser.defer(function(){asyncQueue.length&&$rootScope.$digest()}),asyncQueue.push({scope:this,expression:expr,locals:locals})},$$postDigest:function(fn){postDigestQueue.push(fn)},$apply:function(expr){try{beginPhase("$apply");try{return this.$eval(expr)}finally{clearPhase()}}catch(e){$exceptionHandler(e)}finally{try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$applyAsync:function(expr){function $applyAsyncExpression(){scope.$eval(expr)}var scope=this;expr&&applyAsyncQueue.push($applyAsyncExpression),scheduleApplyAsync()},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=namedListeners.indexOf(listener);-1!==indexOfListener&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event.currentScope=null,event;scope=scope.$parent}while(scope);return event.currentScope=null,event},$broadcast:function(name){var target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1};if(!target.$$listenerCount[name])return event;for(var listeners,i,length,listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event.currentScope=null,event}};var $rootScope=new Scope,asyncQueue=$rootScope.$$asyncQueue=[],postDigestQueue=$rootScope.$$postDigestQueue=[],applyAsyncQueue=$rootScope.$$applyAsyncQueue=[];return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex)?uri:"unsafe:"+normalizedVal}}}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||isUndefined(trustedValue)||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||isUndefined(maybeTrusted)||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sceDelegate",function($parse,$sceDelegate){if(enabled&&8>msie)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:$parse(expr,function(value){return sce.getTrusted(type,value)})};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},android=toInt((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},vendorRegex=/^(Moz|webkit|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(bodyStyle.webkitTransition),animations=isString(bodyStyle.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android||boxee),hasEvent:function(event){if("input"===event&&11>=msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android}}]}function $TemplateRequestProvider(){this.$get=["$templateCache","$http","$q","$sce",function($templateCache,$http,$q,$sce){function handleRequestFn(tpl,ignoreRequestError){function handleError(resp){if(!ignoreRequestError)throw $compileMinErr("tpload","Failed to load template: {0} (HTTP status: {1} {2})",tpl,resp.status,resp.statusText);return $q.reject(resp)}handleRequestFn.totalPendingRequests++,isString(tpl)&&$templateCache.get(tpl)||(tpl=$sce.getTrustedResourceUrl(tpl));var transformResponse=$http.defaults&&$http.defaults.transformResponse;isArray(transformResponse)?transformResponse=transformResponse.filter(function(transformer){return transformer!==defaultHttpResponseTransform}):transformResponse===defaultHttpResponseTransform&&(transformResponse=null);var httpOptions={cache:$templateCache,transformResponse:transformResponse};return $http.get(tpl,httpOptions)["finally"](function(){handleRequestFn.totalPendingRequests--}).then(function(response){return $templateCache.put(tpl,response.data),response.data},handleError)}return handleRequestFn.totalPendingRequests=0,handleRequestFn}]}function $$TestabilityProvider(){this.$get=["$rootScope","$browser","$location",function($rootScope,$browser,$location){var testability={};return testability.findBindings=function(element,expression,opt_exactMatch){var bindings=element.getElementsByClassName("ng-binding"),matches=[];return forEach(bindings,function(binding){var dataBinding=angular.element(binding).data("$binding");dataBinding&&forEach(dataBinding,function(bindingName){if(opt_exactMatch){var matcher=new RegExp("(^|\\s)"+escapeForRegexp(expression)+"(\\s|\\||$)");matcher.test(bindingName)&&matches.push(binding)}else-1!=bindingName.indexOf(expression)&&matches.push(binding)})}),matches},testability.findModels=function(element,expression,opt_exactMatch){for(var prefixes=["ng-","data-ng-","ng\\:"],p=0;p<prefixes.length;++p){var attributeEquals=opt_exactMatch?"=":"*=",selector="["+prefixes[p]+"model"+attributeEquals+'"'+expression+'"]',elements=element.querySelectorAll(selector);if(elements.length)return elements}},testability.getLocation=function(){return $location.url()},testability.setLocation=function(url){url!==$location.url()&&($location.url(url),$rootScope.$digest())},testability.whenStable=function(callback){$browser.notifyWhenNoOutstandingRequests(callback)},testability}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function($rootScope,$browser,$q,$$q,$exceptionHandler){function timeout(fn,delay,invokeApply){isFunction(fn)||(invokeApply=delay,delay=fn,fn=noop);var timeoutId,args=sliceArgs(arguments,3),skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn.apply(null,args))}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $$CookieReader($document){function safeDecodeURIComponent(str){try{return decodeURIComponent(str)}catch(e){return str}}var rawDocument=$document[0]||{},lastCookies={},lastCookieString="";return function(){var cookieArray,cookie,i,index,name,currentCookieString=rawDocument.cookie||"";if(currentCookieString!==lastCookieString)for(lastCookieString=currentCookieString,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=safeDecodeURIComponent(cookie.substring(0,index)),isUndefined(lastCookies[name])&&(lastCookies[name]=safeDecodeURIComponent(cookie.substring(index+1))));return lastCookies}}function $$CookieReaderProvider(){this.$get=$$CookieReader}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator){if(!isArrayLike(array)){if(null==array)return array;throw minErr("filter")("notarray","Expected array but received: {0}",array)}var predicateFn,matchAgainstAnyProp,expressionType=getTypeForFilter(expression);switch(expressionType){case"function":predicateFn=expression;break;case"boolean":case"null":case"number":case"string":matchAgainstAnyProp=!0;case"object":predicateFn=createPredicateFn(expression,comparator,matchAgainstAnyProp);break;default:return array}return Array.prototype.filter.call(array,predicateFn)}}function createPredicateFn(expression,comparator,matchAgainstAnyProp){var predicateFn,shouldMatchPrimitives=isObject(expression)&&"$"in expression;
return comparator===!0?comparator=equals:isFunction(comparator)||(comparator=function(actual,expected){return isUndefined(actual)?!1:null===actual||null===expected?actual===expected:isObject(expected)||isObject(actual)&&!hasCustomToString(actual)?!1:(actual=lowercase(""+actual),expected=lowercase(""+expected),-1!==actual.indexOf(expected))}),predicateFn=function(item){return shouldMatchPrimitives&&!isObject(item)?deepCompare(item,expression.$,comparator,!1):deepCompare(item,expression,comparator,matchAgainstAnyProp)}}function deepCompare(actual,expected,comparator,matchAgainstAnyProp,dontMatchWholeObject){var actualType=getTypeForFilter(actual),expectedType=getTypeForFilter(expected);if("string"===expectedType&&"!"===expected.charAt(0))return!deepCompare(actual,expected.substring(1),comparator,matchAgainstAnyProp);if(isArray(actual))return actual.some(function(item){return deepCompare(item,expected,comparator,matchAgainstAnyProp)});switch(actualType){case"object":var key;if(matchAgainstAnyProp){for(key in actual)if("$"!==key.charAt(0)&&deepCompare(actual[key],expected,comparator,!0))return!0;return dontMatchWholeObject?!1:deepCompare(actual,expected,comparator,!1)}if("object"===expectedType){for(key in expected){var expectedVal=expected[key];if(!isFunction(expectedVal)&&!isUndefined(expectedVal)){var matchAnyProperty="$"===key,actualVal=matchAnyProperty?actual:actual[key];if(!deepCompare(actualVal,expectedVal,comparator,matchAnyProperty,matchAnyProperty))return!1}}return!0}return comparator(actual,expected);case"function":return!1;default:return comparator(actual,expected)}}function getTypeForFilter(val){return null===val?"null":typeof val}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol,fractionSize){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),isUndefined(fractionSize)&&(fractionSize=formats.PATTERNS[1].maxFrac),null==amount?amount:formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return null==number?number:formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(isObject(number))return"";var isNegative=0>number;number=Math.abs(number);var isInfinity=1/0===number;if(!isInfinity&&!isFinite(number))return"";var numStr=number+"",formatedText="",hasExponent=!1,parts=[];if(isInfinity&&(formatedText=""),!isInfinity&&-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?number=0:(formatedText=numStr,hasExponent=!0)}if(isInfinity||hasExponent)fractionSize>0&&1>number&&(formatedText=number.toFixed(fractionSize),number=parseFloat(formatedText),formatedText=formatedText.replace(DECIMAL_SEP,decimalSep));else{var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac)),number=+(Math.round(+(number.toString()+"e"+fractionSize)).toString()+"e"+-fractionSize);var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var i,pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group)for(pos=whole.length-lgroup,i=0;pos>i;i++)(pos-i)%group===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(i=pos;i<whole.length;i++)(whole.length-i)%lgroup===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fraction.length<fractionSize;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return 0===number&&(isNegative=!1),parts.push(isNegative?pattern.negPre:pattern.posPre,formatedText,isNegative?pattern.negSuf:pattern.posSuf),parts.join("")}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date,formats,offset){var zone=-1*offset,paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function getFirstThursdayOfYear(year){var dayOfWeekOnFirst=new Date(year,0,1).getDay();return new Date(year,0,(4>=dayOfWeekOnFirst?5:12)-dayOfWeekOnFirst)}function getThursdayThisWeek(datetime){return new Date(datetime.getFullYear(),datetime.getMonth(),datetime.getDate()+(4-datetime.getDay()))}function weekGetter(size){return function(date){var firstThurs=getFirstThursdayOfYear(date.getFullYear()),thisThurs=getThursdayThisWeek(date),diff=+thisThurs-+firstThurs,result=1+Math.round(diff/6048e5);return padNumber(result,size)}}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function eraGetter(date,formats){return date.getFullYear()<=0?formats.ERAS[0]:formats.ERAS[1]}function longEraGetter(date,formats){return date.getFullYear()<=0?formats.ERANAMES[0]:formats.ERANAMES[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=toInt(match[9]+match[10]),tzMin=toInt(match[9]+match[11])),dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour,m=toInt(match[5]||0)-tzMin,s=toInt(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format,timezone){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?toInt(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date)||!isFinite(date.getTime()))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);var dateTimezoneOffset=date.getTimezoneOffset();return timezone&&(dateTimezoneOffset=timezoneToOffset(timezone,date.getTimezoneOffset()),date=convertTimezoneToLocal(date,timezone,!0)),forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS,dateTimezoneOffset):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object,spacing){return isUndefined(spacing)&&(spacing=2),toJson(object,spacing)}}function limitToFilter(){return function(input,limit,begin){return limit=1/0===Math.abs(Number(limit))?Number(limit):toInt(limit),isNaN(limit)?input:(isNumber(input)&&(input=input.toString()),isArray(input)||isString(input)?(begin=!begin||isNaN(begin)?0:toInt(begin),begin=0>begin&&begin>=-input.length?input.length+begin:begin,limit>=0?input.slice(begin,begin+limit):0===begin?input.slice(limit,input.length):input.slice(Math.max(0,begin+limit),begin)):input)}}function orderByFilter($parse){function processPredicates(sortPredicate,reverseOrder){return reverseOrder=reverseOrder?-1:1,sortPredicate.map(function(predicate){var descending=1,get=identity;if(isFunction(predicate))get=predicate;else if(isString(predicate)&&(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0)?-1:1,predicate=predicate.substring(1)),""!==predicate&&(get=$parse(predicate),get.constant))){var key=get();get=function(value){return value[key]}}return{get:get,descending:descending*reverseOrder}})}function isPrimitive(value){switch(typeof value){case"number":case"boolean":case"string":return!0;default:return!1}}function objectValue(value,index){return"function"==typeof value.valueOf&&(value=value.valueOf(),isPrimitive(value))?value:hasCustomToString(value)&&(value=value.toString(),isPrimitive(value))?value:index}function getPredicateValue(value,index){var type=typeof value;return null===value?(type="string",value="null"):"string"===type?value=value.toLowerCase():"object"===type&&(value=objectValue(value,index)),{value:value,type:type}}function compare(v1,v2){var result=0;return v1.type===v2.type?v1.value!==v2.value&&(result=v1.value<v2.value?-1:1):result=v1.type<v2.type?-1:1,result}return function(array,sortPredicate,reverseOrder){function getComparisonObject(value,index){return{value:value,predicateValues:predicates.map(function(predicate){return getPredicateValue(predicate.get(value),index)})}}function doComparison(v1,v2){for(var result=0,index=0,length=predicates.length;length>index&&!(result=compare(v1.predicateValues[index],v2.predicateValues[index])*predicates[index].descending);++index);return result}if(!isArrayLike(array))return array;isArray(sortPredicate)||(sortPredicate=[sortPredicate]),0===sortPredicate.length&&(sortPredicate=["+"]);var predicates=processPredicates(sortPredicate,reverseOrder);predicates.push({get:function(){return{}},descending:reverseOrder?-1:1});var compareValues=Array.prototype.map.call(array,getComparisonObject);return compareValues.sort(doComparison),array=compareValues.map(function(item){return item.value})}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function nullFormRenameControl(control,name){control.$name=name}function FormController(element,attrs,$scope,$animate,$interpolate){var form=this,controls=[];form.$error={},form.$$success={},form.$pending=undefined,form.$name=$interpolate(attrs.name||attrs.ngForm||"")($scope),form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,form.$submitted=!1,form.$$parentForm=nullFormCtrl,form.$rollbackViewValue=function(){forEach(controls,function(control){control.$rollbackViewValue()})},form.$commitViewValue=function(){forEach(controls,function(control){control.$commitViewValue()})},form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control),control.$$parentForm=form},form.$$renameControl=function(control,newName){var oldName=control.$name;form[oldName]===control&&delete form[oldName],form[newName]=control,control.$name=newName},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(form.$pending,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$error,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$$success,function(value,name){form.$setValidity(name,null,control)}),arrayRemove(controls,control),control.$$parentForm=nullFormCtrl},addSetValidityMethod({ctrl:this,$element:element,set:function(object,property,controller){var list=object[property];if(list){var index=list.indexOf(controller);-1===index&&list.push(controller)}else object[property]=[controller]},unset:function(object,property,controller){var list=object[property];list&&(arrayRemove(list,controller),0===list.length&&delete object[property])},$animate:$animate}),form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,form.$$parentForm.$setDirty()},form.$setPristine=function(){$animate.setClass(element,PRISTINE_CLASS,DIRTY_CLASS+" "+SUBMITTED_CLASS),form.$dirty=!1,form.$pristine=!0,form.$submitted=!1,forEach(controls,function(control){control.$setPristine()})},form.$setUntouched=function(){forEach(controls,function(control){control.$setUntouched()})},form.$setSubmitted=function(){$animate.addClass(element,SUBMITTED_CLASS),form.$submitted=!0,form.$$parentForm.$setSubmitted()}}function stringBasedInputType(ctrl){ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?value:value.toString()})}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl)}function baseInputType(scope,element,attr,ctrl,$sniffer,$browser){var type=lowercase(element[0].type);if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var listener=function(ev){if(timeout&&($browser.defer.cancel(timeout),timeout=null),!composing){var value=element.val(),event=ev&&ev.type;"password"===type||attr.ngTrim&&"false"===attr.ngTrim||(value=trim(value)),(ctrl.$viewValue!==value||""===value&&ctrl.$$hasNativeValidators)&&ctrl.$setViewValue(value,event)}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var timeout,deferListener=function(ev,input,origValue){timeout||(timeout=$browser.defer(function(){timeout=null,input&&input.value===origValue||listener(ev)}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener(event,this,this.value)}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),ctrl.$render=function(){var value=ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue;element.val()!==value&&element.val(value)}}function weekParser(isoWeek,existingDate){if(isDate(isoWeek))return isoWeek;if(isString(isoWeek)){WEEK_REGEXP.lastIndex=0;var parts=WEEK_REGEXP.exec(isoWeek);if(parts){var year=+parts[1],week=+parts[2],hours=0,minutes=0,seconds=0,milliseconds=0,firstThurs=getFirstThursdayOfYear(year),addDays=7*(week-1);return existingDate&&(hours=existingDate.getHours(),minutes=existingDate.getMinutes(),seconds=existingDate.getSeconds(),milliseconds=existingDate.getMilliseconds()),new Date(year,0,firstThurs.getDate()+addDays,hours,minutes,seconds,milliseconds)}}return 0/0}function createDateParser(regexp,mapping){return function(iso,date){var parts,map;if(isDate(iso))return iso;if(isString(iso)){if('"'==iso.charAt(0)&&'"'==iso.charAt(iso.length-1)&&(iso=iso.substring(1,iso.length-1)),ISO_DATE_REGEXP.test(iso))return new Date(iso);if(regexp.lastIndex=0,parts=regexp.exec(iso))return parts.shift(),map=date?{yyyy:date.getFullYear(),MM:date.getMonth()+1,dd:date.getDate(),HH:date.getHours(),mm:date.getMinutes(),ss:date.getSeconds(),sss:date.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},forEach(parts,function(part,index){index<mapping.length&&(map[mapping[index]]=+part)}),new Date(map.yyyy,map.MM-1,map.dd,map.HH,map.mm,map.ss||0,1e3*map.sss||0)}return 0/0}}function createDateInputType(type,regexp,parseDate,format){return function(scope,element,attr,ctrl,$sniffer,$browser,$filter){function isValidDate(value){return value&&!(value.getTime&&value.getTime()!==value.getTime())}function parseObservedDateValue(val){return isDefined(val)&&!isDate(val)?parseDate(val)||undefined:val}badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var previousDate,timezone=ctrl&&ctrl.$options&&ctrl.$options.timezone;if(ctrl.$$parserName=type,ctrl.$parsers.push(function(value){if(ctrl.$isEmpty(value))return null;if(regexp.test(value)){var parsedDate=parseDate(value,previousDate);return timezone&&(parsedDate=convertTimezoneToLocal(parsedDate,timezone)),parsedDate}return undefined}),ctrl.$formatters.push(function(value){if(value&&!isDate(value))throw ngModelMinErr("datefmt","Expected `{0}` to be a date",value);return isValidDate(value)?(previousDate=value,previousDate&&timezone&&(previousDate=convertTimezoneToLocal(previousDate,timezone,!0)),$filter("date")(value,format,timezone)):(previousDate=null,"")}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return!isValidDate(value)||isUndefined(minVal)||parseDate(value)>=minVal},attr.$observe("min",function(val){minVal=parseObservedDateValue(val),ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return!isValidDate(value)||isUndefined(maxVal)||parseDate(value)<=maxVal},attr.$observe("max",function(val){maxVal=parseObservedDateValue(val),ctrl.$validate()})}}}function badInputChecker(scope,element,attr,ctrl){var node=element[0],nativeValidation=ctrl.$$hasNativeValidators=isObject(node.validity);nativeValidation&&ctrl.$parsers.push(function(value){var validity=element.prop(VALIDITY_STATE_PROPERTY)||{};return validity.badInput&&!validity.typeMismatch?undefined:value})}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$$parserName="number",ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:NUMBER_REGEXP.test(value)?parseFloat(value):undefined}),ctrl.$formatters.push(function(value){if(!ctrl.$isEmpty(value)){if(!isNumber(value))throw ngModelMinErr("numfmt","Expected `{0}` to be a number",value);value=value.toString()}return value}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return ctrl.$isEmpty(value)||isUndefined(minVal)||value>=minVal},attr.$observe("min",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val,10)),minVal=isNumber(val)&&!isNaN(val)?val:undefined,ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return ctrl.$isEmpty(value)||isUndefined(maxVal)||maxVal>=value},attr.$observe("max",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val,10)),maxVal=isNumber(val)&&!isNaN(val)?val:undefined,ctrl.$validate()})}}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="url",ctrl.$validators.url=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||URL_REGEXP.test(value)}}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="email",ctrl.$validators.email=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value)}}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid());var listener=function(ev){element[0].checked&&ctrl.$setViewValue(attr.value,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function parseConstantExpr($parse,context,name,expression,fallback){var parseFn;if(isDefined(expression)){if(parseFn=$parse(expression),!parseFn.constant)throw ngModelMinErr("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",name,expression);return parseFn(context)}return fallback}function checkboxInputType(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var trueValue=parseConstantExpr($parse,scope,"ngTrueValue",attr.ngTrueValue,!0),falseValue=parseConstantExpr($parse,scope,"ngFalseValue",attr.ngFalseValue,!1),listener=function(ev){ctrl.$setViewValue(element[0].checked,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value===!1},ctrl.$formatters.push(function(value){return equals(value,trueValue)}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){var classes=[];return isArray(classVal)?(forEach(classVal,function(v){classes=classes.concat(arrayClasses(v))}),classes):isString(classVal)?classVal.split(" "):isObject(classVal)?(forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes):classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||createMap(),classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toAdd=digestClassCounts(toAdd,1),toRemove=digestClassCounts(toRemove,-1),toAdd&&toAdd.length&&$animate.addClass(element,toAdd),toRemove&&toRemove.length&&$animate.removeClass(element,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||scope.$index%2===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}function addSetValidityMethod(context){function setValidity(validationErrorKey,state,controller){isUndefined(state)?createAndSet("$pending",validationErrorKey,controller):unsetAndCleanup("$pending",validationErrorKey,controller),isBoolean(state)?state?(unset(ctrl.$error,validationErrorKey,controller),set(ctrl.$$success,validationErrorKey,controller)):(set(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)):(unset(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)),ctrl.$pending?(cachedToggleClass(PENDING_CLASS,!0),ctrl.$valid=ctrl.$invalid=undefined,toggleValidationCss("",null)):(cachedToggleClass(PENDING_CLASS,!1),ctrl.$valid=isObjectEmpty(ctrl.$error),ctrl.$invalid=!ctrl.$valid,toggleValidationCss("",ctrl.$valid));var combinedState;combinedState=ctrl.$pending&&ctrl.$pending[validationErrorKey]?undefined:ctrl.$error[validationErrorKey]?!1:ctrl.$$success[validationErrorKey]?!0:null,toggleValidationCss(validationErrorKey,combinedState),ctrl.$$parentForm.$setValidity(validationErrorKey,combinedState,ctrl)}function createAndSet(name,value,controller){ctrl[name]||(ctrl[name]={}),set(ctrl[name],value,controller)}function unsetAndCleanup(name,value,controller){ctrl[name]&&unset(ctrl[name],value,controller),isObjectEmpty(ctrl[name])&&(ctrl[name]=undefined)}function cachedToggleClass(className,switchValue){switchValue&&!classCache[className]?($animate.addClass($element,className),classCache[className]=!0):!switchValue&&classCache[className]&&($animate.removeClass($element,className),classCache[className]=!1)}function toggleValidationCss(validationErrorKey,isValid){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",cachedToggleClass(VALID_CLASS+validationErrorKey,isValid===!0),cachedToggleClass(INVALID_CLASS+validationErrorKey,isValid===!1)}var ctrl=context.ctrl,$element=context.$element,classCache={},set=context.set,unset=context.unset,$animate=context.$animate;classCache[INVALID_CLASS]=!(classCache[VALID_CLASS]=$element.hasClass(VALID_CLASS)),ctrl.$setValidity=setValidity}function isObjectEmpty(obj){if(obj)for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}var REGEX_STRING_REGEXP=/^\/(.+)\/([a-z]*)$/,VALIDITY_STATE_PROPERTY="validity",lowercase=function(string){return isString(string)?string.toLowerCase():string},hasOwnProperty=Object.prototype.hasOwnProperty,uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,slice=[].slice,splice=[].splice,push=[].push,toString=Object.prototype.toString,getPrototypeOf=Object.getPrototypeOf,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=0;msie=document.documentMode,noop.$inject=[],identity.$inject=[];var skipDestroyOnNextJQueryCleanData,isArray=Array.isArray,TYPED_ARRAY_REGEXP=/^\[object (Uint8(Clamped)?)|(Uint16)|(Uint32)|(Int8)|(Int16)|(Int32)|(Float(32)|(64))Array\]$/,trim=function(value){return isString(value)?value.trim():value},escapeForRegexp=function(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},csp=function(){function noUnsafeEval(){try{return new Function(""),!1}catch(e){return!0}}if(!isDefined(csp.rules)){var ngCspElement=document.querySelector("[ng-csp]")||document.querySelector("[data-ng-csp]");if(ngCspElement){var ngCspAttribute=ngCspElement.getAttribute("ng-csp")||ngCspElement.getAttribute("data-ng-csp");csp.rules={noUnsafeEval:!ngCspAttribute||-1!==ngCspAttribute.indexOf("no-unsafe-eval"),noInlineStyle:!ngCspAttribute||-1!==ngCspAttribute.indexOf("no-inline-style")}}else csp.rules={noUnsafeEval:noUnsafeEval(),noInlineStyle:!1}}return csp.rules},jq=function(){if(isDefined(jq.name_))return jq.name_;var el,i,prefix,name,ii=ngAttrPrefixes.length;for(i=0;ii>i;++i)if(prefix=ngAttrPrefixes[i],el=document.querySelector("["+prefix.replace(":","\\:")+"jq]")){name=el.getAttribute(prefix+"jq");break}return jq.name_=name},ngAttrPrefixes=["ng-","data-ng-","ng:","x-ng-"],SNAKE_CASE_REGEXP=/[A-Z]/g,bindJQueryFired=!1,NODE_TYPE_ELEMENT=1,NODE_TYPE_ATTRIBUTE=2,NODE_TYPE_TEXT=3,NODE_TYPE_COMMENT=8,NODE_TYPE_DOCUMENT=9,NODE_TYPE_DOCUMENT_FRAGMENT=11,version={full:"1.4.7",major:1,minor:4,dot:7,codeName:"dark-luminescence"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=function(element,type,fn){element.addEventListener(type,fn,!1)},removeEventListenerFn=function(element,type,fn){element.removeEventListener(type,fn,!1)};JQLite._data=function(node){return this.cache[node[this.expando]]||{}};var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,MOUSE_EVENT_MAP={mouseleave:"mouseout",mouseenter:"mouseover"},jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:-]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return index>=0?jqLite(this[index]):jqLite(this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[value]=!0});var ALIASED_ATTR={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};forEach({data:jqLiteData,removeData:jqLiteRemoveData,hasData:jqLiteHasData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){return name=camelCase(name),isDefined(value)?(element.style[name]=value,void 0):element.style[name]},attr:function(element,name,value){var nodeType=element.nodeType;if(nodeType!==NODE_TYPE_TEXT&&nodeType!==NODE_TYPE_ATTRIBUTE&&nodeType!==NODE_TYPE_COMMENT){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}}},prop:function(element,name,value){return isDefined(value)?(element[name]=value,void 0):element[name]},text:function(){function getText(element,value){if(isUndefined(value)){var nodeType=element.nodeType;return nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_TEXT?element.textContent:""}element.textContent=value}return getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if(element.multiple&&"select"===nodeName_(element)){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){return isUndefined(value)?element.innerHTML:(jqLiteDealoc(element,!0),element.innerHTML=value,void 0)},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&isUndefined(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)){if(isObject(arg1)){for(i=0;nodeCount>i;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=isUndefined(value)?Math.min(nodeCount,1):nodeCount,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;nodeCount>i;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,on:function jqLiteOn(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(jqLiteAcceptsData(element)){var expandoStore=jqLiteExpandoStore(element,!0),events=expandoStore.events,handle=expandoStore.handle;handle||(handle=expandoStore.handle=createEventHandler(element,events));for(var types=type.indexOf(" ")>=0?type.split(" "):[type],i=types.length;i--;){type=types[i];var eventFns=events[type];eventFns||(events[type]=[],"mouseenter"===type||"mouseleave"===type?jqLiteOn(element,MOUSE_EVENT_MAP[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!target.contains(related))&&handle(event,type)}):"$destroy"!==type&&addEventListenerFn(element,type,handle),eventFns=events[type]),eventFns.push(fn)}}},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];
return forEach(element.childNodes,function(element){element.nodeType===NODE_TYPE_ELEMENT&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){var nodeType=element.nodeType;if(nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_DOCUMENT_FRAGMENT){node=new JQLite(node);for(var i=0,ii=node.length;ii>i;i++){var child=node[i];element.appendChild(child)}}},prepend:function(element,node){if(element.nodeType===NODE_TYPE_ELEMENT){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode).eq(0).clone()[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:jqLiteRemove,detach:function(element){jqLiteRemove(element,!0)},after:function(element,newElement){var index=element,parent=element.parentNode;newElement=new JQLite(newElement);for(var i=0,ii=newElement.length;ii>i;i++){var node=newElement[i];parent.insertBefore(node,index.nextSibling),index=node}},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&parent.nodeType!==NODE_TYPE_DOCUMENT_FRAGMENT?parent:null},next:function(element){return element.nextElementSibling},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,eventFns=events&&events[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){dummyEvent.isImmediatePropagationStopped()||fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0,ii=this.length;ii>i;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var $$HashMapProvider=[function(){this.$get=[function(){return HashMap}]}],FN_ARGS=/^[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector");createInjector.$$annotate=annotate;var $animateMinErr=minErr("$animate"),ELEMENT_NODE=1,NG_ANIMATE_CLASSNAME="ng-animate",$$CoreAnimateRunnerProvider=function(){this.$get=["$q","$$rAF",function($q,$$rAF){function AnimateRunner(){}return AnimateRunner.all=noop,AnimateRunner.chain=noop,AnimateRunner.prototype={end:noop,cancel:noop,resume:noop,pause:noop,complete:noop,then:function(pass,fail){return $q(function(resolve){$$rAF(function(){resolve()})}).then(pass,fail)}},AnimateRunner}]},$$CoreAnimateQueueProvider=function(){var postDigestQueue=new HashMap,postDigestElements=[];this.$get=["$$AnimateRunner","$rootScope",function($$AnimateRunner,$rootScope){function updateData(data,classes,value){var changed=!1;return classes&&(classes=isString(classes)?classes.split(" "):isArray(classes)?classes:[],forEach(classes,function(className){className&&(changed=!0,data[className]=value)})),changed}function handleCSSClassChanges(){forEach(postDigestElements,function(element){var data=postDigestQueue.get(element);if(data){var existing=splitClasses(element.attr("class")),toAdd="",toRemove="";forEach(data,function(status,className){var hasClass=!!existing[className];status!==hasClass&&(status?toAdd+=(toAdd.length?" ":"")+className:toRemove+=(toRemove.length?" ":"")+className)}),forEach(element,function(elm){toAdd&&jqLiteAddClass(elm,toAdd),toRemove&&jqLiteRemoveClass(elm,toRemove)}),postDigestQueue.remove(element)}}),postDigestElements.length=0}function addRemoveClassesPostDigest(element,add,remove){var data=postDigestQueue.get(element)||{},classesAdded=updateData(data,add,!0),classesRemoved=updateData(data,remove,!1);(classesAdded||classesRemoved)&&(postDigestQueue.put(element,data),postDigestElements.push(element),1===postDigestElements.length&&$rootScope.$$postDigest(handleCSSClassChanges))}return{enabled:noop,on:noop,off:noop,pin:noop,push:function(element,event,options,domOperation){return domOperation&&domOperation(),options=options||{},options.from&&element.css(options.from),options.to&&element.css(options.to),(options.addClass||options.removeClass)&&addRemoveClassesPostDigest(element,options.addClass,options.removeClass),new $$AnimateRunner}}}]},$AnimateProvider=["$provide",function($provide){var provider=this;this.$$registeredAnimations=Object.create(null),this.register=function(name,factory){if(name&&"."!==name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);var key=name+"-animation";provider.$$registeredAnimations[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){if(1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null,this.$$classNameFilter)){var reservedRegex=new RegExp("(\\s+|\\/)"+NG_ANIMATE_CLASSNAME+"(\\s+|\\/)");if(reservedRegex.test(this.$$classNameFilter.toString()))throw $animateMinErr("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',NG_ANIMATE_CLASSNAME)}return this.$$classNameFilter},this.$get=["$$animateQueue",function($$animateQueue){function domInsert(element,parentElement,afterElement){if(afterElement){var afterNode=extractElementNode(afterElement);!afterNode||afterNode.parentNode||afterNode.previousElementSibling||(afterElement=null)}afterElement?afterElement.after(element):parentElement.prepend(element)}return{on:$$animateQueue.on,off:$$animateQueue.off,pin:$$animateQueue.pin,enabled:$$animateQueue.enabled,cancel:function(runner){runner.end&&runner.end()},enter:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"enter",prepareAnimateOptions(options))},move:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"move",prepareAnimateOptions(options))},leave:function(element,options){return $$animateQueue.push(element,"leave",prepareAnimateOptions(options),function(){element.remove()})},addClass:function(element,className,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addclass,className),$$animateQueue.push(element,"addClass",options)},removeClass:function(element,className,options){return options=prepareAnimateOptions(options),options.removeClass=mergeClasses(options.removeClass,className),$$animateQueue.push(element,"removeClass",options)},setClass:function(element,add,remove,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addClass,add),options.removeClass=mergeClasses(options.removeClass,remove),$$animateQueue.push(element,"setClass",options)},animate:function(element,from,to,className,options){return options=prepareAnimateOptions(options),options.from=options.from?extend(options.from,from):from,options.to=options.to?extend(options.to,to):to,className=className||"ng-inline-animate",options.tempClasses=mergeClasses(options.tempClasses,className),$$animateQueue.push(element,"animate",options)}}}]}],$CoreAnimateCssProvider=function(){this.$get=["$$rAF","$q",function($$rAF,$q){var RAFPromise=function(){};return RAFPromise.prototype={done:function(cancel){this.defer&&this.defer[cancel===!0?"reject":"resolve"]()},end:function(){this.done()},cancel:function(){this.done(!0)},getPromise:function(){return this.defer||(this.defer=$q.defer()),this.defer.promise},then:function(f1,f2){return this.getPromise().then(f1,f2)},"catch":function(f1){return this.getPromise()["catch"](f1)},"finally":function(f1){return this.getPromise()["finally"](f1)}},function(element,options){function run(){return $$rAF(function(){close(),closed||runner.done(),closed=!0}),runner}function close(){options.addClass&&(element.addClass(options.addClass),options.addClass=null),options.removeClass&&(element.removeClass(options.removeClass),options.removeClass=null),options.to&&(element.css(options.to),options.to=null)}options.cleanupStyles&&(options.from=options.to=null),options.from&&(element.css(options.from),options.from=null);var closed,runner=new RAFPromise;return{start:run,end:run}}}]},$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"];var PREFIX_REGEXP=/^((?:x|data)[\:\-_])/i,$controllerMinErr=minErr("$controller"),CNTRL_REG=/^(\S+)(\s+as\s+(\w+))?$/,$$ForceReflowProvider=function(){this.$get=["$document",function($document){return function(domNode){return domNode?!domNode.nodeType&&domNode instanceof jqLite&&(domNode=domNode[0]):domNode=$document[0].body,domNode.offsetWidth+1}}]},APPLICATION_JSON="application/json",CONTENT_TYPE_APPLICATION_JSON={"Content-Type":APPLICATION_JSON+";charset=utf-8"},JSON_START=/^\[|^\{(?!\{)/,JSON_ENDS={"[":/]$/,"{":/}$/},JSON_PROTECTION_PREFIX=/^\)\]\}',?\n/,$httpMinErr=minErr("$http"),$httpMinErrLegacyFn=function(method){return function(){throw $httpMinErr("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",method)}},$interpolateMinErr=angular.$interpolateMinErr=minErr("$interpolate");$interpolateMinErr.throwNoconcat=function(text){throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text)},$interpolateMinErr.interr=function(text,err){return $interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString())};var PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location"),locationPrototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return(match[1]||""===url)&&this.path(decodeURIComponent(match[1])),(match[2]||match[1]||""===url)&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");search=copy(search,{}),forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(Location){Location.prototype=Object.create(locationPrototype),Location.prototype.state=function(state){if(!arguments.length)return this.$$state;if(Location!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(state)?null:state,this}});var $parseMinErr=minErr("$parse"),CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,OPERATORS=createMap();forEach("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(operator){OPERATORS[operator]=!0});var ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.tokens=[];this.index<this.text.length;){var ch=this.text.charAt(this.index);if('"'===ch||"'"===ch)this.readString(ch);else if(this.isNumber(ch)||"."===ch&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(ch))this.readIdent();else if(this.is(ch,"(){}[].,;:?"))this.tokens.push({index:this.index,text:ch}),this.index++;else if(this.isWhitespace(ch))this.index++;else{var ch2=ch+this.peek(),ch3=ch2+this.peek(2),op1=OPERATORS[ch],op2=OPERATORS[ch2],op3=OPERATORS[ch3];if(op1||op2||op3){var token=op3?ch3:op2?ch2:ch;this.tokens.push({index:this.index,text:token,operator:!0}),this.index+=token.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(ch,chars){return-1!==chars.indexOf(ch)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch&&"string"==typeof ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||""===ch||""===ch},isIdent:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:start,text:number,constant:!0,value:Number(number)})},readIdent:function(){for(var start=this.index;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(!this.isIdent(ch)&&!this.isNumber(ch))break;this.index++}this.tokens.push({index:start,text:this.text.slice(start,this.index),identifier:!0})},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,this.tokens.push({index:start,text:rawString,constant:!0,value:string}),void 0;string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var AST=function(lexer,options){this.lexer=lexer,this.options=options};AST.Program="Program",AST.ExpressionStatement="ExpressionStatement",AST.AssignmentExpression="AssignmentExpression",AST.ConditionalExpression="ConditionalExpression",AST.LogicalExpression="LogicalExpression",AST.BinaryExpression="BinaryExpression",AST.UnaryExpression="UnaryExpression",AST.CallExpression="CallExpression",AST.MemberExpression="MemberExpression",AST.Identifier="Identifier",AST.Literal="Literal",AST.ArrayExpression="ArrayExpression",AST.Property="Property",AST.ObjectExpression="ObjectExpression",AST.ThisExpression="ThisExpression",AST.NGValueParameter="NGValueParameter",AST.prototype={ast:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value},program:function(){for(var body=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&body.push(this.expressionStatement()),!this.expect(";"))return{type:AST.Program,body:body}},expressionStatement:function(){return{type:AST.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var token,left=this.expression();token=this.expect("|");)left=this.filter(left);return left},expression:function(){return this.assignment()},assignment:function(){var result=this.ternary();return this.expect("=")&&(result={type:AST.AssignmentExpression,left:result,right:this.assignment(),operator:"="}),result},ternary:function(){var alternate,consequent,test=this.logicalOR();return this.expect("?")&&(alternate=this.expression(),this.consume(":"))?(consequent=this.expression(),{type:AST.ConditionalExpression,test:test,alternate:alternate,consequent:consequent}):test},logicalOR:function(){for(var left=this.logicalAND();this.expect("||");)left={type:AST.LogicalExpression,operator:"||",left:left,right:this.logicalAND()};return left},logicalAND:function(){for(var left=this.equality();this.expect("&&");)left={type:AST.LogicalExpression,operator:"&&",left:left,right:this.equality()};return left},equality:function(){for(var token,left=this.relational();token=this.expect("==","!=","===","!==");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.relational()};return left},relational:function(){for(var token,left=this.additive();token=this.expect("<",">","<=",">=");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.additive()};return left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.multiplicative()};return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.unary()};return left},unary:function(){var token;return(token=this.expect("+","-","!"))?{type:AST.UnaryExpression,operator:token.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var primary;this.expect("(")?(primary=this.filterChain(),this.consume(")")):this.expect("[")?primary=this.arrayDeclaration():this.expect("{")?primary=this.object():this.constants.hasOwnProperty(this.peek().text)?primary=copy(this.constants[this.consume().text]):this.peek().identifier?primary=this.identifier():this.peek().constant?primary=this.constant():this.throwError("not a primary expression",this.peek());for(var next;next=this.expect("(","[",".");)"("===next.text?(primary={type:AST.CallExpression,callee:primary,arguments:this.parseArguments()},this.consume(")")):"["===next.text?(primary={type:AST.MemberExpression,object:primary,property:this.expression(),computed:!0},this.consume("]")):"."===next.text?primary={type:AST.MemberExpression,object:primary,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return primary},filter:function(baseExpression){for(var args=[baseExpression],result={type:AST.CallExpression,callee:this.identifier(),arguments:args,filter:!0};this.expect(":");)args.push(this.expression());return result},parseArguments:function(){var args=[];if(")"!==this.peekToken().text)do args.push(this.expression());while(this.expect(","));return args},identifier:function(){var token=this.consume();return token.identifier||this.throwError("is not a valid identifier",token),{type:AST.Identifier,name:token.text}},constant:function(){return{type:AST.Literal,value:this.consume().value}},arrayDeclaration:function(){var elements=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;elements.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:AST.ArrayExpression,elements:elements}},object:function(){var property,properties=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;property={type:AST.Property,kind:"init"},this.peek().constant?property.key=this.constant():this.peek().identifier?property.key=this.identifier():this.throwError("invalid key",this.peek()),this.consume(":"),property.value=this.expression(),properties.push(property)}while(this.expect(","));return this.consume("}"),{type:AST.ObjectExpression,properties:properties}},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},consume:function(e1){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);var token=this.expect(e1);return token||this.throwError("is unexpected, expecting ["+e1+"]",this.peek()),token},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){return this.peekAhead(0,e1,e2,e3,e4)},peekAhead:function(i,e1,e2,e3,e4){if(this.tokens.length>i){var token=this.tokens[i],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.tokens.shift(),token):!1},constants:{"true":{type:AST.Literal,value:!0},"false":{type:AST.Literal,value:!1},"null":{type:AST.Literal,value:null},undefined:{type:AST.Literal,value:undefined},"this":{type:AST.ThisExpression}}},ASTCompiler.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.state={nextId:0,filters:{},expensiveChecks:expensiveChecks,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},findConstantAndWatchExpressions(ast,self.$filter);var assignable,extra="";if(this.stage="assign",assignable=assignableAST(ast)){this.state.computing="assign";var result=this.nextId();this.recurse(assignable,result),this.return_(result),extra="fn.assign="+this.generateFunction("assign","s,v,l")}var toWatch=getInputs(ast.body);self.stage="inputs",forEach(toWatch,function(watch,key){var fnKey="fn"+key;self.state[fnKey]={vars:[],body:[],own:{}},self.state.computing=fnKey;var intoId=self.nextId();self.recurse(watch,intoId),self.return_(intoId),self.state.inputs.push(fnKey),watch.watchId=key}),this.state.computing="fn",this.stage="main",this.recurse(ast);var fnString='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+extra+this.watchFns()+"return fn;",fn=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",fnString)(this.$filter,ensureSafeMemberName,ensureSafeObject,ensureSafeFunction,getStringValue,ensureSafeAssignContext,ifDefined,plusFn,expression);return this.state=this.stage=undefined,fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},USE:"use",STRICT:"strict",watchFns:function(){var result=[],fns=this.state.inputs,self=this;return forEach(fns,function(name){result.push("var "+name+"="+self.generateFunction(name,"s"))}),fns.length&&result.push("fn.inputs=["+fns.join(",")+"];"),result.join("")},generateFunction:function(name,params){return"function("+params+"){"+this.varsPrefix(name)+this.body(name)+"};"},filterPrefix:function(){var parts=[],self=this;return forEach(this.state.filters,function(id,filter){parts.push(id+"=$filter("+self.escape(filter)+")")}),parts.length?"var "+parts.join(",")+";":""},varsPrefix:function(section){return this.state[section].vars.length?"var "+this.state[section].vars.join(",")+";":""},body:function(section){return this.state[section].body.join("")},recurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var left,right,args,expression,self=this;if(recursionFn=recursionFn||noop,!skipWatchIdCheck&&isDefined(ast.watchId))return intoId=intoId||this.nextId(),this.if_("i",this.lazyAssign(intoId,this.computedMember("i",ast.watchId)),this.lazyRecurse(ast,intoId,nameId,recursionFn,create,!0)),void 0;switch(ast.type){case AST.Program:forEach(ast.body,function(expression,pos){self.recurse(expression.expression,undefined,undefined,function(expr){right=expr}),pos!==ast.body.length-1?self.current().body.push(right,";"):self.return_(right)});break;case AST.Literal:expression=this.escape(ast.value),this.assign(intoId,expression),recursionFn(expression);break;case AST.UnaryExpression:this.recurse(ast.argument,undefined,undefined,function(expr){right=expr}),expression=ast.operator+"("+this.ifDefined(right,0)+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.BinaryExpression:this.recurse(ast.left,undefined,undefined,function(expr){left=expr}),this.recurse(ast.right,undefined,undefined,function(expr){right=expr}),expression="+"===ast.operator?this.plus(left,right):"-"===ast.operator?this.ifDefined(left,0)+ast.operator+this.ifDefined(right,0):"("+left+")"+ast.operator+"("+right+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.LogicalExpression:intoId=intoId||this.nextId(),self.recurse(ast.left,intoId),self.if_("&&"===ast.operator?intoId:self.not(intoId),self.lazyRecurse(ast.right,intoId)),recursionFn(intoId);break;case AST.ConditionalExpression:intoId=intoId||this.nextId(),self.recurse(ast.test,intoId),self.if_(intoId,self.lazyRecurse(ast.alternate,intoId),self.lazyRecurse(ast.consequent,intoId)),recursionFn(intoId);break;case AST.Identifier:intoId=intoId||this.nextId(),nameId&&(nameId.context="inputs"===self.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",ast.name)+"?l:s"),nameId.computed=!1,nameId.name=ast.name),ensureSafeMemberName(ast.name),self.if_("inputs"===self.stage||self.not(self.getHasOwnProperty("l",ast.name)),function(){self.if_("inputs"===self.stage||"s",function(){create&&1!==create&&self.if_(self.not(self.nonComputedMember("s",ast.name)),self.lazyAssign(self.nonComputedMember("s",ast.name),"{}")),self.assign(intoId,self.nonComputedMember("s",ast.name))})},intoId&&self.lazyAssign(intoId,self.nonComputedMember("l",ast.name))),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.name))&&self.addEnsureSafeObject(intoId),recursionFn(intoId);break;case AST.MemberExpression:left=nameId&&(nameId.context=this.nextId())||this.nextId(),intoId=intoId||this.nextId(),self.recurse(ast.object,left,undefined,function(){self.if_(self.notNull(left),function(){ast.computed?(right=self.nextId(),self.recurse(ast.property,right),self.getStringValue(right),self.addEnsureSafeMemberName(right),create&&1!==create&&self.if_(self.not(self.computedMember(left,right)),self.lazyAssign(self.computedMember(left,right),"{}")),expression=self.ensureSafeObject(self.computedMember(left,right)),self.assign(intoId,expression),nameId&&(nameId.computed=!0,nameId.name=right)):(ensureSafeMemberName(ast.property.name),create&&1!==create&&self.if_(self.not(self.nonComputedMember(left,ast.property.name)),self.lazyAssign(self.nonComputedMember(left,ast.property.name),"{}")),expression=self.nonComputedMember(left,ast.property.name),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.property.name))&&(expression=self.ensureSafeObject(expression)),self.assign(intoId,expression),nameId&&(nameId.computed=!1,nameId.name=ast.property.name))},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)},!!create);break;case AST.CallExpression:intoId=intoId||this.nextId(),ast.filter?(right=self.filter(ast.callee.name),args=[],forEach(ast.arguments,function(expr){var argument=self.nextId();self.recurse(expr,argument),args.push(argument)}),expression=right+"("+args.join(",")+")",self.assign(intoId,expression),recursionFn(intoId)):(right=self.nextId(),left={},args=[],self.recurse(ast.callee,right,left,function(){self.if_(self.notNull(right),function(){self.addEnsureSafeFunction(right),forEach(ast.arguments,function(expr){self.recurse(expr,self.nextId(),undefined,function(argument){args.push(self.ensureSafeObject(argument))})}),left.name?(self.state.expensiveChecks||self.addEnsureSafeObject(left.context),expression=self.member(left.context,left.name,left.computed)+"("+args.join(",")+")"):expression=right+"("+args.join(",")+")",expression=self.ensureSafeObject(expression),self.assign(intoId,expression)},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)}));break;case AST.AssignmentExpression:if(right=this.nextId(),left={},!isAssignable(ast.left))throw $parseMinErr("lval","Trying to assing a value to a non l-value");this.recurse(ast.left,undefined,left,function(){self.if_(self.notNull(left.context),function(){self.recurse(ast.right,right),self.addEnsureSafeObject(self.member(left.context,left.name,left.computed)),self.addEnsureSafeAssignContext(left.context),expression=self.member(left.context,left.name,left.computed)+ast.operator+right,self.assign(intoId,expression),recursionFn(intoId||expression)})},1);break;case AST.ArrayExpression:args=[],forEach(ast.elements,function(expr){self.recurse(expr,self.nextId(),undefined,function(argument){args.push(argument)})}),expression="["+args.join(",")+"]",this.assign(intoId,expression),recursionFn(expression);break;case AST.ObjectExpression:args=[],forEach(ast.properties,function(property){self.recurse(property.value,self.nextId(),undefined,function(expr){args.push(self.escape(property.key.type===AST.Identifier?property.key.name:""+property.key.value)+":"+expr)})}),expression="{"+args.join(",")+"}",this.assign(intoId,expression),recursionFn(expression);break;case AST.ThisExpression:this.assign(intoId,"s"),recursionFn("s");break;case AST.NGValueParameter:this.assign(intoId,"v"),recursionFn("v")}},getHasOwnProperty:function(element,property){var key=element+"."+property,own=this.current().own;return own.hasOwnProperty(key)||(own[key]=this.nextId(!1,element+"&&("+this.escape(property)+" in "+element+")")),own[key]},assign:function(id,value){return id?(this.current().body.push(id,"=",value,";"),id):void 0},filter:function(filterName){return this.state.filters.hasOwnProperty(filterName)||(this.state.filters[filterName]=this.nextId(!0)),this.state.filters[filterName]},ifDefined:function(id,defaultValue){return"ifDefined("+id+","+this.escape(defaultValue)+")"},plus:function(left,right){return"plus("+left+","+right+")"},return_:function(id){this.current().body.push("return ",id,";")},if_:function(test,alternate,consequent){if(test===!0)alternate();else{var body=this.current().body;body.push("if(",test,"){"),alternate(),body.push("}"),consequent&&(body.push("else{"),consequent(),body.push("}"))}},not:function(expression){return"!("+expression+")"},notNull:function(expression){return expression+"!=null"},nonComputedMember:function(left,right){return left+"."+right},computedMember:function(left,right){return left+"["+right+"]"},member:function(left,right,computed){return computed?this.computedMember(left,right):this.nonComputedMember(left,right)},addEnsureSafeObject:function(item){this.current().body.push(this.ensureSafeObject(item),";")},addEnsureSafeMemberName:function(item){this.current().body.push(this.ensureSafeMemberName(item),";")},addEnsureSafeFunction:function(item){this.current().body.push(this.ensureSafeFunction(item),";")},addEnsureSafeAssignContext:function(item){this.current().body.push(this.ensureSafeAssignContext(item),";")},ensureSafeObject:function(item){return"ensureSafeObject("+item+",text)"},ensureSafeMemberName:function(item){return"ensureSafeMemberName("+item+",text)"},ensureSafeFunction:function(item){return"ensureSafeFunction("+item+",text)"
},getStringValue:function(item){this.assign(item,"getStringValue("+item+",text)")},ensureSafeAssignContext:function(item){return"ensureSafeAssignContext("+item+",text)"},lazyRecurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var self=this;return function(){self.recurse(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck)}},lazyAssign:function(id,value){var self=this;return function(){self.assign(id,value)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)},escape:function(value){if(isString(value))return"'"+value.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(isNumber(value))return value.toString();if(value===!0)return"true";if(value===!1)return"false";if(null===value)return"null";if("undefined"==typeof value)return"undefined";throw $parseMinErr("esc","IMPOSSIBLE")},nextId:function(skip,init){var id="v"+this.state.nextId++;return skip||this.current().vars.push(id+(init?"="+init:"")),id},current:function(){return this.state[this.state.computing]}},ASTInterpreter.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.expression=expression,this.expensiveChecks=expensiveChecks,findConstantAndWatchExpressions(ast,self.$filter);var assignable,assign;(assignable=assignableAST(ast))&&(assign=this.recurse(assignable));var inputs,toWatch=getInputs(ast.body);toWatch&&(inputs=[],forEach(toWatch,function(watch,key){var input=self.recurse(watch);watch.input=input,inputs.push(input),watch.watchId=key}));var expressions=[];forEach(ast.body,function(expression){expressions.push(self.recurse(expression.expression))});var fn=0===ast.body.length?function(){}:1===ast.body.length?expressions[0]:function(scope,locals){var lastValue;return forEach(expressions,function(exp){lastValue=exp(scope,locals)}),lastValue};return assign&&(fn.assign=function(scope,value,locals){return assign(scope,locals,value)}),inputs&&(fn.inputs=inputs),fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},recurse:function(ast,context,create){var left,right,args,self=this;if(ast.input)return this.inputs(ast.input,ast.watchId);switch(ast.type){case AST.Literal:return this.value(ast.value,context);case AST.UnaryExpression:return right=this.recurse(ast.argument),this["unary"+ast.operator](right,context);case AST.BinaryExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.LogicalExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.ConditionalExpression:return this["ternary?:"](this.recurse(ast.test),this.recurse(ast.alternate),this.recurse(ast.consequent),context);case AST.Identifier:return ensureSafeMemberName(ast.name,self.expression),self.identifier(ast.name,self.expensiveChecks||isPossiblyDangerousMemberName(ast.name),context,create,self.expression);case AST.MemberExpression:return left=this.recurse(ast.object,!1,!!create),ast.computed||(ensureSafeMemberName(ast.property.name,self.expression),right=ast.property.name),ast.computed&&(right=this.recurse(ast.property)),ast.computed?this.computedMember(left,right,context,create,self.expression):this.nonComputedMember(left,right,self.expensiveChecks,context,create,self.expression);case AST.CallExpression:return args=[],forEach(ast.arguments,function(expr){args.push(self.recurse(expr))}),ast.filter&&(right=this.$filter(ast.callee.name)),ast.filter||(right=this.recurse(ast.callee,!0)),ast.filter?function(scope,locals,assign,inputs){for(var values=[],i=0;i<args.length;++i)values.push(args[i](scope,locals,assign,inputs));var value=right.apply(undefined,values,inputs);return context?{context:undefined,name:undefined,value:value}:value}:function(scope,locals,assign,inputs){var value,rhs=right(scope,locals,assign,inputs);if(null!=rhs.value){ensureSafeObject(rhs.context,self.expression),ensureSafeFunction(rhs.value,self.expression);for(var values=[],i=0;i<args.length;++i)values.push(ensureSafeObject(args[i](scope,locals,assign,inputs),self.expression));value=ensureSafeObject(rhs.value.apply(rhs.context,values),self.expression)}return context?{value:value}:value};case AST.AssignmentExpression:return left=this.recurse(ast.left,!0,1),right=this.recurse(ast.right),function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs);return ensureSafeObject(lhs.value,self.expression),ensureSafeAssignContext(lhs.context),lhs.context[lhs.name]=rhs,context?{value:rhs}:rhs};case AST.ArrayExpression:return args=[],forEach(ast.elements,function(expr){args.push(self.recurse(expr))}),function(scope,locals,assign,inputs){for(var value=[],i=0;i<args.length;++i)value.push(args[i](scope,locals,assign,inputs));return context?{value:value}:value};case AST.ObjectExpression:return args=[],forEach(ast.properties,function(property){args.push({key:property.key.type===AST.Identifier?property.key.name:""+property.key.value,value:self.recurse(property.value)})}),function(scope,locals,assign,inputs){for(var value={},i=0;i<args.length;++i)value[args[i].key]=args[i].value(scope,locals,assign,inputs);return context?{value:value}:value};case AST.ThisExpression:return function(scope){return context?{value:scope}:scope};case AST.NGValueParameter:return function(scope,locals,assign){return context?{value:assign}:assign}}},"unary+":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?+arg:0,context?{value:arg}:arg}},"unary-":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?-arg:0,context?{value:arg}:arg}},"unary!":function(argument,context){return function(scope,locals,assign,inputs){var arg=!argument(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary+":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=plusFn(lhs,rhs);return context?{value:arg}:arg}},"binary-":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=(isDefined(lhs)?lhs:0)-(isDefined(rhs)?rhs:0);return context?{value:arg}:arg}},"binary*":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)*right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary/":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)/right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary%":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)%right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary===":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)===right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary&&":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)&&right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary||":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)||right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"ternary?:":function(test,alternate,consequent,context){return function(scope,locals,assign,inputs){var arg=test(scope,locals,assign,inputs)?alternate(scope,locals,assign,inputs):consequent(scope,locals,assign,inputs);return context?{value:arg}:arg}},value:function(value,context){return function(){return context?{context:undefined,name:undefined,value:value}:value}},identifier:function(name,expensiveChecks,context,create,expression){return function(scope,locals){var base=locals&&name in locals?locals:scope;create&&1!==create&&base&&!base[name]&&(base[name]={});var value=base?base[name]:undefined;return expensiveChecks&&ensureSafeObject(value,expression),context?{context:base,name:name,value:value}:value}},computedMember:function(left,right,context,create,expression){return function(scope,locals,assign,inputs){var rhs,value,lhs=left(scope,locals,assign,inputs);return null!=lhs&&(rhs=right(scope,locals,assign,inputs),rhs=getStringValue(rhs),ensureSafeMemberName(rhs,expression),create&&1!==create&&lhs&&!lhs[rhs]&&(lhs[rhs]={}),value=lhs[rhs],ensureSafeObject(value,expression)),context?{context:lhs,name:rhs,value:value}:value}},nonComputedMember:function(left,right,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs);create&&1!==create&&lhs&&!lhs[right]&&(lhs[right]={});var value=null!=lhs?lhs[right]:undefined;return(expensiveChecks||isPossiblyDangerousMemberName(right))&&ensureSafeObject(value,expression),context?{context:lhs,name:right,value:value}:value}},inputs:function(input,watchId){return function(scope,value,locals,inputs){return inputs?inputs[watchId]:input(scope,value,locals)}}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options,this.ast=new AST(this.lexer),this.astCompiler=options.csp?new ASTInterpreter(this.ast,$filter):new ASTCompiler(this.ast,$filter)};Parser.prototype={constructor:Parser,parse:function(text){return this.astCompiler.compile(text,this.options.expensiveChecks)}};var objectValueOf=(createMap(),createMap(),Object.prototype.valueOf),$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$compileMinErr=minErr("$compile"),urlParsingNode=document.createElement("a"),originUrl=urlResolve(window.location.href);$$CookieReader.$inject=["$document"],$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter,ww:weekGetter(2),w:weekGetter(1),G:eraGetter,GG:eraGetter,GGG:eraGetter,GGGG:longEraGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return attr.href||attr.xlinkHref?void 0:function(scope,element){if("a"===element[0].nodeName.toLowerCase()){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){function defaultLinkFn(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName),linkFn=defaultLinkFn;"checked"===propName&&(linkFn=function(scope,element,attr){attr.ngModel!==attr[normalized]&&defaultLinkFn(scope,element,attr)}),ngAttributeAliasDirectives[normalized]=function(){return{restrict:"A",priority:100,link:linkFn}}}}),forEach(ALIASED_ATTR,function(htmlAttr,ngAttr){ngAttributeAliasDirectives[ngAttr]=function(){return{priority:100,link:function(scope,element,attr){if("ngPattern"===ngAttr&&"/"==attr.ngPattern.charAt(0)){var match=attr.ngPattern.match(REGEX_STRING_REGEXP);if(match)return attr.$set("ngPattern",new RegExp(match[1],match[2])),void 0}scope.$watch(attr[ngAttr],function(value){attr.$set(ngAttr,value)})}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),msie&&propName&&element.prop(propName,attr[name]),void 0):("href"===attrName&&attr.$set(name,null),void 0)})}}}});var nullFormCtrl={$addControl:noop,$$renameControl:nullFormRenameControl,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop,$setSubmitted:noop},SUBMITTED_CLASS="ng-submitted";FormController.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var formDirectiveFactory=function(isNgForm){return["$timeout","$parse",function($timeout,$parse){function getSetter(expression){return""===expression?$parse('this[""]').assign:$parse(expression).assign||noop}var formDirective={name:"form",restrict:isNgForm?"EAC":"E",require:["form","^^?form"],controller:FormController,compile:function(formElement,attr){formElement.addClass(PRISTINE_CLASS).addClass(VALID_CLASS);var nameAttr=attr.name?"name":isNgForm&&attr.ngForm?"ngForm":!1;return{pre:function(scope,formElement,attr,ctrls){var controller=ctrls[0];if(!("action"in attr)){var handleFormSubmission=function(event){scope.$apply(function(){controller.$commitViewValue(),controller.$setSubmitted()}),event.preventDefault()};addEventListenerFn(formElement[0],"submit",handleFormSubmission),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",handleFormSubmission)},0,!1)})}var parentFormCtrl=ctrls[1]||controller.$$parentForm;parentFormCtrl.$addControl(controller);var setter=nameAttr?getSetter(controller.$name):noop;nameAttr&&(setter(scope,controller),attr.$observe(nameAttr,function(newValue){controller.$name!==newValue&&(setter(scope,undefined),controller.$$parentForm.$$renameControl(controller,newValue),(setter=getSetter(controller.$name))(scope,controller))})),formElement.on("$destroy",function(){controller.$$parentForm.$removeControl(controller),setter(scope,undefined),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),ISO_DATE_REGEXP=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,DATE_REGEXP=/^(\d{4})-(\d{2})-(\d{2})$/,DATETIMELOCAL_REGEXP=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,WEEK_REGEXP=/^(\d{4})-W(\d\d)$/,MONTH_REGEXP=/^(\d{4})-(\d\d)$/,TIME_REGEXP=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,inputType={text:textInputType,date:createDateInputType("date",DATE_REGEXP,createDateParser(DATE_REGEXP,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":createDateInputType("datetimelocal",DATETIMELOCAL_REGEXP,createDateParser(DATETIMELOCAL_REGEXP,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:createDateInputType("time",TIME_REGEXP,createDateParser(TIME_REGEXP,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:createDateInputType("week",WEEK_REGEXP,weekParser,"yyyy-Www"),month:createDateInputType("month",MONTH_REGEXP,createDateParser(MONTH_REGEXP,["yyyy","MM"]),"yyyy-MM"),number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer","$filter","$parse",function($browser,$sniffer,$filter,$parse){return{restrict:"E",require:["?ngModel"],link:{pre:function(scope,element,attr,ctrls){ctrls[0]&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrls[0],$sniffer,$browser,$filter,$parse)}}}}],CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{restrict:"A",priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=["$compile",function($compile){return{restrict:"AC",compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBind),element=element[0],scope.$watch(attr.ngBind,function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindTemplateDirective=["$interpolate","$compile",function($interpolate,$compile){return{compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));$compile.$$addBindingInfo(element,interpolateFn.expressions),element=element[0],attr.$observe("ngBindTemplate",function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindHtmlDirective=["$sce","$parse","$compile",function($sce,$parse,$compile){return{restrict:"A",compile:function(tElement,tAttrs){var ngBindHtmlGetter=$parse(tAttrs.ngBindHtml),ngBindHtmlWatch=$parse(tAttrs.ngBindHtml,function(value){return(value||"").toString()});return $compile.$$addBindingClass(tElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBindHtml),scope.$watch(ngBindHtmlWatch,function(){element.html($sce.getTrustedHtml(ngBindHtmlGetter(scope))||"")})}}}}],ngChangeDirective=valueFn({restrict:"A",require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{restrict:"A",compile:function($element,attr){var fn=$parse(attr[directiveName],null,!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate",function($animate){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){value?childScope||$transclude(function(clone,newScope){childScope=newScope,clone[clone.length++]=document.createComment(" end ngIf: "+$attr.ngIf+" "),block={clone:clone},$animate.enter(clone,$element.parent(),$element)}):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockNodes(block.clone),$animate.leave(previousElements).then(function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$templateRequest","$anchorScroll","$animate",function($templateRequest,$anchorScroll,$animate){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement).then(function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch(srcExp,function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($templateRequest(src,!0).then(function(response){if(thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element).then(afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded",src),scope.$eval(onloadExp)}},function(){thisChangeId===changeCounter&&(cleanupLastIncludeContent(),scope.$emit("$includeContentError",src))}),scope.$emit("$includeContentRequested",src)):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){return/SVG/.test($element[0].toString())?($element.empty(),$compile(jqLiteBuildFragment(ctrl.template,document).childNodes)(scope,function(clone){$element.append(clone)},{futureParentElement:$element}),void 0):($element.html(ctrl.template),$compile($element.contents())(scope),void 0)}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngListDirective=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(scope,element,attr,ctrl){var ngList=element.attr(attr.$attr.ngList)||", ",trimValues="false"!==attr.ngTrim,separator=trimValues?trim(ngList):ngList,parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trimValues?trim(value):value)}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(ngList):undefined}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",UNTOUCHED_CLASS="ng-untouched",TOUCHED_CLASS="ng-touched",PENDING_CLASS="ng-pending",ngModelMinErr=minErr("ngModel"),NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate,$timeout,$rootScope,$q,$interpolate){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=undefined,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=undefined,this.$name=$interpolate($attr.name||"",!1)($scope),this.$$parentForm=nullFormCtrl;var parserValid,parsedNgModel=$parse($attr.ngModel),parsedNgModelAssign=parsedNgModel.assign,ngModelGet=parsedNgModel,ngModelSet=parsedNgModelAssign,pendingDebounce=null,ctrl=this;this.$$setOptions=function(options){if(ctrl.$options=options,options&&options.getterSetter){var invokeModelGetter=$parse($attr.ngModel+"()"),invokeModelSetter=$parse($attr.ngModel+"($$$p)");ngModelGet=function($scope){var modelValue=parsedNgModel($scope);return isFunction(modelValue)&&(modelValue=invokeModelGetter($scope)),modelValue},ngModelSet=function($scope){isFunction(parsedNgModel($scope))?invokeModelSetter($scope,{$$$p:ctrl.$modelValue}):parsedNgModelAssign($scope,ctrl.$modelValue)}}else if(!parsedNgModel.assign)throw ngModelMinErr("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element))},this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value};var currentValidationRunId=0;addSetValidityMethod({ctrl:this,$element:$element,set:function(object,property){object[property]=!0},unset:function(object,property){delete object[property]},$animate:$animate}),this.$setPristine=function(){ctrl.$dirty=!1,ctrl.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setDirty=function(){ctrl.$dirty=!0,ctrl.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),ctrl.$$parentForm.$setDirty()},this.$setUntouched=function(){ctrl.$touched=!1,ctrl.$untouched=!0,$animate.setClass($element,UNTOUCHED_CLASS,TOUCHED_CLASS)},this.$setTouched=function(){ctrl.$touched=!0,ctrl.$untouched=!1,$animate.setClass($element,TOUCHED_CLASS,UNTOUCHED_CLASS)},this.$rollbackViewValue=function(){$timeout.cancel(pendingDebounce),ctrl.$viewValue=ctrl.$$lastCommittedViewValue,ctrl.$render()},this.$validate=function(){if(!isNumber(ctrl.$modelValue)||!isNaN(ctrl.$modelValue)){var viewValue=ctrl.$$lastCommittedViewValue,modelValue=ctrl.$$rawModelValue,prevValid=ctrl.$valid,prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$runValidators(modelValue,viewValue,function(allValid){allowInvalid||prevValid===allValid||(ctrl.$modelValue=allValid?modelValue:undefined,ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope())})}},this.$$runValidators=function(modelValue,viewValue,doneCallback){function processParseErrors(){var errorKey=ctrl.$$parserName||"parse";return isUndefined(parserValid)?(setValidity(errorKey,null),!0):(parserValid||(forEach(ctrl.$validators,function(v,name){setValidity(name,null)}),forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)})),setValidity(errorKey,parserValid),parserValid)}function processSyncValidators(){var syncValidatorsValid=!0;return forEach(ctrl.$validators,function(validator,name){var result=validator(modelValue,viewValue);syncValidatorsValid=syncValidatorsValid&&result,setValidity(name,result)}),syncValidatorsValid?!0:(forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1)}function processAsyncValidators(){var validatorPromises=[],allValid=!0;forEach(ctrl.$asyncValidators,function(validator,name){var promise=validator(modelValue,viewValue);if(!isPromiseLike(promise))throw ngModelMinErr("$asyncValidators","Expected asynchronous validator to return a promise but got '{0}' instead.",promise);setValidity(name,undefined),validatorPromises.push(promise.then(function(){setValidity(name,!0)},function(){allValid=!1,setValidity(name,!1)}))}),validatorPromises.length?$q.all(validatorPromises).then(function(){validationDone(allValid)},noop):validationDone(!0)}function setValidity(name,isValid){localValidationRunId===currentValidationRunId&&ctrl.$setValidity(name,isValid)}function validationDone(allValid){localValidationRunId===currentValidationRunId&&doneCallback(allValid)}currentValidationRunId++;var localValidationRunId=currentValidationRunId;return processParseErrors()?processSyncValidators()?(processAsyncValidators(),void 0):(validationDone(!1),void 0):(validationDone(!1),void 0)},this.$commitViewValue=function(){var viewValue=ctrl.$viewValue;$timeout.cancel(pendingDebounce),(ctrl.$$lastCommittedViewValue!==viewValue||""===viewValue&&ctrl.$$hasNativeValidators)&&(ctrl.$$lastCommittedViewValue=viewValue,ctrl.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function writeToModelIfNeeded(){ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope()}var viewValue=ctrl.$$lastCommittedViewValue,modelValue=viewValue;if(parserValid=isUndefined(modelValue)?undefined:!0)for(var i=0;i<ctrl.$parsers.length;i++)if(modelValue=ctrl.$parsers[i](modelValue),isUndefined(modelValue)){parserValid=!1;break}isNumber(ctrl.$modelValue)&&isNaN(ctrl.$modelValue)&&(ctrl.$modelValue=ngModelGet($scope));var prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$rawModelValue=modelValue,allowInvalid&&(ctrl.$modelValue=modelValue,writeToModelIfNeeded()),ctrl.$$runValidators(modelValue,ctrl.$$lastCommittedViewValue,function(allValid){allowInvalid||(ctrl.$modelValue=allValid?modelValue:undefined,writeToModelIfNeeded())})},this.$$writeModelToScope=function(){ngModelSet($scope,ctrl.$modelValue),forEach(ctrl.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}})},this.$setViewValue=function(value,trigger){ctrl.$viewValue=value,(!ctrl.$options||ctrl.$options.updateOnDefault)&&ctrl.$$debounceViewValueCommit(trigger)},this.$$debounceViewValueCommit=function(trigger){var debounce,debounceDelay=0,options=ctrl.$options;options&&isDefined(options.debounce)&&(debounce=options.debounce,isNumber(debounce)?debounceDelay=debounce:isNumber(debounce[trigger])?debounceDelay=debounce[trigger]:isNumber(debounce["default"])&&(debounceDelay=debounce["default"])),$timeout.cancel(pendingDebounce),debounceDelay?pendingDebounce=$timeout(function(){ctrl.$commitViewValue()},debounceDelay):$rootScope.$$phase?ctrl.$commitViewValue():$scope.$apply(function(){ctrl.$commitViewValue()})},$scope.$watch(function(){var modelValue=ngModelGet($scope);if(modelValue!==ctrl.$modelValue&&(ctrl.$modelValue===ctrl.$modelValue||modelValue===modelValue)){ctrl.$modelValue=ctrl.$$rawModelValue=modelValue,parserValid=undefined;for(var formatters=ctrl.$formatters,idx=formatters.length,viewValue=modelValue;idx--;)viewValue=formatters[idx](viewValue);ctrl.$viewValue!==viewValue&&(ctrl.$viewValue=ctrl.$$lastCommittedViewValue=viewValue,ctrl.$render(),ctrl.$$runValidators(modelValue,viewValue,noop))}return modelValue})}],ngModelDirective=["$rootScope",function($rootScope){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:NgModelController,priority:1,compile:function(element){return element.addClass(PRISTINE_CLASS).addClass(UNTOUCHED_CLASS).addClass(VALID_CLASS),{pre:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||modelCtrl.$$parentForm;modelCtrl.$$setOptions(ctrls[2]&&ctrls[2].$options),formCtrl.$addControl(modelCtrl),attr.$observe("name",function(newValue){modelCtrl.$name!==newValue&&modelCtrl.$$parentForm.$$renameControl(modelCtrl,newValue)}),scope.$on("$destroy",function(){modelCtrl.$$parentForm.$removeControl(modelCtrl)})},post:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];modelCtrl.$options&&modelCtrl.$options.updateOn&&element.on(modelCtrl.$options.updateOn,function(ev){modelCtrl.$$debounceViewValueCommit(ev&&ev.type)}),element.on("blur",function(){modelCtrl.$touched||($rootScope.$$phase?scope.$evalAsync(modelCtrl.$setTouched):scope.$apply(modelCtrl.$setTouched))})}}}}}],DEFAULT_REGEXP=/(\s+|^)default(\s+|$)/,ngModelOptionsDirective=function(){return{restrict:"A",controller:["$scope","$attrs",function($scope,$attrs){var that=this;
this.$options=copy($scope.$eval($attrs.ngModelOptions)),isDefined(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=trim(this.$options.updateOn.replace(DEFAULT_REGEXP,function(){return that.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngOptionsMinErr=minErr("ngOptions"),NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,ngOptionsDirective=["$compile","$parse",function($compile,$parse){function parseOptionsExpression(optionsExp,selectElement,scope){function Option(selectValue,viewValue,label,group,disabled){this.selectValue=selectValue,this.viewValue=viewValue,this.label=label,this.group=group,this.disabled=disabled}function getOptionValuesKeys(optionValues){var optionValuesKeys;if(!keyName&&isArrayLike(optionValues))optionValuesKeys=optionValues;else{optionValuesKeys=[];for(var itemKey in optionValues)optionValues.hasOwnProperty(itemKey)&&"$"!==itemKey.charAt(0)&&optionValuesKeys.push(itemKey)}return optionValuesKeys}var match=optionsExp.match(NG_OPTIONS_REGEXP);if(!match)throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var valueName=match[5]||match[7],keyName=match[6],selectAs=/ as /.test(match[0])&&match[1],trackBy=match[9],valueFn=$parse(match[2]?match[1]:valueName),selectAsFn=selectAs&&$parse(selectAs),viewValueFn=selectAsFn||valueFn,trackByFn=trackBy&&$parse(trackBy),getTrackByValueFn=trackBy?function(value,locals){return trackByFn(scope,locals)}:function(value){return hashKey(value)},getTrackByValue=function(value,key){return getTrackByValueFn(value,getLocals(value,key))},displayFn=$parse(match[2]||match[1]),groupByFn=$parse(match[3]||""),disableWhenFn=$parse(match[4]||""),valuesFn=$parse(match[8]),locals={},getLocals=keyName?function(value,key){return locals[keyName]=key,locals[valueName]=value,locals}:function(value){return locals[valueName]=value,locals};return{trackBy:trackBy,getTrackByValue:getTrackByValue,getWatchables:$parse(valuesFn,function(optionValues){var watchedArray=[];optionValues=optionValues||[];for(var optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;optionValuesLength>index;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],locals=(optionValues[key],getLocals(optionValues[key],key)),selectValue=getTrackByValueFn(optionValues[key],locals);if(watchedArray.push(selectValue),match[2]||match[1]){var label=displayFn(scope,locals);watchedArray.push(label)}if(match[4]){var disableWhen=disableWhenFn(scope,locals);watchedArray.push(disableWhen)}}return watchedArray}),getOptions:function(){for(var optionItems=[],selectValueMap={},optionValues=valuesFn(scope)||[],optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;optionValuesLength>index;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),viewValue=viewValueFn(scope,locals),selectValue=getTrackByValueFn(viewValue,locals),label=displayFn(scope,locals),group=groupByFn(scope,locals),disabled=disableWhenFn(scope,locals),optionItem=new Option(selectValue,viewValue,label,group,disabled);optionItems.push(optionItem),selectValueMap[selectValue]=optionItem}return{items:optionItems,selectValueMap:selectValueMap,getOptionFromViewValue:function(value){return selectValueMap[getTrackByValue(value)]},getViewValueFromOption:function(option){return trackBy?angular.copy(option.viewValue):option.viewValue}}}}}var optionTemplate=document.createElement("option"),optGroupTemplate=document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","?ngModel"],link:function(scope,selectElement,attr,ctrls){function updateOptionElement(option,element){option.element=element,element.disabled=option.disabled,option.label!==element.label&&(element.label=option.label,element.textContent=option.label),option.value!==element.value&&(element.value=option.selectValue)}function addOrReuseElement(parent,current,type,templateElement){var element;return current&&lowercase(current.nodeName)===type?element=current:(element=templateElement.cloneNode(!1),current?parent.insertBefore(element,current):parent.appendChild(element)),element}function removeExcessElements(current){for(var next;current;)next=current.nextSibling,jqLiteRemove(current),current=next}function skipEmptyAndUnknownOptions(current){var emptyOption_=emptyOption&&emptyOption[0],unknownOption_=unknownOption&&unknownOption[0];if(emptyOption_||unknownOption_)for(;current&&(current===emptyOption_||current===unknownOption_||emptyOption_&&emptyOption_.nodeType===NODE_TYPE_COMMENT);)current=current.nextSibling;return current}function updateOptions(){var previousValue=options&&selectCtrl.readValue();options=ngOptions.getOptions();var groupMap={},currentElement=selectElement[0].firstChild;if(providedEmptyOption&&selectElement.prepend(emptyOption),currentElement=skipEmptyAndUnknownOptions(currentElement),options.items.forEach(function(option){var group,groupElement,optionElement;option.group?(group=groupMap[option.group],group||(groupElement=addOrReuseElement(selectElement[0],currentElement,"optgroup",optGroupTemplate),currentElement=groupElement.nextSibling,groupElement.label=option.group,group=groupMap[option.group]={groupElement:groupElement,currentOptionElement:groupElement.firstChild}),optionElement=addOrReuseElement(group.groupElement,group.currentOptionElement,"option",optionTemplate),updateOptionElement(option,optionElement),group.currentOptionElement=optionElement.nextSibling):(optionElement=addOrReuseElement(selectElement[0],currentElement,"option",optionTemplate),updateOptionElement(option,optionElement),currentElement=optionElement.nextSibling)}),Object.keys(groupMap).forEach(function(key){removeExcessElements(groupMap[key].currentOptionElement)}),removeExcessElements(currentElement),ngModelCtrl.$render(),!ngModelCtrl.$isEmpty(previousValue)){var nextValue=selectCtrl.readValue();(ngOptions.trackBy?equals(previousValue,nextValue):previousValue===nextValue)||(ngModelCtrl.$setViewValue(nextValue),ngModelCtrl.$render())}}var ngModelCtrl=ctrls[1];if(ngModelCtrl){for(var emptyOption,selectCtrl=ctrls[0],multiple=attr.multiple,i=0,children=selectElement.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=children.eq(i);break}var providedEmptyOption=!!emptyOption,unknownOption=jqLite(optionTemplate.cloneNode(!1));unknownOption.val("?");var options,ngOptions=parseOptionsExpression(attr.ngOptions,selectElement,scope),renderEmptyOption=function(){providedEmptyOption||selectElement.prepend(emptyOption),selectElement.val(""),emptyOption.prop("selected",!0),emptyOption.attr("selected",!0)},removeEmptyOption=function(){providedEmptyOption||emptyOption.remove()},renderUnknownOption=function(){selectElement.prepend(unknownOption),selectElement.val("?"),unknownOption.prop("selected",!0),unknownOption.attr("selected",!0)},removeUnknownOption=function(){unknownOption.remove()};multiple?(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length},selectCtrl.writeValue=function(value){options.items.forEach(function(option){option.element.selected=!1}),value&&value.forEach(function(item){var option=options.getOptionFromViewValue(item);option&&!option.disabled&&(option.element.selected=!0)})},selectCtrl.readValue=function(){var selectedValues=selectElement.val()||[],selections=[];return forEach(selectedValues,function(value){var option=options.selectValueMap[value];option&&!option.disabled&&selections.push(options.getViewValueFromOption(option))}),selections},ngOptions.trackBy&&scope.$watchCollection(function(){return isArray(ngModelCtrl.$viewValue)?ngModelCtrl.$viewValue.map(function(value){return ngOptions.getTrackByValue(value)}):void 0},function(){ngModelCtrl.$render()})):(selectCtrl.writeValue=function(value){var option=options.getOptionFromViewValue(value);option&&!option.disabled?selectElement[0].value!==option.selectValue&&(removeUnknownOption(),removeEmptyOption(),selectElement[0].value=option.selectValue,option.element.selected=!0,option.element.setAttribute("selected","selected")):null===value||providedEmptyOption?(removeUnknownOption(),renderEmptyOption()):(removeEmptyOption(),renderUnknownOption())},selectCtrl.readValue=function(){var selectedOption=options.selectValueMap[selectElement.val()];return selectedOption&&!selectedOption.disabled?(removeEmptyOption(),removeUnknownOption(),options.getViewValueFromOption(selectedOption)):null},ngOptions.trackBy&&scope.$watch(function(){return ngOptions.getTrackByValue(ngModelCtrl.$viewValue)},function(){ngModelCtrl.$render()})),providedEmptyOption?(emptyOption.remove(),$compile(emptyOption)(scope),emptyOption.removeClass("ng-scope")):emptyOption=jqLite(optionTemplate.cloneNode(!1)),updateOptions(),scope.$watchCollection(ngOptions.getWatchables,updateOptions)}}}}],ngPluralizeDirective=["$locale","$interpolate","$log",function($locale,$interpolate,$log){var BRACE=/{}/g,IS_WHEN=/^when(Minus)?(.+)$/;return{link:function(scope,element,attr){function updateElementText(newText){element.text(newText||"")}var lastCount,numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),braceReplacement=startSymbol+numberExp+"-"+offset+endSymbol,watchRemover=angular.noop;forEach(attr,function(expression,attributeName){var tmpMatch=IS_WHEN.exec(attributeName);if(tmpMatch){var whenKey=(tmpMatch[1]?"-":"")+lowercase(tmpMatch[2]);whens[whenKey]=element.attr(attr.$attr[attributeName])}}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,braceReplacement))}),scope.$watch(numberExp,function(newVal){var count=parseFloat(newVal),countIsNaN=isNaN(count);if(countIsNaN||count in whens||(count=$locale.pluralCat(count-offset)),count!==lastCount&&!(countIsNaN&&isNumber(lastCount)&&isNaN(lastCount))){watchRemover();var whenExpFn=whensExpFns[count];isUndefined(whenExpFn)?(null!=newVal&&$log.debug("ngPluralize: no rule defined for '"+count+"' in "+whenExp),watchRemover=noop,updateElementText()):watchRemover=scope.$watch(whenExpFn,updateElementText),lastCount=count}})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat"),updateScope=function(scope,index,valueIdentifier,value,keyIdentifier,key,arrayLength){scope[valueIdentifier]=value,keyIdentifier&&(scope[keyIdentifier]=key),scope.$index=index,scope.$first=0===index,scope.$last=index===arrayLength-1,scope.$middle=!(scope.$first||scope.$last),scope.$odd=!(scope.$even=0===(1&index))},getBlockStart=function(block){return block.clone[0]},getBlockEnd=function(block){return block.clone[block.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function($element,$attr){var expression=$attr.ngRepeat,ngRepeatEndComment=document.createComment(" end ngRepeat: "+expression+" "),match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);var lhs=match[1],rhs=match[2],aliasAs=match[3],trackByExp=match[4];if(match=lhs.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);var valueIdentifier=match[3]||match[1],keyIdentifier=match[2];if(aliasAs&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(aliasAs)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(aliasAs)))throw ngRepeatMinErr("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",aliasAs);var trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,hashFnLocals={$id:hashKey};return trackByExp?trackByExpGetter=$parse(trackByExp):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),function($scope,$element,$attr,ctrl,$transclude){trackByExpGetter&&(trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)});var lastBlockMap=createMap();$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,collectionLength,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder,elementsToRemove,previousNode=$element[0],nextBlockMap=createMap();if(aliasAs&&($scope[aliasAs]=collection),isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(var itemKey in collection)hasOwnProperty.call(collection,itemKey)&&"$"!==itemKey.charAt(0)&&collectionKeys.push(itemKey)}for(collectionLength=collectionKeys.length,nextBlockOrder=new Array(collectionLength),index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),lastBlockMap[trackById])block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap[trackById])throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,value);nextBlockOrder[index]={id:trackById,scope:undefined,clone:undefined},nextBlockMap[trackById]=!0}for(var blockKey in lastBlockMap){if(block=lastBlockMap[blockKey],elementsToRemove=getBlockNodes(block.clone),$animate.leave(elementsToRemove),elementsToRemove[0].parentNode)for(index=0,length=elementsToRemove.length;length>index;index++)elementsToRemove[index][NG_REMOVED]=!0;block.scope.$destroy()}for(index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],block.scope){nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockNodes(block.clone),null,jqLite(previousNode)),previousNode=getBlockEnd(block),updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)}else $transclude(function(clone,scope){block.scope=scope;var endNode=ngRepeatEndComment.cloneNode(!1);clone[clone.length++]=endNode,$animate.enter(clone,null,jqLite(previousNode)),previousNode=endNode,block.clone=clone,nextBlockMap[block.id]=block,updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)});lastBlockMap=nextBlockMap})}}}}],NG_HIDE_CLASS="ng-hide",NG_HIDE_IN_PROGRESS_CLASS="ng-hide-animate",ngShowDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[value?"removeClass":"addClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngHideDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[value?"addClass":"removeClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate",function($animate){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousLeaveAnimations=[],selectedScopes=[],spliceFactory=function(array,index){return function(){array.splice(index,1)}};scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousLeaveAnimations.length;ii>i;++i)$animate.cancel(previousLeaveAnimations[i]);for(previousLeaveAnimations.length=0,i=0,ii=selectedScopes.length;ii>i;++i){var selected=getBlockNodes(selectedElements[i].clone);selectedScopes[i].$destroy();var promise=previousLeaveAnimations[i]=$animate.leave(selected);promise.then(spliceFactory(previousLeaveAnimations,i))}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&forEach(selectedTranscludes,function(selectedTransclude){selectedTransclude.transclude(function(caseElement,selectedScope){selectedScopes.push(selectedScope);var anchor=selectedTransclude.element;caseElement[caseElement.length++]=document.createComment(" end ngSwitchWhen: ");var block={clone:caseElement};selectedElements.push(block),$animate.enter(caseElement,anchor.parent(),anchor)})})})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeDirective=ngDirective({restrict:"EAC",link:function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$transclude(function(clone){$element.empty(),$element.append(clone)})}}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],noopNgModelController={$setViewValue:noop,$render:noop},SelectController=["$element","$scope","$attrs",function($element,$scope){var self=this,optionsMap=new HashMap;self.ngModelCtrl=noopNgModelController,self.unknownOption=jqLite(document.createElement("option")),self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";self.unknownOption.val(unknownVal),$element.prepend(self.unknownOption),$element.val(unknownVal)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop}),self.removeUnknownOption=function(){self.unknownOption.parent()&&self.unknownOption.remove()},self.readValue=function(){return self.removeUnknownOption(),$element.val()},self.writeValue=function(value){self.hasOption(value)?(self.removeUnknownOption(),$element.val(value),""===value&&self.emptyOption.prop("selected",!0)):null==value&&self.emptyOption?(self.removeUnknownOption(),$element.val("")):self.renderUnknownOption(value)},self.addOption=function(value,element){assertNotHasOwnProperty(value,'"option value"'),""===value&&(self.emptyOption=element);var count=optionsMap.get(value)||0;optionsMap.put(value,count+1)},self.removeOption=function(value){var count=optionsMap.get(value);count&&(1===count?(optionsMap.remove(value),""===value&&(self.emptyOption=undefined)):optionsMap.put(value,count-1))},self.hasOption=function(value){return!!optionsMap.get(value)}}],selectDirective=function(){return{restrict:"E",require:["select","?ngModel"],controller:SelectController,link:function(scope,element,attr,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];if(selectCtrl.ngModelCtrl=ngModelCtrl,ngModelCtrl.$render=function(){selectCtrl.writeValue(ngModelCtrl.$viewValue)},element.on("change",function(){scope.$apply(function(){ngModelCtrl.$setViewValue(selectCtrl.readValue())})}),attr.multiple){selectCtrl.readValue=function(){var array=[];return forEach(element.find("option"),function(option){option.selected&&array.push(option.value)}),array},selectCtrl.writeValue=function(value){var items=new HashMap(value);forEach(element.find("option"),function(option){option.selected=isDefined(items.get(option.value))})};var lastView,lastViewRef=0/0;scope.$watch(function(){lastViewRef!==ngModelCtrl.$viewValue||equals(lastView,ngModelCtrl.$viewValue)||(lastView=shallowCopy(ngModelCtrl.$viewValue),ngModelCtrl.$render()),lastViewRef=ngModelCtrl.$viewValue}),ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}}}}}},optionDirective=["$interpolate",function($interpolate){function chromeHack(optionElement){optionElement[0].hasAttribute("selected")&&(optionElement[0].selected=!0)}return{restrict:"E",priority:100,compile:function(element,attr){if(isDefined(attr.value))var valueInterpolated=$interpolate(attr.value,!0);else{var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){function addOption(optionValue){selectCtrl.addOption(optionValue,element),selectCtrl.ngModelCtrl.$render(),chromeHack(element)}var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);if(selectCtrl&&selectCtrl.ngModelCtrl){if(valueInterpolated){var oldVal;attr.$observe("value",function(newVal){isDefined(oldVal)&&selectCtrl.removeOption(oldVal),oldVal=newVal,addOption(newVal)})}else interpolateFn?scope.$watch(interpolateFn,function(newVal,oldVal){attr.$set("value",newVal),oldVal!==newVal&&selectCtrl.removeOption(oldVal),addOption(newVal)}):addOption(attr.value);element.on("$destroy",function(){selectCtrl.removeOption(attr.value),selectCtrl.ngModelCtrl.$render()})}}}}}],styleDirective=valueFn({restrict:"E",terminal:!1}),requiredDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(attr.required=!0,ctrl.$validators.required=function(modelValue,viewValue){return!attr.required||!ctrl.$isEmpty(viewValue)},attr.$observe("required",function(){ctrl.$validate()}))}}},patternDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var regexp,patternExp=attr.ngPattern||attr.pattern;attr.$observe("pattern",function(regex){if(isString(regex)&&regex.length>0&&(regex=new RegExp("^"+regex+"$")),regex&&!regex.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",patternExp,regex,startingTag(elm));regexp=regex||undefined,ctrl.$validate()}),ctrl.$validators.pattern=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(regexp)||regexp.test(viewValue)}}}}},maxlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var maxlength=-1;attr.$observe("maxlength",function(value){var intVal=toInt(value);maxlength=isNaN(intVal)?-1:intVal,ctrl.$validate()}),ctrl.$validators.maxlength=function(modelValue,viewValue){return 0>maxlength||ctrl.$isEmpty(viewValue)||viewValue.length<=maxlength}}}}},minlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var minlength=0;attr.$observe("minlength",function(value){minlength=toInt(value)||0,ctrl.$validate()}),ctrl.$validators.minlength=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||viewValue.length>=minlength}}}}};return window.angular.bootstrap?(console.log("WARNING: Tried to load angular more than once."),void 0):(bindJQuery(),publishExternalAPI(angular),angular.module("ngLocale",[],["$provide",function($provide){function getDecimals(n){n+="";var i=n.indexOf(".");return-1==i?0:n.length-i-1}function getVF(n,opt_precision){var v=opt_precision;undefined===v&&(v=Math.min(getDecimals(n),3));var base=Math.pow(10,v),f=(n*base|0)%base;return{v:v,f:f}}var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""}]},id:"en-us",pluralCat:function(n,opt_precision){var i=0|n,vf=getVF(n,opt_precision);return 1==i&&0==vf.v?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}})}]),jqLite(document).ready(function(){angularInit(document,bootstrap)}),void 0)}(window,document),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),function(window,angular){"use strict";function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str,lowercaseKeys){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[lowercaseKeys?angular.lowercase(items[i]):items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}"string"!=typeof html&&(html=null===html||"undefined"==typeof html?"":""+html);var index,chars,match,text,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(text="",chars=!0,stack.last()&&specialElements[stack.last()]?(html=html.replace(new RegExp("([\\W\\w]*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last())):(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match?(match[4]&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag)),chars=!1):(text+="<",html=html.substring(1))),chars&&(index=html.indexOf("<"),text+=0>index?html:html.substring(0,index),html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text)))),html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){return value?(hiddenPre.innerHTML=value.replace(/</g,"&lt;"),hiddenPre.textContent):""}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,END_TAG_REGEXP=/^<\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=makeMap("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan,use"),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements,svgElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap,xlink:href"),htmlAttrs=makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),svgAttrs=makeMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),validAttrs=angular.extend({},uriAttrs,svgAttrs,htmlAttrs),hiddenPre=document.createElement("pre");
angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,MAILTO_REGEXP=/^mailto:/i;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),function(window,angular,undefined){"use strict";function $$CookieWriter($document,$log,$browser){function buildCookieString(name,value,options){var path,expires;options=options||{},expires=options.expires,path=angular.isDefined(options.path)?options.path:cookiePath,angular.isUndefined(value)&&(expires="Thu, 01 Jan 1970 00:00:00 GMT",value=""),angular.isString(expires)&&(expires=new Date(expires));var str=encodeURIComponent(name)+"="+encodeURIComponent(value);str+=path?";path="+path:"",str+=options.domain?";domain="+options.domain:"",str+=expires?";expires="+expires.toUTCString():"",str+=options.secure?";secure":"";var cookieLength=str.length+1;return cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"),str}var cookiePath=$browser.baseHref(),rawDocument=$document[0];return function(name,value,options){rawDocument.cookie=buildCookieString(name,value,options)}}angular.module("ngCookies",["ng"]).provider("$cookies",[function(){function calcOptions(options){return options?angular.extend({},defaults,options):defaults}var defaults=this.defaults={};this.$get=["$$cookieReader","$$cookieWriter",function($$cookieReader,$$cookieWriter){return{get:function(key){return $$cookieReader()[key]},getObject:function(key){var value=this.get(key);return value?angular.fromJson(value):value},getAll:function(){return $$cookieReader()},put:function(key,value,options){$$cookieWriter(key,value,calcOptions(options))},putObject:function(key,value,options){this.put(key,angular.toJson(value),options)},remove:function(key,options){$$cookieWriter(key,undefined,calcOptions(options))}}}]}]),angular.module("ngCookies").factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){return $cookies.getObject(key)},put:function(key,value){$cookies.putObject(key,value)},remove:function(key){$cookies.remove(key)}}}]),$$CookieWriter.$inject=["$document","$log","$browser"],angular.module("ngCookies").provider("$$cookieWriter",function(){this.$get=$$CookieWriter})}(window,window.angular),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(window,angular,undefined){"use strict";function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function merge(dst){return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst.hasOwnProperty(key)||(dst[key]=value)})}),dst}function ancestors(first,second){var path=[];for(var n in first.path){if(first.path[n]!==second.path[n])break;path.push(first.path[n])}return path}function arraySearch(array,value){if(Array.prototype.indexOf)return array.indexOf(value,Number(arguments[2])||0);var len=array.length>>>0,from=Number(arguments[2])||0;for(from=0>from?Math.ceil(from):Math.floor(from),0>from&&(from+=len);len>from;from++)if(from in array&&array[from]===value)return from;return-1}function inheritParams(currentParams,newParams,$current,$to){var parentParams,parents=ancestors($current,$to),inherited={},inheritList=[];for(var i in parents)if(parents[i].params&&parents[i].params.length){parentParams=parents[i].params;for(var j in parentParams)arraySearch(inheritList,parentParams[j])>=0||(inheritList.push(parentParams[j]),inherited[parentParams[j]]=currentParams[parentParams[j]])}return extend({},inherited,newParams)}function normalize(keys,values){var normalized={};return forEach(keys,function(name){var value=values[name];normalized[name]=null!=value?String(value):null}),normalized}function equalForKeys(a,b,keys){if(!keys){keys=[];for(var n in a)keys.push(n)}for(var i=0;i<keys.length;i++){var k=keys[i];if(a[k]!=b[k])return!1}return!0}function filterByKeys(keys,values){var filtered={};return forEach(keys,function(name){filtered[name]=values[name]}),filtered}function $Resolve($q,$injector){var VISIT_IN_PROGRESS=1,VISIT_DONE=2,NOTHING={},NO_DEPENDENCIES=[],NO_LOCALS=NOTHING,NO_PARENT=extend($q.when(NOTHING),{$$promises:NOTHING,$$values:NOTHING});this.study=function(invocables){function visit(value,key){if(visited[key]!==VISIT_DONE){if(cycle.push(key),visited[key]===VISIT_IN_PROGRESS)throw cycle.splice(0,cycle.indexOf(key)),new Error("Cyclic dependency: "+cycle.join(" -> "));if(visited[key]=VISIT_IN_PROGRESS,isString(value))plan.push(key,[function(){return $injector.get(value)}],NO_DEPENDENCIES);else{var params=$injector.annotate(value);forEach(params,function(param){param!==key&&invocables.hasOwnProperty(param)&&visit(invocables[param],param)}),plan.push(key,value,params)}cycle.pop(),visited[key]=VISIT_DONE}}function isResolve(value){return isObject(value)&&value.then&&value.$$promises}if(!isObject(invocables))throw new Error("'invocables' must be an object");var plan=[],cycle=[],visited={};return forEach(invocables,visit),invocables=cycle=visited=null,function(locals,parent,self){function done(){--wait||(merged||merge(values,parent.$$values),result.$$values=values,result.$$promises=!0,resolution.resolve(values))}function fail(reason){result.$$failure=reason,resolution.reject(reason)}function invoke(key,invocable,params){function onfailure(reason){invocation.reject(reason),fail(reason)}function proceed(){if(!isDefined(result.$$failure))try{invocation.resolve($injector.invoke(invocable,self,values)),invocation.promise.then(function(result){values[key]=result,done()},onfailure)}catch(e){onfailure(e)}}var invocation=$q.defer(),waitParams=0;forEach(params,function(dep){promises.hasOwnProperty(dep)&&!locals.hasOwnProperty(dep)&&(waitParams++,promises[dep].then(function(result){values[dep]=result,--waitParams||proceed()},onfailure))}),waitParams||proceed(),promises[key]=invocation.promise}if(isResolve(locals)&&self===undefined&&(self=parent,parent=locals,locals=null),locals){if(!isObject(locals))throw new Error("'locals' must be an object")}else locals=NO_LOCALS;if(parent){if(!isResolve(parent))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else parent=NO_PARENT;var resolution=$q.defer(),result=resolution.promise,promises=result.$$promises={},values=extend({},locals),wait=1+plan.length/3,merged=!1;if(isDefined(parent.$$failure))return fail(parent.$$failure),result;parent.$$values?(merged=merge(values,parent.$$values),done()):(extend(promises,parent.$$promises),parent.then(done,fail));for(var i=0,ii=plan.length;ii>i;i+=3)locals.hasOwnProperty(plan[i])?done():invoke(plan[i],plan[i+1],plan[i+2]);return result}},this.resolve=function(invocables,locals,parent,self){return this.study(invocables)(locals,parent,self)}}function $TemplateFactory($http,$templateCache,$injector){this.fromConfig=function(config,params,locals){return isDefined(config.template)?this.fromString(config.template,params):isDefined(config.templateUrl)?this.fromUrl(config.templateUrl,params):isDefined(config.templateProvider)?this.fromProvider(config.templateProvider,params,locals):null},this.fromString=function(template,params){return isFunction(template)?template(params):template},this.fromUrl=function(url,params){return isFunction(url)&&(url=url(params)),null==url?null:$http.get(url,{cache:$templateCache}).then(function(response){return response.data})},this.fromProvider=function(provider,params,locals){return $injector.invoke(provider,null,locals||{params:params})}}function UrlMatcher(pattern){function addParameter(id){if(!/^\w+(-+\w+)*$/.test(id))throw new Error("Invalid parameter name '"+id+"' in pattern '"+pattern+"'");if(names[id])throw new Error("Duplicate parameter name '"+id+"' in pattern '"+pattern+"'");names[id]=!0,params.push(id)}function quoteRegExp(string){return string.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&")}var m,placeholder=/([:*])(\w+)|\{(\w+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,names={},compiled="^",last=0,segments=this.segments=[],params=this.params=[];this.source=pattern;for(var id,regexp,segment;(m=placeholder.exec(pattern))&&(id=m[2]||m[3],regexp=m[4]||("*"==m[1]?".*":"[^/]*"),segment=pattern.substring(last,m.index),!(segment.indexOf("?")>=0));)compiled+=quoteRegExp(segment)+"("+regexp+")",addParameter(id),segments.push(segment),last=placeholder.lastIndex;segment=pattern.substring(last);var i=segment.indexOf("?");if(i>=0){var search=this.sourceSearch=segment.substring(i);segment=segment.substring(0,i),this.sourcePath=pattern.substring(0,last+i),forEach(search.substring(1).split(/[&?]/),addParameter)}else this.sourcePath=pattern,this.sourceSearch="";compiled+=quoteRegExp(segment)+"$",segments.push(segment),this.regexp=new RegExp(compiled),this.prefix=segments[0]}function $UrlMatcherFactory(){this.compile=function(pattern){return new UrlMatcher(pattern)},this.isMatcher=function(o){return isObject(o)&&isFunction(o.exec)&&isFunction(o.format)&&isFunction(o.concat)},this.$get=function(){return this}}function $UrlRouterProvider($urlMatcherFactory){function regExpPrefix(re){var prefix=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);return null!=prefix?prefix[1].replace(/\\(.)/g,"$1"):""}function interpolate(pattern,match){return pattern.replace(/\$(\$|\d{1,2})/,function(m,what){return match["$"===what?0:Number(what)]})}function handleIfMatch($injector,handler,match){if(!match)return!1;var result=$injector.invoke(handler,handler,{$match:match});return isDefined(result)?result:!0}var rules=[],otherwise=null;this.rule=function(rule){if(!isFunction(rule))throw new Error("'rule' must be a function");return rules.push(rule),this},this.otherwise=function(rule){if(isString(rule)){var redirect=rule;rule=function(){return redirect}}else if(!isFunction(rule))throw new Error("'rule' must be a function");return otherwise=rule,this},this.when=function(what,handler){var redirect,handlerIsString=isString(handler);if(isString(what)&&(what=$urlMatcherFactory.compile(what)),!handlerIsString&&!isFunction(handler)&&!isArray(handler))throw new Error("invalid 'handler' in when()");var strategies={matcher:function(what,handler){return handlerIsString&&(redirect=$urlMatcherFactory.compile(handler),handler=["$match",function($match){return redirect.format($match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path(),$location.search()))},{prefix:isString(what.prefix)?what.prefix:""})},regex:function(what,handler){if(what.global||what.sticky)throw new Error("when() RegExp must not be global or sticky");return handlerIsString&&(redirect=handler,handler=["$match",function($match){return interpolate(redirect,$match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path()))},{prefix:regExpPrefix(what)})}},check={matcher:$urlMatcherFactory.isMatcher(what),regex:what instanceof RegExp};for(var n in check)if(check[n])return this.rule(strategies[n](what,handler));throw new Error("invalid 'what' in when()")},this.$get=["$location","$rootScope","$injector",function($location,$rootScope,$injector){function update(evt){function check(rule){var handled=rule($injector,$location);return handled?(isString(handled)&&$location.replace().url(handled),!0):!1}if(!evt||!evt.defaultPrevented){var i,n=rules.length;for(i=0;n>i;i++)if(check(rules[i]))return;otherwise&&check(otherwise)}}return $rootScope.$on("$locationChangeSuccess",update),{sync:function(){update()}}}]}function $StateProvider($urlRouterProvider,$urlMatcherFactory,$locationProvider){function isRelative(stateName){return 0===stateName.indexOf(".")||0===stateName.indexOf("^")}function findState(stateOrName,base){var isStr=isString(stateOrName),name=isStr?stateOrName:stateOrName.name,path=isRelative(name);if(path){if(!base)throw new Error("No reference point given for path '"+name+"'");for(var rel=name.split("."),i=0,pathLength=rel.length,current=base;pathLength>i;i++)if(""!==rel[i]||0!==i){if("^"!==rel[i])break;if(!current.parent)throw new Error("Path '"+name+"' not valid for state '"+base.name+"'");current=current.parent}else current=base;rel=rel.slice(i).join("."),name=current.name+(current.name&&rel?".":"")+rel}var state=states[name];return!state||!isStr&&(isStr||state!==stateOrName&&state.self!==stateOrName)?undefined:state}function queueState(parentName,state){queue[parentName]||(queue[parentName]=[]),queue[parentName].push(state)}function registerState(state){state=inherit(state,{self:state,resolve:state.resolve||{},toString:function(){return this.name}});var name=state.name;if(!isString(name)||name.indexOf("@")>=0)throw new Error("State must have a valid name");if(states.hasOwnProperty(name))throw new Error("State '"+name+"'' is already defined");var parentName=-1!==name.indexOf(".")?name.substring(0,name.lastIndexOf(".")):isString(state.parent)?state.parent:"";if(parentName&&!states[parentName])return queueState(parentName,state.self);for(var key in stateBuilder)isFunction(stateBuilder[key])&&(state[key]=stateBuilder[key](state,stateBuilder.$delegates[key]));if(states[name]=state,!state[abstractKey]&&state.url&&$urlRouterProvider.when(state.url,["$match","$stateParams",function($match,$stateParams){$state.$current.navigable==state&&equalForKeys($match,$stateParams)||$state.transitionTo(state,$match,{location:!1})}]),queue[name])for(var i=0;i<queue[name].length;i++)registerState(queue[name][i]);return state}function decorator(name,func){return isString(name)&&!isDefined(func)?stateBuilder[name]:isFunction(func)&&isString(name)?(stateBuilder[name]&&!stateBuilder.$delegates[name]&&(stateBuilder.$delegates[name]=stateBuilder[name]),stateBuilder[name]=func,this):this}function state(name,definition){return isObject(name)?definition=name:definition.name=name,registerState(definition),this}function $get($rootScope,$q,$view,$injector,$resolve,$stateParams,$location){function syncUrl(){$location.url()!==currentLocation&&($location.url(currentLocation),$location.replace())}function resolveState(state,params,paramsAreFiltered,inherited,dst){var $stateParams=paramsAreFiltered?params:filterByKeys(state.params,params),locals={$stateParams:$stateParams};dst.resolve=$resolve.resolve(state.resolve,locals,dst.resolve,state);var promises=[dst.resolve.then(function(globals){dst.globals=globals})];return inherited&&promises.push(inherited),forEach(state.views,function(view,name){var injectables=view.resolve&&view.resolve!==state.resolve?view.resolve:{};injectables.$template=[function(){return $view.load(name,{view:view,locals:locals,params:$stateParams,notify:!1})||""}],promises.push($resolve.resolve(injectables,locals,dst.resolve,state).then(function(result){if(isFunction(view.controllerProvider)||isArray(view.controllerProvider)){var injectLocals=angular.extend({},injectables,locals);result.$$controller=$injector.invoke(view.controllerProvider,null,injectLocals)}else result.$$controller=view.controller;result.$$state=state,dst[name]=result}))}),$q.all(promises).then(function(){return dst})}var TransitionSuperseded=$q.reject(new Error("transition superseded")),TransitionPrevented=$q.reject(new Error("transition prevented")),TransitionAborted=$q.reject(new Error("transition aborted")),TransitionFailed=$q.reject(new Error("transition failed")),currentLocation=$location.url();return root.locals={resolve:null,globals:{$stateParams:{}}},$state={params:{},current:root.self,$current:root,transition:null},$state.reload=function(){$state.transitionTo($state.current,$stateParams,{reload:!0,inherit:!1,notify:!1})},$state.go=function(to,params,options){return this.transitionTo(to,params,extend({inherit:!0,relative:$state.$current},options))},$state.transitionTo=function(to,toParams,options){toParams=toParams||{},options=extend({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},options||{});var evt,from=$state.$current,fromParams=$state.params,fromPath=from.path,toState=findState(to,options.relative);if(!isDefined(toState)){var redirect={to:to,toParams:toParams,options:options};if(evt=$rootScope.$broadcast("$stateNotFound",redirect,from.self,fromParams),evt.defaultPrevented)return syncUrl(),TransitionAborted;if(evt.retry){if(options.$retry)return syncUrl(),TransitionFailed;var retryTransition=$state.transition=$q.when(evt.retry);return retryTransition.then(function(){return retryTransition!==$state.transition?TransitionSuperseded:(redirect.options.$retry=!0,$state.transitionTo(redirect.to,redirect.toParams,redirect.options))},function(){return TransitionAborted}),syncUrl(),retryTransition}if(to=redirect.to,toParams=redirect.toParams,options=redirect.options,toState=findState(to,options.relative),!isDefined(toState)){if(options.relative)throw new Error("Could not resolve '"+to+"' from state '"+options.relative+"'");throw new Error("No such state '"+to+"'")}}if(toState[abstractKey])throw new Error("Cannot transition to abstract state '"+to+"'");options.inherit&&(toParams=inheritParams($stateParams,toParams||{},$state.$current,toState)),to=toState;var keep,state,toPath=to.path,locals=root.locals,toLocals=[];for(keep=0,state=toPath[keep];state&&state===fromPath[keep]&&equalForKeys(toParams,fromParams,state.ownParams)&&!options.reload;keep++,state=toPath[keep])locals=toLocals[keep]=state.locals;if(shouldTriggerReload(to,from,locals,options))return to.self.reloadOnSearch!==!1&&syncUrl(),$state.transition=null,$q.when($state.current);if(toParams=normalize(to.params,toParams||{}),options.notify&&(evt=$rootScope.$broadcast("$stateChangeStart",to.self,toParams,from.self,fromParams),evt.defaultPrevented))return syncUrl(),TransitionPrevented;for(var resolved=$q.when(locals),l=keep;l<toPath.length;l++,state=toPath[l])locals=toLocals[l]=inherit(locals),resolved=resolveState(state,toParams,state===to,resolved,locals);var transition=$state.transition=resolved.then(function(){var l,entering,exiting;if($state.transition!==transition)return TransitionSuperseded;for(l=fromPath.length-1;l>=keep;l--)exiting=fromPath[l],exiting.self.onExit&&$injector.invoke(exiting.self.onExit,exiting.self,exiting.locals.globals),exiting.locals=null;for(l=keep;l<toPath.length;l++)entering=toPath[l],entering.locals=toLocals[l],entering.self.onEnter&&$injector.invoke(entering.self.onEnter,entering.self,entering.locals.globals);if($state.transition!==transition)return TransitionSuperseded;$state.$current=to,$state.current=to.self,$state.params=toParams,copy($state.params,$stateParams),$state.transition=null;var toNav=to.navigable;return options.location&&toNav&&($location.url(toNav.url.format(toNav.locals.globals.$stateParams)),"replace"===options.location&&$location.replace()),options.notify&&$rootScope.$broadcast("$stateChangeSuccess",to.self,toParams,from.self,fromParams),currentLocation=$location.url(),$state.current},function(error){return $state.transition!==transition?TransitionSuperseded:($state.transition=null,$rootScope.$broadcast("$stateChangeError",to.self,toParams,from.self,fromParams,error),syncUrl(),$q.reject(error))});return transition},$state.is=function(stateOrName,params){var state=findState(stateOrName);return isDefined(state)?$state.$current!==state?!1:isDefined(params)&&null!==params?angular.equals($stateParams,params):!0:undefined},$state.includes=function(stateOrName,params){var state=findState(stateOrName);if(!isDefined(state))return undefined;if(!isDefined($state.$current.includes[state.name]))return!1;var validParams=!0;return angular.forEach(params,function(value,key){isDefined($stateParams[key])&&$stateParams[key]===value||(validParams=!1)}),validParams},$state.href=function(stateOrName,params,options){options=extend({lossy:!0,inherit:!1,absolute:!1,relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state))return null;params=inheritParams($stateParams,params||{},$state.$current,state);var nav=state&&options.lossy?state.navigable:state,url=nav&&nav.url?nav.url.format(normalize(state.params,params||{})):null;return!$locationProvider.html5Mode()&&url&&(url="#"+$locationProvider.hashPrefix()+url),options.absolute&&url&&(url=$location.protocol()+"://"+$location.host()+(80==$location.port()||443==$location.port()?"":":"+$location.port())+(!$locationProvider.html5Mode()&&url?"/":"")+url),url},$state.get=function(stateOrName,context){if(!isDefined(stateOrName)){var list=[];return forEach(states,function(state){list.push(state.self)}),list}var state=findState(stateOrName,context);return state&&state.self?state.self:null},$state}function shouldTriggerReload(to,from,locals,options){return to!==from||(locals!==from.locals||options.reload)&&to.self.reloadOnSearch!==!1?void 0:!0}var root,$state,states={},queue={},abstractKey="abstract",stateBuilder={parent:function(state){if(isDefined(state.parent)&&state.parent)return findState(state.parent);var compositeName=/^(.+)\.[^.]+$/.exec(state.name);return compositeName?findState(compositeName[1]):root},data:function(state){return state.parent&&state.parent.data&&(state.data=state.self.data=extend({},state.parent.data,state.data)),state.data},url:function(state){var url=state.url;if(isString(url))return"^"==url.charAt(0)?$urlMatcherFactory.compile(url.substring(1)):(state.parent.navigable||root).url.concat(url);if($urlMatcherFactory.isMatcher(url)||null==url)return url;throw new Error("Invalid url '"+url+"' in state '"+state+"'")},navigable:function(state){return state.url?state:state.parent?state.parent.navigable:null},params:function(state){if(!state.params)return state.url?state.url.parameters():state.parent.params;if(!isArray(state.params))throw new Error("Invalid params in state '"+state+"'");if(state.url)throw new Error("Both params and url specicified in state '"+state+"'");return state.params},views:function(state){var views={};return forEach(isDefined(state.views)?state.views:{"":state},function(view,name){name.indexOf("@")<0&&(name+="@"+state.parent.name),views[name]=view}),views},ownParams:function(state){if(!state.parent)return state.params;var paramNames={};forEach(state.params,function(p){paramNames[p]=!0}),forEach(state.parent.params,function(p){if(!paramNames[p])throw new Error("Missing required parameter '"+p+"' in state '"+state.name+"'");paramNames[p]=!1});var ownParams=[];return forEach(paramNames,function(own,p){own&&ownParams.push(p)}),ownParams},path:function(state){return state.parent?state.parent.path.concat(state):[]},includes:function(state){var includes=state.parent?extend({},state.parent.includes):{};return includes[state.name]=!0,includes},$delegates:{}};root=registerState({name:"",url:"^",views:null,"abstract":!0}),root.navigable=null,this.decorator=decorator,this.state=state,this.$get=$get,$get.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$location","$urlRouter"]}function $ViewProvider(){function $get($rootScope,$templateFactory){return{load:function(name,options){var result,defaults={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return options=extend(defaults,options),options.view&&(result=$templateFactory.fromConfig(options.view,options.params,options.locals)),result&&options.notify&&$rootScope.$broadcast("$viewContentLoading",options),result}}}this.$get=$get,$get.$inject=["$rootScope","$templateFactory"]}function $ViewScrollProvider(){var useAnchorScroll=!1;this.useAnchorScroll=function(){useAnchorScroll=!0},this.$get=["$anchorScroll","$timeout",function($anchorScroll,$timeout){return useAnchorScroll?$anchorScroll:function($element){$timeout(function(){$element[0].scrollIntoView()},0,!1)}}]}function $ViewDirective($state,$compile,$controller,$injector,$uiViewScroll,$document){function getService(){return $injector.has?function(service){return $injector.has(service)?$injector.get(service):null}:function(service){try{return $injector.get(service)}catch(e){return null}}}function getRenderer(element,attrs,scope){var statics=function(){return{leave:function(element){element.remove()},enter:function(element,parent,anchor){anchor.after(element)}}};if($animate)return function(shouldAnimate){return shouldAnimate?{enter:function(element,parent,anchor){$animate.enter(element,null,anchor)},leave:function(element){$animate.leave(element,function(){element.remove()})}}:statics()};if($animator){var animate=$animator&&$animator(scope,attrs);return function(shouldAnimate){return shouldAnimate?{enter:function(element,parent){animate.enter(element,parent)},leave:function(element){animate.leave(element.contents(),element)}}:statics()}}return statics}var viewIsUpdating=!1,service=getService(),$animator=service("$animator"),$animate=service("$animate"),directive={restrict:"ECA",compile:function(element,attrs){var initial=element.html(),isDefault=!0,anchor=angular.element($document[0].createComment(" ui-view-anchor ")),parentEl=element.parent();return element.prepend(anchor),function($scope){function cleanupLastView(){currentEl&&(renderer(!0).leave(currentEl),currentEl=null),currentScope&&(currentScope.$destroy(),currentScope=null)}function updateView(shouldAnimate){var locals=$state.$current&&$state.$current.locals[name];if(isDefault&&(isDefault=!1,element.replaceWith(anchor)),!locals)return cleanupLastView(),currentEl=element.clone(),currentEl.html(initial),renderer(shouldAnimate).enter(currentEl,parentEl,anchor),currentScope=$scope.$new(),$compile(currentEl.contents())(currentScope),void 0;if(locals!==viewLocals){cleanupLastView(),currentEl=element.clone(),currentEl.html(locals.$template?locals.$template:initial),renderer(!0).enter(currentEl,parentEl,anchor),currentEl.data("$uiView",view),viewLocals=locals,view.state=locals.$$state;var link=$compile(currentEl.contents());if(currentScope=$scope.$new(),locals.$$controller){locals.$scope=currentScope;var controller=$controller(locals.$$controller,locals);currentEl.children().data("$ngControllerController",controller)}link(currentScope),currentScope.$emit("$viewContentLoaded"),onloadExp&&currentScope.$eval(onloadExp),angular.isDefined(autoscrollExp)&&autoscrollExp&&!$scope.$eval(autoscrollExp)||$uiViewScroll(currentEl)}}var currentScope,currentEl,viewLocals,inherited=parentEl.inheritedData("$uiView"),name=attrs[directive.name]||attrs.name||"",onloadExp=attrs.onload||"",autoscrollExp=attrs.autoscroll,renderer=getRenderer(element,attrs,$scope);name.indexOf("@")<0&&(name=name+"@"+(inherited?inherited.state.name:""));var view={name:name,state:null},eventHook=function(){if(!viewIsUpdating){viewIsUpdating=!0;try{updateView(!0)}catch(e){throw viewIsUpdating=!1,e}viewIsUpdating=!1}};$scope.$on("$stateChangeSuccess",eventHook),$scope.$on("$viewContentLoading",eventHook),updateView(!1)}}};return directive}function parseStateRef(ref){var parsed=ref.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!parsed||4!==parsed.length)throw new Error("Invalid state ref '"+ref+"'");return{state:parsed[1],paramExpr:parsed[3]||null}}function stateContext(el){var stateData=el.parent().inheritedData("$uiView");return stateData&&stateData.state&&stateData.state.name?stateData.state:void 0}function $StateRefDirective($state,$timeout){return{restrict:"A",require:"?^uiSrefActive",link:function(scope,element,attrs,uiSrefActive){var ref=parseStateRef(attrs.uiSref),params=null,base=stateContext(element)||$state.$current,isForm="FORM"===element[0].nodeName,attr=isForm?"action":"href",nav=!0,update=function(newVal){if(newVal&&(params=newVal),nav){var newHref=$state.href(ref.state,params,{relative:base});return uiSrefActive&&uiSrefActive.$$setStateInfo(ref.state,params),newHref?(element[0][attr]=newHref,void 0):(nav=!1,!1)}};ref.paramExpr&&(scope.$watch(ref.paramExpr,function(newVal){newVal!==params&&update(newVal)},!0),params=scope.$eval(ref.paramExpr)),update(),isForm||element.bind("click",function(e){var button=e.which||e.button;0!==button&&1!=button||e.ctrlKey||e.metaKey||e.shiftKey||element.attr("target")||($timeout(function(){$state.go(ref.state,params,{relative:base})}),e.preventDefault())})}}}function $StateActiveDirective($state,$stateParams,$interpolate){return{restrict:"A",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){function update(){$state.$current.self===state&&matchesParams()?$element.addClass(activeClass):$element.removeClass(activeClass)}function matchesParams(){return!params||equalForKeys(params,$stateParams)}var state,params,activeClass;activeClass=$interpolate($attrs.uiSrefActive||"",!1)($scope),this.$$setStateInfo=function(newState,newParams){state=$state.get(newState,stateContext($element)),params=newParams,update()},$scope.$on("$stateChangeSuccess",update)}]}}function $IsStateFilter($state){return function(state){return $state.is(state)}}function $IncludedByStateFilter($state){return function(state){return $state.includes(state)}}function $RouteProvider($stateProvider,$urlRouterProvider){function onEnterRoute($$state){this.locals=$$state.locals.globals,this.params=this.locals.$stateParams}function onExitRoute(){this.locals=null,this.params=null}function when(url,route){if(null!=route.redirectTo){var handler,redirect=route.redirectTo;if(isString(redirect))handler=redirect;else{if(!isFunction(redirect))throw new Error("Invalid 'redirectTo' in when()");handler=function(params,$location){return redirect(params,$location.path(),$location.search())}}$urlRouterProvider.when(url,handler)}else $stateProvider.state(inherit(route,{parent:null,name:"route:"+encodeURIComponent(url),url:url,onEnter:onEnterRoute,onExit:onExitRoute}));return routes.push(route),this}function $get($state,$rootScope,$routeParams){function stateAsRoute(state){return""!==state.name?state:undefined}var $route={routes:routes,params:$routeParams,current:undefined};return $rootScope.$on("$stateChangeStart",function(ev,to,toParams,from){$rootScope.$broadcast("$routeChangeStart",stateAsRoute(to),stateAsRoute(from))}),$rootScope.$on("$stateChangeSuccess",function(ev,to,toParams,from){$route.current=stateAsRoute(to),$rootScope.$broadcast("$routeChangeSuccess",stateAsRoute(to),stateAsRoute(from)),copy(toParams,$route.params)}),$rootScope.$on("$stateChangeError",function(ev,to,toParams,from,fromParams,error){$rootScope.$broadcast("$routeChangeError",stateAsRoute(to),stateAsRoute(from),error)}),$route}var routes=[];onEnterRoute.$inject=["$$state"],this.when=when,this.$get=$get,$get.$inject=["$state","$rootScope","$routeParams"]}var isDefined=angular.isDefined,isFunction=angular.isFunction,isString=angular.isString,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy;angular.module("ui.router.util",["ng"]),angular.module("ui.router.router",["ui.router.util"]),angular.module("ui.router.state",["ui.router.router","ui.router.util"]),angular.module("ui.router",["ui.router.state"]),angular.module("ui.router.compat",["ui.router"]),$Resolve.$inject=["$q","$injector"],angular.module("ui.router.util").service("$resolve",$Resolve),$TemplateFactory.$inject=["$http","$templateCache","$injector"],angular.module("ui.router.util").service("$templateFactory",$TemplateFactory),UrlMatcher.prototype.concat=function(pattern){return new UrlMatcher(this.sourcePath+pattern+this.sourceSearch)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(path,searchParams){var m=this.regexp.exec(path);if(!m)return null;var i,params=this.params,nTotal=params.length,nPath=this.segments.length-1,values={};if(nPath!==m.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(i=0;nPath>i;i++)values[params[i]]=m[i+1];for(;nTotal>i;i++)values[params[i]]=searchParams[params[i]];return values},UrlMatcher.prototype.parameters=function(){return this.params},UrlMatcher.prototype.format=function(values){var segments=this.segments,params=this.params;if(!values)return segments.join("");var i,search,value,nPath=segments.length-1,nTotal=params.length,result=segments[0];for(i=0;nPath>i;i++)value=values[params[i]],null!=value&&(result+=encodeURIComponent(value)),result+=segments[i+1];for(;nTotal>i;i++)value=values[params[i]],null!=value&&(result+=(search?"&":"?")+params[i]+"="+encodeURIComponent(value),search=!0);
return result},angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),$UrlRouterProvider.$inject=["$urlMatcherFactoryProvider"],angular.module("ui.router.router").provider("$urlRouter",$UrlRouterProvider),$StateProvider.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider","$locationProvider"],angular.module("ui.router.state").value("$stateParams",{}).provider("$state",$StateProvider),$ViewProvider.$inject=[],angular.module("ui.router.state").provider("$view",$ViewProvider),angular.module("ui.router.state").provider("$uiViewScroll",$ViewScrollProvider),$ViewDirective.$inject=["$state","$compile","$controller","$injector","$uiViewScroll","$document"],angular.module("ui.router.state").directive("uiView",$ViewDirective),$StateRefDirective.$inject=["$state","$timeout"],$StateActiveDirective.$inject=["$state","$stateParams","$interpolate"],angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateActiveDirective),$IsStateFilter.$inject=["$state"],$IncludedByStateFilter.$inject=["$state"],angular.module("ui.router.state").filter("isState",$IsStateFilter).filter("includedByState",$IncludedByStateFilter),$RouteProvider.$inject=["$stateProvider","$urlRouterProvider"],angular.module("ui.router.compat").provider("$route",$RouteProvider).directive("ngView",$ViewDirective)}(window,window.angular),function(angular){"use strict";function $analytics(){function bufferedHandler(handlerName){return function(){angulartics.waitForVendorCount&&(cache[handlerName]||(cache[handlerName]=[]),cache[handlerName].push(arguments))}}function updateHandlers(handlerName,fn){return handlers[handlerName]||(handlers[handlerName]=[]),handlers[handlerName].push(fn),function(){var handlerArgs=arguments;angular.forEach(handlers[handlerName],function(handler){handler.apply(this,handlerArgs)},this)}}function onTimeout(fn,delay){delay?setTimeout(fn,delay):fn()}function register(handlerName,fn){api[handlerName]=updateHandlers(handlerName,fn);var handlerSettings=settings[handlerName],handlerDelay=handlerSettings?handlerSettings.bufferFlushDelay:null,delay=null!==handlerDelay?handlerDelay:settings.bufferFlushDelay;angular.forEach(cache[handlerName],function(args,index){onTimeout(function(){fn.apply(this,args)},index*delay)})}function capitalize(input){return input.replace(/^./,function(match){return match.toUpperCase()})}function installHandlerRegisterFunction(handlerName){var registerName="register"+capitalize(handlerName);provider[registerName]=function(fn){register(handlerName,fn)},api[handlerName]=updateHandlers(handlerName,bufferedHandler(handlerName))}var settings={pageTracking:{autoTrackFirstPage:!0,autoTrackVirtualPages:!0,trackRelativePath:!1,autoBasePath:!1,basePath:"",excludedRoutes:[]},eventTracking:{},bufferFlushDelay:1e3,developerMode:!1},knownHandlers=["pageTrack","eventTrack","exceptionTrack","setAlias","setUsername","setUserProperties","setUserPropertiesOnce","setSuperProperties","setSuperPropertiesOnce","userTimings"],cache={},handlers={},api={settings:settings},provider={$get:function(){return api},api:api,settings:settings,virtualPageviews:function(value){this.settings.pageTracking.autoTrackVirtualPages=value},excludeRoutes:function(routes){this.settings.pageTracking.excludedRoutes=routes},firstPageview:function(value){this.settings.pageTracking.autoTrackFirstPage=value},withBase:function(value){this.settings.pageTracking.basePath=value?angular.element(document).find("base").attr("href"):""},withAutoBase:function(value){this.settings.pageTracking.autoBasePath=value},developerMode:function(value){this.settings.developerMode=value}};return angular.forEach(knownHandlers,installHandlerRegisterFunction),provider}function $analyticsRun($rootScope,$window,$analytics,$injector){function matchesExcludedRoute(url){for(var i=0;i<$analytics.settings.pageTracking.excludedRoutes.length;i++){var excludedRoute=$analytics.settings.pageTracking.excludedRoutes[i];if(excludedRoute instanceof RegExp&&excludedRoute.test(url)||url.indexOf(excludedRoute)>-1)return!0}return!1}function pageTrack(url,$location){matchesExcludedRoute(url)||$analytics.pageTrack(url,$location)}$analytics.settings.pageTracking.autoTrackFirstPage&&$injector.invoke(["$location",function($location){var noRoutesOrStates=!0;if($injector.has("$route")){var $route=$injector.get("$route");for(var route in $route.routes){noRoutesOrStates=!1;break}}else if($injector.has("$state")){var $state=$injector.get("$state");for(var state in $state.get()){noRoutesOrStates=!1;break}}if(noRoutesOrStates)if($analytics.settings.pageTracking.autoBasePath&&($analytics.settings.pageTracking.basePath=$window.location.pathname),$analytics.settings.pageTracking.trackRelativePath){var url=$analytics.settings.pageTracking.basePath+$location.url();pageTrack(url,$location)}else pageTrack($location.absUrl(),$location)}]),$analytics.settings.pageTracking.autoTrackVirtualPages&&$injector.invoke(["$location",function($location){$analytics.settings.pageTracking.autoBasePath&&($analytics.settings.pageTracking.basePath=$window.location.pathname+"#");var noRoutesOrStates=!0;if($injector.has("$route")){var $route=$injector.get("$route");for(var route in $route.routes){noRoutesOrStates=!1;break}$rootScope.$on("$routeChangeSuccess",function(event,current){if(!current||!(current.$$route||current).redirectTo){var url=$analytics.settings.pageTracking.basePath+$location.url();pageTrack(url,$location)}})}$injector.has("$state")&&(noRoutesOrStates=!1,$rootScope.$on("$stateChangeSuccess",function(){var url=$analytics.settings.pageTracking.basePath+$location.url();pageTrack(url,$location)})),noRoutesOrStates&&$rootScope.$on("$locationChangeSuccess",function(event,current){if(!current||!(current.$$route||current).redirectTo)if($analytics.settings.pageTracking.trackRelativePath){var url=$analytics.settings.pageTracking.basePath+$location.url();pageTrack(url,$location)}else pageTrack($location.absUrl(),$location)})}]),$analytics.settings.developerMode&&angular.forEach($analytics,function(attr,name){"function"==typeof attr&&($analytics[name]=function(){})})}function analyticsOn($analytics){return{restrict:"A",link:function($scope,$element,$attrs){var eventType=$attrs.analyticsOn||"click",trackingData={};angular.forEach($attrs.$attr,function(attr,name){isProperty(name)&&(trackingData[propertyName(name)]=$attrs[name],$attrs.$observe(name,function(value){trackingData[propertyName(name)]=value}))}),angular.element($element[0]).bind(eventType,function($event){var eventName=$attrs.analyticsEvent||inferEventName($element[0]);trackingData.eventType=$event.type,(!$attrs.analyticsIf||$scope.$eval($attrs.analyticsIf))&&($attrs.analyticsProperties&&angular.extend(trackingData,$scope.$eval($attrs.analyticsProperties)),$analytics.eventTrack(eventName,trackingData))})}}}function isCommand(element){return["a:","button:","button:button","button:submit","input:button","input:submit"].indexOf(element.tagName.toLowerCase()+":"+(element.type||""))>=0}function inferEventName(element){return isCommand(element)?element.innerText||element.value:element.id||element.name||element.tagName}function isProperty(name){return"analytics"===name.substr(0,9)&&-1===["On","Event","If","Properties","EventType"].indexOf(name.substr(9))}function propertyName(name){var s=name.slice(9);return"undefined"!=typeof s&&null!==s&&s.length>0?s.substring(0,1).toLowerCase()+s.substring(1):s}var angulartics=window.angulartics||(window.angulartics={});angulartics.waitForVendorCount=0,angulartics.waitForVendorApi=function(objectName,delay,containsField,registerFn,onTimeout){onTimeout||angulartics.waitForVendorCount++,registerFn||(registerFn=containsField,containsField=void 0),!Object.prototype.hasOwnProperty.call(window,objectName)||void 0!==containsField&&void 0===window[objectName][containsField]?setTimeout(function(){angulartics.waitForVendorApi(objectName,delay,containsField,registerFn,!0)},delay):(angulartics.waitForVendorCount--,registerFn(window[objectName]))},angular.module("angulartics",[]).provider("$analytics",$analytics).run(["$rootScope","$window","$analytics","$injector",$analyticsRun]).directive("analyticsOn",["$analytics",analyticsOn])}(angular),function(window,angular){"use strict";angular.module("angulartics.segment",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path,properties){try{analytics.page(path,properties)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerEventTrack(function(event,properties,options,callback){try{analytics.track(event,properties,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerSetUserProperties(function(userId,traits,options,callback){try{analytics.identify(userId,traits,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerSetUserPropertiesOnce(function(userId,traits,options,callback){try{analytics.identify(userId,traits,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerSetAlias(function(userId,previousId,options,callback){try{analytics.alias(userId,previousId,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}})}])}(window,window.angular),/* ========================================================================
 * Bootstrap: tooltip.js v3.1.1
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function($){"use strict";var Tooltip=function(element,options){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",element,options)};Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},Tooltip.prototype.init=function(type,element,options){this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options);for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show),void 0):self.show()},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide),void 0):self.hide()},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(e),e.isDefaultPrevented())return;var that=this,$tip=this.tip();this.setContent(),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var $parent=this.$element.parent(),orgPlacement=placement,docScroll=document.documentElement.scrollTop||document.body.scrollTop,parentWidth="body"==this.options.container?window.innerWidth:$parent.outerWidth(),parentHeight="body"==this.options.container?window.innerHeight:$parent.outerHeight(),parentLeft="body"==this.options.container?0:$parent.offset().left;placement="bottom"==placement&&pos.top+pos.height+actualHeight-docScroll>parentHeight?"top":"top"==placement&&pos.top-docScroll-actualHeight<0?"bottom":"right"==placement&&pos.right+actualWidth>parentWidth?"left":"left"==placement&&pos.left-actualWidth<parentLeft?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement),this.hoverState=null;var complete=function(){that.$element.trigger("shown.bs."+that.type)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one($.support.transition.end,complete).emulateTransitionEnd(150):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var replace,$tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top=offset.top+marginTop,offset.left=offset.left+marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if("top"==placement&&actualHeight!=height&&(replace=!0,offset.top=offset.top+height-actualHeight),/bottom|top/.test(placement)){var delta=0;offset.left<0&&(delta=-2*offset.left,offset.left=0,$tip.offset(offset),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight),this.replaceArrow(delta-width+actualWidth,actualWidth,"left")}else this.replaceArrow(actualHeight-height,actualHeight,"top");replace&&$tip.offset(offset)},Tooltip.prototype.replaceArrow=function(delta,dimension,position){this.arrow().css(position,delta?50*(1-delta/dimension)+"%":"")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.trigger("hidden.bs."+that.type)}var that=this,$tip=this.tip(),e=$.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:($tip.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?$tip.one($.support.transition.end,complete).emulateTransitionEnd(150):complete(),this.hoverState=null,this)},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function(){var el=this.$element[0];return $.extend({},"function"==typeof el.getBoundingClientRect?el.getBoundingClientRect():{width:el.offsetWidth,height:el.offsetHeight},this.$element.offset())},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=e?$(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var old=$.fn.tooltip;$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;(data||"destroy"!=option)&&(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())})},$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),/* ========================================================================
 * Bootstrap: transition.js v3.1.1
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one($.support.transition.end,function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd()})}(jQuery),/* ========================================================================
 * Bootstrap: popover.js v3.1.1
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function($){"use strict";var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),Popover.prototype.constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content")[this.options.html?"string"==typeof content?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||("function"==typeof o.content?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},Popover.prototype.tip=function(){return this.$tip||(this.$tip=$(this.options.template)),this.$tip};var old=$.fn.popover;$.fn.popover=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.popover"),options="object"==typeof option&&option;(data||"destroy"!=option)&&(data||$this.data("bs.popover",data=new Popover(this,options)),"string"==typeof option&&data[option]())})},$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),/* ========================================================================
 * Bootstrap: modal.js v3.1.1
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function($){"use strict";var Modal=function(element,options){this.options=options,this.$element=$(element),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this[this.isShown?"hide":"show"](_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(document.body),that.$element.show().scrollTop(0),transition&&that.$element[0].offsetWidth,that.$element.addClass("in").attr("aria-hidden",!1),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$element.find(".modal-dialog").one($.support.transition.end,function(){that.$element.focus().trigger(e)}).emulateTransitionEnd(300):that.$element.focus().trigger(e)}))},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one($.support.transition.end,$.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.focus()},this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",$.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop(function(){that.removeBackdrop(),that.$element.trigger("hidden.bs.modal")})},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body),this.$element.on("click.dismiss.bs.modal",$.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one($.support.transition.end,callback).emulateTransitionEnd(150):callback()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one($.support.transition.end,callback).emulateTransitionEnd(150):callback()):callback&&callback()};var old=$.fn.modal;$.fn.modal=function(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options)),"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})},$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.modal(option,this).one("hide",function(){$this.is(":visible")&&$this.focus()})}),$(document).on("show.bs.modal",".modal",function(){$(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){$(document.body).removeClass("modal-open")})}(jQuery),function(global){function index(array,item){for(var i=array.length;i--;)if(array[i]===item)return i;return-1}function compareArray(a1,a2){if(a1.length!=a2.length)return!1;for(var i=0;i<a1.length;i++)if(a1[i]!==a2[i])return!1;return!0}function updateModifierKey(event){for(k in _mods)_mods[k]=event[modifierMap[k]]}function dispatch(event){var key,handler,k,i,modifiersMatch,scope;if(key=event.keyCode,-1==index(_downKeys,key)&&_downKeys.push(key),(93==key||224==key)&&(key=91),key in _mods){_mods[key]=!0;for(k in _MODIFIERS)_MODIFIERS[k]==key&&(assignKey[k]=!0)}else if(updateModifierKey(event),assignKey.filter.call(this,event)&&key in _handlers)for(scope=getScope(),i=0;i<_handlers[key].length;i++)if(handler=_handlers[key][i],handler.scope==scope||"all"==handler.scope){modifiersMatch=handler.mods.length>0;for(k in _mods)(!_mods[k]&&index(handler.mods,+k)>-1||_mods[k]&&-1==index(handler.mods,+k))&&(modifiersMatch=!1);(0!=handler.mods.length||_mods[16]||_mods[18]||_mods[17]||_mods[91])&&!modifiersMatch||handler.method(event,handler)===!1&&(event.preventDefault?event.preventDefault():event.returnValue=!1,event.stopPropagation&&event.stopPropagation(),event.cancelBubble&&(event.cancelBubble=!0))}}function clearModifier(event){var k,key=event.keyCode,i=index(_downKeys,key);if(i>=0&&_downKeys.splice(i,1),(93==key||224==key)&&(key=91),key in _mods){_mods[key]=!1;for(k in _MODIFIERS)_MODIFIERS[k]==key&&(assignKey[k]=!1)}}function resetModifiers(){for(k in _mods)_mods[k]=!1;for(k in _MODIFIERS)assignKey[k]=!1}function assignKey(key,scope,method){var keys,mods;keys=getKeys(key),void 0===method&&(method=scope,scope="all");for(var i=0;i<keys.length;i++)mods=[],key=keys[i].split("+"),key.length>1&&(mods=getMods(key),key=[key[key.length-1]]),key=key[0],key=code(key),key in _handlers||(_handlers[key]=[]),_handlers[key].push({shortcut:keys[i],scope:scope,method:method,key:keys[i],mods:mods})}function unbindKey(key,scope){var multipleKeys,keys,i,j,obj,mods=[];for(multipleKeys=getKeys(key),j=0;j<multipleKeys.length;j++){if(keys=multipleKeys[j].split("+"),keys.length>1&&(mods=getMods(keys),key=keys[keys.length-1]),key=code(key),void 0===scope&&(scope=getScope()),!_handlers[key])return;for(i in _handlers[key])obj=_handlers[key][i],obj.scope===scope&&compareArray(obj.mods,mods)&&(_handlers[key][i]={})}}function isPressed(keyCode){return"string"==typeof keyCode&&(keyCode=code(keyCode)),-1!=index(_downKeys,keyCode)}function getPressedKeyCodes(){return _downKeys.slice(0)}function filter(event){var tagName=(event.target||event.srcElement).tagName;return!("INPUT"==tagName||"SELECT"==tagName||"TEXTAREA"==tagName)}function setScope(scope){_scope=scope||"all"}function getScope(){return _scope||"all"}function deleteScope(scope){var key,handlers,i;for(key in _handlers)for(handlers=_handlers[key],i=0;i<handlers.length;)handlers[i].scope===scope?handlers.splice(i,1):i++}function getKeys(key){var keys;return key=key.replace(/\s/g,""),keys=key.split(","),""==keys[keys.length-1]&&(keys[keys.length-2]+=","),keys}function getMods(key){for(var mods=key.slice(0,key.length-1),mi=0;mi<mods.length;mi++)mods[mi]=_MODIFIERS[mods[mi]];return mods}function addEvent(object,event,method){object.addEventListener?object.addEventListener(event,method,!1):object.attachEvent&&object.attachEvent("on"+event,function(){method(window.event)})}function noConflict(){var k=global.key;return global.key=previousKey,k}var k,_handlers={},_mods={16:!1,18:!1,17:!1,91:!1},_scope="all",_MODIFIERS={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":91,command:91},_MAP={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},code=function(x){return _MAP[x]||x.toUpperCase().charCodeAt(0)},_downKeys=[];for(k=1;20>k;k++)_MAP["f"+k]=111+k;var modifierMap={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(k in _MODIFIERS)assignKey[k]=!1;addEvent(document,"keydown",function(event){dispatch(event)}),addEvent(document,"keyup",clearModifier),addEvent(window,"focus",resetModifiers);var previousKey=global.key;global.key=assignKey,global.key.setScope=setScope,global.key.getScope=getScope,global.key.deleteScope=deleteScope,global.key.filter=filter,global.key.isPressed=isPressed,global.key.getPressedKeyCodes=getPressedKeyCodes,global.key.noConflict=noConflict,global.key.unbind=unbindKey,"undefined"!=typeof module&&(module.exports=key)}(this),// Copyright (c) 2009-2010 Dominic Baggott
// Copyright (c) 2009-2010 Ash Berlin
// Copyright (c) 2011 Christoph Dorn <christoph@christophdorn.com> (http://www.christophdorn.com)
function(expose){function mk_block_toSource(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function mk_block_inspect(){var util=require("util");return"Markdown.mk_block( "+util.inspect(this.toString())+", "+util.inspect(this.trailing)+", "+util.inspect(this.lineNumber)+" )"}function count_lines(str){for(var n=0,i=-1;-1!==(i=str.indexOf("\n",i+1));)n++;return n}function strong_em(tag,md){function CloseTag(len){this.len_after=len,this.name="close_"+md}var state_slot=tag+"_state",other_slot="strong"==tag?"em_state":"strong_state";return function(text){if(this[state_slot][0]==md)return this[state_slot].shift(),[text.length,new CloseTag(text.length-md.length)];var other=this[other_slot].slice(),state=this[state_slot].slice();this[state_slot].unshift(md);{var res=this.processInline(text.substr(md.length)),last=res[res.length-1];this[state_slot].shift()}if(last instanceof CloseTag){res.pop();var consumed=text.length-last.len_after;return[consumed,[tag].concat(res)]}return this[other_slot]=other,this[state_slot]=state,[md.length,md]}}function split_meta_hash(meta_string){for(var meta=meta_string.split(""),parts=[""],in_quotes=!1;meta.length;){var letter=meta.shift();switch(letter){case" ":in_quotes?parts[parts.length-1]+=letter:parts.push("");break;case"'":case'"':in_quotes=!in_quotes;break;case"\\":letter=meta.shift();default:parts[parts.length-1]+=letter}}return parts}function extract_attr(jsonml){return isArray(jsonml)&&jsonml.length>1&&"object"==typeof jsonml[1]&&!isArray(jsonml[1])?jsonml[1]:void 0}function escapeHTML(text){return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function render_tree(jsonml){if("string"==typeof jsonml)return escapeHTML(jsonml);var tag=jsonml.shift(),attributes={},content=[];for(!jsonml.length||"object"!=typeof jsonml[0]||jsonml[0]instanceof Array||(attributes=jsonml.shift());jsonml.length;)content.push(render_tree(jsonml.shift()));var tag_attrs="";for(var a in attributes)tag_attrs+=" "+a+'="'+escapeHTML(attributes[a])+'"';return"img"==tag||"br"==tag||"hr"==tag?"<"+tag+tag_attrs+"/>":"<"+tag+tag_attrs+">"+content.join("")+"</"+tag+">"}function convert_tree_to_html(tree,references,options){var i;options=options||{};var jsonml=tree.slice(0);"function"==typeof options.preprocessTreeNode&&(jsonml=options.preprocessTreeNode(jsonml,references));var attrs=extract_attr(jsonml);if(attrs){jsonml[1]={};for(i in attrs)jsonml[1][i]=attrs[i];attrs=jsonml[1]}if("string"==typeof jsonml)return jsonml;switch(jsonml[0]){case"header":jsonml[0]="h"+jsonml[1].level,delete jsonml[1].level;break;case"bulletlist":jsonml[0]="ul";break;case"numberlist":jsonml[0]="ol";break;case"listitem":jsonml[0]="li";break;case"para":jsonml[0]="p";break;case"markdown":jsonml[0]="html",attrs&&delete attrs.references;break;case"code_block":jsonml[0]="pre",i=attrs?2:1;var code=["code"];code.push.apply(code,jsonml.splice(i,jsonml.length-i)),jsonml[i]=code;break;case"inlinecode":jsonml[0]="code";break;case"img":jsonml[1].src=jsonml[1].href,delete jsonml[1].href;break;case"linebreak":jsonml[0]="br";break;case"link":jsonml[0]="a";break;case"link_ref":jsonml[0]="a";var ref=references[attrs.ref];if(!ref)return attrs.original;delete attrs.ref,attrs.href=ref.href,ref.title&&(attrs.title=ref.title),delete attrs.original;break;case"img_ref":jsonml[0]="img";var ref=references[attrs.ref];if(!ref)return attrs.original;delete attrs.ref,attrs.src=ref.href,ref.title&&(attrs.title=ref.title),delete attrs.original}if(i=1,attrs){for(var key in jsonml[1]){i=2;break}1===i&&jsonml.splice(i,1)}for(;i<jsonml.length;++i)jsonml[i]=convert_tree_to_html(jsonml[i],references,options);return jsonml}function merge_text_nodes(jsonml){for(var i=extract_attr(jsonml)?2:1;i<jsonml.length;)"string"==typeof jsonml[i]?i+1<jsonml.length&&"string"==typeof jsonml[i+1]?jsonml[i]+=jsonml.splice(i+1,1)[0]:++i:(merge_text_nodes(jsonml[i]),++i)}var Markdown=expose.Markdown=function(dialect){switch(typeof dialect){case"undefined":this.dialect=Markdown.dialects.Gruber;break;case"object":this.dialect=dialect;break;default:if(!(dialect in Markdown.dialects))throw new Error("Unknown Markdown dialect '"+String(dialect)+"'");this.dialect=Markdown.dialects[dialect]}this.em_state=[],this.strong_state=[],this.debug_indent=""};expose.parse=function(source,dialect){var md=new Markdown(dialect);return md.toTree(source)},expose.toHTML=function(source,dialect,options){var input=expose.toHTMLTree(source,dialect,options);return expose.renderJsonML(input)},expose.toHTMLTree=function(input,dialect,options){"string"==typeof input&&(input=this.parse(input,dialect));var attrs=extract_attr(input),refs={};attrs&&attrs.references&&(refs=attrs.references);var html=convert_tree_to_html(input,refs,options);return merge_text_nodes(html),html};var mk_block=Markdown.mk_block=function(block,trail,line){1==arguments.length&&(trail="\n\n");var s=new String(block);return s.trailing=trail,s.inspect=mk_block_inspect,s.toSource=mk_block_toSource,void 0!=line&&(s.lineNumber=line),s};Markdown.prototype.split_blocks=function(input){input=input.replace(/(\r\n|\n|\r)/g,"\n");var m,re=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,blocks=[],line_no=1;for(null!=(m=/^(\s*\n)/.exec(input))&&(line_no+=count_lines(m[0]),re.lastIndex=m[0].length);null!==(m=re.exec(input));)"\n#"==m[2]&&(m[2]="\n",re.lastIndex--),blocks.push(mk_block(m[1],m[2],line_no)),line_no+=count_lines(m[0]);return blocks},Markdown.prototype.processBlock=function(block,next){var cbs=this.dialect.block,ord=cbs.__order__;if("__call__"in cbs)return cbs.__call__.call(this,block,next);for(var i=0;i<ord.length;i++){var res=cbs[ord[i]].call(this,block,next);if(res)return(!isArray(res)||res.length>0&&!isArray(res[0]))&&this.debug(ord[i],"didn't return a proper array"),res}return[]},Markdown.prototype.processInline=function(block){return this.dialect.inline.__call__.call(this,String(block))},Markdown.prototype.toTree=function(source,custom_root){var blocks=source instanceof Array?source:this.split_blocks(source),old_tree=this.tree;try{for(this.tree=custom_root||this.tree||["markdown"];blocks.length;){var b=this.processBlock(blocks.shift(),blocks);b.length&&this.tree.push.apply(this.tree,b)}return this.tree}finally{custom_root&&(this.tree=old_tree)}},Markdown.prototype.debug=function(){var args=Array.prototype.slice.call(arguments);args.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,args),"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log.apply(null,args)},Markdown.prototype.loop_re_over_block=function(re,block,cb){for(var m,b=block.valueOf();b.length&&null!=(m=re.exec(b));)b=b.substr(m[0].length),cb.call(this,m);return b},Markdown.dialects={},Markdown.dialects.Gruber={block:{atxHeader:function(block,next){var m=block.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!m)return void 0;var header=["header",{level:m[1].length}];return Array.prototype.push.apply(header,this.processInline(m[2])),m[0].length<block.length&&next.unshift(mk_block(block.substr(m[0].length),block.trailing,block.lineNumber+2)),[header]},setextHeader:function(block,next){var m=block.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!m)return void 0;var level="="===m[2]?1:2,header=["header",{level:level},m[1]];return m[0].length<block.length&&next.unshift(mk_block(block.substr(m[0].length),block.trailing,block.lineNumber+2)),[header]},code:function(block,next){var ret=[],re=/^(?: {0,3}\t| {4})(.*)\n?/;if(!block.match(re))return void 0;block_search:for(;;){var b=this.loop_re_over_block(re,block.valueOf(),function(m){ret.push(m[1])});if(b.length){next.unshift(mk_block(b,block.trailing));break block_search}if(!next.length)break block_search;if(!next[0].match(re))break block_search;ret.push(block.trailing.replace(/[^\n]/g,"").substring(2)),block=next.shift()}return[["code_block",ret.join("\n")]]},horizRule:function(block,next){var m=block.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!m)return void 0;var jsonml=[["hr"]];return m[1]&&jsonml.unshift.apply(jsonml,this.processBlock(m[1],[])),m[3]&&next.unshift(mk_block(m[3])),jsonml},lists:function(){function regex_for_depth(depth){return new RegExp("(?:^("+indent_re+"{0,"+depth+"} {0,3})("+any_list+")\\s+)|(^"+indent_re+"{0,"+(depth-1)+"}[ ]{0,4})")}function expand_tab(input){return input.replace(/ {0,3}\t/g,"    ")}function add(li,loose,inline,nl){if(loose)return li.push(["para"].concat(inline)),void 0;var add_to=li[li.length-1]instanceof Array&&"para"==li[li.length-1][0]?li[li.length-1]:li;nl&&li.length>1&&inline.unshift(nl);for(var i=0;i<inline.length;i++){var what=inline[i],is_str="string"==typeof what;is_str&&add_to.length>1&&"string"==typeof add_to[add_to.length-1]?add_to[add_to.length-1]+=what:add_to.push(what)}}function get_contained_blocks(depth,blocks){for(var re=new RegExp("^("+indent_re+"{"+depth+"}.*?\\n?)*$"),replace=new RegExp("^"+indent_re+"{"+depth+"}","gm"),ret=[];blocks.length>0&&re.exec(blocks[0]);){var b=blocks.shift(),x=b.replace(replace,"");ret.push(mk_block(x,b.trailing,b.lineNumber))}return ret}function paragraphify(s,i,stack){var list=s.list,last_li=list[list.length-1];if(!(last_li[1]instanceof Array&&"para"==last_li[1][0]))if(i+1==stack.length)last_li.push(["para"].concat(last_li.splice(1,last_li.length-1)));else{var sublist=last_li.pop();last_li.push(["para"].concat(last_li.splice(1,last_li.length-1)),sublist)}}var any_list="[*+-]|\\d+\\.",bullet_list=/[*+-]/,is_list_re=new RegExp("^( {0,3})("+any_list+")[ 	]+"),indent_re="(?: {0,3}\\t| {4})";return function(block,next){function make_list(m){var list=bullet_list.exec(m[2])?["bulletlist"]:["numberlist"];return stack.push({list:list,indent:m[1]}),list}var m=block.match(is_list_re);if(!m)return void 0;for(var last_li,i,stack=[],list=make_list(m),loose=!1,ret=[stack[0].list];;){for(var lines=block.split(/(?=\n)/),li_accumulate="",line_no=0;line_no<lines.length;line_no++){var nl="",l=lines[line_no].replace(/^\n/,function(n){return nl=n,""}),line_re=regex_for_depth(stack.length);if(m=l.match(line_re),void 0!==m[1]){li_accumulate.length&&(add(last_li,loose,this.processInline(li_accumulate),nl),loose=!1,li_accumulate=""),m[1]=expand_tab(m[1]);var wanted_depth=Math.floor(m[1].length/4)+1;if(wanted_depth>stack.length)list=make_list(m),last_li.push(list),last_li=list[1]=["listitem"];else{var found=!1;for(i=0;i<stack.length;i++)if(stack[i].indent==m[1]){list=stack[i].list,stack.splice(i+1,stack.length-(i+1)),found=!0;break}found||(wanted_depth++,wanted_depth<=stack.length?(stack.splice(wanted_depth,stack.length-wanted_depth),list=stack[wanted_depth-1].list):(list=make_list(m),last_li.push(list))),last_li=["listitem"],list.push(last_li)}nl=""}l.length>m[0].length&&(li_accumulate+=nl+l.substr(m[0].length))}li_accumulate.length&&(add(last_li,loose,this.processInline(li_accumulate),nl),loose=!1,li_accumulate="");var contained=get_contained_blocks(stack.length,next);contained.length>0&&(forEach(stack,paragraphify,this),last_li.push.apply(last_li,this.toTree(contained,[])));var next_block=next[0]&&next[0].valueOf()||"";if(!next_block.match(is_list_re)&&!next_block.match(/^ /))break;block=next.shift();var hr=this.dialect.block.horizRule(block,next);if(hr){ret.push.apply(ret,hr);break}forEach(stack,paragraphify,this),loose=!0}return ret}}(),blockquote:function(block,next){if(!block.match(/^>/m))return void 0;var jsonml=[];if(">"!=block[0]){for(var lines=block.split(/\n/),prev=[],line_no=block.lineNumber;lines.length&&">"!=lines[0][0];)prev.push(lines.shift()),line_no++;var abutting=mk_block(prev.join("\n"),"\n",block.lineNumber);jsonml.push.apply(jsonml,this.processBlock(abutting,[])),block=mk_block(lines.join("\n"),block.trailing,line_no)}for(;next.length&&">"==next[0][0];){var b=next.shift();block=mk_block(block+block.trailing+b,b.trailing,block.lineNumber)}var input=block.replace(/^> ?/gm,""),processedBlock=(this.tree,this.toTree(input,["blockquote"])),attr=extract_attr(processedBlock);return attr&&attr.references&&(delete attr.references,isEmpty(attr)&&processedBlock.splice(1,1)),jsonml.push(processedBlock),jsonml},referenceDefn:function(block,next){var re=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!block.match(re))return void 0;extract_attr(this.tree)||this.tree.splice(1,0,{});var attrs=extract_attr(this.tree);void 0===attrs.references&&(attrs.references={});var b=this.loop_re_over_block(re,block,function(m){m[2]&&"<"==m[2][0]&&">"==m[2][m[2].length-1]&&(m[2]=m[2].substring(1,m[2].length-1));var ref=attrs.references[m[1].toLowerCase()]={href:m[2]};void 0!==m[4]?ref.title=m[4]:void 0!==m[5]&&(ref.title=m[5])});return b.length&&next.unshift(mk_block(b,block.trailing)),[]},para:function(block){return[["para"].concat(this.processInline(block))]}}},Markdown.dialects.Gruber.inline={__oneElement__:function(text,patterns_or_re,previous_nodes){var m,res;patterns_or_re=patterns_or_re||this.dialect.inline.__patterns__;var re=new RegExp("([\\s\\S]*?)("+(patterns_or_re.source||patterns_or_re)+")");if(m=re.exec(text),!m)return[text.length,text];if(m[1])return[m[1].length,m[1]];var res;return m[2]in this.dialect.inline&&(res=this.dialect.inline[m[2]].call(this,text.substr(m.index),m,previous_nodes||[])),res=res||[m[2].length,m[2]]},__call__:function(text,patterns){function add(x){"string"==typeof x&&"string"==typeof out[out.length-1]?out[out.length-1]+=x:out.push(x)}for(var res,out=[];text.length>0;)res=this.dialect.inline.__oneElement__.call(this,text,patterns,out),text=text.substr(res.shift()),forEach(res,add);return out},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(text){return this.dialect.inline.__escape__.exec(text)?[2,text.charAt(1)]:[1,"\\"]},"![":function(text){var m=text.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(m){m[2]&&"<"==m[2][0]&&">"==m[2][m[2].length-1]&&(m[2]=m[2].substring(1,m[2].length-1)),m[2]=this.dialect.inline.__call__.call(this,m[2],/\\/)[0];var attrs={alt:m[1],href:m[2]||""};return void 0!==m[4]&&(attrs.title=m[4]),[m[0].length,["img",attrs]]}return m=text.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),m?[m[0].length,["img_ref",{alt:m[1],ref:m[2].toLowerCase(),original:m[0]}]]:[2,"!["]},"[":function link(text){var orig=String(text),res=Markdown.DialectHelpers.inline_until_char.call(this,text.substr(1),"]");if(!res)return[1,"["];var link,attrs,consumed=1+res[0],children=res[1];text=text.substr(consumed);var m=text.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(m){var url=m[1];if(consumed+=m[0].length,url&&"<"==url[0]&&">"==url[url.length-1]&&(url=url.substring(1,url.length-1)),!m[3])for(var open_parens=1,len=0;len<url.length;len++)switch(url[len]){case"(":open_parens++;break;case")":0==--open_parens&&(consumed-=url.length-len,url=url.substring(0,len))}return url=this.dialect.inline.__call__.call(this,url,/\\/)[0],attrs={href:url||""},void 0!==m[3]&&(attrs.title=m[3]),link=["link",attrs].concat(children),[consumed,link]}return m=text.match(/^\s*\[(.*?)\]/),m?(consumed+=m[0].length,attrs={ref:(m[1]||String(children)).toLowerCase(),original:orig.substr(0,consumed)},link=["link_ref",attrs].concat(children),[consumed,link]):1==children.length&&"string"==typeof children[0]?(attrs={ref:children[0].toLowerCase(),original:orig.substr(0,consumed)},link=["link_ref",attrs,children[0]],[consumed,link]):[1,"["]},"<":function(text){var m;return null!=(m=text.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?m[3]?[m[0].length,["link",{href:"mailto:"+m[3]},m[3]]]:"mailto"==m[2]?[m[0].length,["link",{href:m[1]},m[1].substr("mailto:".length)]]:[m[0].length,["link",{href:m[1]},m[1]]]:[1,"<"]},"`":function(text){var m=text.match(/(`+)(([\s\S]*?)\1)/);return m&&m[2]?[m[1].length+m[2].length,["inlinecode",m[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}},Markdown.dialects.Gruber.inline["**"]=strong_em("strong","**"),Markdown.dialects.Gruber.inline.__=strong_em("strong","__"),Markdown.dialects.Gruber.inline["*"]=strong_em("em","*"),Markdown.dialects.Gruber.inline._=strong_em("em","_"),Markdown.buildBlockOrder=function(d){var ord=[];for(var i in d)"__order__"!=i&&"__call__"!=i&&ord.push(i);d.__order__=ord},Markdown.buildInlinePatterns=function(d){var patterns=[];for(var i in d)if(!i.match(/^__.*__$/)){var l=i.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");patterns.push(1==i.length?l:"(?:"+l+")")}patterns=patterns.join("|"),d.__patterns__=patterns;var fn=d.__call__;d.__call__=function(text,pattern){return void 0!=pattern?fn.call(this,text,pattern):fn.call(this,text,patterns)}},Markdown.DialectHelpers={},Markdown.DialectHelpers.inline_until_char=function(text,want){for(var consumed=0,nodes=[];;){if(text.charAt(consumed)==want)return consumed++,[consumed,nodes];if(consumed>=text.length)return null;var res=this.dialect.inline.__oneElement__.call(this,text.substr(consumed));consumed+=res[0],nodes.push.apply(nodes,res.slice(1))}},Markdown.subclassDialect=function(d){function Block(){}function Inline(){}return Block.prototype=d.block,Inline.prototype=d.inline,{block:new Block,inline:new Inline}},Markdown.buildBlockOrder(Markdown.dialects.Gruber.block),Markdown.buildInlinePatterns(Markdown.dialects.Gruber.inline),Markdown.dialects.Maruku=Markdown.subclassDialect(Markdown.dialects.Gruber),Markdown.dialects.Maruku.processMetaHash=function(meta_string){for(var meta=split_meta_hash(meta_string),attr={},i=0;i<meta.length;++i)if(/^#/.test(meta[i]))attr.id=meta[i].substring(1);else if(/^\./.test(meta[i]))attr["class"]=attr["class"]?attr["class"]+meta[i].replace(/./," "):meta[i].substring(1);else if(/\=/.test(meta[i])){var s=meta[i].split(/\=/);attr[s[0]]=s[1]}return attr},Markdown.dialects.Maruku.block.document_meta=function(block){if(block.lineNumber>1)return void 0;if(!block.match(/^(?:\w+:.*\n)*\w+:.*$/))return void 0;extract_attr(this.tree)||this.tree.splice(1,0,{});var pairs=block.split(/\n/);for(p in pairs){var m=pairs[p].match(/(\w+):\s*(.*)$/),key=m[1].toLowerCase(),value=m[2];this.tree[1][key]=value}return[]},Markdown.dialects.Maruku.block.block_meta=function(block){var m=block.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!m)return void 0;var hash,attr=this.dialect.processMetaHash(m[2]);if(""===m[1]){var node=this.tree[this.tree.length-1];if(hash=extract_attr(node),"string"==typeof node)return void 0;hash||(hash={},node.splice(1,0,hash));for(a in attr)hash[a]=attr[a];return[]}var b=block.replace(/\n.*$/,""),result=this.processBlock(b,[]);hash=extract_attr(result[0]),hash||(hash={},result[0].splice(1,0,hash));for(a in attr)hash[a]=attr[a];return result},Markdown.dialects.Maruku.block.definition_list=function(block,next){var i,m,tight=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,list=["dl"];if(!(m=block.match(tight)))return void 0;for(var blocks=[block];next.length&&tight.exec(next[0]);)blocks.push(next.shift());for(var b=0;b<blocks.length;++b){var m=blocks[b].match(tight),terms=m[1].replace(/\n$/,"").split(/\n/),defns=m[2].split(/\n:\s+/);for(i=0;i<terms.length;++i)list.push(["dt",terms[i]]);for(i=0;i<defns.length;++i)list.push(["dd"].concat(this.processInline(defns[i].replace(/(\n)\s+/,"$1"))))}return[list]},Markdown.dialects.Maruku.block.table=function table(block){var i,m,_split_on_unescaped=function(s,ch){ch=ch||"\\s",ch.match(/^[\\|\[\]{}?*.+^$]$/)&&(ch="\\"+ch);for(var m,res=[],r=new RegExp("^((?:\\\\.|[^\\\\"+ch+"])*)"+ch+"(.*)");m=s.match(r);)res.push(m[1]),s=m[2];return res.push(s),res},leading_pipe=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,no_leading_pipe=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/;if(m=block.match(leading_pipe))m[3]=m[3].replace(/^\s*\|/gm,"");else if(!(m=block.match(no_leading_pipe)))return void 0;var table=["table",["thead",["tr"]],["tbody"]];m[2]=m[2].replace(/\|\s*$/,"").split("|");var html_attrs=[];for(forEach(m[2],function(s){s.match(/^\s*-+:\s*$/)?html_attrs.push({align:"right"}):s.match(/^\s*:-+\s*$/)?html_attrs.push({align:"left"}):s.match(/^\s*:-+:\s*$/)?html_attrs.push({align:"center"}):html_attrs.push({})}),m[1]=_split_on_unescaped(m[1].replace(/\|\s*$/,""),"|"),i=0;i<m[1].length;i++)table[1][1].push(["th",html_attrs[i]||{}].concat(this.processInline(m[1][i].trim())));return forEach(m[3].replace(/\|\s*$/gm,"").split("\n"),function(row){var html_row=["tr"];for(row=_split_on_unescaped(row,"|"),i=0;i<row.length;i++)html_row.push(["td",html_attrs[i]||{}].concat(this.processInline(row[i].trim())));table[2].push(html_row)},this),[table]},Markdown.dialects.Maruku.inline["{:"]=function(text,matches,out){if(!out.length)return[2,"{:"];var before=out[out.length-1];if("string"==typeof before)return[2,"{:"];var m=text.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!m)return[2,"{:"];var meta=this.dialect.processMetaHash(m[1]),attr=extract_attr(before);attr||(attr={},before.splice(1,0,attr));for(var k in meta)attr[k]=meta[k];return[m[0].length,""]},Markdown.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,Markdown.buildBlockOrder(Markdown.dialects.Maruku.block),Markdown.buildInlinePatterns(Markdown.dialects.Maruku.inline);var forEach,isArray=Array.isArray||function(obj){return"[object Array]"==Object.prototype.toString.call(obj)};forEach=Array.prototype.forEach?function(arr,cb,thisp){return arr.forEach(cb,thisp)}:function(arr,cb,thisp){for(var i=0;i<arr.length;i++)cb.call(thisp||arr,arr[i],i,arr)};var isEmpty=function(obj){for(var key in obj)if(hasOwnProperty.call(obj,key))return!1;return!0};expose.renderJsonML=function(jsonml,options){options=options||{},options.root=options.root||!1;var content=[];if(options.root)content.push(render_tree(jsonml));else for(jsonml.shift(),!jsonml.length||"object"!=typeof jsonml[0]||jsonml[0]instanceof Array||jsonml.shift();jsonml.length;)content.push(render_tree(jsonml.shift()));return content.join("\n\n")}}(function(){return"undefined"==typeof exports?(window.markdown={},window.markdown):exports}()),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){if("object"==typeof exports&&"object"==typeof module)module.exports=mod();else{if("function"==typeof define&&define.amd)return define([],mod);(this||window).CodeMirror=mod()}}(function(){"use strict";function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options?copyObj(options):{},copyObj(defaults,options,!1),setGuttersForLineNumbers(options);var doc=options.value;"string"==typeof doc&&(doc=new Doc(doc,options.mode,null,options.lineSeparator)),this.doc=doc;var input=new CodeMirror.inputStyles[options.inputStyle](this),display=this.display=new Display(place,doc,input);display.wrapper.CodeMirror=this,updateGutters(this),themeChanged(this),options.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),options.autofocus&&!mobile&&display.input.focus(),initScrollbars(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Delayed,keySeq:null,specialChars:null};var cm=this;ie&&11>ie_version&&setTimeout(function(){cm.display.input.reset(!0)},20),registerEventHandlers(this),ensureGlobalHandlers(),startOperation(this),this.curOp.forceUpdate=!0,attachDoc(this,doc),options.autofocus&&!mobile||cm.hasFocus()?setTimeout(bind(onFocus,this),20):onBlur(this);for(var opt in optionHandlers)optionHandlers.hasOwnProperty(opt)&&optionHandlers[opt](this,options[opt],Init);maybeUpdateLineNumberWidth(this),options.finishInit&&options.finishInit(this);for(var i=0;i<initHooks.length;++i)initHooks[i](this);endOperation(this),webkit&&options.lineWrapping&&"optimizelegibility"==getComputedStyle(display.lineDiv).textRendering&&(display.lineDiv.style.textRendering="auto")}function Display(place,doc,input){var d=this;this.input=input,d.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler"),d.scrollbarFiller.setAttribute("cm-not-content","true"),d.gutterFiller=elt("div",null,"CodeMirror-gutter-filler"),d.gutterFiller.setAttribute("cm-not-content","true"),d.lineDiv=elt("div",null,"CodeMirror-code"),d.selectionDiv=elt("div",null,null,"position: relative; z-index: 1"),d.cursorDiv=elt("div",null,"CodeMirror-cursors"),d.measure=elt("div",null,"CodeMirror-measure"),d.lineMeasure=elt("div",null,"CodeMirror-measure"),d.lineSpace=elt("div",[d.measure,d.lineMeasure,d.selectionDiv,d.cursorDiv,d.lineDiv],null,"position: relative; outline: none"),d.mover=elt("div",[elt("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative"),d.sizer=elt("div",[d.mover],"CodeMirror-sizer"),d.sizerWidth=null,d.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerGap+"px; width: 1px;"),d.gutters=elt("div",null,"CodeMirror-gutters"),d.lineGutter=null,d.scroller=elt("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll"),d.scroller.setAttribute("tabIndex","-1"),d.wrapper=elt("div",[d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror"),ie&&8>ie_version&&(d.gutters.style.zIndex=-1,d.scroller.style.paddingRight=0),webkit||gecko&&mobile||(d.scroller.draggable=!0),place&&(place.appendChild?place.appendChild(d.wrapper):place(d.wrapper)),d.viewFrom=d.viewTo=doc.first,d.reportedViewFrom=d.reportedViewTo=doc.first,d.view=[],d.renderedView=null,d.externalMeasured=null,d.viewOffset=0,d.lastWrapHeight=d.lastWrapWidth=0,d.updateLineNumbers=null,d.nativeBarWidth=d.barHeight=d.barWidth=0,d.scrollbarsClipped=!1,d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null,d.alignWidgets=!1,d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null,d.maxLine=null,d.maxLineLength=0,d.maxLineChanged=!1,d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null,d.shift=!1,d.selForContextMenu=null,d.activeTouch=null,input.init(d)}function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption),resetModeState(cm)}function resetModeState(cm){cm.doc.iter(function(line){line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null)}),cm.doc.frontier=cm.doc.first,startWorker(cm,100),cm.state.modeGen++,cm.curOp&&regChange(cm)}function wrappingChanged(cm){cm.options.lineWrapping?(addClass(cm.display.wrapper,"CodeMirror-wrap"),cm.display.sizer.style.minWidth="",cm.display.sizerWidth=null):(rmClass(cm.display.wrapper,"CodeMirror-wrap"),findMaxLine(cm)),estimateLineHeights(cm),regChange(cm),clearCaches(cm),setTimeout(function(){updateScrollbars(cm)},100)}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping,perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line))return 0;var widgetsHeight=0;if(line.widgets)for(var i=0;i<line.widgets.length;i++)line.widgets[i].height&&(widgetsHeight+=line.widgets[i].height);return wrapping?widgetsHeight+(Math.ceil(line.text.length/perLine)||1)*th:widgetsHeight+th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);estHeight!=line.height&&updateLineHeight(line,estHeight)})}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+cm.options.theme.replace(/(^|\s)\s*/g," cm-s-"),clearCaches(cm)}function guttersChanged(cm){updateGutters(cm),regChange(cm),setTimeout(function(){alignHorizontally(cm)},20)}function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i],gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+gutterClass));"CodeMirror-linenumbers"==gutterClass&&(cm.display.lineGutter=gElt,gElt.style.width=(cm.display.lineNumWidth||1)+"px")}gutters.style.display=i?"":"none",updateGutterSpace(cm)}function updateGutterSpace(cm){var width=cm.display.gutters.offsetWidth;cm.display.sizer.style.marginLeft=width+"px"}function lineLength(line){if(0==line.height)return 0;for(var merged,len=line.text.length,cur=line;merged=collapsedSpanAtStart(cur);){var found=merged.find(0,!0);cur=found.from.line,len+=found.from.ch-found.to.ch}for(cur=line;merged=collapsedSpanAtEnd(cur);){var found=merged.find(0,!0);len-=cur.text.length-found.from.ch,cur=found.to.line,len+=cur.text.length-found.to.ch}return len}function findMaxLine(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first),d.maxLineLength=lineLength(d.maxLine),d.maxLineChanged=!0,doc.iter(function(line){var len=lineLength(line);len>d.maxLineLength&&(d.maxLineLength=len,d.maxLine=line)})}function setGuttersForLineNumbers(options){var found=indexOf(options.gutters,"CodeMirror-linenumbers");-1==found&&options.lineNumbers?options.gutters=options.gutters.concat(["CodeMirror-linenumbers"]):found>-1&&!options.lineNumbers&&(options.gutters=options.gutters.slice(0),options.gutters.splice(found,1))}function measureForScrollbars(cm){var d=cm.display,gutterW=d.gutters.offsetWidth,docH=Math.round(cm.doc.height+paddingVert(cm.display));return{clientHeight:d.scroller.clientHeight,viewHeight:d.wrapper.clientHeight,scrollWidth:d.scroller.scrollWidth,clientWidth:d.scroller.clientWidth,viewWidth:d.wrapper.clientWidth,barLeft:cm.options.fixedGutter?gutterW:0,docHeight:docH,scrollHeight:docH+scrollGap(cm)+d.barHeight,nativeBarWidth:d.nativeBarWidth,gutterWidth:gutterW}}function NativeScrollbars(place,scroll,cm){this.cm=cm;var vert=this.vert=elt("div",[elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),horiz=this.horiz=elt("div",[elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");place(vert),place(horiz),on(vert,"scroll",function(){vert.clientHeight&&scroll(vert.scrollTop,"vertical")}),on(horiz,"scroll",function(){horiz.clientWidth&&scroll(horiz.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,ie&&8>ie_version&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function NullScrollbars(){}function initScrollbars(cm){cm.display.scrollbars&&(cm.display.scrollbars.clear(),cm.display.scrollbars.addClass&&rmClass(cm.display.wrapper,cm.display.scrollbars.addClass)),cm.display.scrollbars=new CodeMirror.scrollbarModel[cm.options.scrollbarStyle](function(node){cm.display.wrapper.insertBefore(node,cm.display.scrollbarFiller),on(node,"mousedown",function(){cm.state.focused&&setTimeout(function(){cm.display.input.focus()},0)}),node.setAttribute("cm-not-content","true")},function(pos,axis){"horizontal"==axis?setScrollLeft(cm,pos):setScrollTop(cm,pos)},cm),cm.display.scrollbars.addClass&&addClass(cm.display.wrapper,cm.display.scrollbars.addClass)}function updateScrollbars(cm,measure){measure||(measure=measureForScrollbars(cm));var startWidth=cm.display.barWidth,startHeight=cm.display.barHeight;updateScrollbarsInner(cm,measure);for(var i=0;4>i&&startWidth!=cm.display.barWidth||startHeight!=cm.display.barHeight;i++)startWidth!=cm.display.barWidth&&cm.options.lineWrapping&&updateHeightsInViewport(cm),updateScrollbarsInner(cm,measureForScrollbars(cm)),startWidth=cm.display.barWidth,startHeight=cm.display.barHeight}function updateScrollbarsInner(cm,measure){var d=cm.display,sizes=d.scrollbars.update(measure);d.sizer.style.paddingRight=(d.barWidth=sizes.right)+"px",d.sizer.style.paddingBottom=(d.barHeight=sizes.bottom)+"px",sizes.right&&sizes.bottom?(d.scrollbarFiller.style.display="block",d.scrollbarFiller.style.height=sizes.bottom+"px",d.scrollbarFiller.style.width=sizes.right+"px"):d.scrollbarFiller.style.display="",sizes.bottom&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter?(d.gutterFiller.style.display="block",d.gutterFiller.style.height=sizes.bottom+"px",d.gutterFiller.style.width=measure.gutterWidth+"px"):d.gutterFiller.style.display=""}function visibleLines(display,doc,viewport){var top=viewport&&null!=viewport.top?Math.max(0,viewport.top):display.scroller.scrollTop;top=Math.floor(top-paddingTop(display));var bottom=viewport&&null!=viewport.bottom?viewport.bottom:top+display.wrapper.clientHeight,from=lineAtHeight(doc,top),to=lineAtHeight(doc,bottom);if(viewport&&viewport.ensure){var ensureFrom=viewport.ensure.from.line,ensureTo=viewport.ensure.to.line;from>ensureFrom?(from=ensureFrom,to=lineAtHeight(doc,heightAtLine(getLine(doc,ensureFrom))+display.wrapper.clientHeight)):Math.min(ensureTo,doc.lastLine())>=to&&(from=lineAtHeight(doc,heightAtLine(getLine(doc,ensureTo))-display.wrapper.clientHeight),to=ensureTo)}return{from:from,to:Math.max(to,from+1)}}function alignHorizontally(cm){var display=cm.display,view=display.view;if(display.alignWidgets||display.gutters.firstChild&&cm.options.fixedGutter){for(var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft,gutterW=display.gutters.offsetWidth,left=comp+"px",i=0;i<view.length;i++)if(!view[i].hidden){cm.options.fixedGutter&&view[i].gutter&&(view[i].gutter.style.left=left);var align=view[i].alignable;if(align)for(var j=0;j<align.length;j++)align[j].style.left=left}cm.options.fixedGutter&&(display.gutters.style.left=comp+gutterW+"px")}}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return!1;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt")),innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;return display.lineGutter.style.width="",display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding)+1,display.lineNumWidth=display.lineNumInnerWidth+padding,display.lineNumChars=display.lineNumInnerWidth?last.length:-1,display.lineGutter.style.width=display.lineNumWidth+"px",updateGutterSpace(cm),!0}return!1}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function compensateForHScroll(display){return display.scroller.getBoundingClientRect().left-display.sizer.getBoundingClientRect().left}function DisplayUpdate(cm,viewport,force){var display=cm.display;this.viewport=viewport,this.visible=visibleLines(display,cm.doc,viewport),this.editorIsHidden=!display.wrapper.offsetWidth,this.wrapperHeight=display.wrapper.clientHeight,this.wrapperWidth=display.wrapper.clientWidth,this.oldDisplayWidth=displayWidth(cm),this.force=force,this.dims=getDimensions(cm),this.events=[]}function maybeClipScrollbars(cm){var display=cm.display;!display.scrollbarsClipped&&display.scroller.offsetWidth&&(display.nativeBarWidth=display.scroller.offsetWidth-display.scroller.clientWidth,display.heightForcer.style.height=scrollGap(cm)+"px",display.sizer.style.marginBottom=-display.nativeBarWidth+"px",display.sizer.style.borderRightWidth=scrollGap(cm)+"px",display.scrollbarsClipped=!0)}function updateDisplayIfNeeded(cm,update){var display=cm.display,doc=cm.doc;if(update.editorIsHidden)return resetView(cm),!1;if(!update.force&&update.visible.from>=display.viewFrom&&update.visible.to<=display.viewTo&&(null==display.updateLineNumbers||display.updateLineNumbers>=display.viewTo)&&display.renderedView==display.view&&0==countDirtyView(cm))return!1;maybeUpdateLineNumberWidth(cm)&&(resetView(cm),update.dims=getDimensions(cm));var end=doc.first+doc.size,from=Math.max(update.visible.from-cm.options.viewportMargin,doc.first),to=Math.min(end,update.visible.to+cm.options.viewportMargin);display.viewFrom<from&&from-display.viewFrom<20&&(from=Math.max(doc.first,display.viewFrom)),display.viewTo>to&&display.viewTo-to<20&&(to=Math.min(end,display.viewTo)),sawCollapsedSpans&&(from=visualLineNo(cm.doc,from),to=visualLineEndNo(cm.doc,to));var different=from!=display.viewFrom||to!=display.viewTo||display.lastWrapHeight!=update.wrapperHeight||display.lastWrapWidth!=update.wrapperWidth;adjustView(cm,from,to),display.viewOffset=heightAtLine(getLine(cm.doc,display.viewFrom)),cm.display.mover.style.top=display.viewOffset+"px";var toUpdate=countDirtyView(cm);if(!different&&0==toUpdate&&!update.force&&display.renderedView==display.view&&(null==display.updateLineNumbers||display.updateLineNumbers>=display.viewTo))return!1;var focused=activeElt();return toUpdate>4&&(display.lineDiv.style.display="none"),patchDisplay(cm,display.updateLineNumbers,update.dims),toUpdate>4&&(display.lineDiv.style.display=""),display.renderedView=display.view,focused&&activeElt()!=focused&&focused.offsetHeight&&focused.focus(),removeChildren(display.cursorDiv),removeChildren(display.selectionDiv),display.gutters.style.height=display.sizer.style.minHeight=0,different&&(display.lastWrapHeight=update.wrapperHeight,display.lastWrapWidth=update.wrapperWidth,startWorker(cm,400)),display.updateLineNumbers=null,!0}function postUpdateDisplay(cm,update){for(var viewport=update.viewport,first=!0;(first&&cm.options.lineWrapping&&update.oldDisplayWidth!=displayWidth(cm)||(viewport&&null!=viewport.top&&(viewport={top:Math.min(cm.doc.height+paddingVert(cm.display)-displayHeight(cm),viewport.top)}),update.visible=visibleLines(cm.display,cm.doc,viewport),!(update.visible.from>=cm.display.viewFrom&&update.visible.to<=cm.display.viewTo)))&&updateDisplayIfNeeded(cm,update);first=!1){updateHeightsInViewport(cm);var barMeasure=measureForScrollbars(cm);updateSelection(cm),setDocumentHeight(cm,barMeasure),updateScrollbars(cm,barMeasure)}update.signal(cm,"update",cm),(cm.display.viewFrom!=cm.display.reportedViewFrom||cm.display.viewTo!=cm.display.reportedViewTo)&&(update.signal(cm,"viewportChange",cm,cm.display.viewFrom,cm.display.viewTo),cm.display.reportedViewFrom=cm.display.viewFrom,cm.display.reportedViewTo=cm.display.viewTo)}function updateDisplaySimple(cm,viewport){var update=new DisplayUpdate(cm,viewport);if(updateDisplayIfNeeded(cm,update)){updateHeightsInViewport(cm),postUpdateDisplay(cm,update);var barMeasure=measureForScrollbars(cm);updateSelection(cm),setDocumentHeight(cm,barMeasure),updateScrollbars(cm,barMeasure),update.finish()}}function setDocumentHeight(cm,measure){cm.display.sizer.style.minHeight=measure.docHeight+"px";var total=measure.docHeight+cm.display.barHeight;cm.display.heightForcer.style.top=total+"px",cm.display.gutters.style.height=Math.max(total+scrollGap(cm),measure.clientHeight)+"px"}function updateHeightsInViewport(cm){for(var display=cm.display,prevBottom=display.lineDiv.offsetTop,i=0;i<display.view.length;i++){var height,cur=display.view[i];if(!cur.hidden){if(ie&&8>ie_version){var bot=cur.node.offsetTop+cur.node.offsetHeight;height=bot-prevBottom,prevBottom=bot}else{var box=cur.node.getBoundingClientRect();height=box.bottom-box.top}var diff=cur.line.height-height;if(2>height&&(height=textHeight(display)),(diff>.001||-.001>diff)&&(updateLineHeight(cur.line,height),updateWidgetHeight(cur.line),cur.rest))for(var j=0;j<cur.rest.length;j++)updateWidgetHeight(cur.rest[j])}}}function updateWidgetHeight(line){if(line.widgets)for(var i=0;i<line.widgets.length;++i)line.widgets[i].height=line.widgets[i].node.parentNode.offsetHeight}function getDimensions(cm){for(var d=cm.display,left={},width={},gutterLeft=d.gutters.clientLeft,n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i)left[cm.options.gutters[i]]=n.offsetLeft+n.clientLeft+gutterLeft,width[cm.options.gutters[i]]=n.clientWidth;return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function patchDisplay(cm,updateNumbersFrom,dims){function rm(node){var next=node.nextSibling;return webkit&&mac&&cm.display.currentWheelTarget==node?node.style.display="none":node.parentNode.removeChild(node),next}for(var display=cm.display,lineNumbers=cm.options.lineNumbers,container=display.lineDiv,cur=container.firstChild,view=display.view,lineN=display.viewFrom,i=0;i<view.length;i++){var lineView=view[i];if(lineView.hidden);else if(lineView.node&&lineView.node.parentNode==container){for(;cur!=lineView.node;)cur=rm(cur);var updateNumber=lineNumbers&&null!=updateNumbersFrom&&lineN>=updateNumbersFrom&&lineView.lineNumber;lineView.changes&&(indexOf(lineView.changes,"gutter")>-1&&(updateNumber=!1),updateLineForChanges(cm,lineView,lineN,dims)),updateNumber&&(removeChildren(lineView.lineNumber),lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options,lineN)))),cur=lineView.node.nextSibling}else{var node=buildLineElement(cm,lineView,lineN,dims);container.insertBefore(node,cur)}lineN+=lineView.size}for(;cur;)cur=rm(cur)}function updateLineForChanges(cm,lineView,lineN,dims){for(var j=0;j<lineView.changes.length;j++){var type=lineView.changes[j];"text"==type?updateLineText(cm,lineView):"gutter"==type?updateLineGutter(cm,lineView,lineN,dims):"class"==type?updateLineClasses(lineView):"widget"==type&&updateLineWidgets(cm,lineView,dims)}lineView.changes=null}function ensureLineWrapped(lineView){return lineView.node==lineView.text&&(lineView.node=elt("div",null,null,"position: relative"),lineView.text.parentNode&&lineView.text.parentNode.replaceChild(lineView.node,lineView.text),lineView.node.appendChild(lineView.text),ie&&8>ie_version&&(lineView.node.style.zIndex=2)),lineView.node}function updateLineBackground(lineView){var cls=lineView.bgClass?lineView.bgClass+" "+(lineView.line.bgClass||""):lineView.line.bgClass;if(cls&&(cls+=" CodeMirror-linebackground"),lineView.background)cls?lineView.background.className=cls:(lineView.background.parentNode.removeChild(lineView.background),lineView.background=null);else if(cls){var wrap=ensureLineWrapped(lineView);lineView.background=wrap.insertBefore(elt("div",null,cls),wrap.firstChild)}}function getLineContent(cm,lineView){var ext=cm.display.externalMeasured;return ext&&ext.line==lineView.line?(cm.display.externalMeasured=null,lineView.measure=ext.measure,ext.built):buildLineContent(cm,lineView)}function updateLineText(cm,lineView){var cls=lineView.text.className,built=getLineContent(cm,lineView);lineView.text==lineView.node&&(lineView.node=built.pre),lineView.text.parentNode.replaceChild(built.pre,lineView.text),lineView.text=built.pre,built.bgClass!=lineView.bgClass||built.textClass!=lineView.textClass?(lineView.bgClass=built.bgClass,lineView.textClass=built.textClass,updateLineClasses(lineView)):cls&&(lineView.text.className=cls)}function updateLineClasses(lineView){updateLineBackground(lineView),lineView.line.wrapClass?ensureLineWrapped(lineView).className=lineView.line.wrapClass:lineView.node!=lineView.text&&(lineView.node.className="");var textClass=lineView.textClass?lineView.textClass+" "+(lineView.line.textClass||""):lineView.line.textClass;lineView.text.className=textClass||""}function updateLineGutter(cm,lineView,lineN,dims){if(lineView.gutter&&(lineView.node.removeChild(lineView.gutter),lineView.gutter=null),lineView.gutterBackground&&(lineView.node.removeChild(lineView.gutterBackground),lineView.gutterBackground=null),lineView.line.gutterClass){var wrap=ensureLineWrapped(lineView);lineView.gutterBackground=elt("div",null,"CodeMirror-gutter-background "+lineView.line.gutterClass,"left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px; width: "+dims.gutterTotalWidth+"px"),wrap.insertBefore(lineView.gutterBackground,lineView.text)}var markers=lineView.line.gutterMarkers;if(cm.options.lineNumbers||markers){var wrap=ensureLineWrapped(lineView),gutterWrap=lineView.gutter=elt("div",null,"CodeMirror-gutter-wrapper","left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px");if(cm.display.input.setUneditable(gutterWrap),wrap.insertBefore(gutterWrap,lineView.text),lineView.line.gutterClass&&(gutterWrap.className+=" "+lineView.line.gutterClass),!cm.options.lineNumbers||markers&&markers["CodeMirror-linenumbers"]||(lineView.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineN),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+cm.display.lineNumInnerWidth+"px"))),markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];found&&gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"))}}}function updateLineWidgets(cm,lineView,dims){lineView.alignable&&(lineView.alignable=null);for(var next,node=lineView.node.firstChild;node;node=next){var next=node.nextSibling;"CodeMirror-linewidget"==node.className&&lineView.node.removeChild(node)}insertLineWidgets(cm,lineView,dims)}function buildLineElement(cm,lineView,lineN,dims){var built=getLineContent(cm,lineView);return lineView.text=lineView.node=built.pre,built.bgClass&&(lineView.bgClass=built.bgClass),built.textClass&&(lineView.textClass=built.textClass),updateLineClasses(lineView),updateLineGutter(cm,lineView,lineN,dims),insertLineWidgets(cm,lineView,dims),lineView.node}function insertLineWidgets(cm,lineView,dims){if(insertLineWidgetsFor(cm,lineView.line,lineView,dims,!0),lineView.rest)for(var i=0;i<lineView.rest.length;i++)insertLineWidgetsFor(cm,lineView.rest[i],lineView,dims,!1)}function insertLineWidgetsFor(cm,line,lineView,dims,allowAbove){if(line.widgets)for(var wrap=ensureLineWrapped(lineView),i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget");widget.handleMouseEvents||node.setAttribute("cm-ignore-events","true"),positionLineWidget(widget,node,lineView,dims),cm.display.input.setUneditable(node),allowAbove&&widget.above?wrap.insertBefore(node,lineView.gutter||lineView.text):wrap.appendChild(node),signalLater(widget,"redraw")}}function positionLineWidget(widget,node,lineView,dims){if(widget.noHScroll){(lineView.alignable||(lineView.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px",widget.coverGutter||(width-=dims.gutterTotalWidth,node.style.paddingLeft=dims.gutterTotalWidth+"px"),node.style.width=width+"px"}widget.coverGutter&&(node.style.zIndex=5,node.style.position="relative",widget.noHScroll||(node.style.marginLeft=-dims.gutterTotalWidth+"px"))}function copyPos(x){return Pos(x.line,x.ch)}function maxPos(a,b){return cmp(a,b)<0?b:a}function minPos(a,b){return cmp(a,b)<0?a:b}function ensureFocus(cm){cm.state.focused||(cm.display.input.focus(),onFocus(cm))}function applyTextInput(cm,inserted,deleted,sel,origin){var doc=cm.doc;cm.display.shift=!1,sel||(sel=doc.sel);var paste=cm.state.pasteIncoming||"paste"==origin,textLines=doc.splitLines(inserted),multiPaste=null;if(paste&&sel.ranges.length>1)if(lastCopied&&lastCopied.join("\n")==inserted){if(sel.ranges.length%lastCopied.length==0){multiPaste=[];for(var i=0;i<lastCopied.length;i++)multiPaste.push(doc.splitLines(lastCopied[i]))}}else textLines.length==sel.ranges.length&&(multiPaste=map(textLines,function(l){return[l]}));for(var i=sel.ranges.length-1;i>=0;i--){var range=sel.ranges[i],from=range.from(),to=range.to();range.empty()&&(deleted&&deleted>0?from=Pos(from.line,from.ch-deleted):cm.state.overwrite&&!paste&&(to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+lst(textLines).length))));var updateInput=cm.curOp.updateInput,changeEvent={from:from,to:to,text:multiPaste?multiPaste[i%multiPaste.length]:textLines,origin:origin||(paste?"paste":cm.state.cutIncoming?"cut":"+input")};makeChange(cm.doc,changeEvent),signalLater(cm,"inputRead",cm,changeEvent)}inserted&&!paste&&triggerElectric(cm,inserted),ensureCursorVisible(cm),cm.curOp.updateInput=updateInput,cm.curOp.typing=!0,cm.state.pasteIncoming=cm.state.cutIncoming=!1}function handlePaste(e,cm){var pasted=e.clipboardData&&e.clipboardData.getData("text/plain");return pasted?(e.preventDefault(),cm.isReadOnly()||cm.options.disableInput||runInOp(cm,function(){applyTextInput(cm,pasted,0,null,"paste")}),!0):void 0}function triggerElectric(cm,inserted){if(cm.options.electricChars&&cm.options.smartIndent)for(var sel=cm.doc.sel,i=sel.ranges.length-1;i>=0;i--){var range=sel.ranges[i];if(!(range.head.ch>100||i&&sel.ranges[i-1].head.line==range.head.line)){var mode=cm.getModeAt(range.head),indented=!1;if(mode.electricChars){for(var j=0;j<mode.electricChars.length;j++)if(inserted.indexOf(mode.electricChars.charAt(j))>-1){indented=indentLine(cm,range.head.line,"smart");break}}else mode.electricInput&&mode.electricInput.test(getLine(cm.doc,range.head.line).text.slice(0,range.head.ch))&&(indented=indentLine(cm,range.head.line,"smart"));indented&&signalLater(cm,"electricInput",cm,range.head.line)}}}function copyableRanges(cm){for(var text=[],ranges=[],i=0;i<cm.doc.sel.ranges.length;i++){var line=cm.doc.sel.ranges[i].head.line,lineRange={anchor:Pos(line,0),head:Pos(line+1,0)};ranges.push(lineRange),text.push(cm.getRange(lineRange.anchor,lineRange.head))}return{text:text,ranges:ranges}}function disableBrowserMagic(field){field.setAttribute("autocorrect","off"),field.setAttribute("autocapitalize","off"),field.setAttribute("spellcheck","false")}function TextareaInput(cm){this.cm=cm,this.prevInput="",this.pollingFast=!1,this.polling=new Delayed,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function hiddenTextarea(){var te=elt("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),div=elt("div",[te],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return webkit?te.style.width="1000px":te.setAttribute("wrap","off"),ios&&(te.style.border="1px solid black"),disableBrowserMagic(te),div}function ContentEditableInput(cm){this.cm=cm,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Delayed,this.gracePeriod=!1}function posToDOM(cm,pos){var view=findViewForLine(cm,pos.line);if(!view||view.hidden)return null;var line=getLine(cm.doc,pos.line),info=mapFromLineView(view,line,pos.line),order=getOrder(line),side="left";if(order){var partPos=getBidiPartAt(order,pos.ch);side=partPos%2?"right":"left"}var result=nodeAndOffsetInLineMap(info.map,pos.ch,side);return result.offset="right"==result.collapse?result.end:result.start,result}function badPos(pos,bad){return bad&&(pos.bad=!0),pos}function domToPos(cm,node,offset){var lineNode;if(node==cm.display.lineDiv){if(lineNode=cm.display.lineDiv.childNodes[offset],!lineNode)return badPos(cm.clipPos(Pos(cm.display.viewTo-1)),!0);node=null,offset=0}else for(lineNode=node;;lineNode=lineNode.parentNode){if(!lineNode||lineNode==cm.display.lineDiv)return null;if(lineNode.parentNode&&lineNode.parentNode==cm.display.lineDiv)break}for(var i=0;i<cm.display.view.length;i++){var lineView=cm.display.view[i];if(lineView.node==lineNode)return locateNodeInLineView(lineView,node,offset)}}function locateNodeInLineView(lineView,node,offset){function find(textNode,topNode,offset){for(var i=-1;i<(maps?maps.length:0);i++)for(var map=0>i?measure.map:maps[i],j=0;j<map.length;j+=3){var curNode=map[j+2];if(curNode==textNode||curNode==topNode){var line=lineNo(0>i?lineView.line:lineView.rest[i]),ch=map[j]+offset;return(0>offset||curNode!=textNode)&&(ch=map[j+(offset?1:0)]),Pos(line,ch)}}}var wrapper=lineView.text.firstChild,bad=!1;if(!node||!contains(wrapper,node))return badPos(Pos(lineNo(lineView.line),0),!0);if(node==wrapper&&(bad=!0,node=wrapper.childNodes[offset],offset=0,!node)){var line=lineView.rest?lst(lineView.rest):lineView.line;return badPos(Pos(lineNo(line),line.text.length),bad)}var textNode=3==node.nodeType?node:null,topNode=node;for(textNode||1!=node.childNodes.length||3!=node.firstChild.nodeType||(textNode=node.firstChild,offset&&(offset=textNode.nodeValue.length));topNode.parentNode!=wrapper;)topNode=topNode.parentNode;var measure=lineView.measure,maps=measure.maps,found=find(textNode,topNode,offset);if(found)return badPos(found,bad);for(var after=topNode.nextSibling,dist=textNode?textNode.nodeValue.length-offset:0;after;after=after.nextSibling){if(found=find(after,after.firstChild,0))return badPos(Pos(found.line,found.ch-dist),bad);dist+=after.textContent.length}for(var before=topNode.previousSibling,dist=offset;before;before=before.previousSibling){if(found=find(before,before.firstChild,-1))return badPos(Pos(found.line,found.ch+dist),bad);dist+=after.textContent.length}}function domTextBetween(cm,from,to,fromLine,toLine){function recognizeMarker(id){return function(marker){return marker.id==id}}function walk(node){if(1==node.nodeType){var cmText=node.getAttribute("cm-text");if(null!=cmText)return""==cmText&&(cmText=node.textContent.replace(/\u200b/g,"")),text+=cmText,void 0;var range,markerID=node.getAttribute("cm-marker");if(markerID){var found=cm.findMarks(Pos(fromLine,0),Pos(toLine+1,0),recognizeMarker(+markerID));return found.length&&(range=found[0].find())&&(text+=getBetween(cm.doc,range.from,range.to).join(lineSep)),void 0}if("false"==node.getAttribute("contenteditable"))return;for(var i=0;i<node.childNodes.length;i++)walk(node.childNodes[i]);/^(pre|div|p)$/i.test(node.nodeName)&&(closing=!0)}else if(3==node.nodeType){var val=node.nodeValue;if(!val)return;closing&&(text+=lineSep,closing=!1),text+=val}}for(var text="",closing=!1,lineSep=cm.doc.lineSeparator();walk(from),from!=to;)from=from.nextSibling;return text}function Selection(ranges,primIndex){this.ranges=ranges,this.primIndex=primIndex}function Range(anchor,head){this.anchor=anchor,this.head=head}function normalizeSelection(ranges,primIndex){var prim=ranges[primIndex];ranges.sort(function(a,b){return cmp(a.from(),b.from())}),primIndex=indexOf(ranges,prim);for(var i=1;i<ranges.length;i++){var cur=ranges[i],prev=ranges[i-1];if(cmp(prev.to(),cur.from())>=0){var from=minPos(prev.from(),cur.from()),to=maxPos(prev.to(),cur.to()),inv=prev.empty()?cur.from()==cur.head:prev.from()==prev.head;primIndex>=i&&--primIndex,ranges.splice(--i,2,new Range(inv?to:from,inv?from:to))}}return new Selection(ranges,primIndex)}function simpleSelection(anchor,head){return new Selection([new Range(anchor,head||anchor)],0)}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;return pos.line>last?Pos(last,getLine(doc,last).text.length):clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;return null==ch||ch>linelen?Pos(pos.line,linelen):0>ch?Pos(pos.line,0):pos}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function clipPosArray(doc,array){for(var out=[],i=0;i<array.length;i++)out[i]=clipPos(doc,array[i]);return out}function extendRange(doc,range,head,other){if(doc.cm&&doc.cm.display.shift||doc.extend){var anchor=range.anchor;if(other){var posBefore=cmp(head,anchor)<0;posBefore!=cmp(other,anchor)<0?(anchor=head,head=other):posBefore!=cmp(head,other)<0&&(head=other)}return new Range(anchor,head)}return new Range(other||head,head)}function extendSelection(doc,head,other,options){setSelection(doc,new Selection([extendRange(doc,doc.sel.primary(),head,other)],0),options)}function extendSelections(doc,heads,options){for(var out=[],i=0;i<doc.sel.ranges.length;i++)out[i]=extendRange(doc,doc.sel.ranges[i],heads[i],null);
var newSel=normalizeSelection(out,doc.sel.primIndex);setSelection(doc,newSel,options)}function replaceOneSelection(doc,i,range,options){var ranges=doc.sel.ranges.slice(0);ranges[i]=range,setSelection(doc,normalizeSelection(ranges,doc.sel.primIndex),options)}function setSimpleSelection(doc,anchor,head,options){setSelection(doc,simpleSelection(anchor,head),options)}function filterSelectionChange(doc,sel,options){var obj={ranges:sel.ranges,update:function(ranges){this.ranges=[];for(var i=0;i<ranges.length;i++)this.ranges[i]=new Range(clipPos(doc,ranges[i].anchor),clipPos(doc,ranges[i].head))},origin:options&&options.origin};return signal(doc,"beforeSelectionChange",doc,obj),doc.cm&&signal(doc.cm,"beforeSelectionChange",doc.cm,obj),obj.ranges!=sel.ranges?normalizeSelection(obj.ranges,obj.ranges.length-1):sel}function setSelectionReplaceHistory(doc,sel,options){var done=doc.history.done,last=lst(done);last&&last.ranges?(done[done.length-1]=sel,setSelectionNoUndo(doc,sel,options)):setSelection(doc,sel,options)}function setSelection(doc,sel,options){setSelectionNoUndo(doc,sel,options),addSelectionToHistory(doc,doc.sel,doc.cm?doc.cm.curOp.id:0/0,options)}function setSelectionNoUndo(doc,sel,options){(hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange"))&&(sel=filterSelectionChange(doc,sel,options));var bias=options&&options.bias||(cmp(sel.primary().head,doc.sel.primary().head)<0?-1:1);setSelectionInner(doc,skipAtomicInSelection(doc,sel,bias,!0)),options&&options.scroll===!1||!doc.cm||ensureCursorVisible(doc.cm)}function setSelectionInner(doc,sel){sel.equals(doc.sel)||(doc.sel=sel,doc.cm&&(doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=!0,signalCursorActivity(doc.cm)),signalLater(doc,"cursorActivity",doc))}function reCheckSelection(doc){setSelectionInner(doc,skipAtomicInSelection(doc,doc.sel,null,!1),sel_dontScroll)}function skipAtomicInSelection(doc,sel,bias,mayClear){for(var out,i=0;i<sel.ranges.length;i++){var range=sel.ranges[i],old=sel.ranges.length==doc.sel.ranges.length&&doc.sel.ranges[i],newAnchor=skipAtomic(doc,range.anchor,old&&old.anchor,bias,mayClear),newHead=skipAtomic(doc,range.head,old&&old.head,bias,mayClear);(out||newAnchor!=range.anchor||newHead!=range.head)&&(out||(out=sel.ranges.slice(0,i)),out[i]=new Range(newAnchor,newHead))}return out?normalizeSelection(out,sel.primIndex):sel}function skipAtomicInner(doc,pos,oldPos,dir,mayClear){var line=getLine(doc,pos.line);if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((null==sp.from||(m.inclusiveLeft?sp.from<=pos.ch:sp.from<pos.ch))&&(null==sp.to||(m.inclusiveRight?sp.to>=pos.ch:sp.to>pos.ch))){if(mayClear&&(signal(m,"beforeCursorEnter"),m.explicitlyCleared)){if(line.markedSpans){--i;continue}break}if(!m.atomic)continue;if(oldPos){var diff,near=m.find(0>dir?1:-1);if((0>dir?m.inclusiveRight:m.inclusiveLeft)&&(near=movePos(doc,near,-dir,line)),near&&near.line==pos.line&&(diff=cmp(near,oldPos))&&(0>dir?0>diff:diff>0))return skipAtomicInner(doc,near,pos,dir,mayClear)}var far=m.find(0>dir?-1:1);return(0>dir?m.inclusiveLeft:m.inclusiveRight)&&(far=movePos(doc,far,dir,line)),far?skipAtomicInner(doc,far,pos,dir,mayClear):null}}return pos}function skipAtomic(doc,pos,oldPos,bias,mayClear){var dir=bias||1,found=skipAtomicInner(doc,pos,oldPos,dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,dir,!0)||skipAtomicInner(doc,pos,oldPos,-dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,-dir,!0);return found?found:(doc.cantEdit=!0,Pos(doc.first,0))}function movePos(doc,pos,dir,line){return 0>dir&&0==pos.ch?pos.line>doc.first?clipPos(doc,Pos(pos.line-1)):null:dir>0&&pos.ch==(line||getLine(doc,pos.line)).text.length?pos.line<doc.first+doc.size-1?Pos(pos.line+1,0):null:new Pos(pos.line,pos.ch+dir)}function updateSelection(cm){cm.display.input.showSelection(cm.display.input.prepareSelection())}function prepareSelection(cm,primary){for(var doc=cm.doc,result={},curFragment=result.cursors=document.createDocumentFragment(),selFragment=result.selection=document.createDocumentFragment(),i=0;i<doc.sel.ranges.length;i++)if(primary!==!1||i!=doc.sel.primIndex){var range=doc.sel.ranges[i],collapsed=range.empty();(collapsed||cm.options.showCursorWhenSelecting)&&drawSelectionCursor(cm,range.head,curFragment),collapsed||drawSelectionRange(cm,range,selFragment)}return result}function drawSelectionCursor(cm,head,output){var pos=cursorCoords(cm,head,"div",null,null,!cm.options.singleCursorHeightPerLine),cursor=output.appendChild(elt("div","","CodeMirror-cursor"));if(cursor.style.left=pos.left+"px",cursor.style.top=pos.top+"px",cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px",pos.other){var otherCursor=output.appendChild(elt("div","","CodeMirror-cursor CodeMirror-secondarycursor"));otherCursor.style.display="",otherCursor.style.left=pos.other.left+"px",otherCursor.style.top=pos.other.top+"px",otherCursor.style.height=.85*(pos.other.bottom-pos.other.top)+"px"}}function drawSelectionRange(cm,range,output){function add(left,top,width,bottom){0>top&&(top=0),top=Math.round(top),bottom=Math.round(bottom),fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px; top: "+top+"px; width: "+(null==width?rightSide-left:width)+"px; height: "+(bottom-top)+"px"))}function drawForLine(line,fromArg,toArg){function coords(ch,bias){return charCoords(cm,Pos(line,ch),"div",lineObj,bias)}var start,end,lineObj=getLine(doc,line),lineLen=lineObj.text.length;return iterateBidiSections(getOrder(lineObj),fromArg||0,null==toArg?lineLen:toArg,function(from,to,dir){var rightPos,left,right,leftPos=coords(from,"left");if(from==to)rightPos=leftPos,left=right=leftPos.left;else{if(rightPos=coords(to-1,"right"),"rtl"==dir){var tmp=leftPos;leftPos=rightPos,rightPos=tmp}left=leftPos.left,right=rightPos.right}null==fromArg&&0==from&&(left=leftSide),rightPos.top-leftPos.top>3&&(add(left,leftPos.top,null,leftPos.bottom),left=leftSide,leftPos.bottom<rightPos.top&&add(left,leftPos.bottom,null,rightPos.top)),null==toArg&&to==lineLen&&(right=rightSide),(!start||leftPos.top<start.top||leftPos.top==start.top&&leftPos.left<start.left)&&(start=leftPos),(!end||rightPos.bottom>end.bottom||rightPos.bottom==end.bottom&&rightPos.right>end.right)&&(end=rightPos),leftSide+1>left&&(left=leftSide),add(left,rightPos.top,right-left,rightPos.bottom)}),{start:start,end:end}}var display=cm.display,doc=cm.doc,fragment=document.createDocumentFragment(),padding=paddingH(cm.display),leftSide=padding.left,rightSide=Math.max(display.sizerWidth,displayWidth(cm)-display.sizer.offsetLeft)-padding.right,sFrom=range.from(),sTo=range.to();if(sFrom.line==sTo.line)drawForLine(sFrom.line,sFrom.ch,sTo.ch);else{var fromLine=getLine(doc,sFrom.line),toLine=getLine(doc,sTo.line),singleVLine=visualLine(fromLine)==visualLine(toLine),leftEnd=drawForLine(sFrom.line,sFrom.ch,singleVLine?fromLine.text.length+1:null).end,rightStart=drawForLine(sTo.line,singleVLine?0:null,sTo.ch).start;singleVLine&&(leftEnd.top<rightStart.top-2?(add(leftEnd.right,leftEnd.top,null,leftEnd.bottom),add(leftSide,rightStart.top,rightStart.left,rightStart.bottom)):add(leftEnd.right,leftEnd.top,rightStart.left-leftEnd.right,leftEnd.bottom)),leftEnd.bottom<rightStart.top&&add(leftSide,leftEnd.bottom,null,rightStart.top)}output.appendChild(fragment)}function restartBlink(cm){if(cm.state.focused){var display=cm.display;clearInterval(display.blinker);var on=!0;display.cursorDiv.style.visibility="",cm.options.cursorBlinkRate>0?display.blinker=setInterval(function(){display.cursorDiv.style.visibility=(on=!on)?"":"hidden"},cm.options.cursorBlinkRate):cm.options.cursorBlinkRate<0&&(display.cursorDiv.style.visibility="hidden")}}function startWorker(cm,time){cm.doc.mode.startState&&cm.doc.frontier<cm.display.viewTo&&cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first&&(doc.frontier=doc.first),!(doc.frontier>=cm.display.viewTo)){var end=+new Date+cm.options.workTime,state=copyState(doc.mode,getStateBefore(cm,doc.frontier)),changedLines=[];doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.viewTo+500),function(line){if(doc.frontier>=cm.display.viewFrom){var oldStyles=line.styles,tooLong=line.text.length>cm.options.maxHighlightLength,highlighted=highlightLine(cm,line,tooLong?copyState(doc.mode,state):state,!0);line.styles=highlighted.styles;var oldCls=line.styleClasses,newCls=highlighted.classes;newCls?line.styleClasses=newCls:oldCls&&(line.styleClasses=null);for(var ischange=!oldStyles||oldStyles.length!=line.styles.length||oldCls!=newCls&&(!oldCls||!newCls||oldCls.bgClass!=newCls.bgClass||oldCls.textClass!=newCls.textClass),i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];ischange&&changedLines.push(doc.frontier),line.stateAfter=tooLong?state:copyState(doc.mode,state)}else line.text.length<=cm.options.maxHighlightLength&&processLine(cm,line.text,state),line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null;return++doc.frontier,+new Date>end?(startWorker(cm,cm.options.workDelay),!0):void 0}),changedLines.length&&runInOp(cm,function(){for(var i=0;i<changedLines.length;i++)regLineChange(cm,changedLines[i],"text")})}}function findStartLine(cm,n,precise){for(var minindent,minline,doc=cm.doc,lim=precise?-1:n-(cm.doc.mode.innerMode?1e3:100),search=n;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter&&(!precise||search<=doc.frontier))return search;var indented=countColumn(line.text,null,cm.options.tabSize);(null==minline||minindent>indented)&&(minline=search-1,minindent=indented)}return minline}function getStateBefore(cm,n,precise){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return!0;var pos=findStartLine(cm,n,precise),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;return state=state?copyState(doc.mode,state):startState(doc.mode),doc.iter(pos,n,function(line){processLine(cm,line.text,state);var save=pos==n-1||pos%5==0||pos>=display.viewFrom&&pos<display.viewTo;line.stateAfter=save?copyState(doc.mode,state):null,++pos}),precise&&(doc.frontier=pos),state}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingH(display){if(display.cachedPaddingH)return display.cachedPaddingH;var e=removeChildrenAndAdd(display.measure,elt("pre","x")),style=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,data={left:parseInt(style.paddingLeft),right:parseInt(style.paddingRight)};return isNaN(data.left)||isNaN(data.right)||(display.cachedPaddingH=data),data}function scrollGap(cm){return scrollerGap-cm.display.nativeBarWidth}function displayWidth(cm){return cm.display.scroller.clientWidth-scrollGap(cm)-cm.display.barWidth}function displayHeight(cm){return cm.display.scroller.clientHeight-scrollGap(cm)-cm.display.barHeight}function ensureLineHeights(cm,lineView,rect){var wrapping=cm.options.lineWrapping,curWidth=wrapping&&displayWidth(cm);if(!lineView.measure.heights||wrapping&&lineView.measure.width!=curWidth){var heights=lineView.measure.heights=[];if(wrapping){lineView.measure.width=curWidth;for(var rects=lineView.text.firstChild.getClientRects(),i=0;i<rects.length-1;i++){var cur=rects[i],next=rects[i+1];Math.abs(cur.bottom-next.bottom)>2&&heights.push((cur.bottom+next.top)/2-rect.top)}}heights.push(rect.bottom-rect.top)}}function mapFromLineView(lineView,line,lineN){if(lineView.line==line)return{map:lineView.measure.map,cache:lineView.measure.cache};for(var i=0;i<lineView.rest.length;i++)if(lineView.rest[i]==line)return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i]};for(var i=0;i<lineView.rest.length;i++)if(lineNo(lineView.rest[i])>lineN)return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i],before:!0}}function updateExternalMeasurement(cm,line){line=visualLine(line);var lineN=lineNo(line),view=cm.display.externalMeasured=new LineView(cm.doc,line,lineN);view.lineN=lineN;var built=view.built=buildLineContent(cm,view);return view.text=built.pre,removeChildrenAndAdd(cm.display.lineMeasure,built.pre),view}function measureChar(cm,line,ch,bias){return measureCharPrepared(cm,prepareMeasureForLine(cm,line),ch,bias)}function findViewForLine(cm,lineN){if(lineN>=cm.display.viewFrom&&lineN<cm.display.viewTo)return cm.display.view[findViewIndex(cm,lineN)];var ext=cm.display.externalMeasured;return ext&&lineN>=ext.lineN&&lineN<ext.lineN+ext.size?ext:void 0}function prepareMeasureForLine(cm,line){var lineN=lineNo(line),view=findViewForLine(cm,lineN);view&&!view.text?view=null:view&&view.changes&&(updateLineForChanges(cm,view,lineN,getDimensions(cm)),cm.curOp.forceUpdate=!0),view||(view=updateExternalMeasurement(cm,line));var info=mapFromLineView(view,line,lineN);return{line:line,view:view,rect:null,map:info.map,cache:info.cache,before:info.before,hasHeights:!1}}function measureCharPrepared(cm,prepared,ch,bias,varHeight){prepared.before&&(ch=-1);var found,key=ch+(bias||"");return prepared.cache.hasOwnProperty(key)?found=prepared.cache[key]:(prepared.rect||(prepared.rect=prepared.view.text.getBoundingClientRect()),prepared.hasHeights||(ensureLineHeights(cm,prepared.view,prepared.rect),prepared.hasHeights=!0),found=measureCharInner(cm,prepared,ch,bias),found.bogus||(prepared.cache[key]=found)),{left:found.left,right:found.right,top:varHeight?found.rtop:found.top,bottom:varHeight?found.rbottom:found.bottom}}function nodeAndOffsetInLineMap(map,ch,bias){for(var node,start,end,collapse,i=0;i<map.length;i+=3){var mStart=map[i],mEnd=map[i+1];if(mStart>ch?(start=0,end=1,collapse="left"):mEnd>ch?(start=ch-mStart,end=start+1):(i==map.length-3||ch==mEnd&&map[i+3]>ch)&&(end=mEnd-mStart,start=end-1,ch>=mEnd&&(collapse="right")),null!=start){if(node=map[i+2],mStart==mEnd&&bias==(node.insertLeft?"left":"right")&&(collapse=bias),"left"==bias&&0==start)for(;i&&map[i-2]==map[i-3]&&map[i-1].insertLeft;)node=map[(i-=3)+2],collapse="left";if("right"==bias&&start==mEnd-mStart)for(;i<map.length-3&&map[i+3]==map[i+4]&&!map[i+5].insertLeft;)node=map[(i+=3)+2],collapse="right";break}}return{node:node,start:start,end:end,collapse:collapse,coverStart:mStart,coverEnd:mEnd}}function measureCharInner(cm,prepared,ch,bias){var rect,place=nodeAndOffsetInLineMap(prepared.map,ch,bias),node=place.node,start=place.start,end=place.end,collapse=place.collapse;if(3==node.nodeType){for(var i=0;4>i;i++){for(;start&&isExtendingChar(prepared.line.text.charAt(place.coverStart+start));)--start;for(;place.coverStart+end<place.coverEnd&&isExtendingChar(prepared.line.text.charAt(place.coverStart+end));)++end;if(ie&&9>ie_version&&0==start&&end==place.coverEnd-place.coverStart)rect=node.parentNode.getBoundingClientRect();else if(ie&&cm.options.lineWrapping){var rects=range(node,start,end).getClientRects();rect=rects.length?rects["right"==bias?rects.length-1:0]:nullRect}else rect=range(node,start,end).getBoundingClientRect()||nullRect;if(rect.left||rect.right||0==start)break;end=start,start-=1,collapse="right"}ie&&11>ie_version&&(rect=maybeUpdateRectForZooming(cm.display.measure,rect))}else{start>0&&(collapse=bias="right");var rects;rect=cm.options.lineWrapping&&(rects=node.getClientRects()).length>1?rects["right"==bias?rects.length-1:0]:node.getBoundingClientRect()}if(ie&&9>ie_version&&!start&&(!rect||!rect.left&&!rect.right)){var rSpan=node.parentNode.getClientRects()[0];rect=rSpan?{left:rSpan.left,right:rSpan.left+charWidth(cm.display),top:rSpan.top,bottom:rSpan.bottom}:nullRect}for(var rtop=rect.top-prepared.rect.top,rbot=rect.bottom-prepared.rect.top,mid=(rtop+rbot)/2,heights=prepared.view.measure.heights,i=0;i<heights.length-1&&!(mid<heights[i]);i++);var top=i?heights[i-1]:0,bot=heights[i],result={left:("right"==collapse?rect.right:rect.left)-prepared.rect.left,right:("left"==collapse?rect.left:rect.right)-prepared.rect.left,top:top,bottom:bot};return rect.left||rect.right||(result.bogus=!0),cm.options.singleCursorHeightPerLine||(result.rtop=rtop,result.rbottom=rbot),result}function maybeUpdateRectForZooming(measure,rect){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!hasBadZoomedRects(measure))return rect;var scaleX=screen.logicalXDPI/screen.deviceXDPI,scaleY=screen.logicalYDPI/screen.deviceYDPI;return{left:rect.left*scaleX,right:rect.right*scaleX,top:rect.top*scaleY,bottom:rect.bottom*scaleY}}function clearLineMeasurementCacheFor(lineView){if(lineView.measure&&(lineView.measure.cache={},lineView.measure.heights=null,lineView.rest))for(var i=0;i<lineView.rest.length;i++)lineView.measure.caches[i]={}}function clearLineMeasurementCache(cm){cm.display.externalMeasure=null,removeChildren(cm.display.lineMeasure);for(var i=0;i<cm.display.view.length;i++)clearLineMeasurementCacheFor(cm.display.view[i])}function clearCaches(cm){clearLineMeasurementCache(cm),cm.display.cachedCharWidth=cm.display.cachedTextHeight=cm.display.cachedPaddingH=null,cm.options.lineWrapping||(cm.display.maxLineChanged=!0),cm.display.lineNumChars=null}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size,rect.bottom+=size}if("line"==context)return rect;context||(context="local");var yOff=heightAtLine(lineObj);if("local"==context?yOff+=paddingTop(cm.display):yOff-=cm.display.viewOffset,"page"==context||"window"==context){var lOff=cm.display.lineSpace.getBoundingClientRect();yOff+=lOff.top+("window"==context?0:pageScrollY());var xOff=lOff.left+("window"==context?0:pageScrollX());rect.left+=xOff,rect.right+=xOff}return rect.top+=yOff,rect.bottom+=yOff,rect}function fromCoordSystem(cm,coords,context){if("div"==context)return coords;var left=coords.left,top=coords.top;if("page"==context)left-=pageScrollX(),top-=pageScrollY();else if("local"==context||!context){var localBox=cm.display.sizer.getBoundingClientRect();left+=localBox.left,top+=localBox.top}var lineSpaceBox=cm.display.lineSpace.getBoundingClientRect();return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj,bias){return lineObj||(lineObj=getLine(cm.doc,pos.line)),intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch,bias),context)}function cursorCoords(cm,pos,context,lineObj,preparedMeasure,varHeight){function get(ch,right){var m=measureCharPrepared(cm,preparedMeasure,ch,right?"right":"left",varHeight);return right?m.left=m.right:m.right=m.left,intoCoordSystem(cm,lineObj,m,context)}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;return ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level?(part=order[--partPos],ch=bidiRight(part)-(part.level%2?0:1),right=!0):ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level&&(part=order[++partPos],ch=bidiLeft(part)-part.level%2,right=!1),right&&ch==part.to&&ch>part.from?get(ch-1):get(ch,right)}lineObj=lineObj||getLine(cm.doc,pos.line),preparedMeasure||(preparedMeasure=prepareMeasureForLine(cm,lineObj));var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var partPos=getBidiPartAt(order,ch),val=getBidi(ch,partPos);return null!=bidiOther&&(val.other=getBidi(ch,bidiOther)),val}function estimateCoords(cm,pos){var left=0,pos=clipPos(cm.doc,pos);cm.options.lineWrapping||(left=charWidth(cm.display)*pos.ch);var lineObj=getLine(cm.doc,pos.line),top=heightAtLine(lineObj)+paddingTop(cm.display);return{left:left,right:left,top:top,bottom:top+lineObj.height}}function PosWithInfo(line,ch,outside,xRel){var pos=Pos(line,ch);return pos.xRel=xRel,outside&&(pos.outside=!0),pos}function coordsChar(cm,x,y){var doc=cm.doc;if(y+=cm.display.viewOffset,0>y)return PosWithInfo(doc.first,0,!0,-1);var lineN=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineN>last)return PosWithInfo(doc.first+doc.size-1,getLine(doc,last).text.length,!0,1);0>x&&(x=0);for(var lineObj=getLine(doc,lineN);;){var found=coordsCharInner(cm,lineObj,lineN,x,y),merged=collapsedSpanAtEnd(lineObj),mergedPos=merged&&merged.find(0,!0);if(!merged||!(found.ch>mergedPos.from.ch||found.ch==mergedPos.from.ch&&found.xRel>0))return found;lineN=lineNo(lineObj=mergedPos.to.line)}}function coordsCharInner(cm,lineObj,lineNo,x,y){function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),"line",lineObj,preparedMeasure);return wrongLine=!0,innerOff>sp.bottom?sp.left-adjust:innerOff<sp.top?sp.left+adjust:(wrongLine=!1,sp.left)}var innerOff=y-heightAtLine(lineObj),wrongLine=!1,adjust=2*cm.display.wrapper.clientWidth,preparedMeasure=prepareMeasureForLine(cm,lineObj),bidi=getOrder(lineObj),dist=lineObj.text.length,from=lineLeft(lineObj),to=lineRight(lineObj),fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosWithInfo(lineNo,to,toOutside,1);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):1>=to-from){for(var ch=fromX>x||toX-x>=x-fromX?from:to,xDiff=x-(ch==from?fromX:toX);isExtendingChar(lineObj.text.charAt(ch));)++ch;var pos=PosWithInfo(lineNo,ch,ch==from?fromOutside:toOutside,-1>xDiff?-1:xDiff>1?1:0);return pos}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;step>i;++i)middle=moveVisually(lineObj,middle,1)}var middleX=getX(middle);middleX>x?(to=middle,toX=middleX,(toOutside=wrongLine)&&(toX+=1e3),dist=step):(from=middle,fromX=middleX,fromOutside=wrongLine,dist-=step)}}function textHeight(display){if(null!=display.cachedTextHeight)return display.cachedTextHeight;if(null==measureText){measureText=elt("pre");for(var i=0;49>i;++i)measureText.appendChild(document.createTextNode("x")),measureText.appendChild(elt("br"));measureText.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;return height>3&&(display.cachedTextHeight=height),removeChildren(display.measure),height||1}function charWidth(display){if(null!=display.cachedCharWidth)return display.cachedCharWidth;var anchor=elt("span","xxxxxxxxxx"),pre=elt("pre",[anchor]);removeChildrenAndAdd(display.measure,pre);var rect=anchor.getBoundingClientRect(),width=(rect.right-rect.left)/10;return width>2&&(display.cachedCharWidth=width),width||10}function startOperation(cm){cm.curOp={cm:cm,viewChanged:!1,startHeight:cm.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++nextOpId},operationGroup?operationGroup.ops.push(cm.curOp):cm.curOp.ownsGroup=operationGroup={ops:[cm.curOp],delayedCallbacks:[]}}function fireCallbacksForOps(group){var callbacks=group.delayedCallbacks,i=0;do{for(;i<callbacks.length;i++)callbacks[i].call(null);for(var j=0;j<group.ops.length;j++){var op=group.ops[j];if(op.cursorActivityHandlers)for(;op.cursorActivityCalled<op.cursorActivityHandlers.length;)op.cursorActivityHandlers[op.cursorActivityCalled++].call(null,op.cm)}}while(i<callbacks.length)}function endOperation(cm){var op=cm.curOp,group=op.ownsGroup;if(group)try{fireCallbacksForOps(group)}finally{operationGroup=null;for(var i=0;i<group.ops.length;i++)group.ops[i].cm.curOp=null;endOperations(group)}}function endOperations(group){for(var ops=group.ops,i=0;i<ops.length;i++)endOperation_R1(ops[i]);for(var i=0;i<ops.length;i++)endOperation_W1(ops[i]);for(var i=0;i<ops.length;i++)endOperation_R2(ops[i]);for(var i=0;i<ops.length;i++)endOperation_W2(ops[i]);for(var i=0;i<ops.length;i++)endOperation_finish(ops[i])}function endOperation_R1(op){var cm=op.cm,display=cm.display;maybeClipScrollbars(cm),op.updateMaxLine&&findMaxLine(cm),op.mustUpdate=op.viewChanged||op.forceUpdate||null!=op.scrollTop||op.scrollToPos&&(op.scrollToPos.from.line<display.viewFrom||op.scrollToPos.to.line>=display.viewTo)||display.maxLineChanged&&cm.options.lineWrapping,op.update=op.mustUpdate&&new DisplayUpdate(cm,op.mustUpdate&&{top:op.scrollTop,ensure:op.scrollToPos},op.forceUpdate)}function endOperation_W1(op){op.updatedDisplay=op.mustUpdate&&updateDisplayIfNeeded(op.cm,op.update)}function endOperation_R2(op){var cm=op.cm,display=cm.display;op.updatedDisplay&&updateHeightsInViewport(cm),op.barMeasure=measureForScrollbars(cm),display.maxLineChanged&&!cm.options.lineWrapping&&(op.adjustWidthTo=measureChar(cm,display.maxLine,display.maxLine.text.length).left+3,cm.display.sizerWidth=op.adjustWidthTo,op.barMeasure.scrollWidth=Math.max(display.scroller.clientWidth,display.sizer.offsetLeft+op.adjustWidthTo+scrollGap(cm)+cm.display.barWidth),op.maxScrollLeft=Math.max(0,display.sizer.offsetLeft+op.adjustWidthTo-displayWidth(cm))),(op.updatedDisplay||op.selectionChanged)&&(op.preparedSelection=display.input.prepareSelection())}function endOperation_W2(op){var cm=op.cm;null!=op.adjustWidthTo&&(cm.display.sizer.style.minWidth=op.adjustWidthTo+"px",op.maxScrollLeft<cm.doc.scrollLeft&&setScrollLeft(cm,Math.min(cm.display.scroller.scrollLeft,op.maxScrollLeft),!0),cm.display.maxLineChanged=!1),op.preparedSelection&&cm.display.input.showSelection(op.preparedSelection),op.updatedDisplay&&setDocumentHeight(cm,op.barMeasure),(op.updatedDisplay||op.startHeight!=cm.doc.height)&&updateScrollbars(cm,op.barMeasure),op.selectionChanged&&restartBlink(cm),cm.state.focused&&op.updateInput&&cm.display.input.reset(op.typing),!op.focus||op.focus!=activeElt()||document.hasFocus&&!document.hasFocus()||ensureFocus(op.cm)}function endOperation_finish(op){var cm=op.cm,display=cm.display,doc=cm.doc;if(op.updatedDisplay&&postUpdateDisplay(cm,op.update),null==display.wheelStartX||null==op.scrollTop&&null==op.scrollLeft&&!op.scrollToPos||(display.wheelStartX=display.wheelStartY=null),null==op.scrollTop||display.scroller.scrollTop==op.scrollTop&&!op.forceScroll||(doc.scrollTop=Math.max(0,Math.min(display.scroller.scrollHeight-display.scroller.clientHeight,op.scrollTop)),display.scrollbars.setScrollTop(doc.scrollTop),display.scroller.scrollTop=doc.scrollTop),null==op.scrollLeft||display.scroller.scrollLeft==op.scrollLeft&&!op.forceScroll||(doc.scrollLeft=Math.max(0,Math.min(display.scroller.scrollWidth-displayWidth(cm),op.scrollLeft)),display.scrollbars.setScrollLeft(doc.scrollLeft),display.scroller.scrollLeft=doc.scrollLeft,alignHorizontally(cm)),op.scrollToPos){var coords=scrollPosIntoView(cm,clipPos(doc,op.scrollToPos.from),clipPos(doc,op.scrollToPos.to),op.scrollToPos.margin);op.scrollToPos.isCursor&&cm.state.focused&&maybeScrollWindow(cm,coords)}var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)hidden[i].lines.length||signal(hidden[i],"hide");if(unhidden)for(var i=0;i<unhidden.length;++i)unhidden[i].lines.length&&signal(unhidden[i],"unhide");display.wrapper.offsetHeight&&(doc.scrollTop=cm.display.scroller.scrollTop),op.changeObjs&&signal(cm,"changes",cm,op.changeObjs),op.update&&op.update.finish()}function runInOp(cm,f){if(cm.curOp)return f();startOperation(cm);try{return f()}finally{endOperation(cm)}}function operation(cm,f){return function(){if(cm.curOp)return f.apply(cm,arguments);startOperation(cm);try{return f.apply(cm,arguments)}finally{endOperation(cm)}}}function methodOp(f){return function(){if(this.curOp)return f.apply(this,arguments);startOperation(this);try{return f.apply(this,arguments)}finally{endOperation(this)}}}function docMethodOp(f){return function(){var cm=this.cm;if(!cm||cm.curOp)return f.apply(this,arguments);startOperation(cm);try{return f.apply(this,arguments)}finally{endOperation(cm)}}}function LineView(doc,line,lineN){this.line=line,this.rest=visualLineContinued(line),this.size=this.rest?lineNo(lst(this.rest))-lineN+1:1,this.node=this.text=null,this.hidden=lineIsHidden(doc,line)}function buildViewArray(cm,from,to){for(var nextPos,array=[],pos=from;to>pos;pos=nextPos){var view=new LineView(cm.doc,getLine(cm.doc,pos),pos);nextPos=pos+view.size,array.push(view)}return array}function regChange(cm,from,to,lendiff){null==from&&(from=cm.doc.first),null==to&&(to=cm.doc.first+cm.doc.size),lendiff||(lendiff=0);var display=cm.display;if(lendiff&&to<display.viewTo&&(null==display.updateLineNumbers||display.updateLineNumbers>from)&&(display.updateLineNumbers=from),cm.curOp.viewChanged=!0,from>=display.viewTo)sawCollapsedSpans&&visualLineNo(cm.doc,from)<display.viewTo&&resetView(cm);else if(to<=display.viewFrom)sawCollapsedSpans&&visualLineEndNo(cm.doc,to+lendiff)>display.viewFrom?resetView(cm):(display.viewFrom+=lendiff,display.viewTo+=lendiff);else if(from<=display.viewFrom&&to>=display.viewTo)resetView(cm);else if(from<=display.viewFrom){var cut=viewCuttingPoint(cm,to,to+lendiff,1);cut?(display.view=display.view.slice(cut.index),display.viewFrom=cut.lineN,display.viewTo+=lendiff):resetView(cm)}else if(to>=display.viewTo){var cut=viewCuttingPoint(cm,from,from,-1);cut?(display.view=display.view.slice(0,cut.index),display.viewTo=cut.lineN):resetView(cm)}else{var cutTop=viewCuttingPoint(cm,from,from,-1),cutBot=viewCuttingPoint(cm,to,to+lendiff,1);cutTop&&cutBot?(display.view=display.view.slice(0,cutTop.index).concat(buildViewArray(cm,cutTop.lineN,cutBot.lineN)).concat(display.view.slice(cutBot.index)),display.viewTo+=lendiff):resetView(cm)}var ext=display.externalMeasured;ext&&(to<ext.lineN?ext.lineN+=lendiff:from<ext.lineN+ext.size&&(display.externalMeasured=null))}function regLineChange(cm,line,type){cm.curOp.viewChanged=!0;var display=cm.display,ext=cm.display.externalMeasured;if(ext&&line>=ext.lineN&&line<ext.lineN+ext.size&&(display.externalMeasured=null),!(line<display.viewFrom||line>=display.viewTo)){var lineView=display.view[findViewIndex(cm,line)];if(null!=lineView.node){var arr=lineView.changes||(lineView.changes=[]);-1==indexOf(arr,type)&&arr.push(type)}}}function resetView(cm){cm.display.viewFrom=cm.display.viewTo=cm.doc.first,cm.display.view=[],cm.display.viewOffset=0}function findViewIndex(cm,n){if(n>=cm.display.viewTo)return null;if(n-=cm.display.viewFrom,0>n)return null;for(var view=cm.display.view,i=0;i<view.length;i++)if(n-=view[i].size,0>n)return i}function viewCuttingPoint(cm,oldN,newN,dir){var diff,index=findViewIndex(cm,oldN),view=cm.display.view;if(!sawCollapsedSpans||newN==cm.doc.first+cm.doc.size)return{index:index,lineN:newN};for(var i=0,n=cm.display.viewFrom;index>i;i++)n+=view[i].size;if(n!=oldN){if(dir>0){if(index==view.length-1)return null;diff=n+view[index].size-oldN,index++}else diff=n-oldN;oldN+=diff,newN+=diff}for(;visualLineNo(cm.doc,newN)!=newN;){if(index==(0>dir?0:view.length-1))return null;newN+=dir*view[index-(0>dir?1:0)].size,index+=dir}return{index:index,lineN:newN}}function adjustView(cm,from,to){var display=cm.display,view=display.view;0==view.length||from>=display.viewTo||to<=display.viewFrom?(display.view=buildViewArray(cm,from,to),display.viewFrom=from):(display.viewFrom>from?display.view=buildViewArray(cm,from,display.viewFrom).concat(display.view):display.viewFrom<from&&(display.view=display.view.slice(findViewIndex(cm,from))),display.viewFrom=from,display.viewTo<to?display.view=display.view.concat(buildViewArray(cm,display.viewTo,to)):display.viewTo>to&&(display.view=display.view.slice(0,findViewIndex(cm,to)))),display.viewTo=to}function countDirtyView(cm){for(var view=cm.display.view,dirty=0,i=0;i<view.length;i++){var lineView=view[i];lineView.hidden||lineView.node&&!lineView.changes||++dirty}return dirty}function registerEventHandlers(cm){function finishTouch(){d.activeTouch&&(touchFinished=setTimeout(function(){d.activeTouch=null},1e3),prevTouch=d.activeTouch,prevTouch.end=+new Date)}function isMouseLikeTouchEvent(e){if(1!=e.touches.length)return!1;var touch=e.touches[0];return touch.radiusX<=1&&touch.radiusY<=1}function farAway(touch,other){if(null==other.left)return!0;var dx=other.left-touch.left,dy=other.top-touch.top;return dx*dx+dy*dy>400}var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown)),ie&&11>ie_version?on(d.scroller,"dblclick",operation(cm,function(e){if(!signalDOMEvent(cm,e)){var pos=posFromMouse(cm,e);if(pos&&!clickInGutter(cm,e)&&!eventInWidget(cm.display,e)){e_preventDefault(e);var word=cm.findWordAt(pos);extendSelection(cm.doc,word.anchor,word.head)}}})):on(d.scroller,"dblclick",function(e){signalDOMEvent(cm,e)||e_preventDefault(e)}),captureRightClick||on(d.scroller,"contextmenu",function(e){onContextMenu(cm,e)});var touchFinished,prevTouch={end:0};on(d.scroller,"touchstart",function(e){if(!signalDOMEvent(cm,e)&&!isMouseLikeTouchEvent(e)){clearTimeout(touchFinished);var now=+new Date;d.activeTouch={start:now,moved:!1,prev:now-prevTouch.end<=300?prevTouch:null},1==e.touches.length&&(d.activeTouch.left=e.touches[0].pageX,d.activeTouch.top=e.touches[0].pageY)
}}),on(d.scroller,"touchmove",function(){d.activeTouch&&(d.activeTouch.moved=!0)}),on(d.scroller,"touchend",function(e){var touch=d.activeTouch;if(touch&&!eventInWidget(d,e)&&null!=touch.left&&!touch.moved&&new Date-touch.start<300){var range,pos=cm.coordsChar(d.activeTouch,"page");range=!touch.prev||farAway(touch,touch.prev)?new Range(pos,pos):!touch.prev.prev||farAway(touch,touch.prev.prev)?cm.findWordAt(pos):new Range(Pos(pos.line,0),clipPos(cm.doc,Pos(pos.line+1,0))),cm.setSelection(range.anchor,range.head),cm.focus(),e_preventDefault(e)}finishTouch()}),on(d.scroller,"touchcancel",finishTouch),on(d.scroller,"scroll",function(){d.scroller.clientHeight&&(setScrollTop(cm,d.scroller.scrollTop),setScrollLeft(cm,d.scroller.scrollLeft,!0),signal(cm,"scroll",cm))}),on(d.scroller,"mousewheel",function(e){onScrollWheel(cm,e)}),on(d.scroller,"DOMMouseScroll",function(e){onScrollWheel(cm,e)}),on(d.wrapper,"scroll",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0}),d.dragFunctions={enter:function(e){signalDOMEvent(cm,e)||e_stop(e)},over:function(e){signalDOMEvent(cm,e)||(onDragOver(cm,e),e_stop(e))},start:function(e){onDragStart(cm,e)},drop:operation(cm,onDrop),leave:function(){clearDragCursor(cm)}};var inp=d.input.getField();on(inp,"keyup",function(e){onKeyUp.call(cm,e)}),on(inp,"keydown",operation(cm,onKeyDown)),on(inp,"keypress",operation(cm,onKeyPress)),on(inp,"focus",bind(onFocus,cm)),on(inp,"blur",bind(onBlur,cm))}function dragDropChanged(cm,value,old){var wasOn=old&&old!=CodeMirror.Init;if(!value!=!wasOn){var funcs=cm.display.dragFunctions,toggle=value?on:off;toggle(cm.display.scroller,"dragstart",funcs.start),toggle(cm.display.scroller,"dragenter",funcs.enter),toggle(cm.display.scroller,"dragover",funcs.over),toggle(cm.display.scroller,"dragleave",funcs.leave),toggle(cm.display.scroller,"drop",funcs.drop)}}function onResize(cm){var d=cm.display;(d.lastWrapHeight!=d.wrapper.clientHeight||d.lastWrapWidth!=d.wrapper.clientWidth)&&(d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null,d.scrollbarsClipped=!1,cm.setSize())}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==display.sizer&&n!=display.mover)return!0}function posFromMouse(cm,e,liberal,forRect){var display=cm.display;if(!liberal&&"true"==e_target(e).getAttribute("cm-not-content"))return null;var x,y,space=display.lineSpace.getBoundingClientRect();try{x=e.clientX-space.left,y=e.clientY-space.top}catch(e){return null}var line,coords=coordsChar(cm,x,y);if(forRect&&1==coords.xRel&&(line=getLine(cm.doc,coords.line).text).length==coords.ch){var colDiff=countColumn(line,line.length,cm.options.tabSize)-line.length;coords=Pos(coords.line,Math.max(0,Math.round((x-paddingH(cm.display).left)/charWidth(cm.display))-colDiff))}return coords}function onMouseDown(e){var cm=this,display=cm.display;if(!(signalDOMEvent(cm,e)||display.activeTouch&&display.input.supportsTouch())){if(display.shift=e.shiftKey,eventInWidget(display,e))return webkit||(display.scroller.draggable=!1,setTimeout(function(){display.scroller.draggable=!0},100)),void 0;if(!clickInGutter(cm,e)){var start=posFromMouse(cm,e);switch(window.focus(),e_button(e)){case 1:cm.state.selectingText?cm.state.selectingText(e):start?leftButtonDown(cm,e,start):e_target(e)==display.scroller&&e_preventDefault(e);break;case 2:webkit&&(cm.state.lastMiddleDown=+new Date),start&&extendSelection(cm.doc,start),setTimeout(function(){display.input.focus()},20),e_preventDefault(e);break;case 3:captureRightClick?onContextMenu(cm,e):delayBlurEvent(cm)}}}}function leftButtonDown(cm,e,start){ie?setTimeout(bind(ensureFocus,cm),0):cm.curOp.focus=activeElt();var type,now=+new Date;lastDoubleClick&&lastDoubleClick.time>now-400&&0==cmp(lastDoubleClick.pos,start)?type="triple":lastClick&&lastClick.time>now-400&&0==cmp(lastClick.pos,start)?(type="double",lastDoubleClick={time:now,pos:start}):(type="single",lastClick={time:now,pos:start});var contained,sel=cm.doc.sel,modifier=mac?e.metaKey:e.ctrlKey;cm.options.dragDrop&&dragAndDrop&&!cm.isReadOnly()&&"single"==type&&(contained=sel.contains(start))>-1&&(cmp((contained=sel.ranges[contained]).from(),start)<0||start.xRel>0)&&(cmp(contained.to(),start)>0||start.xRel<0)?leftButtonStartDrag(cm,e,start,modifier):leftButtonSelect(cm,e,start,type,modifier)}function leftButtonStartDrag(cm,e,start,modifier){var display=cm.display,startTime=+new Date,dragEnd=operation(cm,function(e2){webkit&&(display.scroller.draggable=!1),cm.state.draggingText=!1,off(document,"mouseup",dragEnd),off(display.scroller,"drop",dragEnd),Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10&&(e_preventDefault(e2),!modifier&&+new Date-200<startTime&&extendSelection(cm.doc,start),webkit||ie&&9==ie_version?setTimeout(function(){document.body.focus(),display.input.focus()},20):display.input.focus())});webkit&&(display.scroller.draggable=!0),cm.state.draggingText=dragEnd,display.scroller.dragDrop&&display.scroller.dragDrop(),on(document,"mouseup",dragEnd),on(display.scroller,"drop",dragEnd)}function leftButtonSelect(cm,e,start,type,addNew){function extendTo(pos){if(0!=cmp(lastPos,pos))if(lastPos=pos,"rect"==type){for(var ranges=[],tabSize=cm.options.tabSize,startCol=countColumn(getLine(doc,start.line).text,start.ch,tabSize),posCol=countColumn(getLine(doc,pos.line).text,pos.ch,tabSize),left=Math.min(startCol,posCol),right=Math.max(startCol,posCol),line=Math.min(start.line,pos.line),end=Math.min(cm.lastLine(),Math.max(start.line,pos.line));end>=line;line++){var text=getLine(doc,line).text,leftPos=findColumn(text,left,tabSize);left==right?ranges.push(new Range(Pos(line,leftPos),Pos(line,leftPos))):text.length>leftPos&&ranges.push(new Range(Pos(line,leftPos),Pos(line,findColumn(text,right,tabSize))))}ranges.length||ranges.push(new Range(start,start)),setSelection(doc,normalizeSelection(startSel.ranges.slice(0,ourIndex).concat(ranges),ourIndex),{origin:"*mouse",scroll:!1}),cm.scrollIntoView(pos)}else{var oldRange=ourRange,anchor=oldRange.anchor,head=pos;if("single"!=type){if("double"==type)var range=cm.findWordAt(pos);else var range=new Range(Pos(pos.line,0),clipPos(doc,Pos(pos.line+1,0)));cmp(range.anchor,anchor)>0?(head=range.head,anchor=minPos(oldRange.from(),range.anchor)):(head=range.anchor,anchor=maxPos(oldRange.to(),range.head))}var ranges=startSel.ranges.slice(0);ranges[ourIndex]=new Range(clipPos(doc,anchor),head),setSelection(doc,normalizeSelection(ranges,ourIndex),sel_mouse)}}function extend(e){var curCount=++counter,cur=posFromMouse(cm,e,!0,"rect"==type);if(cur)if(0!=cmp(cur,lastPos)){cm.curOp.focus=activeElt(),extendTo(cur);var visible=visibleLines(display,doc);(cur.line>=visible.to||cur.line<visible.from)&&setTimeout(operation(cm,function(){counter==curCount&&extend(e)}),150)}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;outside&&setTimeout(operation(cm,function(){counter==curCount&&(display.scroller.scrollTop+=outside,extend(e))}),50)}}function done(e){cm.state.selectingText=!1,counter=1/0,e_preventDefault(e),display.input.focus(),off(document,"mousemove",move),off(document,"mouseup",up),doc.history.lastSelOrigin=null}var display=cm.display,doc=cm.doc;e_preventDefault(e);var ourRange,ourIndex,startSel=doc.sel,ranges=startSel.ranges;if(addNew&&!e.shiftKey?(ourIndex=doc.sel.contains(start),ourRange=ourIndex>-1?ranges[ourIndex]:new Range(start,start)):(ourRange=doc.sel.primary(),ourIndex=doc.sel.primIndex),e.altKey)type="rect",addNew||(ourRange=new Range(start,start)),start=posFromMouse(cm,e,!0,!0),ourIndex=-1;else if("double"==type){var word=cm.findWordAt(start);ourRange=cm.display.shift||doc.extend?extendRange(doc,ourRange,word.anchor,word.head):word}else if("triple"==type){var line=new Range(Pos(start.line,0),clipPos(doc,Pos(start.line+1,0)));ourRange=cm.display.shift||doc.extend?extendRange(doc,ourRange,line.anchor,line.head):line}else ourRange=extendRange(doc,ourRange,start);addNew?-1==ourIndex?(ourIndex=ranges.length,setSelection(doc,normalizeSelection(ranges.concat([ourRange]),ourIndex),{scroll:!1,origin:"*mouse"})):ranges.length>1&&ranges[ourIndex].empty()&&"single"==type&&!e.shiftKey?(setSelection(doc,normalizeSelection(ranges.slice(0,ourIndex).concat(ranges.slice(ourIndex+1)),0),{scroll:!1,origin:"*mouse"}),startSel=doc.sel):replaceOneSelection(doc,ourIndex,ourRange,sel_mouse):(ourIndex=0,setSelection(doc,new Selection([ourRange],0),sel_mouse),startSel=doc.sel);var lastPos=start,editorSize=display.wrapper.getBoundingClientRect(),counter=0,move=operation(cm,function(e){e_button(e)?extend(e):done(e)}),up=operation(cm,done);cm.state.selectingText=up,on(document,"mousemove",move),on(document,"mouseup",up)}function gutterEvent(cm,e,type,prevent){try{var mX=e.clientX,mY=e.clientY}catch(e){return!1}if(mX>=Math.floor(cm.display.gutters.getBoundingClientRect().right))return!1;prevent&&e_preventDefault(e);var display=cm.display,lineBox=display.lineDiv.getBoundingClientRect();if(mY>lineBox.bottom||!hasHandler(cm,type))return e_defaultPrevented(e);mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&g.getBoundingClientRect().right>=mX){var line=lineAtHeight(cm.doc,mY),gutter=cm.options.gutters[i];return signal(cm,type,cm,line,gutter,e),e_defaultPrevented(e)}}}function clickInGutter(cm,e){return gutterEvent(cm,e,"gutterClick",!0)}function onDrop(e){var cm=this;if(clearDragCursor(cm),!signalDOMEvent(cm,e)&&!eventInWidget(cm.display,e)){e_preventDefault(e),ie&&(lastDrop=+new Date);var pos=posFromMouse(cm,e,!0),files=e.dataTransfer.files;if(pos&&!cm.isReadOnly())if(files&&files.length&&window.FileReader&&window.File)for(var n=files.length,text=Array(n),read=0,loadFile=function(file,i){if(!cm.options.allowDropFileTypes||-1!=indexOf(cm.options.allowDropFileTypes,file.type)){var reader=new FileReader;reader.onload=operation(cm,function(){var content=reader.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(content)&&(content=""),text[i]=content,++read==n){pos=clipPos(cm.doc,pos);var change={from:pos,to:pos,text:cm.doc.splitLines(text.join(cm.doc.lineSeparator())),origin:"paste"};makeChange(cm.doc,change),setSelectionReplaceHistory(cm.doc,simpleSelection(pos,changeEnd(change)))}}),reader.readAsText(file)}},i=0;n>i;++i)loadFile(files[i],i);else{if(cm.state.draggingText&&cm.doc.sel.contains(pos)>-1)return cm.state.draggingText(e),setTimeout(function(){cm.display.input.focus()},20),void 0;try{var text=e.dataTransfer.getData("Text");if(text){if(cm.state.draggingText&&!(mac?e.altKey:e.ctrlKey))var selected=cm.listSelections();if(setSelectionNoUndo(cm.doc,simpleSelection(pos,pos)),selected)for(var i=0;i<selected.length;++i)replaceRange(cm.doc,"",selected[i].anchor,selected[i].head,"drag");cm.replaceSelection(text,"around","paste"),cm.display.input.focus()}}catch(e){}}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date-lastDrop<100))return e_stop(e),void 0;if(!signalDOMEvent(cm,e)&&!eventInWidget(cm.display,e)&&(e.dataTransfer.setData("Text",cm.getSelection()),e.dataTransfer.setDragImage&&!safari)){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",presto&&(img.width=img.height=1,cm.display.wrapper.appendChild(img),img._top=img.offsetTop),e.dataTransfer.setDragImage(img,0,0),presto&&img.parentNode.removeChild(img)}}function onDragOver(cm,e){var pos=posFromMouse(cm,e);if(pos){var frag=document.createDocumentFragment();drawSelectionCursor(cm,pos,frag),cm.display.dragCursor||(cm.display.dragCursor=elt("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),cm.display.lineSpace.insertBefore(cm.display.dragCursor,cm.display.cursorDiv)),removeChildrenAndAdd(cm.display.dragCursor,frag)}}function clearDragCursor(cm){cm.display.dragCursor&&(cm.display.lineSpace.removeChild(cm.display.dragCursor),cm.display.dragCursor=null)}function setScrollTop(cm,val){Math.abs(cm.doc.scrollTop-val)<2||(cm.doc.scrollTop=val,gecko||updateDisplaySimple(cm,{top:val}),cm.display.scroller.scrollTop!=val&&(cm.display.scroller.scrollTop=val),cm.display.scrollbars.setScrollTop(val),gecko&&updateDisplaySimple(cm),startWorker(cm,100))}function setScrollLeft(cm,val,isScroller){(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)||(val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth),cm.doc.scrollLeft=val,alignHorizontally(cm),cm.display.scroller.scrollLeft!=val&&(cm.display.scroller.scrollLeft=val),cm.display.scrollbars.setScrollLeft(val))}function onScrollWheel(cm,e){var delta=wheelEventDelta(e),dx=delta.x,dy=delta.y,display=cm.display,scroll=display.scroller,canScrollX=scroll.scrollWidth>scroll.clientWidth,canScrollY=scroll.scrollHeight>scroll.clientHeight;if(dx&&canScrollX||dy&&canScrollY){if(dy&&mac&&webkit)outer:for(var cur=e.target,view=display.view;cur!=scroll;cur=cur.parentNode)for(var i=0;i<view.length;i++)if(view[i].node==cur){cm.display.currentWheelTarget=cur;break outer}if(dx&&!gecko&&!presto&&null!=wheelPixelsPerUnit)return dy&&canScrollY&&setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight))),setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth))),(!dy||dy&&canScrollY)&&e_preventDefault(e),display.wheelStartX=null,void 0;if(dy&&null!=wheelPixelsPerUnit){var pixels=dy*wheelPixelsPerUnit,top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;0>pixels?top=Math.max(0,top+pixels-50):bot=Math.min(cm.doc.height,bot+pixels+50),updateDisplaySimple(cm,{top:top,bottom:bot})}20>wheelSamples&&(null==display.wheelStartX?(display.wheelStartX=scroll.scrollLeft,display.wheelStartY=scroll.scrollTop,display.wheelDX=dx,display.wheelDY=dy,setTimeout(function(){if(null!=display.wheelStartX){var movedX=scroll.scrollLeft-display.wheelStartX,movedY=scroll.scrollTop-display.wheelStartY,sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null,sample&&(wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1),++wheelSamples)}},200)):(display.wheelDX+=dx,display.wheelDY+=dy))}}function doHandleBinding(cm,bound,dropShift){if("string"==typeof bound&&(bound=commands[bound],!bound))return!1;cm.display.input.ensurePolled();var prevShift=cm.display.shift,done=!1;try{cm.isReadOnly()&&(cm.state.suppressEdits=!0),dropShift&&(cm.display.shift=!1),done=bound(cm)!=Pass}finally{cm.display.shift=prevShift,cm.state.suppressEdits=!1}return done}function lookupKeyForEditor(cm,name,handle){for(var i=0;i<cm.state.keyMaps.length;i++){var result=lookupKey(name,cm.state.keyMaps[i],handle,cm);if(result)return result}return cm.options.extraKeys&&lookupKey(name,cm.options.extraKeys,handle,cm)||lookupKey(name,cm.options.keyMap,handle,cm)}function dispatchKey(cm,name,e,handle){var seq=cm.state.keySeq;if(seq){if(isModifierKey(name))return"handled";stopSeq.set(50,function(){cm.state.keySeq==seq&&(cm.state.keySeq=null,cm.display.input.reset())}),name=seq+" "+name}var result=lookupKeyForEditor(cm,name,handle);return"multi"==result&&(cm.state.keySeq=name),"handled"==result&&signalLater(cm,"keyHandled",cm,name,e),("handled"==result||"multi"==result)&&(e_preventDefault(e),restartBlink(cm)),seq&&!result&&/\'$/.test(name)?(e_preventDefault(e),!0):!!result}function handleKeyBinding(cm,e){var name=keyName(e,!0);return name?e.shiftKey&&!cm.state.keySeq?dispatchKey(cm,"Shift-"+name,e,function(b){return doHandleBinding(cm,b,!0)})||dispatchKey(cm,name,e,function(b){return("string"==typeof b?/^go[A-Z]/.test(b):b.motion)?doHandleBinding(cm,b):void 0}):dispatchKey(cm,name,e,function(b){return doHandleBinding(cm,b)}):!1}function handleCharBinding(cm,e,ch){return dispatchKey(cm,"'"+ch+"'",e,function(b){return doHandleBinding(cm,b,!0)})}function onKeyDown(e){var cm=this;if(cm.curOp.focus=activeElt(),!signalDOMEvent(cm,e)){ie&&11>ie_version&&27==e.keyCode&&(e.returnValue=!1);var code=e.keyCode;cm.display.shift=16==code||e.shiftKey;var handled=handleKeyBinding(cm,e);presto&&(lastStoppedKey=handled?code:null,!handled&&88==code&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey)&&cm.replaceSelection("",null,"cut")),18!=code||/\bCodeMirror-crosshair\b/.test(cm.display.lineDiv.className)||showCrossHair(cm)}}function showCrossHair(cm){function up(e){18!=e.keyCode&&e.altKey||(rmClass(lineDiv,"CodeMirror-crosshair"),off(document,"keyup",up),off(document,"mouseover",up))}var lineDiv=cm.display.lineDiv;addClass(lineDiv,"CodeMirror-crosshair"),on(document,"keyup",up),on(document,"mouseover",up)}function onKeyUp(e){16==e.keyCode&&(this.doc.sel.shift=!1),signalDOMEvent(this,e)}function onKeyPress(e){var cm=this;if(!(eventInWidget(cm.display,e)||signalDOMEvent(cm,e)||e.ctrlKey&&!e.altKey||mac&&e.metaKey)){var keyCode=e.keyCode,charCode=e.charCode;if(presto&&keyCode==lastStoppedKey)return lastStoppedKey=null,e_preventDefault(e),void 0;if(!presto||e.which&&!(e.which<10)||!handleKeyBinding(cm,e)){var ch=String.fromCharCode(null==charCode?keyCode:charCode);handleCharBinding(cm,e,ch)||cm.display.input.onKeyPress(e)}}}function delayBlurEvent(cm){cm.state.delayingBlurEvent=!0,setTimeout(function(){cm.state.delayingBlurEvent&&(cm.state.delayingBlurEvent=!1,onBlur(cm))},100)}function onFocus(cm){cm.state.delayingBlurEvent&&(cm.state.delayingBlurEvent=!1),"nocursor"!=cm.options.readOnly&&(cm.state.focused||(signal(cm,"focus",cm),cm.state.focused=!0,addClass(cm.display.wrapper,"CodeMirror-focused"),cm.curOp||cm.display.selForContextMenu==cm.doc.sel||(cm.display.input.reset(),webkit&&setTimeout(function(){cm.display.input.reset(!0)},20)),cm.display.input.receivedFocus()),restartBlink(cm))}function onBlur(cm){cm.state.delayingBlurEvent||(cm.state.focused&&(signal(cm,"blur",cm),cm.state.focused=!1,rmClass(cm.display.wrapper,"CodeMirror-focused")),clearInterval(cm.display.blinker),setTimeout(function(){cm.state.focused||(cm.display.shift=!1)},150))}function onContextMenu(cm,e){eventInWidget(cm.display,e)||contextMenuInGutter(cm,e)||signalDOMEvent(cm,e,"contextmenu")||cm.display.input.onContextMenu(e)}function contextMenuInGutter(cm,e){return hasHandler(cm,"gutterContextMenu")?gutterEvent(cm,e,"gutterContextMenu",!1):!1}function adjustForChange(pos,change){if(cmp(pos,change.from)<0)return pos;if(cmp(pos,change.to)<=0)return changeEnd(change);var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;return pos.line==change.to.line&&(ch+=changeEnd(change).ch-change.to.ch),Pos(line,ch)}function computeSelAfterChange(doc,change){for(var out=[],i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];out.push(new Range(adjustForChange(range.anchor,change),adjustForChange(range.head,change)))}return normalizeSelection(out,doc.sel.primIndex)}function offsetPos(pos,old,nw){return pos.line==old.line?Pos(nw.line,pos.ch-old.ch+nw.ch):Pos(nw.line+(pos.line-old.line),pos.ch)}function computeReplacedSel(doc,changes,hint){for(var out=[],oldPrev=Pos(doc.first,0),newPrev=oldPrev,i=0;i<changes.length;i++){var change=changes[i],from=offsetPos(change.from,oldPrev,newPrev),to=offsetPos(changeEnd(change),oldPrev,newPrev);if(oldPrev=change.to,newPrev=to,"around"==hint){var range=doc.sel.ranges[i],inv=cmp(range.head,range.anchor)<0;out[i]=new Range(inv?to:from,inv?from:to)}else out[i]=new Range(from,from)}return new Selection(out,doc.sel.primIndex)}function filterChange(doc,change,update){var obj={canceled:!1,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){this.canceled=!0}};return update&&(obj.update=function(from,to,text,origin){from&&(this.from=clipPos(doc,from)),to&&(this.to=clipPos(doc,to)),text&&(this.text=text),void 0!==origin&&(this.origin=origin)}),signal(doc,"beforeChange",doc,obj),doc.cm&&signal(doc.cm,"beforeChange",doc.cm,obj),obj.canceled?null:{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(!(hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"))||(change=filterChange(doc,change,!0))){var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split)for(var i=split.length-1;i>=0;--i)makeChangeInner(doc,{from:split[i].from,to:split[i].to,text:i?[""]:change.text});else makeChangeInner(doc,change)}}function makeChangeInner(doc,change){if(1!=change.text.length||""!=change.text[0]||0!=cmp(change.from,change.to)){var selAfter=computeSelAfterChange(doc,change);addChangeToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:0/0),makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}}function makeChangeFromHistory(doc,type,allowSelectionOnly){if(!doc.cm||!doc.cm.state.suppressEdits){for(var event,hist=doc.history,selAfter=doc.sel,source="undo"==type?hist.done:hist.undone,dest="undo"==type?hist.undone:hist.done,i=0;i<source.length&&(event=source[i],allowSelectionOnly?!event.ranges||event.equals(doc.sel):event.ranges);i++);if(i!=source.length){for(hist.lastOrigin=hist.lastSelOrigin=null;event=source.pop(),event.ranges;){if(pushSelectionToHistory(event,dest),allowSelectionOnly&&!event.equals(doc.sel))return setSelection(doc,event,{clearRedo:!1}),void 0;selAfter=event}var antiChanges=[];pushSelectionToHistory(selAfter,dest),dest.push({changes:antiChanges,generation:hist.generation}),hist.generation=event.generation||++hist.maxGeneration;for(var filter=hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"),i=event.changes.length-1;i>=0;--i){var change=event.changes[i];if(change.origin=type,filter&&!filterChange(doc,change,!1))return source.length=0,void 0;antiChanges.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change):lst(source);makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change)),!i&&doc.cm&&doc.cm.scrollIntoView({from:change.from,to:changeEnd(change)});var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})}}}}function shiftDoc(doc,distance){if(0!=distance&&(doc.first+=distance,doc.sel=new Selection(map(doc.sel.ranges,function(range){return new Range(Pos(range.anchor.line+distance,range.anchor.ch),Pos(range.head.line+distance,range.head.ch))}),doc.sel.primIndex),doc.cm)){regChange(doc.cm,doc.first,doc.first-distance,distance);for(var d=doc.cm.display,l=d.viewFrom;l<d.viewTo;l++)regLineChange(doc.cm,l,"gutter")}}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first)return shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line)),void 0;if(!(change.from.line>doc.lastLine())){if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift),change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();change.to.line>last&&(change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}),change.removed=getBetween(doc,change.from,change.to),selAfter||(selAfter=computeSelAfterChange(doc,change)),doc.cm?makeChangeSingleDocInEditor(doc.cm,change,spans):updateDoc(doc,change,spans),setSelectionNoUndo(doc,selAfter,sel_dontScroll)}}function makeChangeSingleDocInEditor(cm,change,spans){var doc=cm.doc,display=cm.display,from=change.from,to=change.to,recomputeMaxLength=!1,checkWidthStart=from.line;cm.options.lineWrapping||(checkWidthStart=lineNo(visualLine(getLine(doc,from.line))),doc.iter(checkWidthStart,to.line+1,function(line){return line==display.maxLine?(recomputeMaxLength=!0,!0):void 0})),doc.sel.contains(change.from,change.to)>-1&&signalCursorActivity(cm),updateDoc(doc,change,spans,estimateHeight(cm)),cm.options.lineWrapping||(doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(line);len>display.maxLineLength&&(display.maxLine=line,display.maxLineLength=len,display.maxLineChanged=!0,recomputeMaxLength=!1)}),recomputeMaxLength&&(cm.curOp.updateMaxLine=!0)),doc.frontier=Math.min(doc.frontier,from.line),startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;change.full?regChange(cm):from.line!=to.line||1!=change.text.length||isWholeLineUpdate(cm.doc,change)?regChange(cm,from.line,to.line+1,lendiff):regLineChange(cm,from.line,"text");var changesHandler=hasHandler(cm,"changes"),changeHandler=hasHandler(cm,"change");if(changeHandler||changesHandler){var obj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};changeHandler&&signalLater(cm,"change",cm,obj),changesHandler&&(cm.curOp.changeObjs||(cm.curOp.changeObjs=[])).push(obj)}cm.display.selForContextMenu=null}function replaceRange(doc,code,from,to,origin){if(to||(to=from),cmp(to,from)<0){var tmp=to;to=from,from=tmp}"string"==typeof code&&(code=doc.splitLines(code)),makeChange(doc,{from:from,to:to,text:code,origin:origin})}function maybeScrollWindow(cm,coords){if(!signalDOMEvent(cm,"scrollCursorIntoView")){var display=cm.display,box=display.sizer.getBoundingClientRect(),doScroll=null;if(coords.top+box.top<0?doScroll=!0:coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight)&&(doScroll=!1),null!=doScroll&&!phantom){var scrollNode=elt("div","",null,"position: absolute; top: "+(coords.top-display.viewOffset-paddingTop(cm.display))+"px; height: "+(coords.bottom-coords.top+scrollGap(cm)+display.barHeight)+"px; left: "+coords.left+"px; width: 2px;");cm.display.lineSpace.appendChild(scrollNode),scrollNode.scrollIntoView(doScroll),cm.display.lineSpace.removeChild(scrollNode)}}}function scrollPosIntoView(cm,pos,end,margin){null==margin&&(margin=0);for(var limit=0;5>limit;limit++){var changed=!1,coords=cursorCoords(cm,pos),endCoords=end&&end!=pos?cursorCoords(cm,end):coords,scrollPos=calculateScrollPos(cm,Math.min(coords.left,endCoords.left),Math.min(coords.top,endCoords.top)-margin,Math.max(coords.left,endCoords.left),Math.max(coords.bottom,endCoords.bottom)+margin),startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(null!=scrollPos.scrollTop&&(setScrollTop(cm,scrollPos.scrollTop),Math.abs(cm.doc.scrollTop-startTop)>1&&(changed=!0)),null!=scrollPos.scrollLeft&&(setScrollLeft(cm,scrollPos.scrollLeft),Math.abs(cm.doc.scrollLeft-startLeft)>1&&(changed=!0)),!changed)break}return coords}function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);null!=scrollPos.scrollTop&&setScrollTop(cm,scrollPos.scrollTop),null!=scrollPos.scrollLeft&&setScrollLeft(cm,scrollPos.scrollLeft)}function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);0>y1&&(y1=0);var screentop=cm.curOp&&null!=cm.curOp.scrollTop?cm.curOp.scrollTop:display.scroller.scrollTop,screen=displayHeight(cm),result={};y2-y1>screen&&(y2=y1+screen);var docBottom=cm.doc.height+paddingVert(display),atTop=snapMargin>y1,atBottom=y2>docBottom-snapMargin;if(screentop>y1)result.scrollTop=atTop?0:y1;else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);newTop!=screentop&&(result.scrollTop=newTop)}var screenleft=cm.curOp&&null!=cm.curOp.scrollLeft?cm.curOp.scrollLeft:display.scroller.scrollLeft,screenw=displayWidth(cm)-(cm.options.fixedGutter?display.gutters.offsetWidth:0),tooWide=x2-x1>screenw;return tooWide&&(x2=x1+screenw),10>x1?result.scrollLeft=0:screenleft>x1?result.scrollLeft=Math.max(0,x1-(tooWide?0:10)):x2>screenw+screenleft-3&&(result.scrollLeft=x2+(tooWide?0:10)-screenw),result}function addToScrollPos(cm,left,top){(null!=left||null!=top)&&resolveScrollToPos(cm),null!=left&&(cm.curOp.scrollLeft=(null==cm.curOp.scrollLeft?cm.doc.scrollLeft:cm.curOp.scrollLeft)+left),null!=top&&(cm.curOp.scrollTop=(null==cm.curOp.scrollTop?cm.doc.scrollTop:cm.curOp.scrollTop)+top)}function ensureCursorVisible(cm){resolveScrollToPos(cm);var cur=cm.getCursor(),from=cur,to=cur;cm.options.lineWrapping||(from=cur.ch?Pos(cur.line,cur.ch-1):cur,to=Pos(cur.line,cur.ch+1)),cm.curOp.scrollToPos={from:from,to:to,margin:cm.options.cursorScrollMargin,isCursor:!0}}function resolveScrollToPos(cm){var range=cm.curOp.scrollToPos;if(range){cm.curOp.scrollToPos=null;var from=estimateCoords(cm,range.from),to=estimateCoords(cm,range.to),sPos=calculateScrollPos(cm,Math.min(from.left,to.left),Math.min(from.top,to.top)-range.margin,Math.max(from.right,to.right),Math.max(from.bottom,to.bottom)+range.margin);cm.scrollTo(sPos.scrollLeft,sPos.scrollTop)}}function indentLine(cm,n,how,aggressive){var state,doc=cm.doc;null==how&&(how="add"),"smart"==how&&(doc.mode.indent?state=getStateBefore(cm,n):how="prev");var tabSize=cm.options.tabSize,line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);line.stateAfter&&(line.stateAfter=null);var indentation,curSpaceString=line.text.match(/^\s*/)[0];if(aggressive||/\S/.test(line.text)){if("smart"==how&&(indentation=doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text),indentation==Pass||indentation>150)){if(!aggressive)return;how="prev"}}else indentation=0,how="not";"prev"==how?indentation=n>doc.first?countColumn(getLine(doc,n-1).text,null,tabSize):0:"add"==how?indentation=curSpace+cm.options.indentUnit:"subtract"==how?indentation=curSpace-cm.options.indentUnit:"number"==typeof how&&(indentation=curSpace+how),indentation=Math.max(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i)pos+=tabSize,indentString+="	";if(indentation>pos&&(indentString+=spaceStr(indentation-pos)),indentString!=curSpaceString)return replaceRange(doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input"),line.stateAfter=null,!0;for(var i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];if(range.head.line==n&&range.head.ch<curSpaceString.length){var pos=Pos(n,curSpaceString.length);replaceOneSelection(doc,i,new Range(pos,pos));break}}}function changeLine(doc,handle,changeType,op){var no=handle,line=handle;return"number"==typeof handle?line=getLine(doc,clipLine(doc,handle)):no=lineNo(handle),null==no?null:(op(line,no)&&doc.cm&&regLineChange(doc.cm,no,changeType),line)}function deleteNearSelection(cm,compute){for(var ranges=cm.doc.sel.ranges,kill=[],i=0;i<ranges.length;i++){for(var toKill=compute(ranges[i]);kill.length&&cmp(toKill.from,lst(kill).to)<=0;){var replaced=kill.pop();if(cmp(replaced.from,toKill.from)<0){toKill.from=replaced.from;break}}kill.push(toKill)}runInOp(cm,function(){for(var i=kill.length-1;i>=0;i--)replaceRange(cm.doc,"",kill[i].from,kill[i].to,"+delete");ensureCursorVisible(cm)})}function findPosH(doc,pos,dir,unit,visually){function findNextLine(){var l=line+dir;return l<doc.first||l>=doc.first+doc.size?!1:(line=l,lineObj=getLine(doc,l))}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,!0);if(null==next){if(boundToLine||!findNextLine())return!1;ch=visually?(0>dir?lineRight:lineLeft)(lineObj):0>dir?lineObj.text.length:0}else ch=next;return!0}var line=pos.line,ch=pos.ch,origDir=dir,lineObj=getLine(doc,line);if("char"==unit)moveOnce();else if("column"==unit)moveOnce(!0);else if("word"==unit||"group"==unit)for(var sawType=null,group="group"==unit,helper=doc.cm&&doc.cm.getHelper(pos,"wordChars"),first=!0;!(0>dir)||moveOnce(!first);first=!1){var cur=lineObj.text.charAt(ch)||"\n",type=isWordChar(cur,helper)?"w":group&&"\n"==cur?"n":!group||/\s/.test(cur)?null:"p";if(!group||first||type||(type="s"),sawType&&sawType!=type){0>dir&&(dir=1,moveOnce());break}if(type&&(sawType=type),dir>0&&!moveOnce(!first))break}var result=skipAtomic(doc,Pos(line,ch),pos,origDir,!0);return cmp(pos,result)||(result.hitSide=!0),result}function findPosV(cm,pos,dir,unit){var y,doc=cm.doc,x=pos.left;if("page"==unit){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(0>dir?1.5:.5)*textHeight(cm.display))}else"line"==unit&&(y=dir>0?pos.bottom+3:pos.top-3);for(;;){var target=coordsChar(cm,x,y);if(!target.outside)break;if(0>dir?0>=y:y>=doc.height){target.hitSide=!0;break}y+=5*dir}return target}function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt,handle&&(optionHandlers[name]=notOnInit?function(cm,val,old){old!=Init&&handle(cm,val,old)
}:handle)}function normalizeKeyName(name){for(var alt,ctrl,shift,cmd,parts=name.split(/-(?!$)/),name=parts[parts.length-1],i=0;i<parts.length-1;i++){var mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod))cmd=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else{if(!/^s(hift)$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);shift=!0}}return alt&&(name="Alt-"+name),ctrl&&(name="Ctrl-"+name),cmd&&(name="Cmd-"+name),shift&&(name="Shift-"+name),name}function getKeyMap(val){return"string"==typeof val?keyMap[val]:val}function markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type),diff=cmp(from,to);if(options&&copyObj(options,marker,!1),diff>0||0==diff&&marker.clearWhenEmpty!==!1)return marker;if(marker.replacedWith&&(marker.collapsed=!0,marker.widgetNode=elt("span",[marker.replacedWith],"CodeMirror-widget"),options.handleMouseEvents||marker.widgetNode.setAttribute("cm-ignore-events","true"),options.insertLeft&&(marker.widgetNode.insertLeft=!0)),marker.collapsed){if(conflictingCollapsedRange(doc,from.line,from,to,marker)||from.line!=to.line&&conflictingCollapsedRange(doc,to.line,from,to,marker))throw new Error("Inserting collapsed marker partially overlapping an existing one");sawCollapsedSpans=!0}marker.addToHistory&&addChangeToHistory(doc,{from:from,to:to,origin:"markText"},doc.sel,0/0);var updateMaxLine,curLine=from.line,cm=doc.cm;if(doc.iter(curLine,to.line+1,function(line){cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(line)==cm.display.maxLine&&(updateMaxLine=!0),marker.collapsed&&curLine!=from.line&&updateLineHeight(line,0),addMarkedSpan(line,new MarkedSpan(marker,curLine==from.line?from.ch:null,curLine==to.line?to.ch:null)),++curLine}),marker.collapsed&&doc.iter(from.line,to.line+1,function(line){lineIsHidden(doc,line)&&updateLineHeight(line,0)}),marker.clearOnEnter&&on(marker,"beforeCursorEnter",function(){marker.clear()}),marker.readOnly&&(sawReadOnlySpans=!0,(doc.history.done.length||doc.history.undone.length)&&doc.clearHistory()),marker.collapsed&&(marker.id=++nextMarkerId,marker.atomic=!0),cm){if(updateMaxLine&&(cm.curOp.updateMaxLine=!0),marker.collapsed)regChange(cm,from.line,to.line+1);else if(marker.className||marker.title||marker.startStyle||marker.endStyle||marker.css)for(var i=from.line;i<=to.line;i++)regLineChange(cm,i,"text");marker.atomic&&reCheckSelection(cm.doc),signalLater(cm,"markerAdded",cm,marker)}return marker}function markTextShared(doc,from,to,options,type){options=copyObj(options),options.shared=!1;var markers=[markText(doc,from,to,options,type)],primary=markers[0],widget=options.widgetNode;return linkedDocs(doc,function(doc){widget&&(options.widgetNode=widget.cloneNode(!0)),markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)}),new SharedTextMarker(markers,primary)}function findSharedMarkers(doc){return doc.findMarks(Pos(doc.first,0),doc.clipPos(Pos(doc.lastLine())),function(m){return m.parent})}function copySharedMarkers(doc,markers){for(var i=0;i<markers.length;i++){var marker=markers[i],pos=marker.find(),mFrom=doc.clipPos(pos.from),mTo=doc.clipPos(pos.to);if(cmp(mFrom,mTo)){var subMark=markText(doc,mFrom,mTo,marker.primary,marker.primary.type);marker.markers.push(subMark),subMark.parent=marker}}}function detachSharedMarkers(markers){for(var i=0;i<markers.length;i++){var marker=markers[i],linked=[marker.primary.doc];linkedDocs(marker.primary.doc,function(d){linked.push(d)});for(var j=0;j<marker.markers.length;j++){var subMarker=marker.markers[j];-1==indexOf(linked,subMarker.doc)&&(subMarker.parent=null,marker.markers.splice(j--,1))}}}function MarkedSpan(marker,from,to){this.marker=marker,this.from=from,this.to=to}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i)spans[i]!=span&&(r||(r=[])).push(spans[i]);return r}function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span],span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){if(old)for(var nw,i=0;i<old.length;++i){var span=old[i],marker=span.marker,startsBefore=null==span.from||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||span.from==startCh&&"bookmark"==marker.type&&(!isInsert||!span.marker.insertLeft)){var endsAfter=null==span.to||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push(new MarkedSpan(marker,span.from,endsAfter?null:span.to))}}return nw}function markedSpansAfter(old,endCh,isInsert){if(old)for(var nw,i=0;i<old.length;++i){var span=old[i],marker=span.marker,endsAfter=null==span.to||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||span.from==endCh&&"bookmark"==marker.type&&(!isInsert||span.marker.insertLeft)){var startsBefore=null==span.from||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push(new MarkedSpan(marker,startsBefore?null:span.from-endCh,null==span.to?null:span.to-endCh))}}return nw}function stretchSpansOverChange(doc,change){if(change.full)return null;var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans,oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=0==cmp(change.from,change.to),first=markedSpansBefore(oldFirst,startCh,isInsert),last=markedSpansAfter(oldLast,endCh,isInsert),sameLine=1==change.text.length,offset=lst(change.text).length+(sameLine?startCh:0);if(first)for(var i=0;i<first.length;++i){var span=first[i];if(null==span.to){var found=getMarkedSpanFor(last,span.marker);found?sameLine&&(span.to=null==found.to?null:found.to+offset):span.to=startCh}}if(last)for(var i=0;i<last.length;++i){var span=last[i];if(null!=span.to&&(span.to+=offset),null==span.from){var found=getMarkedSpanFor(first,span.marker);found||(span.from=offset,sameLine&&(first||(first=[])).push(span))}else span.from+=offset,sameLine&&(first||(first=[])).push(span)}first&&(first=clearEmptySpans(first)),last&&last!=first&&(last=clearEmptySpans(last));var newMarkers=[first];if(!sameLine){var gapMarkers,gap=change.text.length-2;if(gap>0&&first)for(var i=0;i<first.length;++i)null==first[i].to&&(gapMarkers||(gapMarkers=[])).push(new MarkedSpan(first[i].marker,null,null));for(var i=0;gap>i;++i)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function clearEmptySpans(spans){for(var i=0;i<spans.length;++i){var span=spans[i];null!=span.from&&span.from==span.to&&span.marker.clearWhenEmpty!==!1&&spans.splice(i--,1)}return spans.length?spans:null}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change),stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur)spans:for(var j=0;j<stretchCur.length;++j){for(var span=stretchCur[j],k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}else stretchCur&&(old[i]=stretchCur)}return old}function removeReadOnlyRanges(doc,from,to){var markers=null;if(doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;!mark.readOnly||markers&&-1!=indexOf(markers,mark)||(markers||(markers=[])).push(mark)}}),!markers)return null;for(var parts=[{from:from,to:to}],i=0;i<markers.length;++i)for(var mk=markers[i],m=mk.find(0),j=0;j<parts.length;++j){var p=parts[j];if(!(cmp(p.to,m.from)<0||cmp(p.from,m.to)>0)){var newParts=[j,1],dfrom=cmp(p.from,m.from),dto=cmp(p.to,m.to);(0>dfrom||!mk.inclusiveLeft&&!dfrom)&&newParts.push({from:p.from,to:m.from}),(dto>0||!mk.inclusiveRight&&!dto)&&newParts.push({from:m.to,to:p.to}),parts.splice.apply(parts,newParts),j+=newParts.length-1}}return parts}function detachMarkedSpans(line){var spans=line.markedSpans;if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}}function attachMarkedSpans(line,spans){if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}}function extraLeft(marker){return marker.inclusiveLeft?-1:0}function extraRight(marker){return marker.inclusiveRight?1:0}function compareCollapsedMarkers(a,b){var lenDiff=a.lines.length-b.lines.length;if(0!=lenDiff)return lenDiff;var aPos=a.find(),bPos=b.find(),fromCmp=cmp(aPos.from,bPos.from)||extraLeft(a)-extraLeft(b);if(fromCmp)return-fromCmp;var toCmp=cmp(aPos.to,bPos.to)||extraRight(a)-extraRight(b);return toCmp?toCmp:b.id-a.id}function collapsedSpanAtSide(line,start){var found,sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i)sp=sps[i],sp.marker.collapsed&&null==(start?sp.from:sp.to)&&(!found||compareCollapsedMarkers(found,sp.marker)<0)&&(found=sp.marker);return found}function collapsedSpanAtStart(line){return collapsedSpanAtSide(line,!0)}function collapsedSpanAtEnd(line){return collapsedSpanAtSide(line,!1)}function conflictingCollapsedRange(doc,lineNo,from,to,marker){var line=getLine(doc,lineNo),sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var i=0;i<sps.length;++i){var sp=sps[i];if(sp.marker.collapsed){var found=sp.marker.find(0),fromCmp=cmp(found.from,from)||extraLeft(sp.marker)-extraLeft(marker),toCmp=cmp(found.to,to)||extraRight(sp.marker)-extraRight(marker);if(!(fromCmp>=0&&0>=toCmp||0>=fromCmp&&toCmp>=0)&&(0>=fromCmp&&(cmp(found.to,from)>0||sp.marker.inclusiveRight&&marker.inclusiveLeft)||fromCmp>=0&&(cmp(found.from,to)<0||sp.marker.inclusiveLeft&&marker.inclusiveRight)))return!0}}}function visualLine(line){for(var merged;merged=collapsedSpanAtStart(line);)line=merged.find(-1,!0).line;return line}function visualLineContinued(line){for(var merged,lines;merged=collapsedSpanAtEnd(line);)line=merged.find(1,!0).line,(lines||(lines=[])).push(line);return lines}function visualLineNo(doc,lineN){var line=getLine(doc,lineN),vis=visualLine(line);return line==vis?lineN:lineNo(vis)}function visualLineEndNo(doc,lineN){if(lineN>doc.lastLine())return lineN;var merged,line=getLine(doc,lineN);if(!lineIsHidden(doc,line))return lineN;for(;merged=collapsedSpanAtEnd(line);)line=merged.find(1,!0).line;return lineNo(line)+1}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i)if(sp=sps[i],sp.marker.collapsed){if(null==sp.from)return!0;if(!sp.marker.widgetNode&&0==sp.from&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return!0}}function lineIsHiddenInner(doc,line,span){if(null==span.to){var end=span.marker.find(1,!0);return lineIsHiddenInner(doc,end.line,getMarkedSpanFor(end.line.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return!0;for(var sp,i=0;i<line.markedSpans.length;++i)if(sp=line.markedSpans[i],sp.marker.collapsed&&!sp.marker.widgetNode&&sp.from==span.to&&(null==sp.to||sp.to!=span.from)&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return!0}function adjustScrollWhenAboveVisible(cm,line,diff){heightAtLine(line)<(cm.curOp&&cm.curOp.scrollTop||cm.doc.scrollTop)&&addToScrollPos(cm,null,diff)}function widgetHeight(widget){if(null!=widget.height)return widget.height;var cm=widget.doc.cm;if(!cm)return 0;if(!contains(document.body,widget.node)){var parentStyle="position: relative;";widget.coverGutter&&(parentStyle+="margin-left: -"+cm.display.gutters.offsetWidth+"px;"),widget.noHScroll&&(parentStyle+="width: "+cm.display.wrapper.clientWidth+"px;"),removeChildrenAndAdd(cm.display.measure,elt("div",[widget.node],null,parentStyle))}return widget.height=widget.node.parentNode.offsetHeight}function addLineWidget(doc,handle,node,options){var widget=new LineWidget(doc,node,options),cm=doc.cm;return cm&&widget.noHScroll&&(cm.display.alignWidgets=!0),changeLine(doc,handle,"widget",function(line){var widgets=line.widgets||(line.widgets=[]);if(null==widget.insertAt?widgets.push(widget):widgets.splice(Math.min(widgets.length-1,Math.max(0,widget.insertAt)),0,widget),widget.line=line,cm&&!lineIsHidden(doc,line)){var aboveVisible=heightAtLine(line)<doc.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget)),aboveVisible&&addToScrollPos(cm,null,widget.height),cm.curOp.forceUpdate=!0}return!0}),widget}function updateLine(line,text,markedSpans,estimateHeight){line.text=text,line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null),null!=line.order&&(line.order=null),detachMarkedSpans(line),attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;estHeight!=line.height&&updateLineHeight(line,estHeight)}function cleanUpLine(line){line.parent=null,detachMarkedSpans(line)}function extractLineClasses(type,output){if(type)for(;;){var lineClass=type.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!lineClass)break;type=type.slice(0,lineClass.index)+type.slice(lineClass.index+lineClass[0].length);var prop=lineClass[1]?"bgClass":"textClass";null==output[prop]?output[prop]=lineClass[2]:new RegExp("(?:^|s)"+lineClass[2]+"(?:$|s)").test(output[prop])||(output[prop]+=" "+lineClass[2])}return type}function callBlankLine(mode,state){if(mode.blankLine)return mode.blankLine(state);if(mode.innerMode){var inner=CodeMirror.innerMode(mode,state);return inner.mode.blankLine?inner.mode.blankLine(inner.state):void 0}}function readToken(mode,stream,state,inner){for(var i=0;10>i;i++){inner&&(inner[0]=CodeMirror.innerMode(mode,state).mode);var style=mode.token(stream,state);if(stream.pos>stream.start)return style}throw new Error("Mode "+mode.name+" failed to advance stream.")}function takeToken(cm,pos,precise,asArray){function getObj(copy){return{start:stream.start,end:stream.pos,string:stream.current(),type:style||null,state:copy?copyState(doc.mode,state):state}}var style,doc=cm.doc,mode=doc.mode;pos=clipPos(doc,pos);var tokens,line=getLine(doc,pos.line),state=getStateBefore(cm,pos.line,precise),stream=new StringStream(line.text,cm.options.tabSize);for(asArray&&(tokens=[]);(asArray||stream.pos<pos.ch)&&!stream.eol();)stream.start=stream.pos,style=readToken(mode,stream,state),asArray&&tokens.push(getObj(!0));return asArray?tokens:getObj()}function runMode(cm,text,mode,state,f,lineClasses,forceToEnd){var flattenSpans=mode.flattenSpans;null==flattenSpans&&(flattenSpans=cm.options.flattenSpans);var style,curStart=0,curStyle=null,stream=new StringStream(text,cm.options.tabSize),inner=cm.options.addModeClass&&[null];for(""==text&&extractLineClasses(callBlankLine(mode,state),lineClasses);!stream.eol();){if(stream.pos>cm.options.maxHighlightLength?(flattenSpans=!1,forceToEnd&&processLine(cm,text,state,stream.pos),stream.pos=text.length,style=null):style=extractLineClasses(readToken(mode,stream,state,inner),lineClasses),inner){var mName=inner[0].name;mName&&(style="m-"+(style?mName+" "+style:mName))}if(!flattenSpans||curStyle!=style){for(;curStart<stream.start;)curStart=Math.min(stream.start,curStart+5e4),f(curStart,curStyle);curStyle=style}stream.start=stream.pos}for(;curStart<stream.pos;){var pos=Math.min(stream.pos,curStart+5e4);f(pos,curStyle),curStart=pos}}function highlightLine(cm,line,state,forceToEnd){var st=[cm.state.modeGen],lineClasses={};runMode(cm,line.text,cm.doc.mode,state,function(end,style){st.push(end,style)},lineClasses,forceToEnd);for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1,at=0;runMode(cm,line.text,overlay.mode,!0,function(end,style){for(var start=i;end>at;){var i_end=st[i];i_end>end&&st.splice(i,1,end,st[i+1],i_end),i+=2,at=Math.min(end,i_end)}if(style)if(overlay.opaque)st.splice(start,i-start,end,"cm-overlay "+style),i=start+2;else for(;i>start;start+=2){var cur=st[start+1];st[start+1]=(cur?cur+" ":"")+"cm-overlay "+style}},lineClasses)}return{styles:st,classes:lineClasses.bgClass||lineClasses.textClass?lineClasses:null}}function getLineStyles(cm,line,updateFrontier){if(!line.styles||line.styles[0]!=cm.state.modeGen){var state=getStateBefore(cm,lineNo(line)),result=highlightLine(cm,line,line.text.length>cm.options.maxHighlightLength?copyState(cm.doc.mode,state):state);line.stateAfter=state,line.styles=result.styles,result.classes?line.styleClasses=result.classes:line.styleClasses&&(line.styleClasses=null),updateFrontier===cm.doc.frontier&&cm.doc.frontier++}return line.styles}function processLine(cm,text,state,startAt){var mode=cm.doc.mode,stream=new StringStream(text,cm.options.tabSize);for(stream.start=stream.pos=startAt||0,""==text&&callBlankLine(mode,state);!stream.eol();)readToken(mode,stream,state),stream.start=stream.pos}function interpretTokenStyle(style,options){if(!style||/^\s*$/.test(style))return null;var cache=options.addModeClass?styleToClassCacheWithMode:styleToClassCache;return cache[style]||(cache[style]=style.replace(/\S+/g,"cm-$&"))}function buildLineContent(cm,lineView){var content=elt("span",null,null,webkit?"padding-right: .1px":null),builder={pre:elt("pre",[content],"CodeMirror-line"),content:content,col:0,pos:0,cm:cm,splitSpaces:(ie||webkit)&&cm.getOption("lineWrapping")};lineView.measure={};for(var i=0;i<=(lineView.rest?lineView.rest.length:0);i++){var order,line=i?lineView.rest[i-1]:lineView.line;builder.pos=0,builder.addToken=buildToken,hasBadBidiRects(cm.display.measure)&&(order=getOrder(line))&&(builder.addToken=buildTokenBadBidi(builder.addToken,order)),builder.map=[];var allowFrontierUpdate=lineView!=cm.display.externalMeasured&&lineNo(line);insertLineContent(line,builder,getLineStyles(cm,line,allowFrontierUpdate)),line.styleClasses&&(line.styleClasses.bgClass&&(builder.bgClass=joinClasses(line.styleClasses.bgClass,builder.bgClass||"")),line.styleClasses.textClass&&(builder.textClass=joinClasses(line.styleClasses.textClass,builder.textClass||""))),0==builder.map.length&&builder.map.push(0,0,builder.content.appendChild(zeroWidthElement(cm.display.measure))),0==i?(lineView.measure.map=builder.map,lineView.measure.cache={}):((lineView.measure.maps||(lineView.measure.maps=[])).push(builder.map),(lineView.measure.caches||(lineView.measure.caches=[])).push({}))}return webkit&&/\bcm-tab\b/.test(builder.content.lastChild.className)&&(builder.content.className="cm-tab-wrap-hack"),signal(cm,"renderLine",cm,lineView.line,builder.pre),builder.pre.className&&(builder.textClass=joinClasses(builder.pre.className,builder.textClass||"")),builder}function defaultSpecialCharPlaceholder(ch){var token=elt("span","","cm-invalidchar");return token.title="\\u"+ch.charCodeAt(0).toString(16),token.setAttribute("aria-label",token.title),token}function buildToken(builder,text,style,startStyle,endStyle,title,css){if(text){var displayText=builder.splitSpaces?text.replace(/ {3,}/g,splitSpaces):text,special=builder.cm.state.specialChars,mustWrap=!1;if(special.test(text))for(var content=document.createDocumentFragment(),pos=0;;){special.lastIndex=pos;var m=special.exec(text),skipped=m?m.index-pos:text.length-pos;if(skipped){var txt=document.createTextNode(displayText.slice(pos,pos+skipped));ie&&9>ie_version?content.appendChild(elt("span",[txt])):content.appendChild(txt),builder.map.push(builder.pos,builder.pos+skipped,txt),builder.col+=skipped,builder.pos+=skipped}if(!m)break;if(pos+=skipped+1,"	"==m[0]){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize,txt=content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab"));txt.setAttribute("role","presentation"),txt.setAttribute("cm-text","	"),builder.col+=tabWidth}else if("\r"==m[0]||"\n"==m[0]){var txt=content.appendChild(elt("span","\r"==m[0]?"":"","cm-invalidchar"));txt.setAttribute("cm-text",m[0]),builder.col+=1}else{var txt=builder.cm.options.specialCharPlaceholder(m[0]);txt.setAttribute("cm-text",m[0]),ie&&9>ie_version?content.appendChild(elt("span",[txt])):content.appendChild(txt),builder.col+=1}builder.map.push(builder.pos,builder.pos+1,txt),builder.pos++}else{builder.col+=text.length;var content=document.createTextNode(displayText);builder.map.push(builder.pos,builder.pos+text.length,content),ie&&9>ie_version&&(mustWrap=!0),builder.pos+=text.length}if(style||startStyle||endStyle||mustWrap||css){var fullStyle=style||"";startStyle&&(fullStyle+=startStyle),endStyle&&(fullStyle+=endStyle);var token=elt("span",[content],fullStyle,css);return title&&(token.title=title),builder.content.appendChild(token)}builder.content.appendChild(content)}}function splitSpaces(old){for(var out=" ",i=0;i<old.length-2;++i)out+=i%2?" ":"";return out+=" "}function buildTokenBadBidi(inner,order){return function(builder,text,style,startStyle,endStyle,title,css){style=style?style+" cm-force-border":"cm-force-border";for(var start=builder.pos,end=start+text.length;;){for(var i=0;i<order.length;i++){var part=order[i];if(part.to>start&&part.from<=start)break}if(part.to>=end)return inner(builder,text,style,startStyle,endStyle,title,css);inner(builder,text.slice(0,part.to-start),style,startStyle,null,title,css),startStyle=null,text=text.slice(part.to-start),start=part.to}}}function buildCollapsedSpan(builder,size,marker,ignoreWidget){var widget=!ignoreWidget&&marker.widgetNode;widget&&builder.map.push(builder.pos,builder.pos+size,widget),!ignoreWidget&&builder.cm.display.input.needsContentAttribute&&(widget||(widget=builder.content.appendChild(document.createElement("span"))),widget.setAttribute("cm-marker",marker.id)),widget&&(builder.cm.display.input.setUneditable(widget),builder.content.appendChild(widget)),builder.pos+=size}function insertLineContent(line,builder,styles){var spans=line.markedSpans,allText=line.text,at=0;if(spans)for(var style,css,spanStyle,spanEndStyle,spanStartStyle,title,collapsed,len=allText.length,pos=0,i=1,text="",nextChange=0;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=title=css="",collapsed=null,nextChange=1/0;for(var endStyles,foundBookmarks=[],j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;"bookmark"==m.type&&sp.from==pos&&m.widgetNode?foundBookmarks.push(m):sp.from<=pos&&(null==sp.to||sp.to>pos||m.collapsed&&sp.to==pos&&sp.from==pos)?(null!=sp.to&&sp.to!=pos&&nextChange>sp.to&&(nextChange=sp.to,spanEndStyle=""),m.className&&(spanStyle+=" "+m.className),m.css&&(css=(css?css+";":"")+m.css),m.startStyle&&sp.from==pos&&(spanStartStyle+=" "+m.startStyle),m.endStyle&&sp.to==nextChange&&(endStyles||(endStyles=[])).push(m.endStyle,sp.to),m.title&&!title&&(title=m.title),m.collapsed&&(!collapsed||compareCollapsedMarkers(collapsed.marker,m)<0)&&(collapsed=sp)):sp.from>pos&&nextChange>sp.from&&(nextChange=sp.from)}if(endStyles)for(var j=0;j<endStyles.length;j+=2)endStyles[j+1]==nextChange&&(spanEndStyle+=" "+endStyles[j]);if(!collapsed||collapsed.from==pos)for(var j=0;j<foundBookmarks.length;++j)buildCollapsedSpan(builder,0,foundBookmarks[j]);if(collapsed&&(collapsed.from||0)==pos){if(buildCollapsedSpan(builder,(null==collapsed.to?len+1:collapsed.to)-pos,collapsed.marker,null==collapsed.from),null==collapsed.to)return;collapsed.to==pos&&(collapsed=!1)}}if(pos>=len)break;for(var upto=Math.min(len,nextChange);;){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"",title,css)}if(end>=upto){text=text.slice(upto-pos),pos=upto;break}pos=end,spanStartStyle=""}text=allText.slice(at,at=styles[i++]),style=interpretTokenStyle(styles[i++],builder.cm.options)}}else for(var i=1;i<styles.length;i+=2)builder.addToken(builder,allText.slice(at,at=styles[i]),interpretTokenStyle(styles[i+1],builder.cm.options))}function isWholeLineUpdate(doc,change){return 0==change.from.ch&&0==change.to.ch&&""==lst(change.text)&&(!doc.cm||doc.cm.options.wholeLineUpdateBefore)}function updateDoc(doc,change,markedSpans,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight),signalLater(line,"change",line,change)}function linesFor(start,end){for(var i=start,result=[];end>i;++i)result.push(new Line(text[i],spansFor(i),estimateHeight));return result}var from=change.from,to=change.to,text=change.text,firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line),lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(change.full)doc.insert(0,linesFor(0,text.length)),doc.remove(text.length,doc.size-text.length);else if(isWholeLineUpdate(doc,change)){var added=linesFor(0,text.length-1);update(lastLine,lastLine.text,lastSpans),nlines&&doc.remove(from.line,nlines),added.length&&doc.insert(from.line,added)}else if(firstLine==lastLine)if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans);else{var added=linesFor(1,text.length-1);added.push(new Line(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight)),update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),doc.insert(from.line+1,added)}else if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0)),doc.remove(from.line+1,nlines);else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);var added=linesFor(1,text.length-1);nlines>1&&doc.remove(from.line+1,nlines-1),doc.insert(from.line+1,added)}signalLater(doc,"change",doc,change)}function LeafChunk(lines){this.lines=lines,this.parent=null;for(var i=0,height=0;i<lines.length;++i)lines[i].parent=this,height+=lines[i].height;this.height=height}function BranchChunk(children){this.children=children;for(var size=0,height=0,i=0;i<children.length;++i){var ch=children[i];size+=ch.chunkSize(),height+=ch.height,ch.parent=this}this.size=size,this.height=height,this.parent=null}function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc!=skip){var shared=sharedHist&&rel.sharedHist;(!sharedHistOnly||shared)&&(f(rel.doc,shared),propagate(rel.doc,doc,shared))}}}propagate(doc,null,!0)}function attachDoc(cm,doc){if(doc.cm)throw new Error("This document is already in use.");cm.doc=doc,doc.cm=cm,estimateLineHeights(cm),loadMode(cm),cm.options.lineWrapping||findMaxLine(cm),cm.options.mode=doc.modeOption,regChange(cm)}function getLine(doc,n){if(n-=doc.first,0>n||n>=doc.size)throw new Error("There is no line "+(n+doc.first)+" in the document.");for(var chunk=doc;!chunk.lines;)for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(sz>n){chunk=child;break}n-=sz}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;return doc.iter(start.line,end.line+1,function(line){var text=line.text;n==end.line&&(text=text.slice(0,end.ch)),n==start.line&&(text=text.slice(start.ch)),out.push(text),++n}),out}function getLines(doc,from,to){var out=[];return doc.iter(from,to,function(line){out.push(line.text)}),out}function updateLineHeight(line,height){var diff=height-line.height;if(diff)for(var n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(null==line.parent)return null;for(var cur=line.parent,no=indexOf(cur.lines,line),chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent)for(var i=0;chunk.children[i]!=cur;++i)no+=chunk.children[i].chunkSize();return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0;i<chunk.children.length;++i){var child=chunk.children[i],ch=child.height;if(ch>h){chunk=child;continue outer}h-=ch,n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i],lh=line.height;if(lh>h)break;h-=lh}return n+i}function heightAtLine(lineObj){lineObj=visualLine(lineObj);for(var h=0,chunk=lineObj.parent,i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;h+=line.height}for(var p=chunk.parent;p;chunk=p,p=chunk.parent)for(var i=0;i<p.children.length;++i){var cur=p.children[i];if(cur==chunk)break;h+=cur.height}return h}function getOrder(line){var order=line.order;return null==order&&(order=line.order=bidiOrdering(line.text)),order}function History(startGen){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=startGen||1}function historyChangeFromChange(doc,change){var histChange={from:copyPos(change.from),to:changeEnd(change),text:getBetween(doc,change.from,change.to)};return attachLocalSpans(doc,histChange,change.from.line,change.to.line+1),linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},!0),histChange}function clearSelectionEvents(array){for(;array.length;){var last=lst(array);if(!last.ranges)break;array.pop()}}function lastChangeEvent(hist,force){return force?(clearSelectionEvents(hist.done),lst(hist.done)):hist.done.length&&!lst(hist.done).ranges?lst(hist.done):hist.done.length>1&&!hist.done[hist.done.length-2].ranges?(hist.done.pop(),lst(hist.done)):void 0}function addChangeToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var cur,time=+new Date;if((hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&("+"==change.origin.charAt(0)&&doc.cm&&hist.lastModTime>time-doc.cm.options.historyEventDelay||"*"==change.origin.charAt(0)))&&(cur=lastChangeEvent(hist,hist.lastOp==opId))){var last=lst(cur.changes);0==cmp(change.from,change.to)&&0==cmp(change.from,last.to)?last.to=changeEnd(change):cur.changes.push(historyChangeFromChange(doc,change))}else{var before=lst(hist.done);for(before&&before.ranges||pushSelectionToHistory(doc.sel,hist.done),cur={changes:[historyChangeFromChange(doc,change)],generation:hist.generation},hist.done.push(cur);hist.done.length>hist.undoDepth;)hist.done.shift(),hist.done[0].ranges||hist.done.shift()}hist.done.push(selAfter),hist.generation=++hist.maxGeneration,hist.lastModTime=hist.lastSelTime=time,hist.lastOp=hist.lastSelOp=opId,hist.lastOrigin=hist.lastSelOrigin=change.origin,last||signal(doc,"historyAdded")}function selectionEventCanBeMerged(doc,origin,prev,sel){var ch=origin.charAt(0);return"*"==ch||"+"==ch&&prev.ranges.length==sel.ranges.length&&prev.somethingSelected()==sel.somethingSelected()&&new Date-doc.history.lastSelTime<=(doc.cm?doc.cm.options.historyEventDelay:500)}function addSelectionToHistory(doc,sel,opId,options){var hist=doc.history,origin=options&&options.origin;opId==hist.lastSelOp||origin&&hist.lastSelOrigin==origin&&(hist.lastModTime==hist.lastSelTime&&hist.lastOrigin==origin||selectionEventCanBeMerged(doc,origin,lst(hist.done),sel))?hist.done[hist.done.length-1]=sel:pushSelectionToHistory(sel,hist.done),hist.lastSelTime=+new Date,hist.lastSelOrigin=origin,hist.lastSelOp=opId,options&&options.clearRedo!==!1&&clearSelectionEvents(hist.undone)}function pushSelectionToHistory(sel,dest){var top=lst(dest);top&&top.ranges&&top.equals(sel)||dest.push(sel)}function attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){line.markedSpans&&((existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans),++n})}function removeClearedSpans(spans){if(!spans)return null;for(var out,i=0;i<spans.length;++i)spans[i].marker.explicitlyCleared?out||(out=spans.slice(0,i)):out&&out.push(spans[i]);return out?out.length?out:null:spans}function getOldSpans(doc,change){var found=change["spans_"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}function copyHistoryArray(events,newGroup,instantiateSel){for(var i=0,copy=[];i<events.length;++i){var event=events[i];if(event.ranges)copy.push(instantiateSel?Selection.prototype.deepCopy.call(event):event);else{var changes=event.changes,newChanges=[];copy.push({changes:newChanges});for(var j=0;j<changes.length;++j){var m,change=changes[j];if(newChanges.push({from:change.from,to:change.to,text:change.text}),newGroup)for(var prop in change)(m=prop.match(/^spans_(\d+)$/))&&indexOf(newGroup,Number(m[1]))>-1&&(lst(newChanges)[prop]=change[prop],delete change[prop])}}}return copy}function rebaseHistSelSingle(pos,from,to,diff){to<pos.line?pos.line+=diff:from<pos.line&&(pos.line=from,pos.ch=0)}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=!0;if(sub.ranges){sub.copied||(sub=array[i]=sub.deepCopy(),sub.copied=!0);
for(var j=0;j<sub.ranges.length;j++)rebaseHistSelSingle(sub.ranges[j].anchor,from,to,diff),rebaseHistSelSingle(sub.ranges[j].head,from,to,diff)}else{for(var j=0;j<sub.changes.length;++j){var cur=sub.changes[j];if(to<cur.from.line)cur.from=Pos(cur.from.line+diff,cur.from.ch),cur.to=Pos(cur.to.line+diff,cur.to.ch);else if(from<=cur.to.line){ok=!1;break}}ok||(array.splice(0,i+1),i=0)}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff),rebaseHistArray(hist.undone,from,to,diff)}function e_defaultPrevented(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;return null==b&&(1&e.button?b=1:2&e.button?b=3:4&e.button&&(b=2)),mac&&e.ctrlKey&&1==b&&(b=3),b}function getHandlers(emitter,type,copy){var arr=emitter._handlers&&emitter._handlers[type];return copy?arr&&arr.length>0?arr.slice():noHandlers:arr||noHandlers}function signalLater(emitter,type){function bnd(f){return function(){f.apply(null,args)}}var arr=getHandlers(emitter,type,!1);if(arr.length){var list,args=Array.prototype.slice.call(arguments,2);operationGroup?list=operationGroup.delayedCallbacks:orphanDelayedCallbacks?list=orphanDelayedCallbacks:(list=orphanDelayedCallbacks=[],setTimeout(fireOrphanDelayed,0));for(var i=0;i<arr.length;++i)list.push(bnd(arr[i]))}}function fireOrphanDelayed(){var delayed=orphanDelayedCallbacks;orphanDelayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function signalDOMEvent(cm,e,override){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),signal(cm,override||e.type,cm,e),e_defaultPrevented(e)||e.codemirrorIgnore}function signalCursorActivity(cm){var arr=cm._handlers&&cm._handlers.cursorActivity;if(arr)for(var set=cm.curOp.cursorActivityHandlers||(cm.curOp.cursorActivityHandlers=[]),i=0;i<arr.length;++i)-1==indexOf(set,arr[i])&&set.push(arr[i])}function hasHandler(emitter,type){return getHandlers(emitter,type).length>0}function eventMixin(ctor){ctor.prototype.on=function(type,f){on(this,type,f)},ctor.prototype.off=function(type,f){off(this,type,f)}}function Delayed(){this.id=null}function spaceStr(n){for(;spaceStrs.length<=n;)spaceStrs.push(lst(spaceStrs)+" ");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function indexOf(array,elt){for(var i=0;i<array.length;++i)if(array[i]==elt)return i;return-1}function map(array,f){for(var out=[],i=0;i<array.length;i++)out[i]=f(array[i],i);return out}function nothing(){}function createObj(base,props){var inst;return Object.create?inst=Object.create(base):(nothing.prototype=base,inst=new nothing),props&&copyObj(props,inst),inst}function copyObj(obj,target,overwrite){target||(target={});for(var prop in obj)!obj.hasOwnProperty(prop)||overwrite===!1&&target.hasOwnProperty(prop)||(target[prop]=obj[prop]);return target}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}function isWordChar(ch,helper){return helper?helper.source.indexOf("\\w")>-1&&isWordCharBasic(ch)?!0:helper.test(ch):isWordCharBasic(ch)}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return!1;return!0}function isExtendingChar(ch){return ch.charCodeAt(0)>=768&&extendingChars.test(ch)}function elt(tag,content,className,style){var e=document.createElement(tag);if(className&&(e.className=className),style&&(e.style.cssText=style),"string"==typeof content)e.appendChild(document.createTextNode(content));else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}function removeChildren(e){for(var count=e.childNodes.length;count>0;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function activeElt(){for(var activeElement=document.activeElement;activeElement&&activeElement.root&&activeElement.root.activeElement;)activeElement=activeElement.root.activeElement;return activeElement}function classTest(cls){return new RegExp("(^|\\s)"+cls+"(?:$|\\s)\\s*")}function joinClasses(a,b){for(var as=a.split(" "),i=0;i<as.length;i++)as[i]&&!classTest(as[i]).test(b)&&(b+=" "+as[i]);return b}function forEachCodeMirror(f){if(document.body.getElementsByClassName)for(var byClass=document.body.getElementsByClassName("CodeMirror"),i=0;i<byClass.length;i++){var cm=byClass[i].CodeMirror;cm&&f(cm)}}function ensureGlobalHandlers(){globalsRegistered||(registerGlobalHandlers(),globalsRegistered=!0)}function registerGlobalHandlers(){var resizeTimer;on(window,"resize",function(){null==resizeTimer&&(resizeTimer=setTimeout(function(){resizeTimer=null,forEachCodeMirror(onResize)},100))}),on(window,"blur",function(){forEachCodeMirror(onBlur)})}function zeroWidthElement(measure){if(null==zwspSupported){var test=elt("span","");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")])),0!=measure.firstChild.offsetHeight&&(zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!(ie&&8>ie_version))}var node=zwspSupported?elt("span",""):elt("span","",null,"display: inline-block; width: 1px; margin-right: -1px");return node.setAttribute("cm-text",""),node}function hasBadBidiRects(measure){if(null!=badBidiRects)return badBidiRects;var txt=removeChildrenAndAdd(measure,document.createTextNode("AA")),r0=range(txt,0,1).getBoundingClientRect();if(!r0||r0.left==r0.right)return!1;var r1=range(txt,1,2).getBoundingClientRect();return badBidiRects=r1.right-r0.right<3}function hasBadZoomedRects(measure){if(null!=badZoomedRects)return badZoomedRects;var node=removeChildrenAndAdd(measure,elt("span","x")),normal=node.getBoundingClientRect(),fromRange=range(node,0,1).getBoundingClientRect();return badZoomedRects=Math.abs(normal.left-fromRange.left)>1}function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,"ltr");for(var found=!1,i=0;i<order.length;++i){var part=order[i];(part.from<to&&part.to>from||from==to&&part.to==from)&&(f(Math.max(part.from,from),Math.min(part.to,to),1==part.level?"rtl":"ltr"),found=!0)}found||f(from,to,"ltr")}function bidiLeft(part){return part.level%2?part.to:part.from}function bidiRight(part){return part.level%2?part.from:part.to}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0}function lineRight(line){var order=getOrder(line);return order?bidiRight(lst(order)):line.text.length}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN),visual=visualLine(line);visual!=line&&(lineN=lineNo(visual));var order=getOrder(visual),ch=order?order[0].level%2?lineRight(visual):lineLeft(visual):0;return Pos(lineN,ch)}function lineEnd(cm,lineN){for(var merged,line=getLine(cm.doc,lineN);merged=collapsedSpanAtEnd(line);)line=merged.find(1,!0).line,lineN=null;var order=getOrder(line),ch=order?order[0].level%2?lineLeft(line):lineRight(line):line.text.length;return Pos(null==lineN?lineNo(line):lineN,ch)}function lineStartSmart(cm,pos){var start=lineStart(cm,pos.line),line=getLine(cm.doc,start.line),order=getOrder(line);if(!order||0==order[0].level){var firstNonWS=Math.max(0,line.text.search(/\S/)),inWS=pos.line==start.line&&pos.ch<=firstNonWS&&pos.ch;return Pos(start.line,inWS?0:firstNonWS)}return start}function compareBidiLevel(order,a,b){var linedir=order[0].level;return a==linedir?!0:b==linedir?!1:b>a}function getBidiPartAt(order,pos){bidiOther=null;for(var found,i=0;i<order.length;++i){var cur=order[i];if(cur.from<pos&&cur.to>pos)return i;if(cur.from==pos||cur.to==pos){if(null!=found)return compareBidiLevel(order,cur.level,order[found].level)?(cur.from!=cur.to&&(bidiOther=found),i):(cur.from!=cur.to&&(bidiOther=i),found);found=i}}return found}function moveInLine(line,pos,dir,byUnit){if(!byUnit)return pos+dir;do pos+=dir;while(pos>0&&isExtendingChar(line.text.charAt(pos)));return pos}function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);for(var pos=getBidiPartAt(bidi,start),part=bidi[pos],target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);;){if(target>part.from&&target<part.to)return target;if(target==part.from||target==part.to)return getBidiPartAt(bidi,target)==pos?target:(part=bidi[pos+=dir],dir>0==part.level%2?part.to:part.from);if(part=bidi[pos+=dir],!part)return null;target=dir>0==part.level%2?moveInLine(line,part.to,-1,byUnit):moveInLine(line,part.from,1,byUnit)}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)for(;target>0&&isExtendingChar(line.text.charAt(target));)target+=dir;return 0>target||target>line.text.length?null:target}var userAgent=navigator.userAgent,platform=navigator.platform,gecko=/gecko\/\d/i.test(userAgent),ie_upto10=/MSIE \d/.test(userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(userAgent),ie=ie_upto10||ie_11up,ie_version=ie&&(ie_upto10?document.documentMode||6:ie_11up[1]),webkit=/WebKit\//.test(userAgent),qtwebkit=webkit&&/Qt\/\d+\.\d+/.test(userAgent),chrome=/Chrome\//.test(userAgent),presto=/Opera\//.test(userAgent),safari=/Apple Computer/.test(navigator.vendor),mac_geMountainLion=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(userAgent),phantom=/PhantomJS/.test(userAgent),ios=/AppleWebKit/.test(userAgent)&&/Mobile\/\w+/.test(userAgent),mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent),mac=ios||/Mac/.test(platform),windows=/win/i.test(platform),presto_version=presto&&userAgent.match(/Version\/(\d*\.\d*)/);presto_version&&(presto_version=Number(presto_version[1])),presto_version&&presto_version>=15&&(presto=!1,webkit=!0);var flipCtrlCmd=mac&&(qtwebkit||presto&&(null==presto_version||12.11>presto_version)),captureRightClick=gecko||ie&&ie_version>=9,sawReadOnlySpans=!1,sawCollapsedSpans=!1;NativeScrollbars.prototype=copyObj({update:function(measure){var needsH=measure.scrollWidth>measure.clientWidth+1,needsV=measure.scrollHeight>measure.clientHeight+1,sWidth=measure.nativeBarWidth;if(needsV){this.vert.style.display="block",this.vert.style.bottom=needsH?sWidth+"px":"0";var totalHeight=measure.viewHeight-(needsH?sWidth:0);this.vert.firstChild.style.height=Math.max(0,measure.scrollHeight-measure.clientHeight+totalHeight)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(needsH){this.horiz.style.display="block",this.horiz.style.right=needsV?sWidth+"px":"0",this.horiz.style.left=measure.barLeft+"px";var totalWidth=measure.viewWidth-measure.barLeft-(needsV?sWidth:0);this.horiz.firstChild.style.width=measure.scrollWidth-measure.clientWidth+totalWidth+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&measure.clientHeight>0&&(0==sWidth&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:needsV?sWidth:0,bottom:needsH?sWidth:0}},setScrollLeft:function(pos){this.horiz.scrollLeft!=pos&&(this.horiz.scrollLeft=pos),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(pos){this.vert.scrollTop!=pos&&(this.vert.scrollTop=pos),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var w=mac&&!mac_geMountainLion?"12px":"18px";this.horiz.style.height=this.vert.style.width=w,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Delayed,this.disableVert=new Delayed},enableZeroWidthBar:function(bar,delay){function maybeDisable(){var box=bar.getBoundingClientRect(),elt=document.elementFromPoint(box.left+1,box.bottom-1);elt!=bar?bar.style.pointerEvents="none":delay.set(1e3,maybeDisable)}bar.style.pointerEvents="auto",delay.set(1e3,maybeDisable)},clear:function(){var parent=this.horiz.parentNode;parent.removeChild(this.horiz),parent.removeChild(this.vert)}},NativeScrollbars.prototype),NullScrollbars.prototype=copyObj({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},NullScrollbars.prototype),CodeMirror.scrollbarModel={"native":NativeScrollbars,"null":NullScrollbars},DisplayUpdate.prototype.signal=function(emitter,type){hasHandler(emitter,type)&&this.events.push(arguments)},DisplayUpdate.prototype.finish=function(){for(var i=0;i<this.events.length;i++)signal.apply(null,this.events[i])};var Pos=CodeMirror.Pos=function(line,ch){return this instanceof Pos?(this.line=line,this.ch=ch,void 0):new Pos(line,ch)},cmp=CodeMirror.cmpPos=function(a,b){return a.line-b.line||a.ch-b.ch},lastCopied=null;TextareaInput.prototype=copyObj({init:function(display){function prepareCopyCut(e){if(!signalDOMEvent(cm,e)){if(cm.somethingSelected())lastCopied=cm.getSelections(),input.inaccurateSelection&&(input.prevInput="",input.inaccurateSelection=!1,te.value=lastCopied.join("\n"),selectInput(te));else{if(!cm.options.lineWiseCopyCut)return;var ranges=copyableRanges(cm);lastCopied=ranges.text,"cut"==e.type?cm.setSelections(ranges.ranges,null,sel_dontScroll):(input.prevInput="",te.value=ranges.text.join("\n"),selectInput(te))}"cut"==e.type&&(cm.state.cutIncoming=!0)}}var input=this,cm=this.cm,div=this.wrapper=hiddenTextarea(),te=this.textarea=div.firstChild;display.wrapper.insertBefore(div,display.wrapper.firstChild),ios&&(te.style.width="0px"),on(te,"input",function(){ie&&ie_version>=9&&input.hasSelection&&(input.hasSelection=null),input.poll()}),on(te,"paste",function(e){signalDOMEvent(cm,e)||handlePaste(e,cm)||(cm.state.pasteIncoming=!0,input.fastPoll())}),on(te,"cut",prepareCopyCut),on(te,"copy",prepareCopyCut),on(display.scroller,"paste",function(e){eventInWidget(display,e)||signalDOMEvent(cm,e)||(cm.state.pasteIncoming=!0,input.focus())}),on(display.lineSpace,"selectstart",function(e){eventInWidget(display,e)||e_preventDefault(e)}),on(te,"compositionstart",function(){var start=cm.getCursor("from");input.composing&&input.composing.range.clear(),input.composing={start:start,range:cm.markText(start,cm.getCursor("to"),{className:"CodeMirror-composing"})}}),on(te,"compositionend",function(){input.composing&&(input.poll(),input.composing.range.clear(),input.composing=null)})},prepareSelection:function(){var cm=this.cm,display=cm.display,doc=cm.doc,result=prepareSelection(cm);if(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,doc.sel.primary().head,"div"),wrapOff=display.wrapper.getBoundingClientRect(),lineOff=display.lineDiv.getBoundingClientRect();result.teTop=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top)),result.teLeft=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))}return result},showSelection:function(drawn){var cm=this.cm,display=cm.display;removeChildrenAndAdd(display.cursorDiv,drawn.cursors),removeChildrenAndAdd(display.selectionDiv,drawn.selection),null!=drawn.teTop&&(this.wrapper.style.top=drawn.teTop+"px",this.wrapper.style.left=drawn.teLeft+"px")},reset:function(typing){if(!this.contextMenuPending){var minimal,selected,cm=this.cm,doc=cm.doc;if(cm.somethingSelected()){this.prevInput="";var range=doc.sel.primary();minimal=hasCopyEvent&&(range.to().line-range.from().line>100||(selected=cm.getSelection()).length>1e3);var content=minimal?"-":selected||cm.getSelection();this.textarea.value=content,cm.state.focused&&selectInput(this.textarea),ie&&ie_version>=9&&(this.hasSelection=content)}else typing||(this.prevInput=this.textarea.value="",ie&&ie_version>=9&&(this.hasSelection=null));this.inaccurateSelection=minimal}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!mobile||activeElt()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var input=this;input.pollingFast||input.polling.set(this.cm.options.pollInterval,function(){input.poll(),input.cm.state.focused&&input.slowPoll()})},fastPoll:function(){function p(){var changed=input.poll();changed||missed?(input.pollingFast=!1,input.slowPoll()):(missed=!0,input.polling.set(60,p))}var missed=!1,input=this;input.pollingFast=!0,input.polling.set(20,p)},poll:function(){var cm=this.cm,input=this.textarea,prevInput=this.prevInput;if(this.contextMenuPending||!cm.state.focused||hasSelection(input)&&!prevInput&&!this.composing||cm.isReadOnly()||cm.options.disableInput||cm.state.keySeq)return!1;var text=input.value;if(text==prevInput&&!cm.somethingSelected())return!1;if(ie&&ie_version>=9&&this.hasSelection===text||mac&&/[\uf700-\uf7ff]/.test(text))return cm.display.input.reset(),!1;if(cm.doc.sel==cm.display.selForContextMenu){var first=text.charCodeAt(0);if(8203!=first||prevInput||(prevInput=""),8666==first)return this.reset(),this.cm.execCommand("undo")}for(var same=0,l=Math.min(prevInput.length,text.length);l>same&&prevInput.charCodeAt(same)==text.charCodeAt(same);)++same;var self=this;return runInOp(cm,function(){applyTextInput(cm,text.slice(same),prevInput.length-same,null,self.composing?"*compose":null),text.length>1e3||text.indexOf("\n")>-1?input.value=self.prevInput="":self.prevInput=text,self.composing&&(self.composing.range.clear(),self.composing.range=cm.markText(self.composing.start,cm.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){ie&&ie_version>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function prepareSelectAllHack(){if(null!=te.selectionStart){var selected=cm.somethingSelected(),extval=""+(selected?te.value:"");te.value="",te.value=extval,input.prevInput=selected?"":"",te.selectionStart=1,te.selectionEnd=extval.length,display.selForContextMenu=cm.doc.sel}}function rehide(){if(input.contextMenuPending=!1,input.wrapper.style.position="relative",te.style.cssText=oldCSS,ie&&9>ie_version&&display.scrollbars.setScrollTop(display.scroller.scrollTop=scrollPos),null!=te.selectionStart){(!ie||ie&&9>ie_version)&&prepareSelectAllHack();var i=0,poll=function(){display.selForContextMenu==cm.doc.sel&&0==te.selectionStart&&te.selectionEnd>0&&""==input.prevInput?operation(cm,commands.selectAll)(cm):i++<10?display.detectingSelectAll=setTimeout(poll,500):display.input.reset()};display.detectingSelectAll=setTimeout(poll,200)}}var input=this,cm=input.cm,display=cm.display,te=input.textarea,pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(pos&&!presto){var reset=cm.options.resetSelectionOnContextMenu;reset&&-1==cm.doc.sel.contains(pos)&&operation(cm,setSelection)(cm.doc,simpleSelection(pos),sel_dontScroll);var oldCSS=te.style.cssText;if(input.wrapper.style.position="absolute",te.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(ie?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",webkit)var oldScrollY=window.scrollY;if(display.input.focus(),webkit&&window.scrollTo(null,oldScrollY),display.input.reset(),cm.somethingSelected()||(te.value=input.prevInput=" "),input.contextMenuPending=!0,display.selForContextMenu=cm.doc.sel,clearTimeout(display.detectingSelectAll),ie&&ie_version>=9&&prepareSelectAllHack(),captureRightClick){e_stop(e);var mouseup=function(){off(window,"mouseup",mouseup),setTimeout(rehide,20)};on(window,"mouseup",mouseup)}else setTimeout(rehide,50)}},readOnlyChanged:function(val){val||this.reset()},setUneditable:nothing,needsContentAttribute:!1},TextareaInput.prototype),ContentEditableInput.prototype=copyObj({init:function(display){function onCopyCut(e){if(!signalDOMEvent(cm,e)){if(cm.somethingSelected())lastCopied=cm.getSelections(),"cut"==e.type&&cm.replaceSelection("",null,"cut");else{if(!cm.options.lineWiseCopyCut)return;var ranges=copyableRanges(cm);lastCopied=ranges.text,"cut"==e.type&&cm.operation(function(){cm.setSelections(ranges.ranges,0,sel_dontScroll),cm.replaceSelection("",null,"cut")})}if(e.clipboardData&&!ios)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",lastCopied.join("\n"));else{var kludge=hiddenTextarea(),te=kludge.firstChild;cm.display.lineSpace.insertBefore(kludge,cm.display.lineSpace.firstChild),te.value=lastCopied.join("\n");var hadFocus=document.activeElement;selectInput(te),setTimeout(function(){cm.display.lineSpace.removeChild(kludge),hadFocus.focus()},50)}}}var input=this,cm=input.cm,div=input.div=display.lineDiv;disableBrowserMagic(div),on(div,"paste",function(e){signalDOMEvent(cm,e)||handlePaste(e,cm)}),on(div,"compositionstart",function(e){var data=e.data;if(input.composing={sel:cm.doc.sel,data:data,startData:data},data){var prim=cm.doc.sel.primary(),line=cm.getLine(prim.head.line),found=line.indexOf(data,Math.max(0,prim.head.ch-data.length));found>-1&&found<=prim.head.ch&&(input.composing.sel=simpleSelection(Pos(prim.head.line,found),Pos(prim.head.line,found+data.length)))}}),on(div,"compositionupdate",function(e){input.composing.data=e.data}),on(div,"compositionend",function(e){var ours=input.composing;ours&&(e.data==ours.startData||/\u200b/.test(e.data)||(ours.data=e.data),setTimeout(function(){ours.handled||input.applyComposition(ours),input.composing==ours&&(input.composing=null)},50))}),on(div,"touchstart",function(){input.forceCompositionEnd()}),on(div,"input",function(){input.composing||(cm.isReadOnly()||!input.pollContent())&&runInOp(input.cm,function(){regChange(cm)})}),on(div,"copy",onCopyCut),on(div,"cut",onCopyCut)},prepareSelection:function(){var result=prepareSelection(this.cm,!1);return result.focus=this.cm.state.focused,result},showSelection:function(info){info&&this.cm.display.view.length&&(info.focus&&this.showPrimarySelection(),this.showMultipleSelections(info))},showPrimarySelection:function(){var sel=window.getSelection(),prim=this.cm.doc.sel.primary(),curAnchor=domToPos(this.cm,sel.anchorNode,sel.anchorOffset),curFocus=domToPos(this.cm,sel.focusNode,sel.focusOffset);if(!curAnchor||curAnchor.bad||!curFocus||curFocus.bad||0!=cmp(minPos(curAnchor,curFocus),prim.from())||0!=cmp(maxPos(curAnchor,curFocus),prim.to())){var start=posToDOM(this.cm,prim.from()),end=posToDOM(this.cm,prim.to());if(start||end){var view=this.cm.display.view,old=sel.rangeCount&&sel.getRangeAt(0);if(start){if(!end){var measure=view[view.length-1].measure,map=measure.maps?measure.maps[measure.maps.length-1]:measure.map;end={node:map[map.length-1],offset:map[map.length-2]-map[map.length-3]}}}else start={node:view[0].measure.map[2],offset:0};try{var rng=range(start.node,start.offset,end.offset,end.node)}catch(e){}rng&&(!gecko&&this.cm.state.focused?(sel.collapse(start.node,start.offset),rng.collapsed||sel.addRange(rng)):(sel.removeAllRanges(),sel.addRange(rng)),old&&null==sel.anchorNode?sel.addRange(old):gecko&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var input=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){input.gracePeriod=!1,input.selectionChanged()&&input.cm.operation(function(){input.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(info){removeChildrenAndAdd(this.cm.display.cursorDiv,info.cursors),removeChildrenAndAdd(this.cm.display.selectionDiv,info.selection)},rememberSelection:function(){var sel=window.getSelection();this.lastAnchorNode=sel.anchorNode,this.lastAnchorOffset=sel.anchorOffset,this.lastFocusNode=sel.focusNode,this.lastFocusOffset=sel.focusOffset},selectionInEditor:function(){var sel=window.getSelection();if(!sel.rangeCount)return!1;var node=sel.getRangeAt(0).commonAncestorContainer;return contains(this.div,node)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function poll(){input.cm.state.focused&&(input.pollSelection(),input.polling.set(input.cm.options.pollInterval,poll))}var input=this;this.selectionInEditor()?this.pollSelection():runInOp(this.cm,function(){input.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,poll)},selectionChanged:function(){var sel=window.getSelection();return sel.anchorNode!=this.lastAnchorNode||sel.anchorOffset!=this.lastAnchorOffset||sel.focusNode!=this.lastFocusNode||sel.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var sel=window.getSelection(),cm=this.cm;this.rememberSelection();var anchor=domToPos(cm,sel.anchorNode,sel.anchorOffset),head=domToPos(cm,sel.focusNode,sel.focusOffset);anchor&&head&&runInOp(cm,function(){setSelection(cm.doc,simpleSelection(anchor,head),sel_dontScroll),(anchor.bad||head.bad)&&(cm.curOp.selectionChanged=!0)})}},pollContent:function(){var cm=this.cm,display=cm.display,sel=cm.doc.sel.primary(),from=sel.from(),to=sel.to();if(from.line<display.viewFrom||to.line>display.viewTo-1)return!1;var fromIndex;if(from.line==display.viewFrom||0==(fromIndex=findViewIndex(cm,from.line)))var fromLine=lineNo(display.view[0].line),fromNode=display.view[0].node;else var fromLine=lineNo(display.view[fromIndex].line),fromNode=display.view[fromIndex-1].node.nextSibling;var toIndex=findViewIndex(cm,to.line);if(toIndex==display.view.length-1)var toLine=display.viewTo-1,toNode=display.lineDiv.lastChild;else var toLine=lineNo(display.view[toIndex+1].line)-1,toNode=display.view[toIndex+1].node.previousSibling;for(var newText=cm.doc.splitLines(domTextBetween(cm,fromNode,toNode,fromLine,toLine)),oldText=getBetween(cm.doc,Pos(fromLine,0),Pos(toLine,getLine(cm.doc,toLine).text.length));newText.length>1&&oldText.length>1;)if(lst(newText)==lst(oldText))newText.pop(),oldText.pop(),toLine--;else{if(newText[0]!=oldText[0])break;newText.shift(),oldText.shift(),fromLine++}for(var cutFront=0,cutEnd=0,newTop=newText[0],oldTop=oldText[0],maxCutFront=Math.min(newTop.length,oldTop.length);maxCutFront>cutFront&&newTop.charCodeAt(cutFront)==oldTop.charCodeAt(cutFront);)++cutFront;for(var newBot=lst(newText),oldBot=lst(oldText),maxCutEnd=Math.min(newBot.length-(1==newText.length?cutFront:0),oldBot.length-(1==oldText.length?cutFront:0));maxCutEnd>cutEnd&&newBot.charCodeAt(newBot.length-cutEnd-1)==oldBot.charCodeAt(oldBot.length-cutEnd-1);)++cutEnd;newText[newText.length-1]=newBot.slice(0,newBot.length-cutEnd),newText[0]=newText[0].slice(cutFront);var chFrom=Pos(fromLine,cutFront),chTo=Pos(toLine,oldText.length?lst(oldText).length-cutEnd:0);return newText.length>1||newText[0]||cmp(chFrom,chTo)?(replaceRange(cm.doc,newText,chFrom,chTo,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(composing){this.cm.isReadOnly()?operation(this.cm,regChange)(this.cm):composing.data&&composing.data!=composing.startData&&operation(this.cm,applyTextInput)(this.cm,composing.data,0,composing.sel)},setUneditable:function(node){node.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),this.cm.isReadOnly()||operation(this.cm,applyTextInput)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(val){this.div.contentEditable=String("nocursor"!=val)},onContextMenu:nothing,resetPosition:nothing,needsContentAttribute:!0},ContentEditableInput.prototype),CodeMirror.inputStyles={textarea:TextareaInput,contenteditable:ContentEditableInput},Selection.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(other){if(other==this)return!0;if(other.primIndex!=this.primIndex||other.ranges.length!=this.ranges.length)return!1;for(var i=0;i<this.ranges.length;i++){var here=this.ranges[i],there=other.ranges[i];if(0!=cmp(here.anchor,there.anchor)||0!=cmp(here.head,there.head))return!1}return!0},deepCopy:function(){for(var out=[],i=0;i<this.ranges.length;i++)out[i]=new Range(copyPos(this.ranges[i].anchor),copyPos(this.ranges[i].head));return new Selection(out,this.primIndex)},somethingSelected:function(){for(var i=0;i<this.ranges.length;i++)if(!this.ranges[i].empty())return!0;return!1},contains:function(pos,end){end||(end=pos);for(var i=0;i<this.ranges.length;i++){var range=this.ranges[i];if(cmp(end,range.from())>=0&&cmp(pos,range.to())<=0)return i}return-1}},Range.prototype={from:function(){return minPos(this.anchor,this.head)},to:function(){return maxPos(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var measureText,lastClick,lastDoubleClick,nullRect={left:0,right:0,top:0,bottom:0},operationGroup=null,nextOpId=0,lastDrop=0,wheelSamples=0,wheelPixelsPerUnit=null;ie?wheelPixelsPerUnit=-.53:gecko?wheelPixelsPerUnit=15:chrome?wheelPixelsPerUnit=-.7:safari&&(wheelPixelsPerUnit=-1/3);var wheelEventDelta=function(e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;return null==dx&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(dx=e.detail),null==dy&&e.detail&&e.axis==e.VERTICAL_AXIS?dy=e.detail:null==dy&&(dy=e.wheelDelta),{x:dx,y:dy}};CodeMirror.wheelEventPixels=function(e){var delta=wheelEventDelta(e);return delta.x*=wheelPixelsPerUnit,delta.y*=wheelPixelsPerUnit,delta};var stopSeq=new Delayed,lastStoppedKey=null,changeEnd=CodeMirror.changeEnd=function(change){return change.text?Pos(change.from.line+change.text.length-1,lst(change.text).length+(1==change.text.length?change.from.ch:0)):change.to};CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus(),this.display.input.focus()},setOption:function(option,value){var options=this.options,old=options[option];(options[option]!=value||"mode"==option)&&(options[option]=value,optionHandlers.hasOwnProperty(option)&&operation(this,optionHandlers[option])(this,value,old))},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](getKeyMap(map))},removeKeyMap:function(map){for(var maps=this.state.keyMaps,i=0;i<maps.length;++i)if(maps[i]==map||maps[i].name==map)return maps.splice(i,1),!0},addOverlay:methodOp(function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque}),this.state.modeGen++,regChange(this)}),removeOverlay:methodOp(function(spec){for(var overlays=this.state.overlays,i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||"string"==typeof spec&&cur.name==spec)return overlays.splice(i,1),this.state.modeGen++,regChange(this),void 0}}),indentLine:methodOp(function(n,dir,aggressive){"string"!=typeof dir&&"number"!=typeof dir&&(dir=null==dir?this.options.smartIndent?"smart":"prev":dir?"add":"subtract"),isLine(this.doc,n)&&indentLine(this,n,dir,aggressive)}),indentSelection:methodOp(function(how){for(var ranges=this.doc.sel.ranges,end=-1,i=0;i<ranges.length;i++){var range=ranges[i];if(range.empty())range.head.line>end&&(indentLine(this,range.head.line,how,!0),end=range.head.line,i==this.doc.sel.primIndex&&ensureCursorVisible(this));else{var from=range.from(),to=range.to(),start=Math.max(end,from.line);end=Math.min(this.lastLine(),to.line-(to.ch?0:1))+1;for(var j=start;end>j;++j)indentLine(this,j,how);var newRanges=this.doc.sel.ranges;0==from.ch&&ranges.length==newRanges.length&&newRanges[i].from().ch>0&&replaceOneSelection(this.doc,i,new Range(from,newRanges[i].to()),sel_dontScroll)}}}),getTokenAt:function(pos,precise){return takeToken(this,pos,precise)},getLineTokens:function(line,precise){return takeToken(this,Pos(line),precise,!0)},getTokenTypeAt:function(pos){pos=clipPos(this.doc,pos);var type,styles=getLineStyles(this,getLine(this.doc,pos.line)),before=0,after=(styles.length-1)/2,ch=pos.ch;if(0==ch)type=styles[2];else for(;;){var mid=before+after>>1;if((mid?styles[2*mid-1]:0)>=ch)after=mid;else{if(!(styles[2*mid+1]<ch)){type=styles[2*mid+2];break}before=mid+1}}var cut=type?type.indexOf("cm-overlay "):-1;return 0>cut?type:0==cut?null:type.slice(0,cut-1)},getModeAt:function(pos){var mode=this.doc.mode;return mode.innerMode?CodeMirror.innerMode(mode,this.getTokenAt(pos).state).mode:mode},getHelper:function(pos,type){return this.getHelpers(pos,type)[0]},getHelpers:function(pos,type){var found=[];if(!helpers.hasOwnProperty(type))return found;var help=helpers[type],mode=this.getModeAt(pos);if("string"==typeof mode[type])help[mode[type]]&&found.push(help[mode[type]]);else if(mode[type])for(var i=0;i<mode[type].length;i++){var val=help[mode[type][i]];
val&&found.push(val)}else mode.helperType&&help[mode.helperType]?found.push(help[mode.helperType]):help[mode.name]&&found.push(help[mode.name]);for(var i=0;i<help._global.length;i++){var cur=help._global[i];cur.pred(mode,this)&&-1==indexOf(found,cur.val)&&found.push(cur.val)}return found},getStateAfter:function(line,precise){var doc=this.doc;return line=clipLine(doc,null==line?doc.first+doc.size-1:line),getStateBefore(this,line+1,precise)},cursorCoords:function(start,mode){var pos,range=this.doc.sel.primary();return pos=null==start?range.head:"object"==typeof start?clipPos(this.doc,start):start?range.from():range.to(),cursorCoords(this,pos,mode||"page")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||"page")},coordsChar:function(coords,mode){return coords=fromCoordSystem(this,coords,mode||"page"),coordsChar(this,coords.left,coords.top)},lineAtHeight:function(height,mode){return height=fromCoordSystem(this,{top:height,left:0},mode||"page").top,lineAtHeight(this.doc,height+this.display.viewOffset)},heightAtLine:function(line,mode){var lineObj,end=!1;if("number"==typeof line){var last=this.doc.first+this.doc.size-1;line<this.doc.first?line=this.doc.first:line>last&&(line=last,end=!0),lineObj=getLine(this.doc,line)}else lineObj=line;return intoCoordSystem(this,lineObj,{top:0,left:0},mode||"page").top+(end?this.doc.height-heightAtLine(lineObj):0)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},setGutterMarker:methodOp(function(line,gutterID,value){return changeLine(this.doc,line,"gutter",function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});return markers[gutterID]=value,!value&&isEmpty(markers)&&(line.gutterMarkers=null),!0})}),clearGutter:methodOp(function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){line.gutterMarkers&&line.gutterMarkers[gutterID]&&(line.gutterMarkers[gutterID]=null,regLineChange(cm,i,"gutter"),isEmpty(line.gutterMarkers)&&(line.gutterMarkers=null)),++i})}),lineInfo:function(line){if("number"==typeof line){if(!isLine(this.doc,line))return null;var n=line;if(line=getLine(this.doc,line),!line)return null}else{var n=lineNo(line);if(null==n)return null}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;if(node.style.position="absolute",node.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(node),display.sizer.appendChild(node),"over"==vert)top=pos.top;else if("above"==vert||"near"==vert){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);("above"==vert||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight?top=pos.top-node.offsetHeight:pos.bottom+node.offsetHeight<=vspace&&(top=pos.bottom),left+node.offsetWidth>hspace&&(left=hspace-node.offsetWidth)}node.style.top=top+"px",node.style.left=node.style.right="","right"==horiz?(left=display.sizer.clientWidth-node.offsetWidth,node.style.right="0px"):("left"==horiz?left=0:"middle"==horiz&&(left=(display.sizer.clientWidth-node.offsetWidth)/2),node.style.left=left+"px"),scroll&&scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight)},triggerOnKeyDown:methodOp(onKeyDown),triggerOnKeyPress:methodOp(onKeyPress),triggerOnKeyUp:onKeyUp,execCommand:function(cmd){return commands.hasOwnProperty(cmd)?commands[cmd].call(null,this):void 0},triggerElectric:methodOp(function(text){triggerElectric(this,text)}),findPosH:function(from,amount,unit,visually){var dir=1;0>amount&&(dir=-1,amount=-amount);for(var i=0,cur=clipPos(this.doc,from);amount>i&&(cur=findPosH(this.doc,cur,dir,unit,visually),!cur.hitSide);++i);return cur},moveH:methodOp(function(dir,unit){var cm=this;cm.extendSelectionsBy(function(range){return cm.display.shift||cm.doc.extend||range.empty()?findPosH(cm.doc,range.head,dir,unit,cm.options.rtlMoveVisually):0>dir?range.from():range.to()},sel_move)}),deleteH:methodOp(function(dir,unit){var sel=this.doc.sel,doc=this.doc;sel.somethingSelected()?doc.replaceSelection("",null,"+delete"):deleteNearSelection(this,function(range){var other=findPosH(doc,range.head,dir,unit,!1);return 0>dir?{from:other,to:range.head}:{from:range.head,to:other}})}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;0>amount&&(dir=-1,amount=-amount);for(var i=0,cur=clipPos(this.doc,from);amount>i;++i){var coords=cursorCoords(this,cur,"div");if(null==x?x=coords.left:coords.left=x,cur=findPosV(this,coords,dir,unit),cur.hitSide)break}return cur},moveV:methodOp(function(dir,unit){var cm=this,doc=this.doc,goals=[],collapse=!cm.display.shift&&!doc.extend&&doc.sel.somethingSelected();if(doc.extendSelectionsBy(function(range){if(collapse)return 0>dir?range.from():range.to();var headPos=cursorCoords(cm,range.head,"div");null!=range.goalColumn&&(headPos.left=range.goalColumn),goals.push(headPos.left);var pos=findPosV(cm,headPos,dir,unit);return"page"==unit&&range==doc.sel.primary()&&addToScrollPos(cm,null,charCoords(cm,pos,"div").top-headPos.top),pos},sel_move),goals.length)for(var i=0;i<doc.sel.ranges.length;i++)doc.sel.ranges[i].goalColumn=goals[i]}),findWordAt:function(pos){var doc=this.doc,line=getLine(doc,pos.line).text,start=pos.ch,end=pos.ch;if(line){var helper=this.getHelper(pos,"wordChars");(pos.xRel<0||end==line.length)&&start?--start:++end;for(var startChar=line.charAt(start),check=isWordChar(startChar,helper)?function(ch){return isWordChar(ch,helper)}:/\s/.test(startChar)?function(ch){return/\s/.test(ch)}:function(ch){return!/\s/.test(ch)&&!isWordChar(ch)};start>0&&check(line.charAt(start-1));)--start;for(;end<line.length&&check(line.charAt(end));)++end}return new Range(Pos(pos.line,start),Pos(pos.line,end))},toggleOverwrite:function(value){(null==value||value!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?addClass(this.display.cursorDiv,"CodeMirror-overwrite"):rmClass(this.display.cursorDiv,"CodeMirror-overwrite"),signal(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==activeElt()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:methodOp(function(x,y){(null!=x||null!=y)&&resolveScrollToPos(this),null!=x&&(this.curOp.scrollLeft=x),null!=y&&(this.curOp.scrollTop=y)}),getScrollInfo:function(){var scroller=this.display.scroller;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-scrollGap(this)-this.display.barHeight,width:scroller.scrollWidth-scrollGap(this)-this.display.barWidth,clientHeight:displayHeight(this),clientWidth:displayWidth(this)}},scrollIntoView:methodOp(function(range,margin){if(null==range?(range={from:this.doc.sel.primary().head,to:null},null==margin&&(margin=this.options.cursorScrollMargin)):"number"==typeof range?range={from:Pos(range,0),to:null}:null==range.from&&(range={from:range,to:null}),range.to||(range.to=range.from),range.margin=margin||0,null!=range.from.line)resolveScrollToPos(this),this.curOp.scrollToPos=range;else{var sPos=calculateScrollPos(this,Math.min(range.from.left,range.to.left),Math.min(range.from.top,range.to.top)-range.margin,Math.max(range.from.right,range.to.right),Math.max(range.from.bottom,range.to.bottom)+range.margin);this.scrollTo(sPos.scrollLeft,sPos.scrollTop)}}),setSize:methodOp(function(width,height){function interpret(val){return"number"==typeof val||/^\d+$/.test(String(val))?val+"px":val}var cm=this;null!=width&&(cm.display.wrapper.style.width=interpret(width)),null!=height&&(cm.display.wrapper.style.height=interpret(height)),cm.options.lineWrapping&&clearLineMeasurementCache(this);var lineNo=cm.display.viewFrom;cm.doc.iter(lineNo,cm.display.viewTo,function(line){if(line.widgets)for(var i=0;i<line.widgets.length;i++)if(line.widgets[i].noHScroll){regLineChange(cm,lineNo,"widget");break}++lineNo}),cm.curOp.forceUpdate=!0,signal(cm,"refresh",this)}),operation:function(f){return runInOp(this,f)},refresh:methodOp(function(){var oldHeight=this.display.cachedTextHeight;regChange(this),this.curOp.forceUpdate=!0,clearCaches(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),updateGutterSpace(this),(null==oldHeight||Math.abs(oldHeight-textHeight(this.display))>.5)&&estimateLineHeights(this),signal(this,"refresh",this)}),swapDoc:methodOp(function(doc){var old=this.doc;return old.cm=null,attachDoc(this,doc),clearCaches(this),this.display.input.reset(),this.scrollTo(doc.scrollLeft,doc.scrollTop),this.curOp.forceScroll=!0,signalLater(this,"swapDoc",this,old),old}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},eventMixin(CodeMirror);var defaults=CodeMirror.defaults={},optionHandlers=CodeMirror.optionHandlers={},Init=CodeMirror.Init={toString:function(){return"CodeMirror.Init"}};option("value","",function(cm,val){cm.setValue(val)},!0),option("mode",null,function(cm,val){cm.doc.modeOption=val,loadMode(cm)},!0),option("indentUnit",2,loadMode,!0),option("indentWithTabs",!1),option("smartIndent",!0),option("tabSize",4,function(cm){resetModeState(cm),clearCaches(cm),regChange(cm)},!0),option("lineSeparator",null,function(cm,val){if(cm.doc.lineSep=val,val){var newBreaks=[],lineNo=cm.doc.first;cm.doc.iter(function(line){for(var pos=0;;){var found=line.text.indexOf(val,pos);if(-1==found)break;pos=found+val.length,newBreaks.push(Pos(lineNo,found))}lineNo++});for(var i=newBreaks.length-1;i>=0;i--)replaceRange(cm.doc,val,newBreaks[i],Pos(newBreaks[i].line,newBreaks[i].ch+val.length))}}),option("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(cm,val,old){cm.state.specialChars=new RegExp(val.source+(val.test("	")?"":"|	"),"g"),old!=CodeMirror.Init&&cm.refresh()}),option("specialCharPlaceholder",defaultSpecialCharPlaceholder,function(cm){cm.refresh()},!0),option("electricChars",!0),option("inputStyle",mobile?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),option("rtlMoveVisually",!windows),option("wholeLineUpdateBefore",!0),option("theme","default",function(cm){themeChanged(cm),guttersChanged(cm)},!0),option("keyMap","default",function(cm,val,old){var next=getKeyMap(val),prev=old!=CodeMirror.Init&&getKeyMap(old);prev&&prev.detach&&prev.detach(cm,next),next.attach&&next.attach(cm,prev||null)}),option("extraKeys",null),option("lineWrapping",!1,wrappingChanged,!0),option("gutters",[],function(cm){setGuttersForLineNumbers(cm.options),guttersChanged(cm)},!0),option("fixedGutter",!0,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0",cm.refresh()},!0),option("coverGutterNextToScrollbar",!1,function(cm){updateScrollbars(cm)},!0),option("scrollbarStyle","native",function(cm){initScrollbars(cm),updateScrollbars(cm),cm.display.scrollbars.setScrollTop(cm.doc.scrollTop),cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft)},!0),option("lineNumbers",!1,function(cm){setGuttersForLineNumbers(cm.options),guttersChanged(cm)},!0),option("firstLineNumber",1,guttersChanged,!0),option("lineNumberFormatter",function(integer){return integer},guttersChanged,!0),option("showCursorWhenSelecting",!1,updateSelection,!0),option("resetSelectionOnContextMenu",!0),option("lineWiseCopyCut",!0),option("readOnly",!1,function(cm,val){"nocursor"==val?(onBlur(cm),cm.display.input.blur(),cm.display.disabled=!0):cm.display.disabled=!1,cm.display.input.readOnlyChanged(val)}),option("disableInput",!1,function(cm,val){val||cm.display.input.reset()},!0),option("dragDrop",!0,dragDropChanged),option("allowDropFileTypes",null),option("cursorBlinkRate",530),option("cursorScrollMargin",0),option("cursorHeight",1,updateSelection,!0),option("singleCursorHeightPerLine",!0,updateSelection,!0),option("workTime",100),option("workDelay",100),option("flattenSpans",!0,resetModeState,!0),option("addModeClass",!1,resetModeState,!0),option("pollInterval",100),option("undoDepth",200,function(cm,val){cm.doc.history.undoDepth=val}),option("historyEventDelay",1250),option("viewportMargin",10,function(cm){cm.refresh()},!0),option("maxHighlightLength",1e4,resetModeState,!0),option("moveInputWithCursor",!0,function(cm,val){val||cm.display.input.resetPosition()}),option("tabindex",null,function(cm,val){cm.display.input.getField().tabIndex=val||""}),option("autofocus",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){CodeMirror.defaults.mode||"null"==name||(CodeMirror.defaults.mode=name),arguments.length>2&&(mode.dependencies=Array.prototype.slice.call(arguments,2)),modes[name]=mode},CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec},CodeMirror.resolveMode=function(spec){if("string"==typeof spec&&mimeModes.hasOwnProperty(spec))spec=mimeModes[spec];else if(spec&&"string"==typeof spec.name&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];"string"==typeof found&&(found={name:found}),spec=createObj(found,spec),spec.name=found.name}else if("string"==typeof spec&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec))return CodeMirror.resolveMode("application/xml");return"string"==typeof spec?{name:spec}:spec||{name:"null"}},CodeMirror.getMode=function(options,spec){var spec=CodeMirror.resolveMode(spec),mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,"text/plain");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts)exts.hasOwnProperty(prop)&&(modeObj.hasOwnProperty(prop)&&(modeObj["_"+prop]=modeObj[prop]),modeObj[prop]=exts[prop])}if(modeObj.name=spec.name,spec.helperType&&(modeObj.helperType=spec.helperType),spec.modeProps)for(var prop in spec.modeProps)modeObj[prop]=spec.modeProps[prop];return modeObj},CodeMirror.defineMode("null",function(){return{token:function(stream){stream.skipToEnd()}}}),CodeMirror.defineMIME("text/plain","null");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)},CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func},CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func},CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};var helpers=CodeMirror.helpers={};CodeMirror.registerHelper=function(type,name,value){helpers.hasOwnProperty(type)||(helpers[type]=CodeMirror[type]={_global:[]}),helpers[type][name]=value},CodeMirror.registerGlobalHelper=function(type,name,predicate,value){CodeMirror.registerHelper(type,name,value),helpers[type]._global.push({pred:predicate,val:value})};var copyState=CodeMirror.copyState=function(mode,state){if(state===!0)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];val instanceof Array&&(val=val.concat([])),nstate[n]=val}return nstate},startState=CodeMirror.startState=function(mode,a1,a2){return mode.startState?mode.startState(a1,a2):!0};CodeMirror.innerMode=function(mode,state){for(;mode.innerMode;){var info=mode.innerMode(state);if(!info||info.mode==mode)break;state=info.state,mode=info.mode}return info||{mode:mode,state:state}};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()),sel_dontScroll)},singleSelection:function(cm){cm.setSelection(cm.getCursor("anchor"),cm.getCursor("head"),sel_dontScroll)},killLine:function(cm){deleteNearSelection(cm,function(range){if(range.empty()){var len=getLine(cm.doc,range.head.line).text.length;return range.head.ch==len&&range.head.line<cm.lastLine()?{from:range.head,to:Pos(range.head.line+1,0)}:{from:range.head,to:Pos(range.head.line,len)}}return{from:range.from(),to:range.to()}})},deleteLine:function(cm){deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:clipPos(cm.doc,Pos(range.to().line+1,0))}})},delLineLeft:function(cm){deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:range.from()}})},delWrappedLineLeft:function(cm){deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5,leftPos=cm.coordsChar({left:0,top:top},"div");return{from:leftPos,to:range.from()}})},delWrappedLineRight:function(cm){deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5,rightPos=cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div");return{from:range.from(),to:rightPos}})},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},undoSelection:function(cm){cm.undoSelection()},redoSelection:function(cm){cm.redoSelection()},goDocStart:function(cm){cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){cm.extendSelectionsBy(function(range){return lineStart(cm,range.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(cm){cm.extendSelectionsBy(function(range){return lineStartSmart(cm,range.head)},{origin:"+move",bias:1})},goLineEnd:function(cm){cm.extendSelectionsBy(function(range){return lineEnd(cm,range.head.line)},{origin:"+move",bias:-1})},goLineRight:function(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;return cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div")},sel_move)},goLineLeft:function(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;return cm.coordsChar({left:0,top:top},"div")},sel_move)},goLineLeftSmart:function(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5,pos=cm.coordsChar({left:0,top:top},"div");return pos.ch<cm.getLine(pos.line).search(/\S/)?lineStartSmart(cm,range.head):pos},sel_move)},goLineUp:function(cm){cm.moveV(-1,"line")},goLineDown:function(cm){cm.moveV(1,"line")},goPageUp:function(cm){cm.moveV(-1,"page")},goPageDown:function(cm){cm.moveV(1,"page")},goCharLeft:function(cm){cm.moveH(-1,"char")},goCharRight:function(cm){cm.moveH(1,"char")},goColumnLeft:function(cm){cm.moveH(-1,"column")},goColumnRight:function(cm){cm.moveH(1,"column")},goWordLeft:function(cm){cm.moveH(-1,"word")},goGroupRight:function(cm){cm.moveH(1,"group")},goGroupLeft:function(cm){cm.moveH(-1,"group")},goWordRight:function(cm){cm.moveH(1,"word")},delCharBefore:function(cm){cm.deleteH(-1,"char")},delCharAfter:function(cm){cm.deleteH(1,"char")},delWordBefore:function(cm){cm.deleteH(-1,"word")},delWordAfter:function(cm){cm.deleteH(1,"word")},delGroupBefore:function(cm){cm.deleteH(-1,"group")},delGroupAfter:function(cm){cm.deleteH(1,"group")},indentAuto:function(cm){cm.indentSelection("smart")},indentMore:function(cm){cm.indentSelection("add")},indentLess:function(cm){cm.indentSelection("subtract")},insertTab:function(cm){cm.replaceSelection("	")},insertSoftTab:function(cm){for(var spaces=[],ranges=cm.listSelections(),tabSize=cm.options.tabSize,i=0;i<ranges.length;i++){var pos=ranges[i].from(),col=countColumn(cm.getLine(pos.line),pos.ch,tabSize);spaces.push(new Array(tabSize-col%tabSize+1).join(" "))}cm.replaceSelections(spaces)},defaultTab:function(cm){cm.somethingSelected()?cm.indentSelection("add"):cm.execCommand("insertTab")},transposeChars:function(cm){runInOp(cm,function(){for(var ranges=cm.listSelections(),newSel=[],i=0;i<ranges.length;i++){var cur=ranges[i].head,line=getLine(cm.doc,cur.line).text;if(line)if(cur.ch==line.length&&(cur=new Pos(cur.line,cur.ch-1)),cur.ch>0)cur=new Pos(cur.line,cur.ch+1),cm.replaceRange(line.charAt(cur.ch-1)+line.charAt(cur.ch-2),Pos(cur.line,cur.ch-2),cur,"+transpose");else if(cur.line>cm.doc.first){var prev=getLine(cm.doc,cur.line-1).text;prev&&cm.replaceRange(line.charAt(0)+cm.doc.lineSeparator()+prev.charAt(prev.length-1),Pos(cur.line-1,prev.length-1),Pos(cur.line,1),"+transpose")}newSel.push(new Range(cur,cur))}cm.setSelections(newSel)})},newlineAndIndent:function(cm){runInOp(cm,function(){for(var len=cm.listSelections().length,i=0;len>i;i++){var range=cm.listSelections()[i];cm.replaceRange(cm.doc.lineSeparator(),range.anchor,range.head,"+input"),cm.indentLine(range.from().line+1,null,!0)}ensureCursorVisible(cm)})},toggleOverwrite:function(cm){cm.toggleOverwrite()}},keyMap=CodeMirror.keyMap={};keyMap.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault,CodeMirror.normalizeKeyMap=function(keymap){var copy={};for(var keyname in keymap)if(keymap.hasOwnProperty(keyname)){var value=keymap[keyname];if(/^(name|fallthrough|(de|at)tach)$/.test(keyname))continue;if("..."==value){delete keymap[keyname];continue}for(var keys=map(keyname.split(" "),normalizeKeyName),i=0;i<keys.length;i++){var val,name;i==keys.length-1?(name=keys.join(" "),val=value):(name=keys.slice(0,i+1).join(" "),val="...");var prev=copy[name];if(prev){if(prev!=val)throw new Error("Inconsistent bindings for "+name)}else copy[name]=val}delete keymap[keyname]}for(var prop in copy)keymap[prop]=copy[prop];return keymap};var lookupKey=CodeMirror.lookupKey=function(key,map,handle,context){map=getKeyMap(map);var found=map.call?map.call(key,context):map[key];if(found===!1)return"nothing";if("..."===found)return"multi";if(null!=found&&handle(found))return"handled";if(map.fallthrough){if("[object Array]"!=Object.prototype.toString.call(map.fallthrough))return lookupKey(key,map.fallthrough,handle,context);for(var i=0;i<map.fallthrough.length;i++){var result=lookupKey(key,map.fallthrough[i],handle,context);if(result)return result}}},isModifierKey=CodeMirror.isModifierKey=function(value){var name="string"==typeof value?value:keyNames[value.keyCode];return"Ctrl"==name||"Alt"==name||"Shift"==name||"Mod"==name},keyName=CodeMirror.keyName=function(event,noShift){if(presto&&34==event.keyCode&&event["char"])return!1;var base=keyNames[event.keyCode],name=base;return null==name||event.altGraphKey?!1:(event.altKey&&"Alt"!=base&&(name="Alt-"+name),(flipCtrlCmd?event.metaKey:event.ctrlKey)&&"Ctrl"!=base&&(name="Ctrl-"+name),(flipCtrlCmd?event.ctrlKey:event.metaKey)&&"Cmd"!=base&&(name="Cmd-"+name),!noShift&&event.shiftKey&&"Shift"!=base&&(name="Shift-"+name),name)};CodeMirror.fromTextArea=function(textarea,options){function save(){textarea.value=cm.getValue()}if(options=options?copyObj(options):{},options.value=textarea.value,!options.tabindex&&textarea.tabIndex&&(options.tabindex=textarea.tabIndex),!options.placeholder&&textarea.placeholder&&(options.placeholder=textarea.placeholder),null==options.autofocus){var hasFocus=activeElt();options.autofocus=hasFocus==textarea||null!=textarea.getAttribute("autofocus")&&hasFocus==document.body}if(textarea.form&&(on(textarea.form,"submit",save),!options.leaveSubmitMethodAlone)){var form=textarea.form,realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save(),form.submit=realSubmit,form.submit(),form.submit=wrappedSubmit}}catch(e){}}options.finishInit=function(cm){cm.save=save,cm.getTextArea=function(){return textarea},cm.toTextArea=function(){cm.toTextArea=isNaN,save(),textarea.parentNode.removeChild(cm.getWrapperElement()),textarea.style.display="",textarea.form&&(off(textarea.form,"submit",save),"function"==typeof textarea.form.submit&&(textarea.form.submit=realSubmit))}},textarea.style.display="none";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);return cm};var StringStream=CodeMirror.StringStream=function(string,tabSize){this.pos=this.start=0,this.string=string,this.tabSize=tabSize||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(match){var ch=this.string.charAt(this.pos);if("string"==typeof match)var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));return ok?(++this.pos,ch):void 0},eatWhile:function(match){for(var start=this.pos;this.eat(match););return this.pos>start},eatSpace:function(){for(var start=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);return found>-1?(this.pos=found,!0):void 0},backUp:function(n){this.pos-=n},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},match:function(pattern,consume,caseInsensitive){if("string"!=typeof pattern){var match=this.string.slice(this.pos).match(pattern);return match&&match.index>0?null:(match&&consume!==!1&&(this.pos+=match[0].length),match)}var cased=function(str){return caseInsensitive?str.toLowerCase():str},substr=this.string.substr(this.pos,pattern.length);return cased(substr)==cased(pattern)?(consume!==!1&&(this.pos+=pattern.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(n,inner){this.lineStart+=n;try{return inner()}finally{this.lineStart-=n}}};var nextMarkerId=0,TextMarker=CodeMirror.TextMarker=function(doc,type){this.lines=[],this.type=type,this.doc=doc,this.id=++nextMarkerId};eventMixin(TextMarker),TextMarker.prototype.clear=function(){if(!this.explicitlyCleared){var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp&&startOperation(cm),hasHandler(this,"clear")){var found=this.find();found&&signalLater(this,"clear",found.from,found.to)}for(var min=null,max=null,i=0;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);cm&&!this.collapsed?regLineChange(cm,lineNo(line),"text"):cm&&(null!=span.to&&(max=lineNo(line)),null!=span.from&&(min=lineNo(line))),line.markedSpans=removeMarkedSpan(line.markedSpans,span),null==span.from&&this.collapsed&&!lineIsHidden(this.doc,line)&&cm&&updateLineHeight(line,textHeight(cm.display))}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(this.lines[i]),len=lineLength(visual);len>cm.display.maxLineLength&&(cm.display.maxLine=visual,cm.display.maxLineLength=len,cm.display.maxLineChanged=!0)}null!=min&&cm&&this.collapsed&&regChange(cm,min,max+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,cm&&reCheckSelection(cm.doc)),cm&&signalLater(cm,"markerCleared",cm,this),withOp&&endOperation(cm),this.parent&&this.parent.clear()}},TextMarker.prototype.find=function(side,lineObj){null==side&&"bookmark"==this.type&&(side=1);for(var from,to,i=0;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);if(null!=span.from&&(from=Pos(lineObj?line:lineNo(line),span.from),-1==side))return from;if(null!=span.to&&(to=Pos(lineObj?line:lineNo(line),span.to),1==side))return to}return from&&{from:from,to:to}},TextMarker.prototype.changed=function(){var pos=this.find(-1,!0),widget=this,cm=this.doc.cm;pos&&cm&&runInOp(cm,function(){var line=pos.line,lineN=lineNo(pos.line),view=findViewForLine(cm,lineN);if(view&&(clearLineMeasurementCacheFor(view),cm.curOp.selectionChanged=cm.curOp.forceUpdate=!0),cm.curOp.updateMaxLine=!0,!lineIsHidden(widget.doc,line)&&null!=widget.height){var oldHeight=widget.height;widget.height=null;var dHeight=widgetHeight(widget)-oldHeight;dHeight&&updateLineHeight(line,line.height+dHeight)}})},TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;op.maybeHiddenMarkers&&-1!=indexOf(op.maybeHiddenMarkers,this)||(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)},TextMarker.prototype.detachLine=function(line){if(this.lines.splice(indexOf(this.lines,line),1),!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}};var nextMarkerId=0,SharedTextMarker=CodeMirror.SharedTextMarker=function(markers,primary){this.markers=markers,this.primary=primary;for(var i=0;i<markers.length;++i)markers[i].parent=this};eventMixin(SharedTextMarker),SharedTextMarker.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,"clear")}},SharedTextMarker.prototype.find=function(side,lineObj){return this.primary.find(side,lineObj)};var LineWidget=CodeMirror.LineWidget=function(doc,node,options){if(options)for(var opt in options)options.hasOwnProperty(opt)&&(this[opt]=options[opt]);this.doc=doc,this.node=node};eventMixin(LineWidget),LineWidget.prototype.clear=function(){var cm=this.doc.cm,ws=this.line.widgets,line=this.line,no=lineNo(line);if(null!=no&&ws){for(var i=0;i<ws.length;++i)ws[i]==this&&ws.splice(i--,1);ws.length||(line.widgets=null);var height=widgetHeight(this);updateLineHeight(line,Math.max(0,line.height-height)),cm&&runInOp(cm,function(){adjustScrollWhenAboveVisible(cm,line,-height),regLineChange(cm,no,"widget")})}},LineWidget.prototype.changed=function(){var oldH=this.height,cm=this.doc.cm,line=this.line;this.height=null;var diff=widgetHeight(this)-oldH;diff&&(updateLineHeight(line,line.height+diff),cm&&runInOp(cm,function(){cm.curOp.forceUpdate=!0,adjustScrollWhenAboveVisible(cm,line,diff)}))};var Line=CodeMirror.Line=function(text,markedSpans,estimateHeight){this.text=text,attachMarkedSpans(this,markedSpans),this.height=estimateHeight?estimateHeight(this):1};eventMixin(Line),Line.prototype.lineNo=function(){return lineNo(this)};var styleToClassCache={},styleToClassCacheWithMode={};LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;e>i;++i){var line=this.lines[i];this.height-=line.height,cleanUpLine(line),signalLater(line,"delete")
}this.lines.splice(at,n)},collapse:function(lines){lines.push.apply(lines,this.lines)},insertInner:function(at,lines,height){this.height+=height,this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0;i<lines.length;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;e>at;++at)if(op(this.lines[at]))return!0}},BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(sz>at){var rm=Math.min(n,sz-at),oldHeight=child.height;if(child.removeInner(at,rm),this.height-=oldHeight-child.height,sz==rm&&(this.children.splice(i--,1),child.parent=null),0==(n-=rm))break;at=0}else at-=sz}if(this.size-n<25&&(this.children.length>1||!(this.children[0]instanceof LeafChunk))){var lines=[];this.collapse(lines),this.children=[new LeafChunk(lines)],this.children[0].parent=this}},collapse:function(lines){for(var i=0;i<this.children.length;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length,this.height+=height;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(sz>=at){if(child.insertInner(at,lines,height),child.lines&&child.lines.length>50){for(;child.lines.length>50;){var spilled=child.lines.splice(child.lines.length-25,25),newleaf=new LeafChunk(spilled);child.height-=newleaf.height,this.children.splice(i+1,0,newleaf),newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(!(this.children.length<=10)){var me=this;do{var spilled=me.children.splice(me.children.length-5,5),sibling=new BranchChunk(spilled);if(me.parent){me.size-=sibling.size,me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}else{var copy=new BranchChunk(me.children);copy.parent=me,me.children=[copy,sibling],me=copy}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()}},iterN:function(at,n,op){for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(sz>at){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return!0;if(0==(n-=used))break;at=0}else at-=sz}}};var nextDocId=0,Doc=CodeMirror.Doc=function(text,mode,firstLine,lineSep){if(!(this instanceof Doc))return new Doc(text,mode,firstLine,lineSep);null==firstLine&&(firstLine=0),BranchChunk.call(this,[new LeafChunk([new Line("",null)])]),this.first=firstLine,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=firstLine;var start=Pos(firstLine,0);this.sel=simpleSelection(start),this.history=new History(null),this.id=++nextDocId,this.modeOption=mode,this.lineSep=lineSep,this.extend=!1,"string"==typeof text&&(text=this.splitLines(text)),updateDoc(this,{from:start,to:start,text:text}),setSelection(this,simpleSelection(start),sel_dontScroll)};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){op?this.iterN(from-this.first,to-from,op):this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){for(var height=0,i=0;i<lines.length;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);return lineSep===!1?lines:lines.join(lineSep||this.lineSeparator())},setValue:docMethodOp(function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:this.splitLines(code),origin:"setValue",full:!0},!0),setSelection(this,simpleSelection(top))}),replaceRange:function(code,from,to,origin){from=clipPos(this,from),to=to?clipPos(this,to):from,replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));return lineSep===!1?lines:lines.join(lineSep||this.lineSeparator())},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},getLineHandle:function(line){return isLine(this,line)?getLine(this,line):void 0},getLineNumber:function(line){return lineNo(line)},getLineHandleVisualStart:function(line){return"number"==typeof line&&(line=getLine(this,line)),visualLine(line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var pos,range=this.sel.primary();return pos=null==start||"head"==start?range.head:"anchor"==start?range.anchor:"end"==start||"to"==start||start===!1?range.to():range.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:docMethodOp(function(line,ch,options){setSimpleSelection(this,clipPos(this,"number"==typeof line?Pos(line,ch||0):line),null,options)}),setSelection:docMethodOp(function(anchor,head,options){setSimpleSelection(this,clipPos(this,anchor),clipPos(this,head||anchor),options)}),extendSelection:docMethodOp(function(head,other,options){extendSelection(this,clipPos(this,head),other&&clipPos(this,other),options)}),extendSelections:docMethodOp(function(heads,options){extendSelections(this,clipPosArray(this,heads),options)}),extendSelectionsBy:docMethodOp(function(f,options){var heads=map(this.sel.ranges,f);extendSelections(this,clipPosArray(this,heads),options)}),setSelections:docMethodOp(function(ranges,primary,options){if(ranges.length){for(var i=0,out=[];i<ranges.length;i++)out[i]=new Range(clipPos(this,ranges[i].anchor),clipPos(this,ranges[i].head));null==primary&&(primary=Math.min(ranges.length-1,this.sel.primIndex)),setSelection(this,normalizeSelection(out,primary),options)}}),addSelection:docMethodOp(function(anchor,head,options){var ranges=this.sel.ranges.slice(0);ranges.push(new Range(clipPos(this,anchor),clipPos(this,head||anchor))),setSelection(this,normalizeSelection(ranges,ranges.length-1),options)}),getSelection:function(lineSep){for(var lines,ranges=this.sel.ranges,i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());lines=lines?lines.concat(sel):sel}return lineSep===!1?lines:lines.join(lineSep||this.lineSeparator())},getSelections:function(lineSep){for(var parts=[],ranges=this.sel.ranges,i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());lineSep!==!1&&(sel=sel.join(lineSep||this.lineSeparator())),parts[i]=sel}return parts},replaceSelection:function(code,collapse,origin){for(var dup=[],i=0;i<this.sel.ranges.length;i++)dup[i]=code;this.replaceSelections(dup,collapse,origin||"+input")},replaceSelections:docMethodOp(function(code,collapse,origin){for(var changes=[],sel=this.sel,i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];changes[i]={from:range.from(),to:range.to(),text:this.splitLines(code[i]),origin:origin}}for(var newSel=collapse&&"end"!=collapse&&computeReplacedSel(this,changes,collapse),i=changes.length-1;i>=0;i--)makeChange(this,changes[i]);newSel?setSelectionReplaceHistory(this,newSel):this.cm&&ensureCursorVisible(this.cm)}),undo:docMethodOp(function(){makeChangeFromHistory(this,"undo")}),redo:docMethodOp(function(){makeChangeFromHistory(this,"redo")}),undoSelection:docMethodOp(function(){makeChangeFromHistory(this,"undo",!0)}),redoSelection:docMethodOp(function(){makeChangeFromHistory(this,"redo",!0)}),setExtending:function(val){this.extend=val},getExtending:function(){return this.extend},historySize:function(){for(var hist=this.history,done=0,undone=0,i=0;i<hist.done.length;i++)hist.done[i].ranges||++done;for(var i=0;i<hist.undone.length;i++)hist.undone[i].ranges||++undone;return{undo:done,redo:undone}},clearHistory:function(){this.history=new History(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(forceSplit){return forceSplit&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(gen){return this.history.generation==(gen||this.cleanGeneration)},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=new History(this.history.maxGeneration);hist.done=copyHistoryArray(histData.done.slice(0),null,!0),hist.undone=copyHistoryArray(histData.undone.slice(0),null,!0)},addLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,"gutter"==where?"gutter":"class",function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"gutter"==where?"gutterClass":"wrapClass";if(line[prop]){if(classTest(cls).test(line[prop]))return!1;line[prop]+=" "+cls}else line[prop]=cls;return!0})}),removeLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,"gutter"==where?"gutter":"class",function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"gutter"==where?"gutterClass":"wrapClass",cur=line[prop];if(!cur)return!1;if(null==cls)line[prop]=null;else{var found=cur.match(classTest(cls));if(!found)return!1;var end=found.index+found[0].length;line[prop]=cur.slice(0,found.index)+(found.index&&end!=cur.length?" ":"")+cur.slice(end)||null}return!0})}),addLineWidget:docMethodOp(function(handle,node,options){return addLineWidget(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,options&&options.type||"range")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(null==options.nodeType?options.widget:options),insertLeft:options&&options.insertLeft,clearWhenEmpty:!1,shared:options&&options.shared,handleMouseEvents:options&&options.handleMouseEvents};return pos=clipPos(this,pos),markText(this,pos,pos,realOpts,"bookmark")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];(null==span.from||span.from<=pos.ch)&&(null==span.to||span.to>=pos.ch)&&markers.push(span.marker.parent||span.marker)}return markers},findMarks:function(from,to,filter){from=clipPos(this,from),to=clipPos(this,to);var found=[],lineNo=from.line;return this.iter(from.line,to.line+1,function(line){var spans=line.markedSpans;if(spans)for(var i=0;i<spans.length;i++){var span=spans[i];lineNo==from.line&&from.ch>span.to||null==span.from&&lineNo!=from.line||lineNo==to.line&&span.from>to.ch||filter&&!filter(span.marker)||found.push(span.marker.parent||span.marker)}++lineNo}),found},getAllMarks:function(){var markers=[];return this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)null!=sps[i].from&&markers.push(sps[i].marker)}),markers},posFromIndex:function(off){var ch,lineNo=this.first;return this.iter(function(line){var sz=line.text.length+1;return sz>off?(ch=off,!0):(off-=sz,++lineNo,void 0)}),clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;return coords.line<this.first||coords.ch<0?0:(this.iter(this.first,coords.line,function(line){index+=line.text.length+1}),index)},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return doc.scrollTop=this.scrollTop,doc.scrollLeft=this.scrollLeft,doc.sel=this.sel,doc.extend=!1,copyHistory&&(doc.history.undoDepth=this.history.undoDepth,doc.setHistory(this.getHistory())),doc},linkedDoc:function(options){options||(options={});var from=this.first,to=this.first+this.size;null!=options.from&&options.from>from&&(from=options.from),null!=options.to&&options.to<to&&(to=options.to);var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from,this.lineSep);return options.sharedHist&&(copy.history=this.history),(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist}),copy.linked=[{doc:this,isParent:!0,sharedHist:options.sharedHist}],copySharedMarkers(copy,findSharedMarkers(this)),copy},unlinkDoc:function(other){if(other instanceof CodeMirror&&(other=other.doc),this.linked)for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc==other){this.linked.splice(i,1),other.unlinkDoc(this),detachSharedMarkers(findSharedMarkers(this));break}}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id)},!0),other.history=new History(null),other.history.done=copyHistoryArray(this.history.done,splitIds),other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(str){return this.lineSep?str.split(this.lineSep):splitLinesAuto(str)},lineSeparator:function(){return this.lineSep||"\n"}}),Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate="iter insert remove copy getEditor constructor".split(" ");for(var prop in Doc.prototype)Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0&&(CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]));eventMixin(Doc);var e_preventDefault=CodeMirror.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},e_stopPropagation=CodeMirror.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e_stop=CodeMirror.e_stop=function(e){e_preventDefault(e),e_stopPropagation(e)},on=CodeMirror.on=function(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,!1);else if(emitter.attachEvent)emitter.attachEvent("on"+type,f);else{var map=emitter._handlers||(emitter._handlers={}),arr=map[type]||(map[type]=[]);arr.push(f)}},noHandlers=[],off=CodeMirror.off=function(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,!1);else if(emitter.detachEvent)emitter.detachEvent("on"+type,f);else for(var handlers=getHandlers(emitter,type,!1),i=0;i<handlers.length;++i)if(handlers[i]==f){handlers.splice(i,1);break}},signal=CodeMirror.signal=function(emitter,type){var handlers=getHandlers(emitter,type,!0);if(handlers.length)for(var args=Array.prototype.slice.call(arguments,2),i=0;i<handlers.length;++i)handlers[i].apply(null,args)},orphanDelayedCallbacks=null,scrollerGap=30,Pass=CodeMirror.Pass={toString:function(){return"CodeMirror.Pass"}},sel_dontScroll={scroll:!1},sel_mouse={origin:"*mouse"},sel_move={origin:"+move"};Delayed.prototype.set=function(ms,f){clearTimeout(this.id),this.id=setTimeout(f,ms)};var countColumn=CodeMirror.countColumn=function(string,end,tabSize,startIndex,startValue){null==end&&(end=string.search(/[^\s\u00a0]/),-1==end&&(end=string.length));for(var i=startIndex||0,n=startValue||0;;){var nextTab=string.indexOf("	",i);if(0>nextTab||nextTab>=end)return n+(end-i);n+=nextTab-i,n+=tabSize-n%tabSize,i=nextTab+1}},findColumn=CodeMirror.findColumn=function(string,goal,tabSize){for(var pos=0,col=0;;){var nextTab=string.indexOf("	",pos);-1==nextTab&&(nextTab=string.length);var skipped=nextTab-pos;if(nextTab==string.length||col+skipped>=goal)return pos+Math.min(skipped,goal-col);if(col+=nextTab-pos,col+=tabSize-col%tabSize,pos=nextTab+1,col>=goal)return pos}},spaceStrs=[""],selectInput=function(node){node.select()};ios?selectInput=function(node){node.selectionStart=0,node.selectionEnd=node.value.length}:ie&&(selectInput=function(node){try{node.select()}catch(_e){}});var range,nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,isWordCharBasic=CodeMirror.isWordChar=function(ch){return/\w/.test(ch)||ch>""&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))},extendingChars=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;range=document.createRange?function(node,start,end,endNode){var r=document.createRange();return r.setEnd(endNode||node,end),r.setStart(node,start),r}:function(node,start,end){var r=document.body.createTextRange();try{r.moveToElementText(node.parentNode)}catch(e){return r}return r.collapse(!0),r.moveEnd("character",end),r.moveStart("character",start),r};var contains=CodeMirror.contains=function(parent,child){if(3==child.nodeType&&(child=child.parentNode),parent.contains)return parent.contains(child);do if(11==child.nodeType&&(child=child.host),child==parent)return!0;while(child=child.parentNode)};ie&&11>ie_version&&(activeElt=function(){try{return document.activeElement}catch(e){return document.body}});var zwspSupported,badBidiRects,rmClass=CodeMirror.rmClass=function(node,cls){var current=node.className,match=classTest(cls).exec(current);if(match){var after=current.slice(match.index+match[0].length);node.className=current.slice(0,match.index)+(after?match[1]+after:"")}},addClass=CodeMirror.addClass=function(node,cls){var current=node.className;classTest(cls).test(current)||(node.className+=(current?" ":"")+cls)},globalsRegistered=!1,dragAndDrop=function(){if(ie&&9>ie_version)return!1;var div=elt("div");return"draggable"in div||"dragDrop"in div}(),splitLinesAuto=CodeMirror.splitLines=3!="\n\nb".split(/\n/).length?function(string){for(var pos=0,result=[],l=string.length;l>=pos;){var nl=string.indexOf("\n",pos);-1==nl&&(nl=string.length);var line=string.slice(pos,"\r"==string.charAt(nl-1)?nl-1:nl),rt=line.indexOf("\r");-1!=rt?(result.push(line.slice(0,rt)),pos+=rt+1):(result.push(line),pos=nl+1)}return result}:function(string){return string.split(/\r\n?|\n/)},hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return!1}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}return range&&range.parentElement()==te?0!=range.compareEndPoints("StartToEnd",range):!1},hasCopyEvent=function(){var e=elt("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),badZoomedRects=null,keyNames=CodeMirror.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var i=0;10>i;i++)keyNames[i+48]=keyNames[i+96]=String(i);for(var i=65;90>=i;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;12>=i;i++)keyNames[i+111]=keyNames[i+63235]="F"+i}();var bidiOther,bidiOrdering=function(){function charType(code){return 247>=code?lowTypes.charAt(code):code>=1424&&1524>=code?"R":code>=1536&&1773>=code?arabicTypes.charAt(code-1536):code>=1774&&2220>=code?"r":code>=8192&&8203>=code?"w":8204==code?"b":"L"}function BidiSpan(level,from,to){this.level=level,this.from=from,this.to=to}var lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",arabicTypes="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/,outerType="L";return function(str){if(!bidiRE.test(str))return!1;for(var type,len=str.length,types=[],i=0;len>i;++i)types.push(type=charType(str.charCodeAt(i)));for(var i=0,prev=outerType;len>i;++i){var type=types[i];"m"==type?types[i]=prev:prev=type}for(var i=0,cur=outerType;len>i;++i){var type=types[i];"1"==type&&"r"==cur?types[i]="n":isStrong.test(type)&&(cur=type,"r"==type&&(types[i]="R"))}for(var i=1,prev=types[0];len-1>i;++i){var type=types[i];"+"==type&&"1"==prev&&"1"==types[i+1]?types[i]="1":","!=type||prev!=types[i+1]||"1"!=prev&&"n"!=prev||(types[i]=prev),prev=type}for(var i=0;len>i;++i){var type=types[i];if(","==type)types[i]="N";else if("%"==type){for(var end=i+1;len>end&&"%"==types[end];++end);for(var replace=i&&"!"==types[i-1]||len>end&&"1"==types[end]?"1":"N",j=i;end>j;++j)types[j]=replace;i=end-1}}for(var i=0,cur=outerType;len>i;++i){var type=types[i];"L"==cur&&"1"==type?types[i]="L":isStrong.test(type)&&(cur=type)}for(var i=0;len>i;++i)if(isNeutral.test(types[i])){for(var end=i+1;len>end&&isNeutral.test(types[end]);++end);for(var before="L"==(i?types[i-1]:outerType),after="L"==(len>end?types[end]:outerType),replace=before||after?"L":"R",j=i;end>j;++j)types[j]=replace;i=end-1}for(var m,order=[],i=0;len>i;)if(countsAsLeft.test(types[i])){var start=i;for(++i;len>i&&countsAsLeft.test(types[i]);++i);order.push(new BidiSpan(0,start,i))}else{var pos=i,at=order.length;for(++i;len>i&&"L"!=types[i];++i);for(var j=pos;i>j;)if(countsAsNum.test(types[j])){j>pos&&order.splice(at,0,new BidiSpan(1,pos,j));var nstart=j;for(++j;i>j&&countsAsNum.test(types[j]);++j);order.splice(at,0,new BidiSpan(2,nstart,j)),pos=j}else++j;i>pos&&order.splice(at,0,new BidiSpan(1,pos,i))}return 1==order[0].level&&(m=str.match(/^\s+/))&&(order[0].from=m[0].length,order.unshift(new BidiSpan(0,0,m[0].length))),1==lst(order).level&&(m=str.match(/\s+$/))&&(lst(order).to-=m[0].length,order.push(new BidiSpan(0,len-m[0].length,len))),2==order[0].level&&order.unshift(new BidiSpan(1,order[0].to,order[0].to)),order[0].level!=lst(order).level&&order.push(new BidiSpan(order[0].level,len,len)),order}}();return CodeMirror.version="5.11.0",CodeMirror}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function ensureState(states,name){if(!states.hasOwnProperty(name))throw new Error("Undefined state "+name+" in simple mode")}function toRegex(val,caret){if(!val)return/(?:)/;var flags="";return val instanceof RegExp?(val.ignoreCase&&(flags="i"),val=val.source):val=String(val),new RegExp((caret===!1?"":"^")+"(?:"+val+")",flags)}function asToken(val){if(!val)return null;if("string"==typeof val)return val.replace(/\./g," ");for(var result=[],i=0;i<val.length;i++)result.push(val[i]&&val[i].replace(/\./g," "));return result}function Rule(data,states){(data.next||data.push)&&ensureState(states,data.next||data.push),this.regex=toRegex(data.regex),this.token=asToken(data.token),this.data=data}function tokenFunction(states,config){return function(stream,state){if(state.pending){var pend=state.pending.shift();return 0==state.pending.length&&(state.pending=null),stream.pos+=pend.text.length,pend.token}if(state.local){if(state.local.end&&stream.match(state.local.end)){var tok=state.local.endToken||null;return state.local=state.localState=null,tok}var m,tok=state.local.mode.token(stream,state.localState);return state.local.endScan&&(m=state.local.endScan.exec(stream.current()))&&(stream.pos=stream.start+m.index),tok}for(var curState=states[state.state],i=0;i<curState.length;i++){var rule=curState[i],matches=(!rule.data.sol||stream.sol())&&stream.match(rule.regex);if(matches){if(rule.data.next?state.state=rule.data.next:rule.data.push?((state.stack||(state.stack=[])).push(state.state),state.state=rule.data.push):rule.data.pop&&state.stack&&state.stack.length&&(state.state=state.stack.pop()),rule.data.mode&&enterLocalMode(config,state,rule.data.mode,rule.token),rule.data.indent&&state.indent.push(stream.indentation()+config.indentUnit),rule.data.dedent&&state.indent.pop(),matches.length>2){state.pending=[];for(var j=2;j<matches.length;j++)matches[j]&&state.pending.push({text:matches[j],token:rule.token[j-1]});return stream.backUp(matches[0].length-(matches[1]?matches[1].length:0)),rule.token[0]}return rule.token&&rule.token.join?rule.token[0]:rule.token}}return stream.next(),null}}function cmp(a,b){if(a===b)return!0;if(!a||"object"!=typeof a||!b||"object"!=typeof b)return!1;var props=0;for(var prop in a)if(a.hasOwnProperty(prop)){if(!b.hasOwnProperty(prop)||!cmp(a[prop],b[prop]))return!1;props++}for(var prop in b)b.hasOwnProperty(prop)&&props--;return 0==props}function enterLocalMode(config,state,spec,token){var pers;if(spec.persistent)for(var p=state.persistentStates;p&&!pers;p=p.next)(spec.spec?cmp(spec.spec,p.spec):spec.mode==p.mode)&&(pers=p);var mode=pers?pers.mode:spec.mode||CodeMirror.getMode(config,spec.spec),lState=pers?pers.state:CodeMirror.startState(mode);spec.persistent&&!pers&&(state.persistentStates={mode:mode,spec:spec.spec,state:lState,next:state.persistentStates}),state.localState=lState,state.local={mode:mode,end:spec.end&&toRegex(spec.end),endScan:spec.end&&spec.forceEnd!==!1&&toRegex(spec.end,!1),endToken:token&&token.join?token[token.length-1]:token}}function indexOf(val,arr){for(var i=0;i<arr.length;i++)if(arr[i]===val)return!0}function indentFunction(states,meta){return function(state,textAfter,line){if(state.local&&state.local.mode.indent)return state.local.mode.indent(state.localState,textAfter,line);if(null==state.indent||state.local||meta.dontIndentStates&&indexOf(state.state,meta.dontIndentStates)>-1)return CodeMirror.Pass;var pos=state.indent.length-1,rules=states[state.state];scan:for(;;){for(var i=0;i<rules.length;i++){var rule=rules[i];if(rule.data.dedent&&rule.data.dedentIfLineStart!==!1){var m=rule.regex.exec(textAfter);if(m&&m[0]){pos--,(rule.next||rule.push)&&(rules=states[rule.next||rule.push]),textAfter=textAfter.slice(m[0].length);continue scan}}}break}return 0>pos?0:state.indent[pos]}}CodeMirror.defineSimpleMode=function(name,states){CodeMirror.defineMode(name,function(config){return CodeMirror.simpleMode(config,states)})},CodeMirror.simpleMode=function(config,states){ensureState(states,"start");var states_={},meta=states.meta||{},hasIndentation=!1;for(var state in states)if(state!=meta&&states.hasOwnProperty(state))for(var list=states_[state]=[],orig=states[state],i=0;i<orig.length;i++){var data=orig[i];list.push(new Rule(data,states)),(data.indent||data.dedent)&&(hasIndentation=!0)}var mode={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:hasIndentation?[]:null}},copyState:function(state){var s={state:state.state,pending:state.pending,local:state.local,localState:null,indent:state.indent&&state.indent.slice(0)};state.localState&&(s.localState=CodeMirror.copyState(state.local.mode,state.localState)),state.stack&&(s.stack=state.stack.slice(0));for(var pers=state.persistentStates;pers;pers=pers.next)s.persistentStates={mode:pers.mode,spec:pers.spec,state:pers.state==state.localState?s.localState:CodeMirror.copyState(pers.mode,pers.state),next:s.persistentStates};return s},token:tokenFunction(states_,config),innerMode:function(state){return state.local&&{mode:state.local.mode,state:state.localState}},indent:indentFunction(states_,meta)};if(meta)for(var prop in meta)meta.hasOwnProperty(prop)&&(mode[prop]=meta[prop]);return mode}}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.multiplexingMode=function(outer){function indexOf(string,pattern,from,returnEnd){if("string"==typeof pattern){var found=string.indexOf(pattern,from);return returnEnd&&found>-1?found+pattern.length:found}var m=pattern.exec(from?string.slice(from):string);return m?m.index+from+(returnEnd?m[0].length:0):-1}var others=Array.prototype.slice.call(arguments,1);return{startState:function(){return{outer:CodeMirror.startState(outer),innerActive:null,inner:null}},copyState:function(state){return{outer:CodeMirror.copyState(outer,state.outer),innerActive:state.innerActive,inner:state.innerActive&&CodeMirror.copyState(state.innerActive.mode,state.inner)}},token:function(stream,state){if(state.innerActive){var curInner=state.innerActive,oldContent=stream.string;if(!curInner.close&&stream.sol())return state.innerActive=state.inner=null,this.token(stream,state);var found=curInner.close?indexOf(oldContent,curInner.close,stream.pos,curInner.parseDelimiters):-1;if(found==stream.pos&&!curInner.parseDelimiters)return stream.match(curInner.close),state.innerActive=state.inner=null,curInner.delimStyle&&curInner.delimStyle+" "+curInner.delimStyle+"-close";found>-1&&(stream.string=oldContent.slice(0,found));var innerToken=curInner.mode.token(stream,state.inner);return found>-1&&(stream.string=oldContent),found==stream.pos&&curInner.parseDelimiters&&(state.innerActive=state.inner=null),curInner.innerStyle&&(innerToken=innerToken?innerToken+" "+curInner.innerStyle:curInner.innerStyle),innerToken}for(var cutOff=1/0,oldContent=stream.string,i=0;i<others.length;++i){var other=others[i],found=indexOf(oldContent,other.open,stream.pos);if(found==stream.pos)return other.parseDelimiters||stream.match(other.open),state.innerActive=other,state.inner=CodeMirror.startState(other.mode,outer.indent?outer.indent(state.outer,""):0),other.delimStyle&&other.delimStyle+" "+other.delimStyle+"-open";-1!=found&&cutOff>found&&(cutOff=found)}1/0!=cutOff&&(stream.string=oldContent.slice(0,cutOff));var outerToken=outer.token(stream,state.outer);return 1/0!=cutOff&&(stream.string=oldContent),outerToken},indent:function(state,textAfter){var mode=state.innerActive?state.innerActive.mode:outer;return mode.indent?mode.indent(state.innerActive?state.inner:state.outer,textAfter):CodeMirror.Pass},blankLine:function(state){var mode=state.innerActive?state.innerActive.mode:outer;if(mode.blankLine&&mode.blankLine(state.innerActive?state.inner:state.outer),state.innerActive)"\n"===state.innerActive.close&&(state.innerActive=state.inner=null);else for(var i=0;i<others.length;++i){var other=others[i];"\n"===other.open&&(state.innerActive=other,state.inner=CodeMirror.startState(other.mode,mode.indent?mode.indent(state.outer,""):0))}},electricChars:outer.electricChars,innerMode:function(state){return state.inner?{state:state.inner,mode:state.innerActive.mode}:{state:state.outer,mode:outer}}}}}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function firstNonWS(str){var found=str.search(nonWS);return-1==found?0:found}var noOptions={},nonWS=/[^\s\u00a0]/,Pos=CodeMirror.Pos;CodeMirror.commands.toggleComment=function(cm){cm.toggleComment()},CodeMirror.defineExtension("toggleComment",function(options){options||(options=noOptions);for(var cm=this,minLine=1/0,ranges=this.listSelections(),mode=null,i=ranges.length-1;i>=0;i--){var from=ranges[i].from(),to=ranges[i].to();from.line>=minLine||(to.line>=minLine&&(to=Pos(minLine,0)),minLine=from.line,null==mode?cm.uncomment(from,to,options)?mode="un":(cm.lineComment(from,to,options),mode="line"):"un"==mode?cm.uncomment(from,to,options):cm.lineComment(from,to,options))}}),CodeMirror.defineExtension("lineComment",function(from,to,options){options||(options=noOptions);var self=this,mode=self.getModeAt(from),commentString=options.lineComment||mode.lineComment;if(!commentString)return(options.blockCommentStart||mode.blockCommentStart)&&(options.fullLines=!0,self.blockComment(from,to,options)),void 0;var firstLine=self.getLine(from.line);if(null!=firstLine){var end=Math.min(0!=to.ch||to.line==from.line?to.line+1:to.line,self.lastLine()+1),pad=null==options.padding?" ":options.padding,blankLines=options.commentBlankLines||from.line==to.line;self.operation(function(){if(options.indent){for(var baseString=null,i=from.line;end>i;++i){var line=self.getLine(i),whitespace=line.slice(0,firstNonWS(line));(null==baseString||baseString.length>whitespace.length)&&(baseString=whitespace)}for(var i=from.line;end>i;++i){var line=self.getLine(i),cut=baseString.length;(blankLines||nonWS.test(line))&&(line.slice(0,cut)!=baseString&&(cut=firstNonWS(line)),self.replaceRange(baseString+commentString+pad,Pos(i,0),Pos(i,cut)))}}else for(var i=from.line;end>i;++i)(blankLines||nonWS.test(self.getLine(i)))&&self.replaceRange(commentString+pad,Pos(i,0))})}}),CodeMirror.defineExtension("blockComment",function(from,to,options){options||(options=noOptions);var self=this,mode=self.getModeAt(from),startString=options.blockCommentStart||mode.blockCommentStart,endString=options.blockCommentEnd||mode.blockCommentEnd;if(!startString||!endString)return(options.lineComment||mode.lineComment)&&0!=options.fullLines&&self.lineComment(from,to,options),void 0;var end=Math.min(to.line,self.lastLine());end!=from.line&&0==to.ch&&nonWS.test(self.getLine(end))&&--end;var pad=null==options.padding?" ":options.padding;from.line>end||self.operation(function(){if(0!=options.fullLines){var lastLineHasText=nonWS.test(self.getLine(end));self.replaceRange(pad+endString,Pos(end)),self.replaceRange(startString+pad,Pos(from.line,0));var lead=options.blockCommentLead||mode.blockCommentLead;if(null!=lead)for(var i=from.line+1;end>=i;++i)(i!=end||lastLineHasText)&&self.replaceRange(lead+pad,Pos(i,0))}else self.replaceRange(endString,to),self.replaceRange(startString,from)})}),CodeMirror.defineExtension("uncomment",function(from,to,options){options||(options=noOptions);var didSomething,self=this,mode=self.getModeAt(from),end=Math.min(0!=to.ch||to.line==from.line?to.line:to.line-1,self.lastLine()),start=Math.min(from.line,end),lineString=options.lineComment||mode.lineComment,lines=[],pad=null==options.padding?" ":options.padding;lineComment:if(lineString){for(var i=start;end>=i;++i){var line=self.getLine(i),found=line.indexOf(lineString);if(found>-1&&!/comment/.test(self.getTokenTypeAt(Pos(i,found+1)))&&(found=-1),-1==found&&(i!=end||i==start)&&nonWS.test(line))break lineComment;if(found>-1&&nonWS.test(line.slice(0,found)))break lineComment;lines.push(line)}if(self.operation(function(){for(var i=start;end>=i;++i){var line=lines[i-start],pos=line.indexOf(lineString),endPos=pos+lineString.length;0>pos||(line.slice(endPos,endPos+pad.length)==pad&&(endPos+=pad.length),didSomething=!0,self.replaceRange("",Pos(i,pos),Pos(i,endPos)))}}),didSomething)return!0}var startString=options.blockCommentStart||mode.blockCommentStart,endString=options.blockCommentEnd||mode.blockCommentEnd;if(!startString||!endString)return!1;var lead=options.blockCommentLead||mode.blockCommentLead,startLine=self.getLine(start),endLine=end==start?startLine:self.getLine(end),open=startLine.indexOf(startString),close=endLine.lastIndexOf(endString);if(-1==close&&start!=end&&(endLine=self.getLine(--end),close=endLine.lastIndexOf(endString)),-1==open||-1==close||!/comment/.test(self.getTokenTypeAt(Pos(start,open+1)))||!/comment/.test(self.getTokenTypeAt(Pos(end,close+1))))return!1;var lastStart=startLine.lastIndexOf(startString,from.ch),firstEnd=-1==lastStart?-1:startLine.slice(0,from.ch).indexOf(endString,lastStart+startString.length);if(-1!=lastStart&&-1!=firstEnd&&firstEnd+endString.length!=from.ch)return!1;firstEnd=endLine.indexOf(endString,to.ch);var almostLastStart=endLine.slice(to.ch).lastIndexOf(startString,firstEnd-to.ch);return lastStart=-1==firstEnd||-1==almostLastStart?-1:to.ch+almostLastStart,-1!=firstEnd&&-1!=lastStart&&lastStart!=to.ch?!1:(self.operation(function(){self.replaceRange("",Pos(end,close-(pad&&endLine.slice(close-pad.length,close)==pad?pad.length:0)),Pos(end,close+endString.length));var openEnd=open+startString.length;if(pad&&startLine.slice(openEnd,openEnd+pad.length)==pad&&(openEnd+=pad.length),self.replaceRange("",Pos(start,open),Pos(start,openEnd)),lead)for(var i=start+1;end>=i;++i){var line=self.getLine(i),found=line.indexOf(lead);if(-1!=found&&!nonWS.test(line.slice(0,found))){var foundEnd=found+lead.length;pad&&line.slice(foundEnd,foundEnd+pad.length)==pad&&(foundEnd+=pad.length),self.replaceRange("",Pos(i,found),Pos(i,foundEnd))}}}),!0)})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";var htmlConfig={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},xmlConfig={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1};CodeMirror.defineMode("xml",function(editorConf,config_){function inText(stream,state){function chain(parser){return state.tokenize=parser,parser(stream,state)}var ch=stream.next();if("<"==ch)return stream.eat("!")?stream.eat("[")?stream.match("CDATA[")?chain(inBlock("atom","]]>")):null:stream.match("--")?chain(inBlock("comment","-->")):stream.match("DOCTYPE",!0,!0)?(stream.eatWhile(/[\w\._\-]/),chain(doctype(1))):null:stream.eat("?")?(stream.eatWhile(/[\w\._\-]/),state.tokenize=inBlock("meta","?>"),"meta"):(type=stream.eat("/")?"closeTag":"openTag",state.tokenize=inTag,"tag bracket");if("&"==ch){var ok;return ok=stream.eat("#")?stream.eat("x")?stream.eatWhile(/[a-fA-F\d]/)&&stream.eat(";"):stream.eatWhile(/[\d]/)&&stream.eat(";"):stream.eatWhile(/[\w\.\-:]/)&&stream.eat(";"),ok?"atom":"error"}return stream.eatWhile(/[^&<]/),null}function inTag(stream,state){var ch=stream.next();if(">"==ch||"/"==ch&&stream.eat(">"))return state.tokenize=inText,type=">"==ch?"endTag":"selfcloseTag","tag bracket";if("="==ch)return type="equals",null;if("<"==ch){state.tokenize=inText,state.state=baseState,state.tagName=state.tagStart=null;var next=state.tokenize(stream,state);return next?next+" tag error":"tag error"}return/[\'\"]/.test(ch)?(state.tokenize=inAttribute(ch),state.stringStartCol=stream.column(),state.tokenize(stream,state)):(stream.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function inAttribute(quote){var closure=function(stream,state){for(;!stream.eol();)if(stream.next()==quote){state.tokenize=inTag;break}return"string"};return closure.isInAttribute=!0,closure}function inBlock(style,terminator){return function(stream,state){for(;!stream.eol();){if(stream.match(terminator)){state.tokenize=inText;break}stream.next()}return style}}function doctype(depth){return function(stream,state){for(var ch;null!=(ch=stream.next());){if("<"==ch)return state.tokenize=doctype(depth+1),state.tokenize(stream,state);if(">"==ch){if(1==depth){state.tokenize=inText;break}return state.tokenize=doctype(depth-1),state.tokenize(stream,state)}}return"meta"}}function Context(state,tagName,startOfLine){this.prev=state.context,this.tagName=tagName,this.indent=state.indented,this.startOfLine=startOfLine,(config.doNotIndent.hasOwnProperty(tagName)||state.context&&state.context.noIndent)&&(this.noIndent=!0)}function popContext(state){state.context&&(state.context=state.context.prev)}function maybePopContext(state,nextTagName){for(var parentTagName;;){if(!state.context)return;if(parentTagName=state.context.tagName,!config.contextGrabbers.hasOwnProperty(parentTagName)||!config.contextGrabbers[parentTagName].hasOwnProperty(nextTagName))return;popContext(state)}}function baseState(type,stream,state){return"openTag"==type?(state.tagStart=stream.column(),tagNameState):"closeTag"==type?closeTagNameState:baseState}function tagNameState(type,stream,state){return"word"==type?(state.tagName=stream.current(),setStyle="tag",attrState):(setStyle="error",tagNameState)}function closeTagNameState(type,stream,state){if("word"==type){var tagName=stream.current();return state.context&&state.context.tagName!=tagName&&config.implicitlyClosed.hasOwnProperty(state.context.tagName)&&popContext(state),state.context&&state.context.tagName==tagName?(setStyle="tag",closeState):(setStyle="tag error",closeStateErr)}return setStyle="error",closeStateErr}function closeState(type,_stream,state){return"endTag"!=type?(setStyle="error",closeState):(popContext(state),baseState)}function closeStateErr(type,stream,state){return setStyle="error",closeState(type,stream,state)}function attrState(type,_stream,state){if("word"==type)return setStyle="attribute",attrEqState;if("endTag"==type||"selfcloseTag"==type){var tagName=state.tagName,tagStart=state.tagStart;return state.tagName=state.tagStart=null,"selfcloseTag"==type||config.autoSelfClosers.hasOwnProperty(tagName)?maybePopContext(state,tagName):(maybePopContext(state,tagName),state.context=new Context(state,tagName,tagStart==state.indented)),baseState}return setStyle="error",attrState}function attrEqState(type,stream,state){return"equals"==type?attrValueState:(config.allowMissing||(setStyle="error"),attrState(type,stream,state))}function attrValueState(type,stream,state){return"string"==type?attrContinuedState:"word"==type&&config.allowUnquoted?(setStyle="string",attrState):(setStyle="error",attrState(type,stream,state))}function attrContinuedState(type,stream,state){return"string"==type?attrContinuedState:attrState(type,stream,state)}var indentUnit=editorConf.indentUnit,config={},defaults=config_.htmlMode?htmlConfig:xmlConfig;for(var prop in defaults)config[prop]=defaults[prop];for(var prop in config_)config[prop]=config_[prop];var type,setStyle;return inText.isInText=!0,{startState:function(baseIndent){var state={tokenize:inText,state:baseState,indented:baseIndent||0,tagName:null,tagStart:null,context:null};return null!=baseIndent&&(state.baseIndent=baseIndent),state},token:function(stream,state){if(!state.tagName&&stream.sol()&&(state.indented=stream.indentation()),stream.eatSpace())return null;type=null;var style=state.tokenize(stream,state);return(style||type)&&"comment"!=style&&(setStyle=null,state.state=state.state(type||style,stream,state),setStyle&&(style="error"==setStyle?style+" error":setStyle)),style},indent:function(state,textAfter,fullLine){var context=state.context;if(state.tokenize.isInAttribute)return state.tagStart==state.indented?state.stringStartCol+1:state.indented+indentUnit;if(context&&context.noIndent)return CodeMirror.Pass;if(state.tokenize!=inTag&&state.tokenize!=inText)return fullLine?fullLine.match(/^(\s*)/)[0].length:0;if(state.tagName)return config.multilineTagIndentPastTag!==!1?state.tagStart+state.tagName.length+2:state.tagStart+indentUnit*(config.multilineTagIndentFactor||1);if(config.alignCDATA&&/<!\[CDATA\[/.test(textAfter))return 0;var tagAfter=textAfter&&/^<(\/)?([\w_:\.-]*)/.exec(textAfter);if(tagAfter&&tagAfter[1])for(;context;){if(context.tagName==tagAfter[2]){context=context.prev;break}if(!config.implicitlyClosed.hasOwnProperty(context.tagName))break;context=context.prev}else if(tagAfter)for(;context;){var grabbers=config.contextGrabbers[context.tagName];if(!grabbers||!grabbers.hasOwnProperty(tagAfter[2]))break;context=context.prev}for(;context&&context.prev&&!context.startOfLine;)context=context.prev;return context?context.indent+indentUnit:state.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:config.htmlMode?"html":"xml",helperType:config.htmlMode?"html":"xml",skipAttribute:function(state){state.state==attrValueState&&(state.state=attrState)}}}),CodeMirror.defineMIME("text/xml","xml"),CodeMirror.defineMIME("application/xml","xml"),CodeMirror.mimeModes.hasOwnProperty("text/html")||CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:!0})}),CodeMirror.defineMode("regex",function(){var otherChar=/^[\^\$\.\+\?\*]/,g=0,tokenBase=function(stream){var ch=stream.next();return"\\"==ch&&stream.match(/./,!1)?stream.match(/u\w{4}/)?"a":stream.match(/u/)?"err":stream.match(/x\w{2}/)?"a":stream.match(/x/)?"err":stream.match(/./)?"a":"a":"{"==ch&&stream.match(/(\d|\d,\d?)\}/)?"a":"["==ch&&stream.match(/[^\]]+\]/)?"b":"|"==ch?"g"+g:"("==ch?(stream.match(/[\?\!\:]+/),"g"+ ++g%5):")"==ch?0>g-1?"err":"g"+g--%5:otherChar.test(ch)?"a":void 0};return{startState:function(){g=0},token:tokenBase}}),CodeMirror.defineMIME("text/regex","regex"),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function maybeBackup(stream,pat,style){var cur=stream.current(),close=cur.search(pat);return close>-1?stream.backUp(cur.length-close):cur.match(/<\/?$/)&&(stream.backUp(cur.length),stream.match(pat,!1)||stream.match(cur)),style}function getAttrRegexp(attr){var regexp=attrRegexpCache[attr];return regexp?regexp:attrRegexpCache[attr]=new RegExp("\\s+"+attr+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*")}function getAttrValue(stream,attr){for(var match,pos=stream.pos;pos>=0&&"<"!==stream.string.charAt(pos);)pos--;return 0>pos?pos:(match=stream.string.slice(pos,stream.pos).match(getAttrRegexp(attr)))?match[2]:""}function getTagRegexp(tagName,anchored){return new RegExp((anchored?"^":"")+"</s*"+tagName+"s*>","i")}function addTags(from,to){for(var tag in from)for(var dest=to[tag]||(to[tag]=[]),source=from[tag],i=source.length-1;i>=0;i--)dest.unshift(source[i])}function findMatchingMode(tagInfo,stream){for(var i=0;i<tagInfo.length;i++){var spec=tagInfo[i];if(!spec[0]||spec[1].test(getAttrValue(stream,spec[0])))return spec[2]}}var defaultTags={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]},attrRegexpCache={};CodeMirror.defineMode("htmlmixed",function(config,parserConfig){function html(stream,state){var modeSpec,tagName=state.htmlState.tagName&&state.htmlState.tagName.toLowerCase(),tagInfo=tagName&&tags.hasOwnProperty(tagName)&&tags[tagName],style=htmlMode.token(stream,state.htmlState);if(tagInfo&&/\btag\b/.test(style)&&">"===stream.current()&&(modeSpec=findMatchingMode(tagInfo,stream))){var mode=CodeMirror.getMode(config,modeSpec),endTagA=getTagRegexp(tagName,!0),endTag=getTagRegexp(tagName,!1);state.token=function(stream,state){return stream.match(endTagA,!1)?(state.token=html,state.localState=state.localMode=null,null):maybeBackup(stream,endTag,state.localMode.token(stream,state.localState))},state.localMode=mode,state.localState=CodeMirror.startState(mode,htmlMode.indent(state.htmlState,""))}return style}var htmlMode=CodeMirror.getMode(config,{name:"xml",htmlMode:!0,multilineTagIndentFactor:parserConfig.multilineTagIndentFactor,multilineTagIndentPastTag:parserConfig.multilineTagIndentPastTag}),tags={},configTags=parserConfig&&parserConfig.tags,configScript=parserConfig&&parserConfig.scriptTypes;if(addTags(defaultTags,tags),configTags&&addTags(configTags,tags),configScript)for(var i=configScript.length-1;i>=0;i--)tags.script.unshift(["type",configScript[i].matches,configScript[i].mode]);return{startState:function(){var state=htmlMode.startState();return{token:html,localMode:null,localState:null,htmlState:state}},copyState:function(state){var local;return state.localState&&(local=CodeMirror.copyState(state.localMode,state.localState)),{token:state.token,localMode:state.localMode,localState:local,htmlState:CodeMirror.copyState(htmlMode,state.htmlState)}},token:function(stream,state){return state.token(stream,state)},indent:function(state,textAfter){return!state.localMode||/^\s*<\//.test(textAfter)?htmlMode.indent(state.htmlState,textAfter):state.localMode.indent?state.localMode.indent(state.localState,textAfter):CodeMirror.Pass},innerMode:function(state){return{state:state.localState||state.htmlState,mode:state.localMode||htmlMode}}}},"xml","javascript","css"),CodeMirror.defineMIME("text/html","htmlmixed")}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function expressionAllowed(stream,state,backUp){return/^(?:operator|sof|keyword c|case|new|[\[{}\(,;:]|=>)$/.test(state.lastType)||"quasi"==state.lastType&&/\{\s*$/.test(stream.string.slice(0,stream.pos-(backUp||0)))}CodeMirror.defineMode("javascript",function(config,parserConfig){function readRegexp(stream){for(var next,escaped=!1,inSet=!1;null!=(next=stream.next());){if(!escaped){if("/"==next&&!inSet)return;"["==next?inSet=!0:inSet&&"]"==next&&(inSet=!1)}escaped=!escaped&&"\\"==next}}function ret(tp,style,cont){return type=tp,content=cont,style}function tokenBase(stream,state){var ch=stream.next();if('"'==ch||"'"==ch)return state.tokenize=tokenString(ch),state.tokenize(stream,state);if("."==ch&&stream.match(/^\d+(?:[eE][+\-]?\d+)?/))return ret("number","number");if("."==ch&&stream.match(".."))return ret("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(ch))return ret(ch);if("="==ch&&stream.eat(">"))return ret("=>","operator");if("0"==ch&&stream.eat(/x/i))return stream.eatWhile(/[\da-f]/i),ret("number","number");if("0"==ch&&stream.eat(/o/i))return stream.eatWhile(/[0-7]/i),ret("number","number");if("0"==ch&&stream.eat(/b/i))return stream.eatWhile(/[01]/i),ret("number","number");if(/\d/.test(ch))return stream.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),ret("number","number");if("/"==ch)return stream.eat("*")?(state.tokenize=tokenComment,tokenComment(stream,state)):stream.eat("/")?(stream.skipToEnd(),ret("comment","comment")):expressionAllowed(stream,state,1)?(readRegexp(stream),stream.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/),ret("regexp","string-2")):(stream.eatWhile(isOperatorChar),ret("operator","operator",stream.current()));if("`"==ch)return state.tokenize=tokenQuasi,tokenQuasi(stream,state);if("#"==ch)return stream.skipToEnd(),ret("error","error");if(isOperatorChar.test(ch))return stream.eatWhile(isOperatorChar),ret("operator","operator",stream.current());if(wordRE.test(ch)){stream.eatWhile(wordRE);var word=stream.current(),known=keywords.propertyIsEnumerable(word)&&keywords[word];return known&&"."!=state.lastType?ret(known.type,known.style,word):ret("variable","variable",word)}}function tokenString(quote){return function(stream,state){var next,escaped=!1;if(jsonldMode&&"@"==stream.peek()&&stream.match(isJsonldKeyword))return state.tokenize=tokenBase,ret("jsonld-keyword","meta");for(;null!=(next=stream.next())&&(next!=quote||escaped);)escaped=!escaped&&"\\"==next;return escaped||(state.tokenize=tokenBase),ret("string","string")}}function tokenComment(stream,state){for(var ch,maybeEnd=!1;ch=stream.next();){if("/"==ch&&maybeEnd){state.tokenize=tokenBase;break}maybeEnd="*"==ch}return ret("comment","comment")}function tokenQuasi(stream,state){for(var next,escaped=!1;null!=(next=stream.next());){if(!escaped&&("`"==next||"$"==next&&stream.eat("{"))){state.tokenize=tokenBase;break}escaped=!escaped&&"\\"==next}return ret("quasi","string-2",stream.current())}function findFatArrow(stream,state){state.fatArrowAt&&(state.fatArrowAt=null);var arrow=stream.string.indexOf("=>",stream.start);if(!(0>arrow)){for(var depth=0,sawSomething=!1,pos=arrow-1;pos>=0;--pos){var ch=stream.string.charAt(pos),bracket=brackets.indexOf(ch);if(bracket>=0&&3>bracket){if(!depth){++pos;break}if(0==--depth)break}else if(bracket>=3&&6>bracket)++depth;else if(wordRE.test(ch))sawSomething=!0;else{if(/["'\/]/.test(ch))return;if(sawSomething&&!depth){++pos;break}}}sawSomething&&!depth&&(state.fatArrowAt=pos)}}function JSLexical(indented,column,type,align,prev,info){this.indented=indented,this.column=column,this.type=type,this.prev=prev,this.info=info,null!=align&&(this.align=align)}function inScope(state,varname){for(var v=state.localVars;v;v=v.next)if(v.name==varname)return!0;for(var cx=state.context;cx;cx=cx.prev)for(var v=cx.vars;v;v=v.next)if(v.name==varname)return!0}function parseJS(state,style,type,content,stream){var cc=state.cc;for(cx.state=state,cx.stream=stream,cx.marked=null,cx.cc=cc,cx.style=style,state.lexical.hasOwnProperty("align")||(state.lexical.align=!0);;){var combinator=cc.length?cc.pop():jsonMode?expression:statement;if(combinator(type,content)){for(;cc.length&&cc[cc.length-1].lex;)cc.pop()();return cx.marked?cx.marked:"variable"==type&&inScope(state,content)?"variable-2":style}}}function pass(){for(var i=arguments.length-1;i>=0;i--)cx.cc.push(arguments[i])}function cont(){return pass.apply(null,arguments),!0}function register(varname){function inList(list){for(var v=list;v;v=v.next)if(v.name==varname)return!0;return!1}var state=cx.state;if(cx.marked="def",state.context){if(inList(state.localVars))return;state.localVars={name:varname,next:state.localVars}}else{if(inList(state.globalVars))return;parserConfig.globalVars&&(state.globalVars={name:varname,next:state.globalVars})}}function pushcontext(){cx.state.context={prev:cx.state.context,vars:cx.state.localVars},cx.state.localVars=defaultVars}function popcontext(){cx.state.localVars=cx.state.context.vars,cx.state.context=cx.state.context.prev}function pushlex(type,info){var result=function(){var state=cx.state,indent=state.indented;if("stat"==state.lexical.type)indent=state.lexical.indented;else for(var outer=state.lexical;outer&&")"==outer.type&&outer.align;outer=outer.prev)indent=outer.indented;state.lexical=new JSLexical(indent,cx.stream.column(),type,null,state.lexical,info)};return result.lex=!0,result}function poplex(){var state=cx.state;state.lexical.prev&&(")"==state.lexical.type&&(state.indented=state.lexical.indented),state.lexical=state.lexical.prev)}function expect(wanted){function exp(type){return type==wanted?cont():";"==wanted?pass():cont(exp)}return exp}function statement(type,value){return"var"==type?cont(pushlex("vardef",value.length),vardef,expect(";"),poplex):"keyword a"==type?cont(pushlex("form"),expression,statement,poplex):"keyword b"==type?cont(pushlex("form"),statement,poplex):"{"==type?cont(pushlex("}"),block,poplex):";"==type?cont():"if"==type?("else"==cx.state.lexical.info&&cx.state.cc[cx.state.cc.length-1]==poplex&&cx.state.cc.pop()(),cont(pushlex("form"),expression,statement,poplex,maybeelse)):"function"==type?cont(functiondef):"for"==type?cont(pushlex("form"),forspec,statement,poplex):"variable"==type?cont(pushlex("stat"),maybelabel):"switch"==type?cont(pushlex("form"),expression,pushlex("}","switch"),expect("{"),block,poplex,poplex):"case"==type?cont(expression,expect(":")):"default"==type?cont(expect(":")):"catch"==type?cont(pushlex("form"),pushcontext,expect("("),funarg,expect(")"),statement,poplex,popcontext):"class"==type?cont(pushlex("form"),className,poplex):"export"==type?cont(pushlex("stat"),afterExport,poplex):"import"==type?cont(pushlex("stat"),afterImport,poplex):"module"==type?cont(pushlex("form"),pattern,pushlex("}"),expect("{"),block,poplex,poplex):pass(pushlex("stat"),expression,expect(";"),poplex)}function expression(type){return expressionInner(type,!1)}function expressionNoComma(type){return expressionInner(type,!0)}function expressionInner(type,noComma){if(cx.state.fatArrowAt==cx.stream.start){var body=noComma?arrowBodyNoComma:arrowBody;if("("==type)return cont(pushcontext,pushlex(")"),commasep(pattern,")"),poplex,expect("=>"),body,popcontext);if("variable"==type)return pass(pushcontext,pattern,expect("=>"),body,popcontext)}var maybeop=noComma?maybeoperatorNoComma:maybeoperatorComma;return atomicTypes.hasOwnProperty(type)?cont(maybeop):"function"==type?cont(functiondef,maybeop):"keyword c"==type?cont(noComma?maybeexpressionNoComma:maybeexpression):"("==type?cont(pushlex(")"),maybeexpression,comprehension,expect(")"),poplex,maybeop):"operator"==type||"spread"==type?cont(noComma?expressionNoComma:expression):"["==type?cont(pushlex("]"),arrayLiteral,poplex,maybeop):"{"==type?contCommasep(objprop,"}",null,maybeop):"quasi"==type?pass(quasi,maybeop):"new"==type?cont(maybeTarget(noComma)):cont()}function maybeexpression(type){return type.match(/[;\}\)\],]/)?pass():pass(expression)}function maybeexpressionNoComma(type){return type.match(/[;\}\)\],]/)?pass():pass(expressionNoComma)}function maybeoperatorComma(type,value){return","==type?cont(expression):maybeoperatorNoComma(type,value,!1)}function maybeoperatorNoComma(type,value,noComma){var me=0==noComma?maybeoperatorComma:maybeoperatorNoComma,expr=0==noComma?expression:expressionNoComma;return"=>"==type?cont(pushcontext,noComma?arrowBodyNoComma:arrowBody,popcontext):"operator"==type?/\+\+|--/.test(value)?cont(me):"?"==value?cont(expression,expect(":"),expr):cont(expr):"quasi"==type?pass(quasi,me):";"!=type?"("==type?contCommasep(expressionNoComma,")","call",me):"."==type?cont(property,me):"["==type?cont(pushlex("]"),maybeexpression,expect("]"),poplex,me):void 0:void 0}function quasi(type,value){return"quasi"!=type?pass():"${"!=value.slice(value.length-2)?cont(quasi):cont(expression,continueQuasi)}function continueQuasi(type){return"}"==type?(cx.marked="string-2",cx.state.tokenize=tokenQuasi,cont(quasi)):void 0}function arrowBody(type){return findFatArrow(cx.stream,cx.state),pass("{"==type?statement:expression)}function arrowBodyNoComma(type){return findFatArrow(cx.stream,cx.state),pass("{"==type?statement:expressionNoComma)}function maybeTarget(noComma){return function(type){return"."==type?cont(noComma?targetNoComma:target):pass(noComma?expressionNoComma:expression)}}function target(_,value){return"target"==value?(cx.marked="keyword",cont(maybeoperatorComma)):void 0}function targetNoComma(_,value){return"target"==value?(cx.marked="keyword",cont(maybeoperatorNoComma)):void 0}function maybelabel(type){return":"==type?cont(poplex,statement):pass(maybeoperatorComma,expect(";"),poplex)}function property(type){return"variable"==type?(cx.marked="property",cont()):void 0}function objprop(type,value){return"variable"==type||"keyword"==cx.style?(cx.marked="property","get"==value||"set"==value?cont(getterSetter):cont(afterprop)):"number"==type||"string"==type?(cx.marked=jsonldMode?"property":cx.style+" property",cont(afterprop)):"jsonld-keyword"==type?cont(afterprop):"modifier"==type?cont(objprop):"["==type?cont(expression,expect("]"),afterprop):"spread"==type?cont(expression):void 0}function getterSetter(type){return"variable"!=type?pass(afterprop):(cx.marked="property",cont(functiondef))}function afterprop(type){return":"==type?cont(expressionNoComma):"("==type?pass(functiondef):void 0}function commasep(what,end){function proceed(type){if(","==type){var lex=cx.state.lexical;return"call"==lex.info&&(lex.pos=(lex.pos||0)+1),cont(what,proceed)}return type==end?cont():cont(expect(end))}return function(type){return type==end?cont():pass(what,proceed)}}function contCommasep(what,end,info){for(var i=3;i<arguments.length;i++)cx.cc.push(arguments[i]);return cont(pushlex(end,info),commasep(what,end),poplex)}function block(type){return"}"==type?cont():pass(statement,block)}function maybetype(type){return isTS&&":"==type?cont(typedef):void 0}function maybedefault(_,value){return"="==value?cont(expressionNoComma):void 0}function typedef(type){return"variable"==type?(cx.marked="variable-3",cont()):void 0}function vardef(){return pass(pattern,maybetype,maybeAssign,vardefCont)}function pattern(type,value){return"modifier"==type?cont(pattern):"variable"==type?(register(value),cont()):"spread"==type?cont(pattern):"["==type?contCommasep(pattern,"]"):"{"==type?contCommasep(proppattern,"}"):void 0}function proppattern(type,value){return"variable"!=type||cx.stream.match(/^\s*:/,!1)?("variable"==type&&(cx.marked="property"),"spread"==type?cont(pattern):"}"==type?pass():cont(expect(":"),pattern,maybeAssign)):(register(value),cont(maybeAssign))}function maybeAssign(_type,value){return"="==value?cont(expressionNoComma):void 0}function vardefCont(type){return","==type?cont(vardef):void 0}function maybeelse(type,value){return"keyword b"==type&&"else"==value?cont(pushlex("form","else"),statement,poplex):void 0}function forspec(type){return"("==type?cont(pushlex(")"),forspec1,expect(")"),poplex):void 0}function forspec1(type){return"var"==type?cont(vardef,expect(";"),forspec2):";"==type?cont(forspec2):"variable"==type?cont(formaybeinof):pass(expression,expect(";"),forspec2)}function formaybeinof(_type,value){return"in"==value||"of"==value?(cx.marked="keyword",cont(expression)):cont(maybeoperatorComma,forspec2)}function forspec2(type,value){return";"==type?cont(forspec3):"in"==value||"of"==value?(cx.marked="keyword",cont(expression)):pass(expression,expect(";"),forspec3)}function forspec3(type){")"!=type&&cont(expression)}function functiondef(type,value){return"*"==value?(cx.marked="keyword",cont(functiondef)):"variable"==type?(register(value),cont(functiondef)):"("==type?cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,statement,popcontext):void 0}function funarg(type){return"spread"==type?cont(funarg):pass(pattern,maybetype,maybedefault)}function className(type,value){return"variable"==type?(register(value),cont(classNameAfter)):void 0}function classNameAfter(type,value){return"extends"==value?cont(expression,classNameAfter):"{"==type?cont(pushlex("}"),classBody,poplex):void 0}function classBody(type,value){return"variable"==type||"keyword"==cx.style?"static"==value?(cx.marked="keyword",cont(classBody)):(cx.marked="property","get"==value||"set"==value?cont(classGetterSetter,functiondef,classBody):cont(functiondef,classBody)):"*"==value?(cx.marked="keyword",cont(classBody)):";"==type?cont(classBody):"}"==type?cont():void 0}function classGetterSetter(type){return"variable"!=type?pass():(cx.marked="property",cont())}function afterExport(_type,value){return"*"==value?(cx.marked="keyword",cont(maybeFrom,expect(";"))):"default"==value?(cx.marked="keyword",cont(expression,expect(";"))):pass(statement)}function afterImport(type){return"string"==type?cont():pass(importSpec,maybeFrom)}function importSpec(type,value){return"{"==type?contCommasep(importSpec,"}"):("variable"==type&&register(value),"*"==value&&(cx.marked="keyword"),cont(maybeAs))}function maybeAs(_type,value){return"as"==value?(cx.marked="keyword",cont(importSpec)):void 0}function maybeFrom(_type,value){return"from"==value?(cx.marked="keyword",cont(expression)):void 0}function arrayLiteral(type){return"]"==type?cont():pass(expressionNoComma,maybeArrayComprehension)}function maybeArrayComprehension(type){return"for"==type?pass(comprehension,expect("]")):","==type?cont(commasep(maybeexpressionNoComma,"]")):pass(commasep(expressionNoComma,"]"))}function comprehension(type){return"for"==type?cont(forspec,comprehension):"if"==type?cont(expression,comprehension):void 0}function isContinuedStatement(state,textAfter){return"operator"==state.lastType||","==state.lastType||isOperatorChar.test(textAfter.charAt(0))||/[,.]/.test(textAfter.charAt(0))}var type,content,indentUnit=config.indentUnit,statementIndent=parserConfig.statementIndent,jsonldMode=parserConfig.jsonld,jsonMode=parserConfig.json||jsonldMode,isTS=parserConfig.typescript,wordRE=parserConfig.wordCharacters||/[\w$\xa1-\uffff]/,keywords=function(){function kw(type){return{type:type,style:"keyword"}}var A=kw("keyword a"),B=kw("keyword b"),C=kw("keyword c"),operator=kw("operator"),atom={type:"atom",style:"atom"},jsKeywords={"if":kw("if"),"while":A,"with":A,"else":B,"do":B,"try":B,"finally":B,"return":C,"break":C,"continue":C,"new":kw("new"),"delete":C,"throw":C,"debugger":C,"var":kw("var"),"const":kw("var"),let:kw("var"),"function":kw("function"),"catch":kw("catch"),"for":kw("for"),"switch":kw("switch"),"case":kw("case"),"default":kw("default"),"in":operator,"typeof":operator,"instanceof":operator,"true":atom,"false":atom,"null":atom,undefined:atom,NaN:atom,Infinity:atom,"this":kw("this"),"class":kw("class"),"super":kw("atom"),yield:C,"export":kw("export"),"import":kw("import"),"extends":C};if(isTS){var type={type:"variable",style:"variable-3"},tsKeywords={"interface":kw("class"),"implements":C,namespace:C,module:kw("module"),"enum":kw("module"),"public":kw("modifier"),"private":kw("modifier"),"protected":kw("modifier"),"abstract":kw("modifier"),as:operator,string:type,number:type,"boolean":type,any:type};for(var attr in tsKeywords)jsKeywords[attr]=tsKeywords[attr]}return jsKeywords}(),isOperatorChar=/[+\-*&%=<>!?|~^]/,isJsonldKeyword=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,brackets="([{}])",atomicTypes={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},cx={state:null,column:null,marked:null,cc:null},defaultVars={name:"this",next:{name:"arguments"}};return poplex.lex=!0,{startState:function(basecolumn){var state={tokenize:tokenBase,lastType:"sof",cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,"block",!1),localVars:parserConfig.localVars,context:parserConfig.localVars&&{vars:parserConfig.localVars},indented:basecolumn||0};return parserConfig.globalVars&&"object"==typeof parserConfig.globalVars&&(state.globalVars=parserConfig.globalVars),state},token:function(stream,state){if(stream.sol()&&(state.lexical.hasOwnProperty("align")||(state.lexical.align=!1),state.indented=stream.indentation(),findFatArrow(stream,state)),state.tokenize!=tokenComment&&stream.eatSpace())return null;var style=state.tokenize(stream,state);return"comment"==type?style:(state.lastType="operator"!=type||"++"!=content&&"--"!=content?type:"incdec",parseJS(state,style,type,content,stream))},indent:function(state,textAfter){if(state.tokenize==tokenComment)return CodeMirror.Pass;if(state.tokenize!=tokenBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical;if(!/^\s*else\b/.test(textAfter))for(var i=state.cc.length-1;i>=0;--i){var c=state.cc[i];if(c==poplex)lexical=lexical.prev;else if(c!=maybeelse)break}"stat"==lexical.type&&"}"==firstChar&&(lexical=lexical.prev),statementIndent&&")"==lexical.type&&"stat"==lexical.prev.type&&(lexical=lexical.prev);var type=lexical.type,closing=firstChar==type;return"vardef"==type?lexical.indented+("operator"==state.lastType||","==state.lastType?lexical.info+1:0):"form"==type&&"{"==firstChar?lexical.indented:"form"==type?lexical.indented+indentUnit:"stat"==type?lexical.indented+(isContinuedStatement(state,textAfter)?statementIndent||indentUnit:0):"switch"!=lexical.info||closing||0==parserConfig.doubleIndentSwitch?lexical.align?lexical.column+(closing?0:1):lexical.indented+(closing?0:indentUnit):lexical.indented+(/^(?:case|default)\b/.test(textAfter)?indentUnit:2*indentUnit)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:jsonMode?null:"/*",blockCommentEnd:jsonMode?null:"*/",lineComment:jsonMode?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:jsonMode?"json":"javascript",jsonldMode:jsonldMode,jsonMode:jsonMode,expressionAllowed:expressionAllowed,skipExpression:function(state){var top=state.cc[state.cc.length-1];(top==expression||top==expressionNoComma)&&state.cc.pop()}}}),CodeMirror.registerHelper("wordChars","javascript",/[\w$]/),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("text/ecmascript","javascript"),CodeMirror.defineMIME("application/javascript","javascript"),CodeMirror.defineMIME("application/x-javascript","javascript"),CodeMirror.defineMIME("application/ecmascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),CodeMirror.defineMIME("application/x-json",{name:"javascript",json:!0}),CodeMirror.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function keySet(array){for(var keys={},i=0;i<array.length;++i)keys[array[i]]=!0;return keys}function tokenCComment(stream,state){for(var ch,maybeEnd=!1;null!=(ch=stream.next());){if(maybeEnd&&"/"==ch){state.tokenize=null;break}maybeEnd="*"==ch}return["comment","comment"]}CodeMirror.defineMode("css",function(config,parserConfig){function ret(style,tp){return type=tp,style}function tokenBase(stream,state){var ch=stream.next();if(tokenHooks[ch]){var result=tokenHooks[ch](stream,state);if(result!==!1)return result}return"@"==ch?(stream.eatWhile(/[\w\\\-]/),ret("def",stream.current())):"="==ch||("~"==ch||"|"==ch)&&stream.eat("=")?ret(null,"compare"):'"'==ch||"'"==ch?(state.tokenize=tokenString(ch),state.tokenize(stream,state)):"#"==ch?(stream.eatWhile(/[\w\\\-]/),ret("atom","hash")):"!"==ch?(stream.match(/^\s*\w*/),ret("keyword","important")):/\d/.test(ch)||"."==ch&&stream.eat(/\d/)?(stream.eatWhile(/[\w.%]/),ret("number","unit")):"-"!==ch?/[,+>*\/]/.test(ch)?ret(null,"select-op"):"."==ch&&stream.match(/^-?[_a-z][_a-z0-9-]*/i)?ret("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(ch)?ret(null,ch):"u"==ch&&stream.match(/rl(-prefix)?\(/)||"d"==ch&&stream.match("omain(")||"r"==ch&&stream.match("egexp(")?(stream.backUp(1),state.tokenize=tokenParenthesized,ret("property","word")):/[\w\\\-]/.test(ch)?(stream.eatWhile(/[\w\\\-]/),ret("property","word")):ret(null,null):/[\d.]/.test(stream.peek())?(stream.eatWhile(/[\w.%]/),ret("number","unit")):stream.match(/^-[\w\\\-]+/)?(stream.eatWhile(/[\w\\\-]/),stream.match(/^\s*:/,!1)?ret("variable-2","variable-definition"):ret("variable-2","variable")):stream.match(/^\w+-/)?ret("meta","meta"):void 0}function tokenString(quote){return function(stream,state){for(var ch,escaped=!1;null!=(ch=stream.next());){if(ch==quote&&!escaped){")"==quote&&stream.backUp(1);break}escaped=!escaped&&"\\"==ch}return(ch==quote||!escaped&&")"!=quote)&&(state.tokenize=null),ret("string","string")}}function tokenParenthesized(stream,state){return stream.next(),state.tokenize=stream.match(/\s*[\"\')]/,!1)?null:tokenString(")"),ret(null,"(")}function Context(type,indent,prev){this.type=type,this.indent=indent,this.prev=prev}function pushContext(state,stream,type,indent){return state.context=new Context(type,stream.indentation()+(indent===!1?0:indentUnit),state.context),type}function popContext(state){return state.context.prev&&(state.context=state.context.prev),state.context.type}function pass(type,stream,state){return states[state.context.type](type,stream,state)}function popAndPass(type,stream,state,n){for(var i=n||1;i>0;i--)state.context=state.context.prev;return pass(type,stream,state)}function wordAsValue(stream){var word=stream.current().toLowerCase();override=valueKeywords.hasOwnProperty(word)?"atom":colorKeywords.hasOwnProperty(word)?"keyword":"variable"}var inline=parserConfig.inline;parserConfig.propertyKeywords||(parserConfig=CodeMirror.resolveMode("text/css"));var type,override,indentUnit=config.indentUnit,tokenHooks=parserConfig.tokenHooks,documentTypes=parserConfig.documentTypes||{},mediaTypes=parserConfig.mediaTypes||{},mediaFeatures=parserConfig.mediaFeatures||{},mediaValueKeywords=parserConfig.mediaValueKeywords||{},propertyKeywords=parserConfig.propertyKeywords||{},nonStandardPropertyKeywords=parserConfig.nonStandardPropertyKeywords||{},fontProperties=parserConfig.fontProperties||{},counterDescriptors=parserConfig.counterDescriptors||{},colorKeywords=parserConfig.colorKeywords||{},valueKeywords=parserConfig.valueKeywords||{},allowNested=parserConfig.allowNested,supportsAtComponent=parserConfig.supportsAtComponent===!0,states={};return states.top=function(type,stream,state){if("{"==type)return pushContext(state,stream,"block");if("}"==type&&state.context.prev)return popContext(state);if(supportsAtComponent&&/@component/.test(type))return pushContext(state,stream,"atComponentBlock");if(/^@(-moz-)?document$/.test(type))return pushContext(state,stream,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/.test(type))return pushContext(state,stream,"atBlock");if(/^@(font-face|counter-style)/.test(type))return state.stateArg=type,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/.test(type))return"keyframes";if(type&&"@"==type.charAt(0))return pushContext(state,stream,"at");if("hash"==type)override="builtin";else if("word"==type)override="tag";else{if("variable-definition"==type)return"maybeprop";if("interpolation"==type)return pushContext(state,stream,"interpolation");if(":"==type)return"pseudo";if(allowNested&&"("==type)return pushContext(state,stream,"parens")}return state.context.type},states.block=function(type,stream,state){if("word"==type){var word=stream.current().toLowerCase();return propertyKeywords.hasOwnProperty(word)?(override="property","maybeprop"):nonStandardPropertyKeywords.hasOwnProperty(word)?(override="string-2","maybeprop"):allowNested?(override=stream.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(override+=" error","maybeprop")}return"meta"==type?"block":allowNested||"hash"!=type&&"qualifier"!=type?states.top(type,stream,state):(override="error","block")},states.maybeprop=function(type,stream,state){return":"==type?pushContext(state,stream,"prop"):pass(type,stream,state)},states.prop=function(type,stream,state){if(";"==type)return popContext(state);if("{"==type&&allowNested)return pushContext(state,stream,"propBlock");if("}"==type||"{"==type)return popAndPass(type,stream,state);if("("==type)return pushContext(state,stream,"parens");if("hash"!=type||/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(stream.current())){if("word"==type)wordAsValue(stream);else if("interpolation"==type)return pushContext(state,stream,"interpolation")}else override+=" error";return"prop"},states.propBlock=function(type,_stream,state){return"}"==type?popContext(state):"word"==type?(override="property","maybeprop"):state.context.type},states.parens=function(type,stream,state){return"{"==type||"}"==type?popAndPass(type,stream,state):")"==type?popContext(state):"("==type?pushContext(state,stream,"parens"):"interpolation"==type?pushContext(state,stream,"interpolation"):("word"==type&&wordAsValue(stream),"parens")},states.pseudo=function(type,stream,state){return"word"==type?(override="variable-3",state.context.type):pass(type,stream,state)},states.documentTypes=function(type,stream,state){return"word"==type&&documentTypes.hasOwnProperty(stream.current())?(override="tag",state.context.type):states.atBlock(type,stream,state)},states.atBlock=function(type,stream,state){if("("==type)return pushContext(state,stream,"atBlock_parens");if("}"==type||";"==type)return popAndPass(type,stream,state);if("{"==type)return popContext(state)&&pushContext(state,stream,allowNested?"block":"top");if("interpolation"==type)return pushContext(state,stream,"interpolation");if("word"==type){var word=stream.current().toLowerCase();override="only"==word||"not"==word||"and"==word||"or"==word?"keyword":mediaTypes.hasOwnProperty(word)?"attribute":mediaFeatures.hasOwnProperty(word)?"property":mediaValueKeywords.hasOwnProperty(word)?"keyword":propertyKeywords.hasOwnProperty(word)?"property":nonStandardPropertyKeywords.hasOwnProperty(word)?"string-2":valueKeywords.hasOwnProperty(word)?"atom":colorKeywords.hasOwnProperty(word)?"keyword":"error"}return state.context.type},states.atComponentBlock=function(type,stream,state){return"}"==type?popAndPass(type,stream,state):"{"==type?popContext(state)&&pushContext(state,stream,allowNested?"block":"top",!1):("word"==type&&(override="error"),state.context.type)},states.atBlock_parens=function(type,stream,state){return")"==type?popContext(state):"{"==type||"}"==type?popAndPass(type,stream,state,2):states.atBlock(type,stream,state)},states.restricted_atBlock_before=function(type,stream,state){return"{"==type?pushContext(state,stream,"restricted_atBlock"):"word"==type&&"@counter-style"==state.stateArg?(override="variable","restricted_atBlock_before"):pass(type,stream,state)},states.restricted_atBlock=function(type,stream,state){return"}"==type?(state.stateArg=null,popContext(state)):"word"==type?(override="@font-face"==state.stateArg&&!fontProperties.hasOwnProperty(stream.current().toLowerCase())||"@counter-style"==state.stateArg&&!counterDescriptors.hasOwnProperty(stream.current().toLowerCase())?"error":"property","maybeprop"):"restricted_atBlock"},states.keyframes=function(type,stream,state){return"word"==type?(override="variable","keyframes"):"{"==type?pushContext(state,stream,"top"):pass(type,stream,state)},states.at=function(type,stream,state){return";"==type?popContext(state):"{"==type||"}"==type?popAndPass(type,stream,state):("word"==type?override="tag":"hash"==type&&(override="builtin"),"at")},states.interpolation=function(type,stream,state){return"}"==type?popContext(state):"{"==type||";"==type?popAndPass(type,stream,state):("word"==type?override="variable":"variable"!=type&&"("!=type&&")"!=type&&(override="error"),"interpolation")},{startState:function(base){return{tokenize:null,state:inline?"block":"top",stateArg:null,context:new Context(inline?"block":"top",base||0,null)}},token:function(stream,state){if(!state.tokenize&&stream.eatSpace())return null;var style=(state.tokenize||tokenBase)(stream,state);return style&&"object"==typeof style&&(type=style[1],style=style[0]),override=style,state.state=states[state.state](type,stream,state),override},indent:function(state,textAfter){var cx=state.context,ch=textAfter&&textAfter.charAt(0),indent=cx.indent;return"prop"!=cx.type||"}"!=ch&&")"!=ch||(cx=cx.prev),cx.prev&&("}"!=ch||"block"!=cx.type&&"top"!=cx.type&&"interpolation"!=cx.type&&"restricted_atBlock"!=cx.type?(")"==ch&&("parens"==cx.type||"atBlock_parens"==cx.type)||"{"==ch&&("at"==cx.type||"atBlock"==cx.type))&&(indent=Math.max(0,cx.indent-indentUnit),cx=cx.prev):(cx=cx.prev,indent=cx.indent)),indent},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",fold:"brace"}});var documentTypes_=["domain","regexp","url","url-prefix"],documentTypes=keySet(documentTypes_),mediaTypes_=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],mediaTypes=keySet(mediaTypes_),mediaFeatures_=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover"],mediaFeatures=keySet(mediaFeatures_),mediaValueKeywords_=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive"],mediaValueKeywords=keySet(mediaValueKeywords_),propertyKeywords_=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-position","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],propertyKeywords=keySet(propertyKeywords_),nonStandardPropertyKeywords_=["scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-3d-light-color","scrollbar-track-color","shape-inside","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","zoom"],nonStandardPropertyKeywords=keySet(nonStandardPropertyKeywords_),fontProperties_=["font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"],fontProperties=keySet(fontProperties_),counterDescriptors_=["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"],counterDescriptors=keySet(counterDescriptors_),colorKeywords_=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],colorKeywords=keySet(colorKeywords_),valueKeywords_=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","spell-out","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","symbolic","symbols","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],valueKeywords=keySet(valueKeywords_),allWords=documentTypes_.concat(mediaTypes_).concat(mediaFeatures_).concat(mediaValueKeywords_).concat(propertyKeywords_).concat(nonStandardPropertyKeywords_).concat(colorKeywords_).concat(valueKeywords_);CodeMirror.registerHelper("hintWords","css",allWords),CodeMirror.defineMIME("text/css",{documentTypes:documentTypes,mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,mediaValueKeywords:mediaValueKeywords,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,fontProperties:fontProperties,counterDescriptors:counterDescriptors,colorKeywords:colorKeywords,valueKeywords:valueKeywords,tokenHooks:{"/":function(stream,state){return stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):!1}},name:"css"}),CodeMirror.defineMIME("text/x-scss",{mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,mediaValueKeywords:mediaValueKeywords,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,fontProperties:fontProperties,allowNested:!0,tokenHooks:{"/":function(stream,state){return stream.eat("/")?(stream.skipToEnd(),["comment","comment"]):stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):["operator","operator"]},":":function(stream){return stream.match(/\s*\{/)?[null,"{"]:!1},$:function(stream){return stream.match(/^[\w-]+/),stream.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(stream){return stream.eat("{")?[null,"interpolation"]:!1}},name:"css",helperType:"scss"}),CodeMirror.defineMIME("text/x-less",{mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,mediaValueKeywords:mediaValueKeywords,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,fontProperties:fontProperties,allowNested:!0,tokenHooks:{"/":function(stream,state){return stream.eat("/")?(stream.skipToEnd(),["comment","comment"]):stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):["operator","operator"]},"@":function(stream){return stream.eat("{")?[null,"interpolation"]:stream.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/,!1)?!1:(stream.eatWhile(/[\w\\\-]/),stream.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),CodeMirror.defineMIME("text/x-gss",{documentTypes:documentTypes,mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,fontProperties:fontProperties,counterDescriptors:counterDescriptors,colorKeywords:colorKeywords,valueKeywords:valueKeywords,supportsAtComponent:!0,tokenHooks:{"/":function(stream,state){return stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):!1}},name:"css",helperType:"gss"})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.defineMode("sql",function(config,parserConfig){function tokenBase(stream,state){var ch=stream.next();if(hooks[ch]){var result=hooks[ch](stream,state);if(result!==!1)return result}if(1==support.hexNumber&&("0"==ch&&stream.match(/^[xX][0-9a-fA-F]+/)||("x"==ch||"X"==ch)&&stream.match(/^'[0-9a-fA-F]+'/)))return"number";if(1==support.binaryNumber&&(("b"==ch||"B"==ch)&&stream.match(/^'[01]+'/)||"0"==ch&&stream.match(/^b[01]+/)))return"number";if(ch.charCodeAt(0)>47&&ch.charCodeAt(0)<58)return stream.match(/^[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/),1==support.decimallessFloat&&stream.eat("."),"number";if("?"==ch&&(stream.eatSpace()||stream.eol()||stream.eat(";")))return"variable-3";if("'"==ch||'"'==ch&&support.doubleQuote)return state.tokenize=tokenLiteral(ch),state.tokenize(stream,state);if((1==support.nCharCast&&("n"==ch||"N"==ch)||1==support.charsetCast&&"_"==ch&&stream.match(/[a-z][a-z0-9]*/i))&&("'"==stream.peek()||'"'==stream.peek()))return"keyword";if(/^[\(\),\;\[\]]/.test(ch))return null;if(support.commentSlashSlash&&"/"==ch&&stream.eat("/"))return stream.skipToEnd(),"comment";if(support.commentHash&&"#"==ch||"-"==ch&&stream.eat("-")&&(!support.commentSpaceRequired||stream.eat(" ")))return stream.skipToEnd(),"comment";if("/"==ch&&stream.eat("*"))return state.tokenize=tokenComment,state.tokenize(stream,state);if("."!=ch){if(operatorChars.test(ch))return stream.eatWhile(operatorChars),null;if("{"==ch&&(stream.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||stream.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/)))return"number";stream.eatWhile(/^[_\w\d]/);var word=stream.current().toLowerCase();return dateSQL.hasOwnProperty(word)&&(stream.match(/^( )+'[^']*'/)||stream.match(/^( )+"[^"]*"/))?"number":atoms.hasOwnProperty(word)?"atom":builtin.hasOwnProperty(word)?"builtin":keywords.hasOwnProperty(word)?"keyword":client.hasOwnProperty(word)?"string-2":null}return 1==support.zerolessFloat&&stream.match(/^(?:\d+(?:e[+-]?\d+)?)/i)?"number":1==support.ODBCdotTable&&stream.match(/^[a-zA-Z_]+/)?"variable-2":void 0}function tokenLiteral(quote){return function(stream,state){for(var ch,escaped=!1;null!=(ch=stream.next());){if(ch==quote&&!escaped){state.tokenize=tokenBase;break}escaped=!escaped&&"\\"==ch}return"string"}}function tokenComment(stream,state){for(;;){if(!stream.skipTo("*")){stream.skipToEnd();break}if(stream.next(),stream.eat("/")){state.tokenize=tokenBase;break}}return"comment"}function pushContext(stream,state,type){state.context={prev:state.context,indent:stream.indentation(),col:stream.column(),type:type}}function popContext(state){state.indent=state.context.indent,state.context=state.context.prev}var client=parserConfig.client||{},atoms=parserConfig.atoms||{"false":!0,"true":!0,"null":!0},builtin=parserConfig.builtin||{},keywords=parserConfig.keywords||{},operatorChars=parserConfig.operatorChars||/^[*+\-%<>!=&|~^]/,support=parserConfig.support||{},hooks=parserConfig.hooks||{},dateSQL=parserConfig.dateSQL||{date:!0,time:!0,timestamp:!0};return{startState:function(){return{tokenize:tokenBase,context:null}},token:function(stream,state){if(stream.sol()&&state.context&&null==state.context.align&&(state.context.align=!1),stream.eatSpace())return null;var style=state.tokenize(stream,state);if("comment"==style)return style;state.context&&null==state.context.align&&(state.context.align=!0);var tok=stream.current();return"("==tok?pushContext(stream,state,")"):"["==tok?pushContext(stream,state,"]"):state.context&&state.context.type==tok&&popContext(state),style},indent:function(state,textAfter){var cx=state.context;if(!cx)return CodeMirror.Pass;var closing=textAfter.charAt(0)==cx.type;return cx.align?cx.col+(closing?0:1):cx.indent+(closing?0:config.indentUnit)},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:support.commentSlashSlash?"//":support.commentHash?"#":null}}),function(){function hookIdentifier(stream){for(var ch;null!=(ch=stream.next());)if("`"==ch&&!stream.eat("`"))return"variable-2";return stream.backUp(stream.current().length-1),stream.eatWhile(/\w/)?"variable-2":null}function hookVar(stream){return stream.eat("@")&&(stream.match(/^session\./),stream.match(/^local\./),stream.match(/^global\./)),stream.eat("'")?(stream.match(/^.*'/),"variable-2"):stream.eat('"')?(stream.match(/^.*"/),"variable-2"):stream.eat("`")?(stream.match(/^.*`/),"variable-2"):stream.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function hookClient(stream){return stream.eat("N")?"atom":stream.match(/^[a-zA-Z.#!?]/)?"variable-2":null}function set(str){for(var obj={},words=str.split(" "),i=0;i<words.length;++i)obj[words[i]]=!0;return obj}var sqlKeywords="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit";CodeMirror.defineMIME("text/x-sql",{name:"sql",keywords:set(sqlKeywords+"begin"),builtin:set("bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:set("date time timestamp"),support:set("ODBCdotTable doubleQuote binaryNumber hexNumber")}),CodeMirror.defineMIME("text/x-mssql",{name:"sql",client:set("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:set(sqlKeywords+"begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered declare"),builtin:set("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:set("date datetimeoffset datetime2 smalldatetime datetime time"),hooks:{"@":hookVar}}),CodeMirror.defineMIME("text/x-mysql",{name:"sql",client:set("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:set(sqlKeywords+"accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group group_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:set("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:set("date time timestamp"),support:set("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":hookVar,"`":hookIdentifier,"\\":hookClient}}),CodeMirror.defineMIME("text/x-mariadb",{name:"sql",client:set("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:set(sqlKeywords+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:set("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:set("date time timestamp"),support:set("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":hookVar,"`":hookIdentifier,"\\":hookClient}}),CodeMirror.defineMIME("text/x-cassandra",{name:"sql",client:{},keywords:set("add all allow alter and any apply as asc authorize batch begin by clustering columnfamily compact consistency count create custom delete desc distinct drop each_quorum exists filtering from grant if in index insert into key keyspace keyspaces level limit local_one local_quorum modify nan norecursive nosuperuser not of on one order password permission permissions primary quorum rename revoke schema select set storage superuser table three to token truncate ttl two type unlogged update use user users using values where with writetime"),builtin:set("ascii bigint blob boolean counter decimal double float frozen inet int list map static text timestamp timeuuid tuple uuid varchar varint"),atoms:set("false true infinity NaN"),operatorChars:/^[<>=]/,dateSQL:{},support:set("commentSlashSlash decimallessFloat"),hooks:{}}),CodeMirror.defineMIME("text/x-plsql",{name:"sql",client:set("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),keywords:set("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),builtin:set("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least lenght lenghtb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),operatorChars:/^[*+\-%<>!=~]/,dateSQL:set("date time timestamp"),support:set("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")}),CodeMirror.defineMIME("text/x-hive",{name:"sql",keywords:set("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external false fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger true unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with"),builtin:set("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:set("date timestamp"),support:set("ODBCdotTable doubleQuote binaryNumber hexNumber")})}()}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.defineMode("ruby",function(config){function wordObj(words){for(var o={},i=0,e=words.length;e>i;++i)o[words[i]]=!0;return o}function chain(newtok,stream,state){return state.tokenize.push(newtok),newtok(stream,state)}function tokenBase(stream,state){if(stream.sol()&&stream.match("=begin")&&stream.eol())return state.tokenize.push(readBlockComment),"comment";if(stream.eatSpace())return null;var m,ch=stream.next();if("`"==ch||"'"==ch||'"'==ch)return chain(readQuoted(ch,"string",'"'==ch||"`"==ch),stream,state);if("/"==ch){var currentIndex=stream.current().length;if(stream.skipTo("/")){var search_till=stream.current().length;stream.backUp(stream.current().length-currentIndex);for(var balance=0;stream.current().length<search_till;){var chchr=stream.next();if("("==chchr?balance+=1:")"==chchr&&(balance-=1),0>balance)break}if(stream.backUp(stream.current().length-currentIndex),0==balance)return chain(readQuoted(ch,"string-2",!0),stream,state)}return"operator"}if("%"==ch){var style="string",embed=!0;stream.eat("s")?style="atom":stream.eat(/[WQ]/)?style="string":stream.eat(/[r]/)?style="string-2":stream.eat(/[wxq]/)&&(style="string",embed=!1);var delim=stream.eat(/[^\w\s=]/);return delim?(matching.propertyIsEnumerable(delim)&&(delim=matching[delim]),chain(readQuoted(delim,style,embed,!0),stream,state)):"operator"}if("#"==ch)return stream.skipToEnd(),"comment";if("<"==ch&&(m=stream.match(/^<-?[\`\"\']?([a-zA-Z_?]\w*)[\`\"\']?(?:;|$)/)))return chain(readHereDoc(m[1]),stream,state);if("0"==ch)return stream.eat("x")?stream.eatWhile(/[\da-fA-F]/):stream.eat("b")?stream.eatWhile(/[01]/):stream.eatWhile(/[0-7]/),"number";if(/\d/.test(ch))return stream.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/),"number";if("?"==ch){for(;stream.match(/^\\[CM]-/););return stream.eat("\\")?stream.eatWhile(/\w/):stream.next(),"string"}if(":"==ch)return stream.eat("'")?chain(readQuoted("'","atom",!1),stream,state):stream.eat('"')?chain(readQuoted('"',"atom",!0),stream,state):stream.eat(/[\<\>]/)?(stream.eat(/[\<\>]/),"atom"):stream.eat(/[\+\-\*\/\&\|\:\!]/)?"atom":stream.eat(/[a-zA-Z$@_\xa1-\uffff]/)?(stream.eatWhile(/[\w$\xa1-\uffff]/),stream.eat(/[\?\!\=]/),"atom"):"operator";if("@"==ch&&stream.match(/^@?[a-zA-Z_\xa1-\uffff]/))return stream.eat("@"),stream.eatWhile(/[\w\xa1-\uffff]/),"variable-2";if("$"==ch)return stream.eat(/[a-zA-Z_]/)?stream.eatWhile(/[\w]/):stream.eat(/\d/)?stream.eat(/\d/):stream.next(),"variable-3";if(/[a-zA-Z_\xa1-\uffff]/.test(ch))return stream.eatWhile(/[\w\xa1-\uffff]/),stream.eat(/[\?\!]/),stream.eat(":")?"atom":"ident";if("|"!=ch||!state.varList&&"{"!=state.lastTok&&"do"!=state.lastTok){if(/[\(\)\[\]{}\\;]/.test(ch))return curPunc=ch,null;if("-"==ch&&stream.eat(">"))return"arrow";if(/[=+\-\/*:\.^%<>~|]/.test(ch)){var more=stream.eatWhile(/[=+\-\/*:\.^%<>~|]/);return"."!=ch||more||(curPunc="."),"operator"}return null}return curPunc="|",null}function tokenBaseUntilBrace(depth){return depth||(depth=1),function(stream,state){if("}"==stream.peek()){if(1==depth)return state.tokenize.pop(),state.tokenize[state.tokenize.length-1](stream,state);state.tokenize[state.tokenize.length-1]=tokenBaseUntilBrace(depth-1)}else"{"==stream.peek()&&(state.tokenize[state.tokenize.length-1]=tokenBaseUntilBrace(depth+1));return tokenBase(stream,state)}}function tokenBaseOnce(){var alreadyCalled=!1;return function(stream,state){return alreadyCalled?(state.tokenize.pop(),state.tokenize[state.tokenize.length-1](stream,state)):(alreadyCalled=!0,tokenBase(stream,state))}}function readQuoted(quote,style,embed,unescaped){return function(stream,state){var ch,escaped=!1;for("read-quoted-paused"===state.context.type&&(state.context=state.context.prev,stream.eat("}"));null!=(ch=stream.next());){if(ch==quote&&(unescaped||!escaped)){state.tokenize.pop();break}if(embed&&"#"==ch&&!escaped){if(stream.eat("{")){"}"==quote&&(state.context={prev:state.context,type:"read-quoted-paused"}),state.tokenize.push(tokenBaseUntilBrace());break}if(/[@\$]/.test(stream.peek())){state.tokenize.push(tokenBaseOnce());break}}escaped=!escaped&&"\\"==ch}return style}}function readHereDoc(phrase){return function(stream,state){return stream.match(phrase)?state.tokenize.pop():stream.skipToEnd(),"string"}}function readBlockComment(stream,state){return stream.sol()&&stream.match("=end")&&stream.eol()&&state.tokenize.pop(),stream.skipToEnd(),"comment"}var curPunc,keywords=wordObj(["alias","and","BEGIN","begin","break","case","class","def","defined?","do","else","elsif","END","end","ensure","false","for","if","in","module","next","not","or","redo","rescue","retry","return","self","super","then","true","undef","unless","until","when","while","yield","nil","raise","throw","catch","fail","loop","callcc","caller","lambda","proc","public","protected","private","require","load","require_relative","extend","autoload","__END__","__FILE__","__LINE__","__dir__"]),indentWords=wordObj(["def","class","case","for","while","until","module","then","catch","loop","proc","begin"]),dedentWords=wordObj(["end","until"]),matching={"[":"]","{":"}","(":")"};return{startState:function(){return{tokenize:[tokenBase],indented:0,context:{type:"top",indented:-config.indentUnit},continuedLine:!1,lastTok:null,varList:!1}},token:function(stream,state){curPunc=null,stream.sol()&&(state.indented=stream.indentation());var kwtype,style=state.tokenize[state.tokenize.length-1](stream,state),thisTok=curPunc;if("ident"==style){var word=stream.current();style="."==state.lastTok?"property":keywords.propertyIsEnumerable(stream.current())?"keyword":/^[A-Z]/.test(word)?"tag":"def"==state.lastTok||"class"==state.lastTok||state.varList?"def":"variable","keyword"==style&&(thisTok=word,indentWords.propertyIsEnumerable(word)?kwtype="indent":dedentWords.propertyIsEnumerable(word)?kwtype="dedent":"if"!=word&&"unless"!=word||stream.column()!=stream.indentation()?"do"==word&&state.context.indented<state.indented&&(kwtype="indent"):kwtype="indent")}return(curPunc||style&&"comment"!=style)&&(state.lastTok=thisTok),"|"==curPunc&&(state.varList=!state.varList),"indent"==kwtype||/[\(\[\{]/.test(curPunc)?state.context={prev:state.context,type:curPunc||style,indented:state.indented}:("dedent"==kwtype||/[\)\]\}]/.test(curPunc))&&state.context.prev&&(state.context=state.context.prev),stream.eol()&&(state.continuedLine="\\"==curPunc||"operator"==style),style},indent:function(state,textAfter){if(state.tokenize[state.tokenize.length-1]!=tokenBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),ct=state.context,closing=ct.type==matching[firstChar]||"keyword"==ct.type&&/^(?:end|until|else|elsif|when|rescue)\b/.test(textAfter);return ct.indented+(closing?0:config.indentUnit)+(state.continuedLine?config.indentUnit:0)},electricInput:/^\s*(?:end|rescue|\})$/,lineComment:"#"}}),CodeMirror.defineMIME("text/x-ruby","ruby")}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function wordRegexp(words){return new RegExp("^(("+words.join(")|(")+"))\\b")}function top(state){return state.scopes[state.scopes.length-1]}var wordOperators=wordRegexp(["and","or","not","is"]),commonKeywords=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield","in"],commonBuiltins=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"],py2={builtins:["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"],keywords:["exec","print"]},py3={builtins:["ascii","bytes","exec","print"],keywords:["nonlocal","False","True","None","async","await"]};CodeMirror.registerHelper("hintWords","python",commonKeywords.concat(commonBuiltins)),CodeMirror.defineMode("python",function(conf,parserConf){function tokenBase(stream,state){if(stream.sol()&&"py"==top(state).type){var scopeOffset=top(state).offset;if(stream.eatSpace()){var lineOffset=stream.indentation();return lineOffset>scopeOffset?pushScope(stream,state,"py"):scopeOffset>lineOffset&&dedent(stream,state)&&(state.errorToken=!0),null}var style=tokenBaseInner(stream,state);return scopeOffset>0&&dedent(stream,state)&&(style+=" "+ERRORCLASS),style}return tokenBaseInner(stream,state)}function tokenBaseInner(stream,state){if(stream.eatSpace())return null;var ch=stream.peek();if("#"==ch)return stream.skipToEnd(),"comment";if(stream.match(/^[0-9\.]/,!1)){var floatLiteral=!1;if(stream.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)&&(floatLiteral=!0),stream.match(/^\d+\.\d*/)&&(floatLiteral=!0),stream.match(/^\.\d+/)&&(floatLiteral=!0),floatLiteral)return stream.eat(/J/i),"number";var intLiteral=!1;if(stream.match(/^0x[0-9a-f]+/i)&&(intLiteral=!0),stream.match(/^0b[01]+/i)&&(intLiteral=!0),stream.match(/^0o[0-7]+/i)&&(intLiteral=!0),stream.match(/^[1-9]\d*(e[\+\-]?\d+)?/)&&(stream.eat(/J/i),intLiteral=!0),stream.match(/^0(?![\dx])/i)&&(intLiteral=!0),intLiteral)return stream.eat(/L/i),"number"}return stream.match(stringPrefixes)?(state.tokenize=tokenStringFactory(stream.current()),state.tokenize(stream,state)):stream.match(tripleDelimiters)||stream.match(doubleDelimiters)?"punctuation":stream.match(doubleOperators)||stream.match(singleOperators)?"operator":stream.match(singleDelimiters)?"punctuation":"."==state.lastToken&&stream.match(identifiers)?"property":stream.match(keywords)||stream.match(wordOperators)?"keyword":stream.match(builtins)?"builtin":stream.match(/^(self|cls)\b/)?"variable-2":stream.match(identifiers)?"def"==state.lastToken||"class"==state.lastToken?"def":"variable":(stream.next(),ERRORCLASS)}function tokenStringFactory(delimiter){function tokenString(stream,state){for(;!stream.eol();)if(stream.eatWhile(/[^'"\\]/),stream.eat("\\")){if(stream.next(),singleline&&stream.eol())return OUTCLASS}else{if(stream.match(delimiter))return state.tokenize=tokenBase,OUTCLASS;stream.eat(/['"]/)}if(singleline){if(parserConf.singleLineStringErrors)return ERRORCLASS;state.tokenize=tokenBase}return OUTCLASS}for(;"rub".indexOf(delimiter.charAt(0).toLowerCase())>=0;)delimiter=delimiter.substr(1);var singleline=1==delimiter.length,OUTCLASS="string";return tokenString.isString=!0,tokenString}function pushScope(stream,state,type){var offset=0,align=null;if("py"==type)for(;"py"!=top(state).type;)state.scopes.pop();offset=top(state).offset+("py"==type?conf.indentUnit:hangingIndent),"py"==type||stream.match(/^(\s|#.*)*$/,!1)||(align=stream.column()+1),state.scopes.push({offset:offset,type:type,align:align})}function dedent(stream,state){for(var indented=stream.indentation();top(state).offset>indented;){if("py"!=top(state).type)return!0;state.scopes.pop()}return top(state).offset!=indented}function tokenLexer(stream,state){var style=state.tokenize(stream,state),current=stream.current();if("@"==current)return parserConf.version&&3==parseInt(parserConf.version,10)?stream.match(identifiers,!1)?"meta":"operator":stream.match(identifiers,!1)?"meta":ERRORCLASS;"variable"!=style&&"builtin"!=style||"meta"!=state.lastToken||(style="meta"),("pass"==current||"return"==current)&&(state.dedent+=1),"lambda"==current&&(state.lambda=!0),":"!=current||state.lambda||"py"!=top(state).type||pushScope(stream,state,"py");var delimiter_index=1==current.length?"[({".indexOf(current):-1;if(-1!=delimiter_index&&pushScope(stream,state,"])}".slice(delimiter_index,delimiter_index+1)),delimiter_index="])}".indexOf(current),-1!=delimiter_index){if(top(state).type!=current)return ERRORCLASS;state.scopes.pop()}return state.dedent>0&&stream.eol()&&"py"==top(state).type&&(state.scopes.length>1&&state.scopes.pop(),state.dedent-=1),style}var ERRORCLASS="error",singleDelimiters=parserConf.singleDelimiters||/^[\(\)\[\]\{\}@,:`=;\.]/,doubleOperators=parserConf.doubleOperators||/^([!<>]==|<>|<<|>>|\/\/|\*\*)/,doubleDelimiters=parserConf.doubleDelimiters||/^(\+=|\-=|\*=|%=|\/=|&=|\|=|\^=)/,tripleDelimiters=parserConf.tripleDelimiters||/^(\/\/=|>>=|<<=|\*\*=)/;if(parserConf.version&&3==parseInt(parserConf.version,10))var singleOperators=parserConf.singleOperators||/^[\+\-\*\/%&|\^~<>!@]/,identifiers=parserConf.identifiers||/^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*/;else var singleOperators=parserConf.singleOperators||/^[\+\-\*\/%&|\^~<>!]/,identifiers=parserConf.identifiers||/^[_A-Za-z][_A-Za-z0-9]*/;var hangingIndent=parserConf.hangingIndent||conf.indentUnit,myKeywords=commonKeywords,myBuiltins=commonBuiltins;if(void 0!=parserConf.extra_keywords&&(myKeywords=myKeywords.concat(parserConf.extra_keywords)),void 0!=parserConf.extra_builtins&&(myBuiltins=myBuiltins.concat(parserConf.extra_builtins)),parserConf.version&&3==parseInt(parserConf.version,10)){myKeywords=myKeywords.concat(py3.keywords),myBuiltins=myBuiltins.concat(py3.builtins);var stringPrefixes=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}else{myKeywords=myKeywords.concat(py2.keywords),myBuiltins=myBuiltins.concat(py2.builtins);var stringPrefixes=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}var keywords=wordRegexp(myKeywords),builtins=wordRegexp(myBuiltins),external={startState:function(basecolumn){return{tokenize:tokenBase,scopes:[{offset:basecolumn||0,type:"py",align:null}],lastToken:null,lambda:!1,dedent:0}},token:function(stream,state){var addErr=state.errorToken;addErr&&(state.errorToken=!1);var style=tokenLexer(stream,state);return style&&"comment"!=style&&(state.lastToken="keyword"==style||"punctuation"==style?stream.current():style),"punctuation"==style&&(style=null),stream.eol()&&state.lambda&&(state.lambda=!1),addErr?style+" "+ERRORCLASS:style},indent:function(state,textAfter){if(state.tokenize!=tokenBase)return state.tokenize.isString?CodeMirror.Pass:0;var scope=top(state),closing=textAfter&&textAfter.charAt(0)==scope.type;return null!=scope.align?scope.align-(closing?1:0):closing&&state.scopes.length>1?state.scopes[state.scopes.length-2].offset:scope.offset},closeBrackets:{triples:"'\""},lineComment:"#",fold:"indent"};return external}),CodeMirror.defineMIME("text/x-python","python");var words=function(str){return str.split(" ")};CodeMirror.defineMIME("text/x-cython",{name:"python",extra_keywords:words("by cdef cimport cpdef ctypedef enum exceptextern gil include nogil property publicreadonly struct union DEF IF ELIF ELSE")})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function wordSet(words){for(var set={},i=0;i<words.length;i++)set[words[i]]=!0;return set}function tokenBase(stream,state,prev){if(stream.sol()&&(state.indented=stream.indentation()),stream.eatSpace())return null;var ch=stream.peek();if("/"==ch){if(stream.match("//"))return stream.skipToEnd(),"comment";if(stream.match("/*"))return state.tokenize.push(tokenComment),tokenComment(stream,state);if(stream.match(regexp))return"string-2"}if(operators.indexOf(ch)>-1)return stream.next(),"operator";if(punc.indexOf(ch)>-1)return stream.next(),stream.match(".."),"punctuation";if('"'==ch||"'"==ch){stream.next();var tokenize=tokenString(ch);return state.tokenize.push(tokenize),tokenize(stream,state)}if(stream.match(number))return"number";if(stream.match(property))return"property";if(stream.match(identifier)){var ident=stream.current();return keywords.hasOwnProperty(ident)?(definingKeywords.hasOwnProperty(ident)&&(state.prev="define"),"keyword"):types.hasOwnProperty(ident)?"variable-2":atoms.hasOwnProperty(ident)?"atom":"define"==prev?"def":"variable"}return stream.next(),null}function tokenUntilClosingParen(){var depth=0;return function(stream,state,prev){var inner=tokenBase(stream,state,prev);if("punctuation"==inner)if("("==stream.current())++depth;else if(")"==stream.current()){if(0==depth)return stream.backUp(1),state.tokenize.pop(),state.tokenize[state.tokenize.length-1](stream,state);--depth}return inner}}function tokenString(quote){return function(stream,state){for(var ch,escaped=!1;ch=stream.next();)if(escaped){if("("==ch)return state.tokenize.push(tokenUntilClosingParen()),"string";escaped=!1}else{if(ch==quote)break;escaped="\\"==ch}return state.tokenize.pop(),"string"}}function tokenComment(stream,state){return stream.match(/^(?:[^*]|\*(?!\/))*/),stream.match("*/")&&state.tokenize.pop(),"comment"}function Context(prev,align,indented){this.prev=prev,this.align=align,this.indented=indented}function pushContext(state,stream){var align=stream.match(/^\s*($|\/[\/\*])/,!1)?null:stream.column()+1;state.context=new Context(state.context,align,state.indented)}function popContext(state){state.context&&(state.indented=state.context.indented,state.context=state.context.prev)}var keywords=wordSet(["var","let","class","deinit","enum","extension","func","import","init","protocol","static","struct","subscript","typealias","as","dynamicType","is","new","super","self","Self","Type","__COLUMN__","__FILE__","__FUNCTION__","__LINE__","break","case","continue","default","do","else","fallthrough","if","in","for","return","switch","where","while","associativity","didSet","get","infix","inout","left","mutating","none","nonmutating","operator","override","postfix","precedence","prefix","right","set","unowned","weak","willSet"]),definingKeywords=wordSet(["var","let","class","enum","extension","func","import","protocol","struct","typealias","dynamicType","for"]),atoms=wordSet(["Infinity","NaN","undefined","null","true","false","on","off","yes","no","nil","null","this","super"]),types=wordSet(["String","bool","int","string","double","Double","Int","Float","float","public","private","extension"]),operators="+-/*%=|&<>#",punc=";,.(){}[]",number=/^-?(?:(?:[\d_]+\.[_\d]*|\.[_\d]+|0o[0-7_\.]+|0b[01_\.]+)(?:e-?[\d_]+)?|0x[\d_a-f\.]+(?:p-?[\d_]+)?)/i,identifier=/^[_A-Za-z$][_A-Za-z$0-9]*/,property=/^[@\.][_A-Za-z$][_A-Za-z$0-9]*/,regexp=/^\/(?!\s)(?:\/\/)?(?:\\.|[^\/])+\//;CodeMirror.defineMode("swift",function(config){return{startState:function(){return{prev:null,context:null,indented:0,tokenize:[]}},token:function(stream,state){var prev=state.prev;state.prev=null;var tokenize=state.tokenize[state.tokenize.length-1]||tokenBase,style=tokenize(stream,state,prev);if(style&&"comment"!=style?state.prev||(state.prev=style):state.prev=prev,"punctuation"==style){var bracket=/[\(\[\{]|([\]\)\}])/.exec(stream.current());bracket&&(bracket[1]?popContext:pushContext)(state,stream)}return style},indent:function(state,textAfter){var cx=state.context;if(!cx)return 0;var closing=/^[\]\}\)]/.test(textAfter);return null!=cx.align?cx.align-(closing?1:0):cx.indented+(closing?0:config.indentUnit)},electricInput:/^\s*[\)\}\]]$/,lineComment:"//",blockCommentStart:"/*",blockCommentEnd:"*/"}}),CodeMirror.defineMIME("text/x-swift","swift")}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed"),require("../../addon/mode/multiplex")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../htmlmixed/htmlmixed","../../addon/mode/multiplex"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.defineMode("htmlembedded",function(config,parserConfig){return CodeMirror.multiplexingMode(CodeMirror.getMode(config,"htmlmixed"),{open:parserConfig.open||parserConfig.scriptStartRegex||"<%",close:parserConfig.close||parserConfig.scriptEndRegex||"%>",mode:CodeMirror.getMode(config,parserConfig.scriptingModeSpec)})},"htmlmixed"),CodeMirror.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"}),CodeMirror.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"}),CodeMirror.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"}),CodeMirror.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("../xml/xml"),require("../meta")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../meta"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.defineMode("markdown",function(cmCfg,modeCfg){function getMode(name){if(CodeMirror.findModeByName){var found=CodeMirror.findModeByName(name);found&&(name=found.mime||found.mimes[0])}var mode=CodeMirror.getMode(cmCfg,name);return"null"==mode.name?null:mode}function switchInline(stream,state,f){return state.f=state.inline=f,f(stream,state)}function switchBlock(stream,state,f){return state.f=state.block=f,f(stream,state)}function lineIsEmpty(line){return!line||!/\S/.test(line.string)}function blankLine(state){return state.linkTitle=!1,state.em=!1,state.strong=!1,state.strikethrough=!1,state.quote=0,state.indentedCode=!1,htmlFound||state.f!=htmlBlock||(state.f=inlineNormal,state.block=blockNormal),state.trailingSpace=0,state.trailingSpaceNewLine=!1,state.prevLine=state.thisLine,state.thisLine=null,null}function blockNormal(stream,state){var sol=stream.sol(),prevLineIsList=state.list!==!1,prevLineIsIndentedCode=state.indentedCode;state.indentedCode=!1,prevLineIsList&&(state.indentationDiff>=0?(state.indentationDiff<4&&(state.indentation-=state.indentationDiff),state.list=null):state.indentation>0?(state.list=null,state.listDepth=Math.floor(state.indentation/4)):(state.list=!1,state.listDepth=0));var match=null;if(state.indentationDiff>=4)return stream.skipToEnd(),prevLineIsIndentedCode||lineIsEmpty(state.prevLine)?(state.indentation-=4,state.indentedCode=!0,tokenTypes.code):null;if(stream.eatSpace())return null;if((match=stream.match(atxHeaderRE))&&match[1].length<=6)return state.header=match[1].length,modeCfg.highlightFormatting&&(state.formatting="header"),state.f=state.inline,getType(state);if(!(lineIsEmpty(state.prevLine)||state.quote||prevLineIsList||prevLineIsIndentedCode)&&(match=stream.match(setextHeaderRE)))return state.header="="==match[0].charAt(0)?1:2,modeCfg.highlightFormatting&&(state.formatting="header"),state.f=state.inline,getType(state);if(stream.eat(">"))return state.quote=sol?1:state.quote+1,modeCfg.highlightFormatting&&(state.formatting="quote"),stream.eatSpace(),getType(state);if("["===stream.peek())return switchInline(stream,state,footnoteLink);if(stream.match(hrRE,!0))return state.hr=!0,tokenTypes.hr;if((lineIsEmpty(state.prevLine)||prevLineIsList)&&(stream.match(ulRE,!1)||stream.match(olRE,!1))){var listType=null;return stream.match(ulRE,!0)?listType="ul":(stream.match(olRE,!0),listType="ol"),state.indentation=stream.column()+stream.current().length,state.list=!0,state.listDepth++,modeCfg.taskLists&&stream.match(taskListRE,!1)&&(state.taskList=!0),state.f=state.inline,modeCfg.highlightFormatting&&(state.formatting=["list","list-"+listType]),getType(state)}return modeCfg.fencedCodeBlocks&&(match=stream.match(fencedCodeRE,!0))?(state.fencedChars=match[1],state.localMode=getMode(match[2]),state.localMode&&(state.localState=state.localMode.startState()),state.f=state.block=local,modeCfg.highlightFormatting&&(state.formatting="code-block"),state.code=!0,getType(state)):switchInline(stream,state,state.inline)}function htmlBlock(stream,state){var style=htmlMode.token(stream,state.htmlState);return(htmlFound&&null===state.htmlState.tagStart&&!state.htmlState.context&&state.htmlState.tokenize.isInText||state.md_inside&&stream.current().indexOf(">")>-1)&&(state.f=inlineNormal,state.block=blockNormal,state.htmlState=null),style}function local(stream,state){return state.fencedChars&&stream.match(state.fencedChars,!1)?(state.localMode=state.localState=null,state.f=state.block=leavingLocal,null):state.localMode?state.localMode.token(stream,state.localState):(stream.skipToEnd(),tokenTypes.code)}function leavingLocal(stream,state){stream.match(state.fencedChars),state.block=blockNormal,state.f=inlineNormal,state.fencedChars=null,modeCfg.highlightFormatting&&(state.formatting="code-block"),state.code=!0;var returnType=getType(state);return state.code=!1,returnType}function getType(state){var styles=[];if(state.formatting){styles.push(tokenTypes.formatting),"string"==typeof state.formatting&&(state.formatting=[state.formatting]);for(var i=0;i<state.formatting.length;i++)styles.push(tokenTypes.formatting+"-"+state.formatting[i]),"header"===state.formatting[i]&&styles.push(tokenTypes.formatting+"-"+state.formatting[i]+"-"+state.header),"quote"===state.formatting[i]&&(!modeCfg.maxBlockquoteDepth||modeCfg.maxBlockquoteDepth>=state.quote?styles.push(tokenTypes.formatting+"-"+state.formatting[i]+"-"+state.quote):styles.push("error"))}if(state.taskOpen)return styles.push("meta"),styles.length?styles.join(" "):null;if(state.taskClosed)return styles.push("property"),styles.length?styles.join(" "):null;if(state.linkHref?styles.push(tokenTypes.linkHref,"url"):(state.strong&&styles.push(tokenTypes.strong),state.em&&styles.push(tokenTypes.em),state.strikethrough&&styles.push(tokenTypes.strikethrough),state.linkText&&styles.push(tokenTypes.linkText),state.code&&styles.push(tokenTypes.code)),state.header&&styles.push(tokenTypes.header,tokenTypes.header+"-"+state.header),state.quote&&(styles.push(tokenTypes.quote),!modeCfg.maxBlockquoteDepth||modeCfg.maxBlockquoteDepth>=state.quote?styles.push(tokenTypes.quote+"-"+state.quote):styles.push(tokenTypes.quote+"-"+modeCfg.maxBlockquoteDepth)),state.list!==!1){var listMod=(state.listDepth-1)%3;listMod?1===listMod?styles.push(tokenTypes.list2):styles.push(tokenTypes.list3):styles.push(tokenTypes.list1)}return state.trailingSpaceNewLine?styles.push("trailing-space-new-line"):state.trailingSpace&&styles.push("trailing-space-"+(state.trailingSpace%2?"a":"b")),styles.length?styles.join(" "):null}function handleText(stream,state){return stream.match(textRE,!0)?getType(state):void 0}function inlineNormal(stream,state){var style=state.text(stream,state);if("undefined"!=typeof style)return style;if(state.list)return state.list=null,getType(state);if(state.taskList){var taskOpen="x"!==stream.match(taskListRE,!0)[1];return taskOpen?state.taskOpen=!0:state.taskClosed=!0,modeCfg.highlightFormatting&&(state.formatting="task"),state.taskList=!1,getType(state)}if(state.taskOpen=!1,state.taskClosed=!1,state.header&&stream.match(/^#+$/,!0))return modeCfg.highlightFormatting&&(state.formatting="header"),getType(state);var sol=stream.sol(),ch=stream.next();if("\\"===ch&&(stream.next(),modeCfg.highlightFormatting)){var type=getType(state),formattingEscape=tokenTypes.formatting+"-escape";return type?type+" "+formattingEscape:formattingEscape}if(state.linkTitle){state.linkTitle=!1;var matchCh=ch;"("===ch&&(matchCh=")"),matchCh=(matchCh+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var regex="^\\s*(?:[^"+matchCh+"\\\\]+|\\\\\\\\|\\\\.)"+matchCh;if(stream.match(new RegExp(regex),!0))return tokenTypes.linkHref}if("`"===ch){var previousFormatting=state.formatting;modeCfg.highlightFormatting&&(state.formatting="code");var t=getType(state),before=stream.pos;stream.eatWhile("`");var difference=1+stream.pos-before;return state.code?difference===codeDepth?(state.code=!1,t):(state.formatting=previousFormatting,getType(state)):(codeDepth=difference,state.code=!0,getType(state))}if(state.code)return getType(state);if("!"===ch&&stream.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return stream.match(/\[[^\]]*\]/),state.inline=state.f=linkHref,tokenTypes.image;if("["===ch&&stream.match(/.*\](\(.*\)| ?\[.*\])/,!1))return state.linkText=!0,modeCfg.highlightFormatting&&(state.formatting="link"),getType(state);if("]"===ch&&state.linkText&&stream.match(/\(.*\)| ?\[.*\]/,!1)){modeCfg.highlightFormatting&&(state.formatting="link");var type=getType(state);return state.linkText=!1,state.inline=state.f=linkHref,type}if("<"===ch&&stream.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1)){state.f=state.inline=linkInline,modeCfg.highlightFormatting&&(state.formatting="link");var type=getType(state);return type?type+=" ":type="",type+tokenTypes.linkInline}if("<"===ch&&stream.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1)){state.f=state.inline=linkInline,modeCfg.highlightFormatting&&(state.formatting="link");var type=getType(state);return type?type+=" ":type="",type+tokenTypes.linkEmail}if("<"===ch&&stream.match(/^(!--|\w)/,!1)){var end=stream.string.indexOf(">",stream.pos);if(-1!=end){var atts=stream.string.substring(stream.start,end);/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(atts)&&(state.md_inside=!0)}return stream.backUp(1),state.htmlState=CodeMirror.startState(htmlMode),switchBlock(stream,state,htmlBlock)}if("<"===ch&&stream.match(/^\/\w*?>/))return state.md_inside=!1,"tag";var ignoreUnderscore=!1;if(!modeCfg.underscoresBreakWords&&"_"===ch&&"_"!==stream.peek()&&stream.match(/(\w)/,!1)){var prevPos=stream.pos-2;if(prevPos>=0){var prevCh=stream.string.charAt(prevPos);"_"!==prevCh&&prevCh.match(/(\w)/,!1)&&(ignoreUnderscore=!0)}}if("*"===ch||"_"===ch&&!ignoreUnderscore)if(sol&&" "===stream.peek());else{if(state.strong===ch&&stream.eat(ch)){modeCfg.highlightFormatting&&(state.formatting="strong");var t=getType(state);return state.strong=!1,t}if(!state.strong&&stream.eat(ch))return state.strong=ch,modeCfg.highlightFormatting&&(state.formatting="strong"),getType(state);if(state.em===ch){modeCfg.highlightFormatting&&(state.formatting="em");var t=getType(state);return state.em=!1,t}if(!state.em)return state.em=ch,modeCfg.highlightFormatting&&(state.formatting="em"),getType(state)}else if(" "===ch&&(stream.eat("*")||stream.eat("_"))){if(" "===stream.peek())return getType(state);stream.backUp(1)}if(modeCfg.strikethrough)if("~"===ch&&stream.eatWhile(ch)){if(state.strikethrough){modeCfg.highlightFormatting&&(state.formatting="strikethrough");var t=getType(state);return state.strikethrough=!1,t}if(stream.match(/^[^\s]/,!1))return state.strikethrough=!0,modeCfg.highlightFormatting&&(state.formatting="strikethrough"),getType(state)}else if(" "===ch&&stream.match(/^~~/,!0)){if(" "===stream.peek())return getType(state);stream.backUp(2)}return" "===ch&&(stream.match(/ +$/,!1)?state.trailingSpace++:state.trailingSpace&&(state.trailingSpaceNewLine=!0)),getType(state)}function linkInline(stream,state){var ch=stream.next();if(">"===ch){state.f=state.inline=inlineNormal,modeCfg.highlightFormatting&&(state.formatting="link");var type=getType(state);return type?type+=" ":type="",type+tokenTypes.linkInline}return stream.match(/^[^>]+/,!0),tokenTypes.linkInline}function linkHref(stream,state){if(stream.eatSpace())return null;var ch=stream.next();return"("===ch||"["===ch?(state.f=state.inline=getLinkHrefInside("("===ch?")":"]"),modeCfg.highlightFormatting&&(state.formatting="link-string"),state.linkHref=!0,getType(state)):"error"}function getLinkHrefInside(endChar){return function(stream,state){var ch=stream.next();if(ch===endChar){state.f=state.inline=inlineNormal,modeCfg.highlightFormatting&&(state.formatting="link-string");var returnState=getType(state);return state.linkHref=!1,returnState}return stream.match(inlineRE(endChar),!0)&&stream.backUp(1),state.linkHref=!0,getType(state)}}function footnoteLink(stream,state){return stream.match(/^([^\]\\]|\\.)*\]:/,!1)?(state.f=footnoteLinkInside,stream.next(),modeCfg.highlightFormatting&&(state.formatting="link"),state.linkText=!0,getType(state)):switchInline(stream,state,inlineNormal)}function footnoteLinkInside(stream,state){if(stream.match(/^\]:/,!0)){state.f=state.inline=footnoteUrl,modeCfg.highlightFormatting&&(state.formatting="link");var returnType=getType(state);return state.linkText=!1,returnType}return stream.match(/^([^\]\\]|\\.)+/,!0),tokenTypes.linkText}function footnoteUrl(stream,state){return stream.eatSpace()?null:(stream.match(/^[^\s]+/,!0),void 0===stream.peek()?state.linkTitle=!0:stream.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),state.f=state.inline=inlineNormal,tokenTypes.linkHref+" url")}function inlineRE(endChar){return savedInlineRE[endChar]||(endChar=(endChar+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),savedInlineRE[endChar]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+endChar+")")),savedInlineRE[endChar]}var htmlFound=CodeMirror.modes.hasOwnProperty("xml"),htmlMode=CodeMirror.getMode(cmCfg,htmlFound?{name:"xml",htmlMode:!0}:"text/plain");void 0===modeCfg.highlightFormatting&&(modeCfg.highlightFormatting=!1),void 0===modeCfg.maxBlockquoteDepth&&(modeCfg.maxBlockquoteDepth=0),void 0===modeCfg.underscoresBreakWords&&(modeCfg.underscoresBreakWords=!0),void 0===modeCfg.taskLists&&(modeCfg.taskLists=!1),void 0===modeCfg.strikethrough&&(modeCfg.strikethrough=!1),void 0===modeCfg.tokenTypeOverrides&&(modeCfg.tokenTypeOverrides={});var codeDepth=0,tokenTypes={header:"header",code:"comment",quote:"quote",list1:"variable-2",list2:"variable-3",list3:"keyword",hr:"hr",image:"tag",formatting:"formatting",linkInline:"link",linkEmail:"link",linkText:"link",linkHref:"string",em:"em",strong:"strong",strikethrough:"strikethrough"};for(var tokenType in tokenTypes)tokenTypes.hasOwnProperty(tokenType)&&modeCfg.tokenTypeOverrides[tokenType]&&(tokenTypes[tokenType]=modeCfg.tokenTypeOverrides[tokenType]);var hrRE=/^([*\-_])(?:\s*\1){2,}\s*$/,ulRE=/^[*\-+]\s+/,olRE=/^[0-9]+([.)])\s+/,taskListRE=/^\[(x| )\](?=\s)/,atxHeaderRE=modeCfg.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,setextHeaderRE=/^ *(?:\={1,}|-{1,})\s*$/,textRE=/^[^#!\[\]*_\\<>` "'(~]+/,fencedCodeRE=new RegExp("^("+(modeCfg.fencedCodeBlocks===!0?"~~~+|```+":modeCfg.fencedCodeBlocks)+")[ \\t]*([\\w+#]*)"),savedInlineRE=[],mode={startState:function(){return{f:blockNormal,prevLine:null,thisLine:null,block:blockNormal,htmlState:null,indentation:0,inline:inlineNormal,text:handleText,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,em:!1,strong:!1,header:0,hr:!1,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,fencedChars:null}},copyState:function(s){return{f:s.f,prevLine:s.prevLine,thisLine:s.thisLine,block:s.block,htmlState:s.htmlState&&CodeMirror.copyState(htmlMode,s.htmlState),indentation:s.indentation,localMode:s.localMode,localState:s.localMode?CodeMirror.copyState(s.localMode,s.localState):null,inline:s.inline,text:s.text,formatting:!1,linkTitle:s.linkTitle,code:s.code,em:s.em,strong:s.strong,strikethrough:s.strikethrough,header:s.header,hr:s.hr,taskList:s.taskList,list:s.list,listDepth:s.listDepth,quote:s.quote,indentedCode:s.indentedCode,trailingSpace:s.trailingSpace,trailingSpaceNewLine:s.trailingSpaceNewLine,md_inside:s.md_inside,fencedChars:s.fencedChars}},token:function(stream,state){if(state.formatting=!1,stream!=state.thisLine){var forceBlankLine=state.header||state.hr;if(state.header=0,state.hr=!1,stream.match(/^\s*$/,!0)||forceBlankLine){if(blankLine(state),!forceBlankLine)return null;state.prevLine=null}state.prevLine=state.thisLine,state.thisLine=stream,state.taskList=!1,state.trailingSpace=0,state.trailingSpaceNewLine=!1,state.f=state.block;var indentation=stream.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,difference=4*Math.floor((indentation-state.indentation)/4);difference>4&&(difference=4);var adjustedIndentation=state.indentation+difference;if(state.indentationDiff=adjustedIndentation-state.indentation,state.indentation=adjustedIndentation,indentation>0)return null}return state.f(stream,state)},innerMode:function(state){return state.block==htmlBlock?{state:state.htmlState,mode:htmlMode}:state.localState?{state:state.localState,mode:state.localMode}:{state:state,mode:mode}},blankLine:blankLine,getType:getType,fold:"markdown"};return mode},"xml"),CodeMirror.defineMIME("text/x-markdown","markdown")}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function words(str){for(var obj={},words=str.split(" "),i=0;i<words.length;++i)obj[words[i]]=!0;return obj}function contains(words,word){return"function"==typeof words?words(word):words.propertyIsEnumerable(word)}function cppHook(stream,state){if(!state.startOfLine)return!1;for(var ch,next=null;ch=stream.peek();){if("\\"==ch&&stream.match(/^.$/)){next=cppHook;break}if("/"==ch&&stream.match(/^\/[\/\*]/,!1))break;stream.next()}return state.tokenize=next,"meta"}function pointerHook(_stream,state){return"variable-3"==state.prevToken?"variable-3":!1}function cpp14Literal(stream){return stream.eatWhile(/[\w\.']/),"number"}function cpp11StringHook(stream,state){if(stream.backUp(1),stream.match(/(R|u8R|uR|UR|LR)/)){var match=stream.match(/"([^\s\\()]{0,16})\(/);return match?(state.cpp11RawStringDelim=match[1],state.tokenize=tokenRawString,tokenRawString(stream,state)):!1}return stream.match(/(u8|u|U|L)/)?stream.match(/["']/,!1)?"string":!1:(stream.next(),!1)}function cppLooksLikeConstructor(word){var lastTwo=/(\w+)::(\w+)$/.exec(word);return lastTwo&&lastTwo[1]==lastTwo[2]}function tokenAtString(stream,state){for(var next;null!=(next=stream.next());)if('"'==next&&!stream.eat('"')){state.tokenize=null;break}return"string"}function tokenRawString(stream,state){var delim=state.cpp11RawStringDelim.replace(/[^\w\s]/g,"\\$&"),match=stream.match(new RegExp(".*?\\)"+delim+'"'));return match?state.tokenize=null:stream.skipToEnd(),"string"}function def(mimes,mode){function add(obj){if(obj)for(var prop in obj)obj.hasOwnProperty(prop)&&words.push(prop)}"string"==typeof mimes&&(mimes=[mimes]);var words=[];add(mode.keywords),add(mode.types),add(mode.builtin),add(mode.atoms),words.length&&(mode.helperType=mimes[0],CodeMirror.registerHelper("hintWords",mimes[0],words));for(var i=0;i<mimes.length;++i)CodeMirror.defineMIME(mimes[i],mode)}function tokenTripleString(stream,state){for(var escaped=!1;!stream.eol();){if(!escaped&&stream.match('"""')){state.tokenize=null;break}escaped="\\"==stream.next()&&!escaped}return"string"}function tokenKotlinString(tripleString){return function(stream,state){for(var next,escaped=!1,end=!1;!stream.eol();){if(!tripleString&&!escaped&&stream.match('"')){end=!0;break}if(tripleString&&stream.match('"""')){end=!0;break}next=stream.next(),!escaped&&"$"==next&&stream.match("{")&&stream.skipTo("}"),escaped=!escaped&&"\\"==next&&!tripleString}return(end||!tripleString)&&(state.tokenize=null),"string"}}function tokenCeylonString(type){return function(stream,state){for(var next,escaped=!1,end=!1;!stream.eol();){if(!escaped&&stream.match('"')&&("single"==type||stream.match('""'))){end=!0;break}if(!escaped&&stream.match("``")){stringTokenizer=tokenCeylonString(type),end=!0;break}next=stream.next(),escaped="single"==type&&!escaped&&"\\"==next}return end&&(state.tokenize=null),"string"}}CodeMirror.defineMode("clike",function(config,parserConfig){function tokenBase(stream,state){var ch=stream.next();if(hooks[ch]){var result=hooks[ch](stream,state);if(result!==!1)return result}if('"'==ch||"'"==ch)return state.tokenize=tokenString(ch),state.tokenize(stream,state);if(isPunctuationChar.test(ch))return curPunc=ch,null;if(numberStart.test(ch)){if(stream.backUp(1),stream.match(number))return"number";stream.next()}if("/"==ch){if(stream.eat("*"))return state.tokenize=tokenComment,tokenComment(stream,state);if(stream.eat("/"))return stream.skipToEnd(),"comment"}if(isOperatorChar.test(ch))return stream.eatWhile(isOperatorChar),"operator";if(stream.eatWhile(/[\w\$_\xa1-\uffff]/),namespaceSeparator)for(;stream.match(namespaceSeparator);)stream.eatWhile(/[\w\$_\xa1-\uffff]/);var cur=stream.current();return contains(keywords,cur)?(contains(blockKeywords,cur)&&(curPunc="newstatement"),contains(defKeywords,cur)&&(isDefKeyword=!0),"keyword"):contains(types,cur)?"variable-3":contains(builtin,cur)?(contains(blockKeywords,cur)&&(curPunc="newstatement"),"builtin"):contains(atoms,cur)?"atom":"variable"}function tokenString(quote){return function(stream,state){for(var next,escaped=!1,end=!1;null!=(next=stream.next());){if(next==quote&&!escaped){end=!0;break}escaped=!escaped&&"\\"==next}return(end||!escaped&&!multiLineStrings)&&(state.tokenize=null),"string"}}function tokenComment(stream,state){for(var ch,maybeEnd=!1;ch=stream.next();){if("/"==ch&&maybeEnd){state.tokenize=null;break}maybeEnd="*"==ch}return"comment"}function Context(indented,column,type,align,prev){this.indented=indented,this.column=column,this.type=type,this.align=align,this.prev=prev}function isStatement(type){return"statement"==type||"switchstatement"==type||"namespace"==type}function pushContext(state,col,type){var indent=state.indented;return state.context&&isStatement(state.context.type)&&!isStatement(type)&&(indent=state.context.indented),state.context=new Context(indent,col,type,null,state.context)}function popContext(state){var t=state.context.type;return(")"==t||"]"==t||"}"==t)&&(state.indented=state.context.indented),state.context=state.context.prev}function typeBefore(stream,state){return"variable"==state.prevToken||"variable-3"==state.prevToken?!0:/\S(?:[^- ]>|[*\]])\s*$|\*$/.test(stream.string.slice(0,stream.start))?!0:void 0}function isTopScope(context){for(;;){if(!context||"top"==context.type)return!0;if("}"==context.type&&"namespace"!=context.prev.type)return!1;context=context.prev}}var curPunc,isDefKeyword,indentUnit=config.indentUnit,statementIndentUnit=parserConfig.statementIndentUnit||indentUnit,dontAlignCalls=parserConfig.dontAlignCalls,keywords=parserConfig.keywords||{},types=parserConfig.types||{},builtin=parserConfig.builtin||{},blockKeywords=parserConfig.blockKeywords||{},defKeywords=parserConfig.defKeywords||{},atoms=parserConfig.atoms||{},hooks=parserConfig.hooks||{},multiLineStrings=parserConfig.multiLineStrings,indentStatements=parserConfig.indentStatements!==!1,indentSwitch=parserConfig.indentSwitch!==!1,namespaceSeparator=parserConfig.namespaceSeparator,isPunctuationChar=parserConfig.isPunctuationChar||/[\[\]{}\(\),;\:\.]/,numberStart=parserConfig.numberStart||/[\d\.]/,number=parserConfig.number||/^(?:0x[a-f\d]+|0b[01]+|(?:\d+\.?\d*|\.\d+)(?:e[-+]?\d+)?)(u|ll?|l|f)?/i,isOperatorChar=parserConfig.isOperatorChar||/[+\-*&%=<>!?|\/]/,endStatement=parserConfig.endStatement||/^[;:,]$/;return{startState:function(basecolumn){return{tokenize:null,context:new Context((basecolumn||0)-indentUnit,0,"top",!1),indented:0,startOfLine:!0,prevToken:null}},token:function(stream,state){var ctx=state.context;if(stream.sol()&&(null==ctx.align&&(ctx.align=!1),state.indented=stream.indentation(),state.startOfLine=!0),stream.eatSpace())return null;curPunc=isDefKeyword=null;var style=(state.tokenize||tokenBase)(stream,state);if("comment"==style||"meta"==style)return style;if(null==ctx.align&&(ctx.align=!0),endStatement.test(curPunc))for(;isStatement(state.context.type);)popContext(state);else if("{"==curPunc)pushContext(state,stream.column(),"}");else if("["==curPunc)pushContext(state,stream.column(),"]");else if("("==curPunc)pushContext(state,stream.column(),")");else if("}"==curPunc){for(;isStatement(ctx.type);)ctx=popContext(state);for("}"==ctx.type&&(ctx=popContext(state));isStatement(ctx.type);)ctx=popContext(state)}else if(curPunc==ctx.type)popContext(state);else if(indentStatements&&(("}"==ctx.type||"top"==ctx.type)&&";"!=curPunc||isStatement(ctx.type)&&"newstatement"==curPunc)){var type="statement";"newstatement"==curPunc&&indentSwitch&&"switch"==stream.current()?type="switchstatement":"keyword"==style&&"namespace"==stream.current()&&(type="namespace"),pushContext(state,stream.column(),type)}if("variable"==style&&("def"==state.prevToken||parserConfig.typeFirstDefinitions&&typeBefore(stream,state)&&isTopScope(state.context)&&stream.match(/^\s*\(/,!1))&&(style="def"),hooks.token){var result=hooks.token(stream,state,style);void 0!==result&&(style=result)}return"def"==style&&parserConfig.styleDefs===!1&&(style="variable"),state.startOfLine=!1,state.prevToken=isDefKeyword?"def":style||curPunc,style},indent:function(state,textAfter){if(state.tokenize!=tokenBase&&null!=state.tokenize)return CodeMirror.Pass;var ctx=state.context,firstChar=textAfter&&textAfter.charAt(0);if(isStatement(ctx.type)&&"}"==firstChar&&(ctx=ctx.prev),hooks.indent){var hook=hooks.indent(state,ctx,textAfter);if("number"==typeof hook)return hook}var closing=firstChar==ctx.type,switchBlock=ctx.prev&&"switchstatement"==ctx.prev.type;if(parserConfig.allmanIndentation&&/[{(]/.test(firstChar)){for(;"top"!=ctx.type&&"}"!=ctx.type;)ctx=ctx.prev;return ctx.indented}return isStatement(ctx.type)?ctx.indented+("{"==firstChar?0:statementIndentUnit):!ctx.align||dontAlignCalls&&")"==ctx.type?")"!=ctx.type||closing?ctx.indented+(closing?0:indentUnit)+(closing||!switchBlock||/^(?:case|default)\b/.test(textAfter)?0:indentUnit):ctx.indented+statementIndentUnit:ctx.column+(closing?0:1)},electricInput:indentSwitch?/^\s*(?:case .*?:|default:|\{\}?|\})$/:/^\s*[{}]$/,blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//",fold:"brace"}});var cKeywords="auto if break case register continue return default do sizeof static else struct switch extern typedef union for goto while enum const volatile",cTypes="int long char short double float unsigned signed void size_t ptrdiff_t";def(["text/x-csrc","text/x-c","text/x-chdr"],{name:"clike",keywords:words(cKeywords),types:words(cTypes+" bool _Complex _Bool float_t double_t intptr_t intmax_t int8_t int16_t int32_t int64_t uintptr_t uintmax_t uint8_t uint16_t uint32_t uint64_t"),blockKeywords:words("case do else for if switch while struct"),defKeywords:words("struct"),typeFirstDefinitions:!0,atoms:words("null true false"),hooks:{"#":cppHook,"*":pointerHook},modeProps:{fold:["brace","include"]}}),def(["text/x-c++src","text/x-c++hdr"],{name:"clike",keywords:words(cKeywords+" asm dynamic_cast namespace reinterpret_cast try explicit new static_cast typeid catch operator template typename class friend private this using const_cast inline public throw virtual delete mutable protected alignas alignof constexpr decltype nullptr noexcept thread_local final static_assert override"),types:words(cTypes+" bool wchar_t"),blockKeywords:words("catch class do else finally for if struct switch try while"),defKeywords:words("class namespace struct enum union"),typeFirstDefinitions:!0,atoms:words("true false null"),hooks:{"#":cppHook,"*":pointerHook,u:cpp11StringHook,U:cpp11StringHook,L:cpp11StringHook,R:cpp11StringHook,0:cpp14Literal,1:cpp14Literal,2:cpp14Literal,3:cpp14Literal,4:cpp14Literal,5:cpp14Literal,6:cpp14Literal,7:cpp14Literal,8:cpp14Literal,9:cpp14Literal,token:function(stream,state,style){return"variable"!=style||"("!=stream.peek()||";"!=state.prevToken&&null!=state.prevToken&&"}"!=state.prevToken||!cppLooksLikeConstructor(stream.current())?void 0:"def"}},namespaceSeparator:"::",modeProps:{fold:["brace","include"]}}),def("text/x-java",{name:"clike",keywords:words("abstract assert break case catch class const continue default do else enum extends final finally float for goto if implements import instanceof interface native new package private protected public return static strictfp super switch synchronized this throw throws transient try volatile while"),types:words("byte short int long float double boolean char void Boolean Byte Character Double Float Integer Long Number Object Short String StringBuffer StringBuilder Void"),blockKeywords:words("catch class do else finally for if switch try while"),defKeywords:words("class interface package enum"),typeFirstDefinitions:!0,atoms:words("true false null"),endStatement:/^[;:]$/,hooks:{"@":function(stream){return stream.eatWhile(/[\w\$_]/),"meta"}},modeProps:{fold:["brace","import"]}}),def("text/x-csharp",{name:"clike",keywords:words("abstract as async await base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in interface internal is lock namespace new operator out override params private protected public readonly ref return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),types:words("Action Boolean Byte Char DateTime DateTimeOffset Decimal Double Func Guid Int16 Int32 Int64 Object SByte Single String Task TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),blockKeywords:words("catch class do else finally for foreach if struct switch try while"),defKeywords:words("class interface namespace struct var"),typeFirstDefinitions:!0,atoms:words("true false null"),hooks:{"@":function(stream,state){return stream.eat('"')?(state.tokenize=tokenAtString,tokenAtString(stream,state)):(stream.eatWhile(/[\w\$_]/),"meta")}}}),def("text/x-scala",{name:"clike",keywords:words("abstract case catch class def do else extends final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try type val var while with yield _ : = => <- <: <% >: # @ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble :: #:: "),types:words("AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),multiLineStrings:!0,blockKeywords:words("catch class do else finally for forSome if match switch try while"),defKeywords:words("class def object package trait type val var"),atoms:words("true false null"),indentStatements:!1,indentSwitch:!1,hooks:{"@":function(stream){return stream.eatWhile(/[\w\$_]/),"meta"},'"':function(stream,state){return stream.match('""')?(state.tokenize=tokenTripleString,state.tokenize(stream,state)):!1},"'":function(stream){return stream.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"}},modeProps:{closeBrackets:{triples:'"'}}}),def("text/x-kotlin",{name:"clike",keywords:words("package as typealias class interface this super val var fun for is in This throw return break continue object if else while do try when !in !is as? file import where by get set abstract enum open inner override private public internal protected catch finally out final vararg reified dynamic companion constructor init sealed field property receiver param sparam lateinit data inline noinline tailrec external annotation crossinline const operator infix"),types:words("Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),intendSwitch:!1,indentStatements:!1,multiLineStrings:!0,blockKeywords:words("catch class do else finally for if where try while enum"),defKeywords:words("class val var object package interface fun"),atoms:words("true false null this"),hooks:{'"':function(stream,state){return state.tokenize=tokenKotlinString(stream.match('""')),state.tokenize(stream,state)}},modeProps:{closeBrackets:{triples:'"'}}}),def(["x-shader/x-vertex","x-shader/x-fragment"],{name:"clike",keywords:words("sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow const attribute uniform varying break continue discard return for while do if else struct in out inout"),types:words("float int bool void vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 mat2 mat3 mat4"),blockKeywords:words("for while do if else struct"),builtin:words("radians degrees sin cos tan asin acos atan pow exp log exp2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize ftransform faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not texture1D texture1DProj texture1DLod texture1DProjLod texture2D texture2DProj texture2DLod texture2DProjLod texture3D texture3DProj texture3DLod texture3DProjLod textureCube textureCubeLod shadow1D shadow2D shadow1DProj shadow2DProj shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod dFdx dFdy fwidth noise1 noise2 noise3 noise4"),atoms:words("true false gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_FogCoord gl_PointCoord gl_Position gl_PointSize gl_ClipVertex gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord gl_FragCoord gl_FrontFacing gl_FragData gl_FragDepth gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse gl_TexureMatrixTranspose gl_ModelViewMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixInverseTranspose gl_TextureMatrixInverseTranspose gl_NormalScale gl_DepthRange gl_ClipPlane gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel gl_FrontLightModelProduct gl_BackLightModelProduct gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ gl_FogParameters gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits gl_MaxDrawBuffers"),indentSwitch:!1,hooks:{"#":cppHook},modeProps:{fold:["brace","include"]}}),def("text/x-nesc",{name:"clike",keywords:words(cKeywords+"as atomic async call command component components configuration event generic implementation includes interface module new norace nx_struct nx_union post provides signal task uses abstract extends"),types:words(cTypes),blockKeywords:words("case do else for if switch while struct"),atoms:words("null true false"),hooks:{"#":cppHook},modeProps:{fold:["brace","include"]}}),def("text/x-objectivec",{name:"clike",keywords:words(cKeywords+"inline restrict _Bool _Complex _Imaginery BOOL Class bycopy byref id IMP in inout nil oneway out Protocol SEL self super atomic nonatomic retain copy readwrite readonly"),types:words(cTypes),atoms:words("YES NO NULL NILL ON OFF true false"),hooks:{"@":function(stream){return stream.eatWhile(/[\w\$]/),"keyword"},"#":cppHook,indent:function(_state,ctx,textAfter){return"statement"==ctx.type&&/^@\w/.test(textAfter)?ctx.indented:void 0}},modeProps:{fold:"brace"}}),def("text/x-squirrel",{name:"clike",keywords:words("base break clone continue const default delete enum extends function in class foreach local resume return this throw typeof yield constructor instanceof static"),types:words(cTypes),blockKeywords:words("case catch class else for foreach if switch try while"),defKeywords:words("function local class"),typeFirstDefinitions:!0,atoms:words("true false null"),hooks:{"#":cppHook},modeProps:{fold:["brace","include"]}});var stringTokenizer=null;def("text/x-ceylon",{name:"clike",keywords:words("abstracts alias assembly assert assign break case catch class continue dynamic else exists extends finally for function given if import in interface is let module new nonempty object of out outer package return satisfies super switch then this throw try value void while"),types:function(word){var first=word.charAt(0);return first===first.toUpperCase()&&first!==first.toLowerCase()},blockKeywords:words("case catch class dynamic else finally for function if interface module new object switch try while"),defKeywords:words("class dynamic function interface module object package value"),builtin:words("abstract actual aliased annotation by default deprecated doc final formal late license native optional sealed see serializable shared suppressWarnings tagged throws variable"),isPunctuationChar:/[\[\]{}\(\),;\:\.`]/,isOperatorChar:/[+\-*&%=<>!?|^~:\/]/,numberStart:/[\d#$]/,number:/^(?:#[\da-fA-F_]+|\$[01_]+|[\d_]+[kMGTPmunpf]?|[\d_]+\.[\d_]+(?:[eE][-+]?\d+|[kMGTPmunpf]|)|)/i,multiLineStrings:!0,typeFirstDefinitions:!0,atoms:words("true false null larger smaller equal empty finished"),indentSwitch:!1,styleDefs:!1,hooks:{"@":function(stream){return stream.eatWhile(/[\w\$_]/),"meta"},'"':function(stream,state){return state.tokenize=tokenCeylonString(stream.match('""')?"triple":"single"),state.tokenize(stream,state)},"`":function(stream,state){return stringTokenizer&&stream.match("`")?(state.tokenize=stringTokenizer,stringTokenizer=null,state.tokenize(stream,state)):!1},"'":function(stream){return stream.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},token:function(_stream,state,style){return"variable"!=style&&"variable-3"!=style||"."!=state.prevToken?void 0:"variable-2"}},modeProps:{fold:["brace","import"],closeBrackets:{triples:'"'}}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("../../addon/mode/simple"),require("../../addon/mode/multiplex")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../../addon/mode/simple","../../addon/mode/multiplex"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.defineSimpleMode("handlebars-tags",{start:[{regex:/\{\{!--/,push:"dash_comment",token:"comment"},{regex:/\{\{!/,push:"comment",token:"comment"},{regex:/\{\{/,push:"handlebars",token:"tag"}],handlebars:[{regex:/\}\}/,pop:!0,token:"tag"},{regex:/"(?:[^\\"]|\\.)*"?/,token:"string"},{regex:/'(?:[^\\']|\\.)*'?/,token:"string"},{regex:/>|[#\/]([A-Za-z_]\w*)/,token:"keyword"},{regex:/(?:else|this)\b/,token:"keyword"},{regex:/\d+/i,token:"number"},{regex:/=|~|@|true|false/,token:"atom"},{regex:/(?:\.\.\/)*(?:[A-Za-z_][\w\.]*)+/,token:"variable-2"}],dash_comment:[{regex:/--\}\}/,pop:!0,token:"comment"},{regex:/./,token:"comment"}],comment:[{regex:/\}\}/,pop:!0,token:"comment"},{regex:/./,token:"comment"}]}),CodeMirror.defineMode("handlebars",function(config,parserConfig){var handlebars=CodeMirror.getMode(config,"handlebars-tags");return parserConfig&&parserConfig.base?CodeMirror.multiplexingMode(CodeMirror.getMode(config,parserConfig.base),{open:"{{",close:"}}",mode:handlebars,parseDelimiters:!0}):handlebars}),CodeMirror.defineMIME("text/x-handlebars-template","handlebars")}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function Context(state,mode,depth,prev){this.state=state,this.mode=mode,this.depth=depth,this.prev=prev}function copyContext(context){return new Context(CodeMirror.copyState(context.mode,context.state),context.mode,context.depth,context.prev&&copyContext(context.prev))}CodeMirror.defineMode("jsx",function(config){function flatXMLIndent(state){var tagName=state.tagName;state.tagName=null;var result=xmlMode.indent(state,"");return state.tagName=tagName,result}function token(stream,state){return state.context.mode==xmlMode?xmlToken(stream,state,state.context):jsToken(stream,state,state.context)}function xmlToken(stream,state,cx){if(2==cx.depth)return stream.match(/^.*?\*\//)?cx.depth=1:stream.skipToEnd(),"comment";if("{"==stream.peek()){xmlMode.skipAttribute(cx.state);var indent=flatXMLIndent(cx.state),xmlContext=cx.state.context;if(xmlContext&&stream.match(/^[^>]*>\s*$/,!1)){for(;xmlContext.prev&&!xmlContext.startOfLine;)xmlContext=xmlContext.prev;xmlContext.startOfLine?indent-=config.indentUnit:cx.prev.state.lexical&&(indent=cx.prev.state.lexical.indented)}else 1==cx.depth&&(indent+=config.indentUnit);return state.context=new Context(CodeMirror.startState(jsMode,indent),jsMode,0,state.context),null}if(1==cx.depth){if("<"==stream.peek())return xmlMode.skipAttribute(cx.state),state.context=new Context(CodeMirror.startState(xmlMode,flatXMLIndent(cx.state)),xmlMode,0,state.context),null;if(stream.match("//"))return stream.skipToEnd(),"comment";if(stream.match("/*"))return cx.depth=2,token(stream,state)}var stop,style=xmlMode.token(stream,cx.state),cur=stream.current();return/\btag\b/.test(style)?/>$/.test(cur)?cx.state.context?cx.depth=0:state.context=state.context.prev:/^</.test(cur)&&(cx.depth=1):!style&&(stop=cur.indexOf("{"))>-1&&stream.backUp(cur.length-stop),style}function jsToken(stream,state,cx){if("<"==stream.peek()&&jsMode.expressionAllowed(stream,cx.state))return jsMode.skipExpression(cx.state),state.context=new Context(CodeMirror.startState(xmlMode,jsMode.indent(cx.state,"")),xmlMode,0,state.context),null;var style=jsMode.token(stream,cx.state);if(!style&&null!=cx.depth){var cur=stream.current();"{"==cur?cx.depth++:"}"==cur&&0==--cx.depth&&(state.context=state.context.prev)}return style}var xmlMode=CodeMirror.getMode(config,{name:"xml",allowMissing:!0,multilineTagIndentPastTag:!1}),jsMode=CodeMirror.getMode(config,"javascript");return{startState:function(){return{context:new Context(CodeMirror.startState(jsMode),jsMode)}},copyState:function(state){return{context:copyContext(state.context)}},token:token,indent:function(state,textAfter,fullLine){return state.context.mode.indent(state.context.state,textAfter,fullLine)},innerMode:function(state){return state.context}}},"xml","javascript"),CodeMirror.defineMIME("text/jsx","jsx")}),function(){$(function(){var atoms,convertToWords,keywords,tokenString;return keywords="@property @interface UIApplication self unichar IMP Class @selector class protocol @implementation @end auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned void super NSInteger NSArray NSArrayM NSDictionary NSLog NSMutableArray NSNumber NSString NSRange Cake NSObject NSUInteger @selector UIViewController UIImageView UIViewContentModeScaleAspectFit UIImage UINavigationController UITableViewCell UITableView NSIndexPath UITableViewCellStyleDefault UIWindow UILabel CGRectMake UITabBarController UIStatusBarStyle UIFont UIFontDescriptor UIFontDescriptorFamilyAttribute UIButton NSURLSessionConfiguration CLLocationCoordinate2DMake MKPlacemark MKMapItem NSHTTPURLResponse NSURLRequest CLLocationCoordinate2D CLGeocoder NSError CLPlacemark CLLocation GMSCameraPosition GMSMapView GMSMarker GMSMutablePath UIColor GMSPolygon GMSPanoramaService GMSPanoramaView GMSPanorama",atoms="true false TRUE FALSE YES NO NULL Nil nil BOOL SEL id IBOutlet IBAction weak strong #import atomic nonatomic alloc init setContentMode initWithImage addSubview initWithRootViewController dequeueReusableCellWithIdentifier initWithStyle cellForRowAtIndexPath setViewControllers fontDescriptorWithFontAttributes",convertToWords=function(str){var obj,word,words,_i,_len;for(obj={},words=str.split(" "),_i=0,_len=words.length;_len>_i;_i++)word=words[_i],obj[word]=!0;return obj},tokenString=function(quote){return function(stream,state){var end,escaped,multiLineStrings,next;for(multiLineStrings=!1,escaped=!1,next=void 0,end=!1;null!==(next=stream.next());){if(next===quote&&!escaped){end=!0;break}escaped=!escaped&&"\\"===next}return(end||!escaped&&!multiLineStrings)&&(state.tokenize=null),"string"}},CodeMirror.defineMIME("objc",{name:"clike",blockKeywords:convertToWords("@interface @implementation @end"),useCPP:!0,atoms:convertToWords(atoms),keywords:convertToWords(keywords),hooks:{"#":function(stream,state){return state.startOfLine?(stream.skipToEnd(),"meta"):!1},"@":function(stream,state){return stream.eat('"')?(state.tokenize=tokenString('"'),state.tokenize(stream,state)):(stream.eatWhile(/[\w\$_]/),"keyword")}}})})}.call(this),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.runMode=function(string,modespec,callback,options){var mode=CodeMirror.getMode(CodeMirror.defaults,modespec),ie=/MSIE \d/.test(navigator.userAgent),ie_lt9=ie&&(null==document.documentMode||document.documentMode<9);if(callback.appendChild){var tabSize=options&&options.tabSize||CodeMirror.defaults.tabSize,node=callback,col=0;node.innerHTML="",callback=function(text,style){if("\n"==text)return node.appendChild(document.createTextNode(ie_lt9?"\r":text)),col=0,void 0;for(var content="",pos=0;;){var idx=text.indexOf("	",pos);if(-1==idx){content+=text.slice(pos),col+=text.length-pos;break}col+=idx-pos,content+=text.slice(pos,idx);var size=tabSize-col%tabSize;col+=size;for(var i=0;size>i;++i)content+=" ";pos=idx+1}if(style){var sp=node.appendChild(document.createElement("span"));sp.className="cm-"+style.replace(/ +/g," cm-"),sp.appendChild(document.createTextNode(content))}else node.appendChild(document.createTextNode(content))}}for(var lines=CodeMirror.splitLines(string),state=options&&options.state||CodeMirror.startState(mode),i=0,e=lines.length;e>i;++i){i&&callback("\n");var stream=new CodeMirror.StringStream(lines[i]);for(!stream.string&&mode.blankLine&&mode.blankLine(state);!stream.eol();){var style=mode.token(stream,state);callback(stream.current(),style,i,stream.start,state),stream.start=stream.pos}}}}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function doFold(cm,pos,options,force){function getRange(allowFolded){var range=finder(cm,pos);if(!range||range.to.line-range.from.line<minSize)return null;for(var marks=cm.findMarksAt(range.from),i=0;i<marks.length;++i)if(marks[i].__isFold&&"fold"!==force){if(!allowFolded)return null;range.cleared=!0,marks[i].clear()}return range}if(options&&options.call){var finder=options;options=null}else var finder=getOption(cm,options,"rangeFinder");"number"==typeof pos&&(pos=CodeMirror.Pos(pos,0));var minSize=getOption(cm,options,"minFoldSize"),range=getRange(!0);if(getOption(cm,options,"scanUp"))for(;!range&&pos.line>cm.firstLine();)pos=CodeMirror.Pos(pos.line-1,0),range=getRange(!1);if(range&&!range.cleared&&"unfold"!==force){var myWidget=makeWidget(cm,options);CodeMirror.on(myWidget,"mousedown",function(e){myRange.clear(),CodeMirror.e_preventDefault(e)});var myRange=cm.markText(range.from,range.to,{replacedWith:myWidget,clearOnEnter:!0,__isFold:!0});myRange.on("clear",function(from,to){CodeMirror.signal(cm,"unfold",cm,from,to)}),CodeMirror.signal(cm,"fold",cm,range.from,range.to)}}function makeWidget(cm,options){var widget=getOption(cm,options,"widget");if("string"==typeof widget){var text=document.createTextNode(widget);widget=document.createElement("span"),widget.appendChild(text),widget.className="CodeMirror-foldmarker"}return widget}function getOption(cm,options,name){if(options&&void 0!==options[name])return options[name];var editorOptions=cm.options.foldOptions;return editorOptions&&void 0!==editorOptions[name]?editorOptions[name]:defaultOptions[name]}CodeMirror.newFoldFunction=function(rangeFinder,widget){return function(cm,pos){doFold(cm,pos,{rangeFinder:rangeFinder,widget:widget})}},CodeMirror.defineExtension("foldCode",function(pos,options,force){doFold(this,pos,options,force)}),CodeMirror.defineExtension("isFolded",function(pos){for(var marks=this.findMarksAt(pos),i=0;i<marks.length;++i)if(marks[i].__isFold)return!0}),CodeMirror.commands.toggleFold=function(cm){cm.foldCode(cm.getCursor())},CodeMirror.commands.fold=function(cm){cm.foldCode(cm.getCursor(),null,"fold")},CodeMirror.commands.unfold=function(cm){cm.foldCode(cm.getCursor(),null,"unfold")},CodeMirror.commands.foldAll=function(cm){cm.operation(function(){for(var i=cm.firstLine(),e=cm.lastLine();e>=i;i++)cm.foldCode(CodeMirror.Pos(i,0),null,"fold")})},CodeMirror.commands.unfoldAll=function(cm){cm.operation(function(){for(var i=cm.firstLine(),e=cm.lastLine();e>=i;i++)cm.foldCode(CodeMirror.Pos(i,0),null,"unfold")})},CodeMirror.registerHelper("fold","combine",function(){var funcs=Array.prototype.slice.call(arguments,0);return function(cm,start){for(var i=0;i<funcs.length;++i){var found=funcs[i](cm,start);if(found)return found}}}),CodeMirror.registerHelper("fold","auto",function(cm,start){for(var helpers=cm.getHelpers(start,"fold"),i=0;i<helpers.length;i++){var cur=helpers[i](cm,start);if(cur)return cur}});var defaultOptions={rangeFinder:CodeMirror.fold.auto,widget:"",minFoldSize:0,scanUp:!1};CodeMirror.defineOption("foldOptions",null),CodeMirror.defineExtension("foldOption",function(options,name){return getOption(this,options,name)})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function State(options){this.options=options,this.from=this.to=0}function parseOptions(opts){return opts===!0&&(opts={}),null==opts.gutter&&(opts.gutter="CodeMirror-foldgutter"),null==opts.indicatorOpen&&(opts.indicatorOpen="CodeMirror-foldgutter-open"),null==opts.indicatorFolded&&(opts.indicatorFolded="CodeMirror-foldgutter-folded"),opts}function isFolded(cm,line){for(var marks=cm.findMarksAt(Pos(line)),i=0;i<marks.length;++i)if(marks[i].__isFold&&marks[i].find().from.line==line)return marks[i]}function marker(spec){if("string"==typeof spec){var elt=document.createElement("div");return elt.className=spec+" CodeMirror-guttermarker-subtle",elt}return spec.cloneNode(!0)}function updateFoldInfo(cm,from,to){var opts=cm.state.foldGutter.options,cur=from,minSize=cm.foldOption(opts,"minFoldSize"),func=cm.foldOption(opts,"rangeFinder");cm.eachLine(from,to,function(line){var mark=null;if(isFolded(cm,cur))mark=marker(opts.indicatorFolded);else{var pos=Pos(cur,0),range=func&&func(cm,pos);range&&range.to.line-range.from.line>=minSize&&(mark=marker(opts.indicatorOpen))}cm.setGutterMarker(line,opts.gutter,mark),++cur})}function updateInViewport(cm){var vp=cm.getViewport(),state=cm.state.foldGutter;state&&(cm.operation(function(){updateFoldInfo(cm,vp.from,vp.to)}),state.from=vp.from,state.to=vp.to)}function onGutterClick(cm,line,gutter){var state=cm.state.foldGutter;if(state){var opts=state.options;if(gutter==opts.gutter){var folded=isFolded(cm,line);folded?folded.clear():cm.foldCode(Pos(line,0),opts.rangeFinder)}}}function onChange(cm){var state=cm.state.foldGutter;if(state){var opts=state.options;state.from=state.to=0,clearTimeout(state.changeUpdate),state.changeUpdate=setTimeout(function(){updateInViewport(cm)},opts.foldOnChangeTimeSpan||600)}}function onViewportChange(cm){var state=cm.state.foldGutter;if(state){var opts=state.options;clearTimeout(state.changeUpdate),state.changeUpdate=setTimeout(function(){var vp=cm.getViewport();state.from==state.to||vp.from-state.to>20||state.from-vp.to>20?updateInViewport(cm):cm.operation(function(){vp.from<state.from&&(updateFoldInfo(cm,vp.from,state.from),state.from=vp.from),vp.to>state.to&&(updateFoldInfo(cm,state.to,vp.to),state.to=vp.to)})},opts.updateViewportTimeSpan||400)}}function onFold(cm,from){var state=cm.state.foldGutter;if(state){var line=from.line;line>=state.from&&line<state.to&&updateFoldInfo(cm,line,line+1)}}CodeMirror.defineOption("foldGutter",!1,function(cm,val,old){old&&old!=CodeMirror.Init&&(cm.clearGutter(cm.state.foldGutter.options.gutter),cm.state.foldGutter=null,cm.off("gutterClick",onGutterClick),cm.off("change",onChange),cm.off("viewportChange",onViewportChange),cm.off("fold",onFold),cm.off("unfold",onFold),cm.off("swapDoc",onChange)),val&&(cm.state.foldGutter=new State(parseOptions(val)),updateInViewport(cm),cm.on("gutterClick",onGutterClick),cm.on("change",onChange),cm.on("viewportChange",onViewportChange),cm.on("fold",onFold),cm.on("unfold",onFold),cm.on("swapDoc",onChange))});var Pos=CodeMirror.Pos}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.registerHelper("fold","brace",function(cm,start){function findOpening(openCh){for(var at=start.ch,pass=0;;){var found=0>=at?-1:lineText.lastIndexOf(openCh,at-1);if(-1!=found){if(1==pass&&found<start.ch)break;if(tokenType=cm.getTokenTypeAt(CodeMirror.Pos(line,found+1)),!/^(comment|string)/.test(tokenType))return found+1;at=found-1}else{if(1==pass)break;pass=1,at=lineText.length}}}var startCh,tokenType,line=start.line,lineText=cm.getLine(line),startToken="{",endToken="}",startCh=findOpening("{");if(null==startCh&&(startToken="[",endToken="]",startCh=findOpening("[")),null!=startCh){var end,endCh,count=1,lastLine=cm.lastLine();outer:for(var i=line;lastLine>=i;++i)for(var text=cm.getLine(i),pos=i==line?startCh:0;;){var nextOpen=text.indexOf(startToken,pos),nextClose=text.indexOf(endToken,pos);if(0>nextOpen&&(nextOpen=text.length),0>nextClose&&(nextClose=text.length),pos=Math.min(nextOpen,nextClose),pos==text.length)break;if(cm.getTokenTypeAt(CodeMirror.Pos(i,pos+1))==tokenType)if(pos==nextOpen)++count;else if(!--count){end=i,endCh=pos;break outer}++pos}if(null!=end&&(line!=end||endCh!=startCh))return{from:CodeMirror.Pos(line,startCh),to:CodeMirror.Pos(end,endCh)}}}),CodeMirror.registerHelper("fold","import",function(cm,start){function hasImport(line){if(line<cm.firstLine()||line>cm.lastLine())return null;var start=cm.getTokenAt(CodeMirror.Pos(line,1));if(/\S/.test(start.string)||(start=cm.getTokenAt(CodeMirror.Pos(line,start.end+1))),"keyword"!=start.type||"import"!=start.string)return null;for(var i=line,e=Math.min(cm.lastLine(),line+10);e>=i;++i){var text=cm.getLine(i),semi=text.indexOf(";");if(-1!=semi)return{startCh:start.end,end:CodeMirror.Pos(i,semi)}}}var prev,start=start.line,has=hasImport(start);if(!has||hasImport(start-1)||(prev=hasImport(start-2))&&prev.end.line==start-1)return null;for(var end=has.end;;){var next=hasImport(end.line+1);if(null==next)break;end=next.end}return{from:cm.clipPos(CodeMirror.Pos(start,has.startCh+1)),to:end}}),CodeMirror.registerHelper("fold","include",function(cm,start){function hasInclude(line){if(line<cm.firstLine()||line>cm.lastLine())return null;var start=cm.getTokenAt(CodeMirror.Pos(line,1));return/\S/.test(start.string)||(start=cm.getTokenAt(CodeMirror.Pos(line,start.end+1))),"meta"==start.type&&"#include"==start.string.slice(0,8)?start.start+8:void 0}var start=start.line,has=hasInclude(start);if(null==has||null!=hasInclude(start-1))return null;for(var end=start;;){var next=hasInclude(end+1);if(null==next)break;++end}return{from:CodeMirror.Pos(start,has+1),to:cm.clipPos(CodeMirror.Pos(end))}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.registerGlobalHelper("fold","comment",function(mode){return mode.blockCommentStart&&mode.blockCommentEnd},function(cm,start){var mode=cm.getModeAt(start),startToken=mode.blockCommentStart,endToken=mode.blockCommentEnd;if(startToken&&endToken){for(var startCh,line=start.line,lineText=cm.getLine(line),at=start.ch,pass=0;;){var found=0>=at?-1:lineText.lastIndexOf(startToken,at-1);if(-1!=found){if(1==pass&&found<start.ch)return;if(/comment/.test(cm.getTokenTypeAt(CodeMirror.Pos(line,found+1)))&&(lineText.slice(found-endToken.length,found)==endToken||!/comment/.test(cm.getTokenTypeAt(CodeMirror.Pos(line,found))))){startCh=found+startToken.length;break}at=found-1}else{if(1==pass)return;pass=1,at=lineText.length}}var end,endCh,depth=1,lastLine=cm.lastLine();outer:for(var i=line;lastLine>=i;++i)for(var text=cm.getLine(i),pos=i==line?startCh:0;;){var nextOpen=text.indexOf(startToken,pos),nextClose=text.indexOf(endToken,pos);if(0>nextOpen&&(nextOpen=text.length),0>nextClose&&(nextClose=text.length),pos=Math.min(nextOpen,nextClose),pos==text.length)break;if(pos==nextOpen)++depth;else if(!--depth){end=i,endCh=pos;break outer}++pos}if(null!=end&&(line!=end||endCh!=startCh))return{from:CodeMirror.Pos(line,startCh),to:CodeMirror.Pos(end,endCh)}}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.registerHelper("fold","indent",function(cm,start){var tabSize=cm.getOption("tabSize"),firstLine=cm.getLine(start.line);if(/\S/.test(firstLine)){for(var getIndent=function(line){return CodeMirror.countColumn(line,null,tabSize)},myIndent=getIndent(firstLine),lastLineInFold=null,i=start.line+1,end=cm.lastLine();end>=i;++i){var curLine=cm.getLine(i),curIndent=getIndent(curLine);if(curIndent>myIndent)lastLineInFold=i;else if(/\S/.test(curLine))break}return lastLineInFold?{from:CodeMirror.Pos(start.line,firstLine.length),to:CodeMirror.Pos(lastLineInFold,cm.getLine(lastLineInFold).length)}:void 0}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.registerHelper("fold","markdown",function(cm,start){function isHeader(lineNo){var tokentype=cm.getTokenTypeAt(CodeMirror.Pos(lineNo,0));return tokentype&&/\bheader\b/.test(tokentype)}function headerLevel(lineNo,line,nextLine){var match=line&&line.match(/^#+/);return match&&isHeader(lineNo)?match[0].length:(match=nextLine&&nextLine.match(/^[=\-]+\s*$/),match&&isHeader(lineNo+1)?"="==nextLine[0]?1:2:maxDepth)}var maxDepth=100,firstLine=cm.getLine(start.line),nextLine=cm.getLine(start.line+1),level=headerLevel(start.line,firstLine,nextLine);if(level===maxDepth)return void 0;for(var lastLineNo=cm.lastLine(),end=start.line,nextNextLine=cm.getLine(end+2);lastLineNo>end&&!(headerLevel(end+1,nextLine,nextNextLine)<=level);)++end,nextLine=nextNextLine,nextNextLine=cm.getLine(end+2);return{from:CodeMirror.Pos(start.line,firstLine.length),to:CodeMirror.Pos(end,cm.getLine(end).length)}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function cmp(a,b){return a.line-b.line||a.ch-b.ch}function Iter(cm,line,ch,range){this.line=line,this.ch=ch,this.cm=cm,this.text=cm.getLine(line),this.min=range?range.from:cm.firstLine(),this.max=range?range.to-1:cm.lastLine()}function tagAt(iter,ch){var type=iter.cm.getTokenTypeAt(Pos(iter.line,ch));return type&&/\btag\b/.test(type)}function nextLine(iter){return iter.line>=iter.max?void 0:(iter.ch=0,iter.text=iter.cm.getLine(++iter.line),!0)}function prevLine(iter){return iter.line<=iter.min?void 0:(iter.text=iter.cm.getLine(--iter.line),iter.ch=iter.text.length,!0)}function toTagEnd(iter){for(;;){var gt=iter.text.indexOf(">",iter.ch);if(-1==gt){if(nextLine(iter))continue;return}{if(tagAt(iter,gt+1)){var lastSlash=iter.text.lastIndexOf("/",gt),selfClose=lastSlash>-1&&!/\S/.test(iter.text.slice(lastSlash+1,gt));return iter.ch=gt+1,selfClose?"selfClose":"regular"}iter.ch=gt+1}}}function toTagStart(iter){for(;;){var lt=iter.ch?iter.text.lastIndexOf("<",iter.ch-1):-1;if(-1==lt){if(prevLine(iter))continue;return}if(tagAt(iter,lt+1)){xmlTagStart.lastIndex=lt,iter.ch=lt;var match=xmlTagStart.exec(iter.text);if(match&&match.index==lt)return match}else iter.ch=lt}}function toNextTag(iter){for(;;){xmlTagStart.lastIndex=iter.ch;var found=xmlTagStart.exec(iter.text);if(!found){if(nextLine(iter))continue;return}{if(tagAt(iter,found.index+1))return iter.ch=found.index+found[0].length,found;iter.ch=found.index+1}}}function toPrevTag(iter){for(;;){var gt=iter.ch?iter.text.lastIndexOf(">",iter.ch-1):-1;if(-1==gt){if(prevLine(iter))continue;return}{if(tagAt(iter,gt+1)){var lastSlash=iter.text.lastIndexOf("/",gt),selfClose=lastSlash>-1&&!/\S/.test(iter.text.slice(lastSlash+1,gt));return iter.ch=gt+1,selfClose?"selfClose":"regular"}iter.ch=gt}}}function findMatchingClose(iter,tag){for(var stack=[];;){var end,next=toNextTag(iter),startLine=iter.line,startCh=iter.ch-(next?next[0].length:0);if(!next||!(end=toTagEnd(iter)))return;if("selfClose"!=end)if(next[1]){for(var i=stack.length-1;i>=0;--i)if(stack[i]==next[2]){stack.length=i;break}if(0>i&&(!tag||tag==next[2]))return{tag:next[2],from:Pos(startLine,startCh),to:Pos(iter.line,iter.ch)}}else stack.push(next[2])}}function findMatchingOpen(iter,tag){for(var stack=[];;){var prev=toPrevTag(iter);if(!prev)return;if("selfClose"!=prev){var endLine=iter.line,endCh=iter.ch,start=toTagStart(iter);if(!start)return;if(start[1])stack.push(start[2]);else{for(var i=stack.length-1;i>=0;--i)if(stack[i]==start[2]){stack.length=i;break}if(0>i&&(!tag||tag==start[2]))return{tag:start[2],from:Pos(iter.line,iter.ch),to:Pos(endLine,endCh)}}}else toTagStart(iter)}}var Pos=CodeMirror.Pos,nameStartChar="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",nameChar=nameStartChar+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",xmlTagStart=new RegExp("<(/?)(["+nameStartChar+"]["+nameChar+"]*)","g");CodeMirror.registerHelper("fold","xml",function(cm,start){for(var iter=new Iter(cm,start.line,0);;){var end,openTag=toNextTag(iter);if(!openTag||iter.line!=start.line||!(end=toTagEnd(iter)))return;if(!openTag[1]&&"selfClose"!=end){var start=Pos(iter.line,iter.ch),close=findMatchingClose(iter,openTag[2]);return close&&{from:start,to:close.from}}}}),CodeMirror.findMatchingTag=function(cm,pos,range){var iter=new Iter(cm,pos.line,pos.ch,range);if(-1!=iter.text.indexOf(">")||-1!=iter.text.indexOf("<")){var end=toTagEnd(iter),to=end&&Pos(iter.line,iter.ch),start=end&&toTagStart(iter);if(end&&start&&!(cmp(iter,pos)>0)){var here={from:Pos(iter.line,iter.ch),to:to,tag:start[2]};return"selfClose"==end?{open:here,close:null,at:"open"}:start[1]?{open:findMatchingOpen(iter,start[2]),close:here,at:"close"}:(iter=new Iter(cm,to.line,to.ch,range),{open:here,close:findMatchingClose(iter,start[2]),at:"open"})}}},CodeMirror.findEnclosingTag=function(cm,pos,range){for(var iter=new Iter(cm,pos.line,pos.ch,range);;){var open=findMatchingOpen(iter);if(!open)break;var forward=new Iter(cm,pos.line,pos.ch,range),close=findMatchingClose(forward,open.tag);if(close)return{open:open,close:close}}},CodeMirror.scanForClosingTag=function(cm,pos,name,end){var iter=new Iter(cm,pos.line,pos.ch,end?{from:0,to:end}:null);return findMatchingClose(iter,name)}}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function SearchCursor(doc,query,pos,caseFold){if(this.atOccurrence=!1,this.doc=doc,null==caseFold&&"string"==typeof query&&(caseFold=!1),pos=pos?doc.clipPos(pos):Pos(0,0),this.pos={from:pos,to:pos},"string"!=typeof query)query.global||(query=new RegExp(query.source,query.ignoreCase?"ig":"g")),this.matches=function(reverse,pos){if(reverse){query.lastIndex=0;for(var match,start,line=doc.getLine(pos.line).slice(0,pos.ch),cutOff=0;;){query.lastIndex=cutOff;var newMatch=query.exec(line);if(!newMatch)break;if(match=newMatch,start=match.index,cutOff=match.index+(match[0].length||1),cutOff==line.length)break}var matchLen=match&&match[0].length||0;matchLen||(0==start&&0==line.length?match=void 0:start!=doc.getLine(pos.line).length&&matchLen++)}else{query.lastIndex=pos.ch;var line=doc.getLine(pos.line),match=query.exec(line),matchLen=match&&match[0].length||0,start=match&&match.index;start+matchLen==line.length||matchLen||(matchLen=1)}return match&&matchLen?{from:Pos(pos.line,start),to:Pos(pos.line,start+matchLen),match:match}:void 0};else{var origQuery=query;caseFold&&(query=query.toLowerCase());var fold=caseFold?function(str){return str.toLowerCase()}:function(str){return str},target=query.split("\n");if(1==target.length)this.matches=query.length?function(reverse,pos){if(reverse){var orig=doc.getLine(pos.line).slice(0,pos.ch),line=fold(orig),match=line.lastIndexOf(query);if(match>-1)return match=adjustPos(orig,line,match),{from:Pos(pos.line,match),to:Pos(pos.line,match+origQuery.length)}}else{var orig=doc.getLine(pos.line).slice(pos.ch),line=fold(orig),match=line.indexOf(query);if(match>-1)return match=adjustPos(orig,line,match)+pos.ch,{from:Pos(pos.line,match),to:Pos(pos.line,match+origQuery.length)}}}:function(){};else{var origTarget=origQuery.split("\n");this.matches=function(reverse,pos){var last=target.length-1;if(reverse){if(pos.line-(target.length-1)<doc.firstLine())return;if(fold(doc.getLine(pos.line).slice(0,origTarget[last].length))!=target[target.length-1])return;for(var to=Pos(pos.line,origTarget[last].length),ln=pos.line-1,i=last-1;i>=1;--i,--ln)if(target[i]!=fold(doc.getLine(ln)))return;var line=doc.getLine(ln),cut=line.length-origTarget[0].length;if(fold(line.slice(cut))!=target[0])return;return{from:Pos(ln,cut),to:to}}if(!(pos.line+(target.length-1)>doc.lastLine())){var line=doc.getLine(pos.line),cut=line.length-origTarget[0].length;if(fold(line.slice(cut))==target[0]){for(var from=Pos(pos.line,cut),ln=pos.line+1,i=1;last>i;++i,++ln)if(target[i]!=fold(doc.getLine(ln)))return;if(fold(doc.getLine(ln).slice(0,origTarget[last].length))==target[last])return{from:from,to:Pos(ln,origTarget[last].length)}}}}}}}function adjustPos(orig,folded,pos){if(orig.length==folded.length)return pos;for(var pos1=Math.min(pos,orig.length);;){var len1=orig.slice(0,pos1).toLowerCase().length;if(pos>len1)++pos1;else{if(!(len1>pos))return pos1;--pos1}}}var Pos=CodeMirror.Pos;SearchCursor.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(reverse){function savePosAndFail(line){var pos=Pos(line,0);return self.pos={from:pos,to:pos},self.atOccurrence=!1,!1}for(var self=this,pos=this.doc.clipPos(reverse?this.pos.from:this.pos.to);;){if(this.pos=this.matches(reverse,pos))return this.atOccurrence=!0,this.pos.match||!0;if(reverse){if(!pos.line)return savePosAndFail(0);pos=Pos(pos.line-1,this.doc.getLine(pos.line-1).length)}else{var maxLine=this.doc.lineCount();if(pos.line==maxLine-1)return savePosAndFail(maxLine);pos=Pos(pos.line+1,0)}}},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(newText,origin){if(this.atOccurrence){var lines=CodeMirror.splitLines(newText);this.doc.replaceRange(lines,this.pos.from,this.pos.to,origin),this.pos.to=Pos(this.pos.from.line+lines.length-1,lines[lines.length-1].length+(1==lines.length?this.pos.from.ch:0))}}},CodeMirror.defineExtension("getSearchCursor",function(query,pos,caseFold){return new SearchCursor(this.doc,query,pos,caseFold)}),CodeMirror.defineDocExtension("getSearchCursor",function(query,pos,caseFold){return new SearchCursor(this,query,pos,caseFold)}),CodeMirror.defineExtension("selectMatches",function(query,caseFold){for(var ranges=[],cur=this.getSearchCursor(query,this.getCursor("from"),caseFold);cur.findNext()&&!(CodeMirror.cmpPos(cur.to(),this.getCursor("to"))>0);)ranges.push({anchor:cur.from(),head:cur.to()});ranges.length&&this.setSelections(ranges,0)})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){function getOption(conf,name){return"pairs"==name&&"string"==typeof conf?conf:"object"==typeof conf&&null!=conf[name]?conf[name]:defaults[name]}function handler(ch){return function(cm){return handleChar(cm,ch)}}function getConfig(cm){var deflt=cm.state.closeBrackets;if(!deflt)return null;var mode=cm.getModeAt(cm.getCursor());return mode.closeBrackets||deflt}function handleBackspace(cm){var conf=getConfig(cm);if(!conf||cm.getOption("disableInput"))return CodeMirror.Pass;for(var pairs=getOption(conf,"pairs"),ranges=cm.listSelections(),i=0;i<ranges.length;i++){if(!ranges[i].empty())return CodeMirror.Pass;var around=charsAround(cm,ranges[i].head);if(!around||pairs.indexOf(around)%2!=0)return CodeMirror.Pass}for(var i=ranges.length-1;i>=0;i--){var cur=ranges[i].head;cm.replaceRange("",Pos(cur.line,cur.ch-1),Pos(cur.line,cur.ch+1),"+delete")}}function handleEnter(cm){var conf=getConfig(cm),explode=conf&&getOption(conf,"explode");if(!explode||cm.getOption("disableInput"))return CodeMirror.Pass;for(var ranges=cm.listSelections(),i=0;i<ranges.length;i++){if(!ranges[i].empty())return CodeMirror.Pass;var around=charsAround(cm,ranges[i].head);if(!around||explode.indexOf(around)%2!=0)return CodeMirror.Pass}cm.operation(function(){cm.replaceSelection("\n\n",null),cm.execCommand("goCharLeft"),ranges=cm.listSelections();for(var i=0;i<ranges.length;i++){var line=ranges[i].head.line;cm.indentLine(line,null,!0),cm.indentLine(line+1,null,!0)}})}function contractSelection(sel){var inverted=CodeMirror.cmpPos(sel.anchor,sel.head)>0;return{anchor:new Pos(sel.anchor.line,sel.anchor.ch+(inverted?-1:1)),head:new Pos(sel.head.line,sel.head.ch+(inverted?1:-1))}}function handleChar(cm,ch){var conf=getConfig(cm);if(!conf||cm.getOption("disableInput"))return CodeMirror.Pass;var pairs=getOption(conf,"pairs"),pos=pairs.indexOf(ch);if(-1==pos)return CodeMirror.Pass;for(var type,next,triples=getOption(conf,"triples"),identical=pairs.charAt(pos+1)==ch,ranges=cm.listSelections(),opening=pos%2==0,i=0;i<ranges.length;i++){var curType,range=ranges[i],cur=range.head,next=cm.getRange(cur,Pos(cur.line,cur.ch+1));if(opening&&!range.empty())curType="surround";else if(!identical&&opening||next!=ch)if(identical&&cur.ch>1&&triples.indexOf(ch)>=0&&cm.getRange(Pos(cur.line,cur.ch-2),cur)==ch+ch&&(cur.ch<=2||cm.getRange(Pos(cur.line,cur.ch-3),Pos(cur.line,cur.ch-2))!=ch))curType="addFour";else if(identical){if(CodeMirror.isWordChar(next)||!enteringString(cm,cur,ch))return CodeMirror.Pass;curType="both"}else{if(!opening||cm.getLine(cur.line).length!=cur.ch&&!isClosingBracket(next,pairs)&&!/\s/.test(next))return CodeMirror.Pass;curType="both"}else curType=triples.indexOf(ch)>=0&&cm.getRange(cur,Pos(cur.line,cur.ch+3))==ch+ch+ch?"skipThree":"skip";if(type){if(type!=curType)return CodeMirror.Pass}else type=curType}var left=pos%2?pairs.charAt(pos-1):ch,right=pos%2?ch:pairs.charAt(pos+1);cm.operation(function(){if("skip"==type)cm.execCommand("goCharRight");else if("skipThree"==type)for(var i=0;3>i;i++)cm.execCommand("goCharRight");else if("surround"==type){for(var sels=cm.getSelections(),i=0;i<sels.length;i++)sels[i]=left+sels[i]+right;cm.replaceSelections(sels,"around"),sels=cm.listSelections().slice();for(var i=0;i<sels.length;i++)sels[i]=contractSelection(sels[i]);cm.setSelections(sels)}else"both"==type?(cm.replaceSelection(left+right,null),cm.triggerElectric(left+right),cm.execCommand("goCharLeft")):"addFour"==type&&(cm.replaceSelection(left+left+left+left,"before"),cm.execCommand("goCharRight"))})}function isClosingBracket(ch,pairs){var pos=pairs.lastIndexOf(ch);return pos>-1&&pos%2==1}function charsAround(cm,pos){var str=cm.getRange(Pos(pos.line,pos.ch-1),Pos(pos.line,pos.ch+1));return 2==str.length?str:null}function enteringString(cm,pos,ch){var line=cm.getLine(pos.line),token=cm.getTokenAt(pos);if(/\bstring2?\b/.test(token.type))return!1;var stream=new CodeMirror.StringStream(line.slice(0,pos.ch)+ch+line.slice(pos.ch),4);for(stream.pos=stream.start=token.start;;){var type1=cm.getMode().token(stream,token.state);if(stream.pos>=pos.ch+1)return/\bstring2?\b/.test(type1);stream.start=stream.pos}}var defaults={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},Pos=CodeMirror.Pos;CodeMirror.defineOption("autoCloseBrackets",!1,function(cm,val,old){old&&old!=CodeMirror.Init&&(cm.removeKeyMap(keyMap),cm.state.closeBrackets=null),val&&(cm.state.closeBrackets=val,cm.addKeyMap(keyMap))});for(var bind=defaults.pairs+"`",keyMap={Backspace:handleBackspace,Enter:handleEnter},i=0;i<bind.length;i++)keyMap["'"+bind.charAt(i)+"'"]=handler(bind.charAt(i))}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){function findMatchingBracket(cm,where,strict,config){var line=cm.getLineHandle(where.line),pos=where.ch-1,match=pos>=0&&matching[line.text.charAt(pos)]||matching[line.text.charAt(++pos)];if(!match)return null;var dir=">"==match.charAt(1)?1:-1;if(strict&&dir>0!=(pos==where.ch))return null;var style=cm.getTokenTypeAt(Pos(where.line,pos+1)),found=scanForBracket(cm,Pos(where.line,pos+(dir>0?1:0)),dir,style||null,config);return null==found?null:{from:Pos(where.line,pos),to:found&&found.pos,match:found&&found.ch==match.charAt(0),forward:dir>0}}function scanForBracket(cm,where,dir,style,config){for(var maxScanLen=config&&config.maxScanLineLength||1e4,maxScanLines=config&&config.maxScanLines||1e3,stack=[],re=config&&config.bracketRegex?config.bracketRegex:/[(){}[\]]/,lineEnd=dir>0?Math.min(where.line+maxScanLines,cm.lastLine()+1):Math.max(cm.firstLine()-1,where.line-maxScanLines),lineNo=where.line;lineNo!=lineEnd;lineNo+=dir){var line=cm.getLine(lineNo);if(line){var pos=dir>0?0:line.length-1,end=dir>0?line.length:-1;if(!(line.length>maxScanLen))for(lineNo==where.line&&(pos=where.ch-(0>dir?1:0));pos!=end;pos+=dir){var ch=line.charAt(pos);if(re.test(ch)&&(void 0===style||cm.getTokenTypeAt(Pos(lineNo,pos+1))==style)){var match=matching[ch];if(">"==match.charAt(1)==dir>0)stack.push(ch);else{if(!stack.length)return{pos:Pos(lineNo,pos),ch:ch};stack.pop()}}}}}return lineNo-dir==(dir>0?cm.lastLine():cm.firstLine())?!1:null}function matchBrackets(cm,autoclear,config){for(var maxHighlightLen=cm.state.matchBrackets.maxHighlightLineLength||1e3,marks=[],ranges=cm.listSelections(),i=0;i<ranges.length;i++){var match=ranges[i].empty()&&findMatchingBracket(cm,ranges[i].head,!1,config);if(match&&cm.getLine(match.from.line).length<=maxHighlightLen){var style=match.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";marks.push(cm.markText(match.from,Pos(match.from.line,match.from.ch+1),{className:style})),match.to&&cm.getLine(match.to.line).length<=maxHighlightLen&&marks.push(cm.markText(match.to,Pos(match.to.line,match.to.ch+1),{className:style}))}}if(marks.length){ie_lt8&&cm.state.focused&&cm.focus();var clear=function(){cm.operation(function(){for(var i=0;i<marks.length;i++)marks[i].clear()})};if(!autoclear)return clear;setTimeout(clear,800)}}function doMatchBrackets(cm){cm.operation(function(){currentlyHighlighted&&(currentlyHighlighted(),currentlyHighlighted=null),currentlyHighlighted=matchBrackets(cm,!1,cm.state.matchBrackets)})}var ie_lt8=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),Pos=CodeMirror.Pos,matching={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},currentlyHighlighted=null;CodeMirror.defineOption("matchBrackets",!1,function(cm,val,old){old&&old!=CodeMirror.Init&&cm.off("cursorActivity",doMatchBrackets),val&&(cm.state.matchBrackets="object"==typeof val?val:{},cm.on("cursorActivity",doMatchBrackets))}),CodeMirror.defineExtension("matchBrackets",function(){matchBrackets(this,!0)}),CodeMirror.defineExtension("findMatchingBracket",function(pos,strict,config){return findMatchingBracket(this,pos,strict,config)}),CodeMirror.defineExtension("scanForBracket",function(pos,dir,style,config){return scanForBracket(this,pos,dir,style,config)})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function clear(cm){cm.state.tagHit&&cm.state.tagHit.clear(),cm.state.tagOther&&cm.state.tagOther.clear(),cm.state.tagHit=cm.state.tagOther=null}function doMatchTags(cm){cm.state.failedTagMatch=!1,cm.operation(function(){if(clear(cm),!cm.somethingSelected()){var cur=cm.getCursor(),range=cm.getViewport();range.from=Math.min(range.from,cur.line),range.to=Math.max(cur.line+1,range.to);var match=CodeMirror.findMatchingTag(cm,cur,range);if(match){if(cm.state.matchBothTags){var hit="open"==match.at?match.open:match.close;hit&&(cm.state.tagHit=cm.markText(hit.from,hit.to,{className:"CodeMirror-matchingtag"}))}var other="close"==match.at?match.open:match.close;other?cm.state.tagOther=cm.markText(other.from,other.to,{className:"CodeMirror-matchingtag"}):cm.state.failedTagMatch=!0}}})}function maybeUpdateMatch(cm){cm.state.failedTagMatch&&doMatchTags(cm)}CodeMirror.defineOption("matchTags",!1,function(cm,val,old){old&&old!=CodeMirror.Init&&(cm.off("cursorActivity",doMatchTags),cm.off("viewportChange",maybeUpdateMatch),clear(cm)),val&&(cm.state.matchBothTags="object"==typeof val&&val.bothTags,cm.on("cursorActivity",doMatchTags),cm.on("viewportChange",maybeUpdateMatch),doMatchTags(cm))}),CodeMirror.commands.toMatchingTag=function(cm){var found=CodeMirror.findMatchingTag(cm,cm.getCursor());if(found){var other="close"==found.at?found.open:found.close;other&&cm.extendSelection(other.to,other.from)}}}),/*
The MIT License (MIT)

Copyright (c) 2013 Adam Rensel, Code School LLC

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
function(){var Filter,STYLES,defaults,extend,toHexString,_i,_results,__slice=[].slice;STYLES={ef0:"color:#000",ef1:"color:#A00",ef2:"color:#0A0",ef3:"color:#A50",ef4:"color:#00A",ef5:"color:#A0A",ef6:"color:#0AA",ef7:"color:#AAA",ef8:"color:#555",ef9:"color:#F55",ef10:"color:#5F5",ef11:"color:#FF5",ef12:"color:#55F",ef13:"color:#F5F",ef14:"color:#5FF",ef15:"color:#FFF",eb0:"background-color:#000",eb1:"background-color:#A00",eb2:"background-color:#0A0",eb3:"background-color:#A50",eb4:"background-color:#00A",eb5:"background-color:#A0A",eb6:"background-color:#0AA",eb7:"background-color:#AAA",eb8:"background-color:#555",eb9:"background-color:#F55",eb10:"background-color:#5F5",eb11:"background-color:#FF5",eb12:"background-color:#55F",eb13:"background-color:#F5F",eb14:"background-color:#5FF",eb15:"background-color:#FFF"},toHexString=function(num){for(num=num.toString(16);num.length<2;)num="0"+num;return num},[0,1,2,3,4,5].forEach(function(red){return[0,1,2,3,4,5].forEach(function(green){return[0,1,2,3,4,5].forEach(function(blue){var b,c,g,n,r,rgb;return c=16+36*red+6*green+blue,r=red>0?40*red+55:0,g=green>0?40*green+55:0,b=blue>0?40*blue+55:0,rgb=function(){var _i,_len,_ref,_results;for(_ref=[r,g,b],_results=[],_i=0,_len=_ref.length;_len>_i;_i++)n=_ref[_i],_results.push(toHexString(n));return _results}().join(""),STYLES["ef"+c]="color:#"+rgb,STYLES["eb"+c]="background-color:#"+rgb})})}),function(){for(_results=[],_i=0;23>=_i;_i++)_results.push(_i);return _results}.apply(this).forEach(function(gray){var c,l;return c=gray+232,l=toHexString(10*gray+8),STYLES["ef"+c]="color:#"+l+l+l,STYLES["eb"+c]="background-color:#"+l+l+l}),extend=function(){var dest,k,obj,objs,v,_j,_len;for(dest=arguments[0],objs=2<=arguments.length?__slice.call(arguments,1):[],_j=0,_len=objs.length;_len>_j;_j++){obj=objs[_j];for(k in obj)v=obj[k],dest[k]=v}return dest},defaults={fg:"#FFF",bg:"#000"},Filter=function(){function Filter(options){null==options&&(options={}),this.opts=extend({},defaults,options),this.input=[],this.stack=[]}return Filter.prototype.toHtml=function(input){var buf;return this.input="string"==typeof input?[input]:input,buf=[],this.forEach(function(chunk){return buf.push(chunk)}),this.input=[],buf.join("")},Filter.prototype.forEach=function(callback){var buf,handleDisplay,_this=this;return buf="",handleDisplay=function(code){return code=parseInt(code,10),-1===code&&callback("<br/>"),0===code&&_this.stack.length&&callback(_this.resetStyles()),1===code&&callback(_this.pushTag("b")),code>2&&5>code&&callback(_this.pushTag("u")),code>4&&7>code&&callback(_this.pushTag("blink")),8===code&&callback(_this.pushStyle("display:none")),9===code&&callback(_this.pushTag("strike")),24===code&&callback(_this.closeTag("u")),code>29&&38>code&&callback(_this.pushStyle("ef"+(code-30))),39===code&&callback(_this.pushStyle("color:"+_this.opts.fg)),code>39&&48>code&&callback(_this.pushStyle("eb"+(code-40))),49===code&&callback(_this.pushStyle("background-color:"+_this.opts.bg)),code>89&&98>code&&callback(_this.pushStyle("ef"+(8+(code-90)))),code>99&&108>code?callback(_this.pushStyle("eb"+(8+(code-100)))):void 0},this.input.forEach(function(chunk){return buf+=chunk,_this.tokenize(buf,function(tok,data){switch(tok){case"text":return callback(data);case"display":return handleDisplay(data);case"xterm256":return callback(_this.pushStyle("ef"+data))}})}),this.stack.length?callback(this.resetStyles()):void 0},Filter.prototype.pushTag=function(tag,style){return null==style&&(style=""),style.length&&-1===style.indexOf(":")&&(style=STYLES[style]),this.stack.push(tag),["<"+tag,style?' style="'+style+'"':void 0,">"].join("")},Filter.prototype.pushStyle=function(style){return this.pushTag("span",style)},Filter.prototype.closeTag=function(style){var last;return this.stack.slice(-1)[0]===style&&(last=this.stack.pop()),null!=last?"</"+style+">":void 0},Filter.prototype.resetStyles=function(){var stack,_ref;return _ref=[this.stack,[]],stack=_ref[0],this.stack=_ref[1],stack.reverse().map(function(tag){return"</"+tag+">"}).join("")},Filter.prototype.tokenize=function(text,callback){var ansiHandler,ansiMatch,ansiMess,handler,i,length,newline,process,realText,remove,removeXterm256,tokens,_j,_len,_results1,_this=this;for(ansiMatch=!1,ansiHandler=3,remove=function(){return""},removeXterm256=function(m,g1){return callback("xterm256",g1),""},newline=function(m){return _this.opts.newline?callback("display",-1):callback("text",m),""},ansiMess=function(m,g1){var code,_j,_len;for(ansiMatch=!0,0===g1.trim().length&&(g1="0"),g1=g1.trimRight(";").split(";"),_j=0,_len=g1.length;_len>_j;_j++)code=g1[_j],callback("display",code);return""},realText=function(m){return callback("text",m),""},tokens=[{pattern:/^\x08+/,sub:remove},{pattern:/^\x1b\[38;5;(\d+)m/,sub:removeXterm256},{pattern:/^\n+/,sub:newline},{pattern:/^\x1b\[((?:\d{1,3};?)+|)m/,sub:ansiMess},{pattern:/^\x1b\[?[\d;]{0,3}/,sub:remove},{pattern:/^([^\x1b\x08\n]+)/,sub:realText}],process=function(handler,i){var matches;i>ansiHandler&&ansiMatch||(ansiMatch=!1,matches=text.match(handler.pattern),text=text.replace(handler.pattern,handler.sub))},_results1=[];(length=text.length)>0;){for(i=_j=0,_len=tokens.length;_len>_j;i=++_j)handler=tokens[i],process(handler,i);if(text.length===length)break;_results1.push(void 0)}return _results1},Filter}(),window.ansi_to_html=Filter}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};window.CSConsole=function(){function CSConsole(el,options){this.moveInputForward=__bind(this.moveInputForward,this),this.addColors=__bind(this.addColors,this),this.formatWidgetElementText=__bind(this.formatWidgetElementText,this),this.buildWidget=__bind(this.buildWidget,this),this.renderResponse=__bind(this.renderResponse,this),this.responseObject=__bind(this.responseObject,this),this.lineNumber=__bind(this.lineNumber,this),this.inputLine=__bind(this.inputLine,this),this.promptLength=__bind(this.promptLength,this),this.submit=__bind(this.submit,this),this.initCallbacks=__bind(this.initCallbacks,this),this.showWelcomeMessage=__bind(this.showWelcomeMessage,this),this.previousHistory=__bind(this.previousHistory,this),this.nextHistory=__bind(this.nextHistory,this),this.focusInput=__bind(this.focusInput,this),this.innerConsole=__bind(this.innerConsole,this),this.reset=__bind(this.reset,this),this.getAllInput=__bind(this.getAllInput,this),this.setPrompt=__bind(this.setPrompt,this),this.setLine=__bind(this.setLine,this),this.getValue=__bind(this.getValue,this),this.setValue=__bind(this.setValue,this),this.options=options,this.options.prompt||(this.options.prompt="> "),this.initCallbacks(options),this.initializeKeyMap(),this.initConsole(el),this.submitHistory=new CSConsoleHistory(this.options)}var CSConsoleHistory,CodeMirrorHelpers,KeyActions;return CSConsole.prototype.keyMap={"Alt-Delete":"delGroupAfter","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Right":"goLineEnd","Ctrl-E":"goLineEnd","Ctrl-Alt-Backspace":"delGroupAfter",Delete:"delCharAfter",End:"goLineEnd",Home:"goLineStartSmart",PageDown:"goPageDown",PageUp:"goPageUp",Right:"goCharRight","Ctrl-F":"goCharRight"},CSConsole.prototype.outputWidgets=[],CSConsole.prototype.currentLine=0,CSConsole.prototype.submitInProgress=!1,CSConsole.prototype.setValue=function(value){return this.setLine(this.lineNumber(),""+this.options.prompt+value)},CSConsole.prototype.getValue=function(){return this.getAllInput()},CSConsole.prototype.setLine=function(lineNumber,content){return this.helpers.setLine(lineNumber,content)},CSConsole.prototype.setPrompt=function(prompt){return this.setLine(this.currentLine,this.console.doc.getLine(this.currentLine).replace(new RegExp(this.options.prompt),prompt)),this.options.prompt=prompt},CSConsole.prototype.focus=function(){return this.console.getInputField().focus()},CSConsole.prototype.appendToInput=function(value){return this.setLine(this.lineNumber(),""+this.console.doc.getLine(this.lineNumber())+value)},CSConsole.prototype.getAllInput=function(){var input,lineInput,startingInput;for(startingInput=this.currentLine,input=[];startingInput<=this.lineNumber();)startingInput===this.currentLine?(lineInput=this.console.doc.getLine(startingInput).substr(this.promptLength(),this.console.doc.getLine(this.currentLine).length),input.push(lineInput)):input.push(this.console.doc.getLine(startingInput)),startingInput++;return input.join("\n")},CSConsole.prototype.reset=function(welcomeMessage){var widget,_i,_len,_ref;for(null==welcomeMessage&&(welcomeMessage=!0),this.submitInProgress=!1,this.console.setValue(""),this.currentLine=0,_ref=this.outputWidgets,_i=0,_len=_ref.length;_len>_i;_i++)widget=_ref[_i],this.console.removeLineWidget(widget);return this.outputWidgets=[],this.options.welcomeMessage&&welcomeMessage&&(this.showWelcomeMessage(),this.moveInputForward()),this.console.refresh(),this.console.scrollIntoView()},CSConsole.prototype.innerConsole=function(){return this.console},CSConsole.prototype.initializeKeyMap=function(){return window.CodeMirror.keyMap.console=this.keyMap},CSConsole.prototype.initConsole=function(el){var keyActions,_this=this;return el.className+=" cs-console cs-console-height cs-console-width console-panel console-panel--height console-panel--width",keyActions=new KeyActions(this.options),this.console=window.CodeMirror(el,{mode:{name:this.options.syntax,useCPP:!0},gutter:this.options.lineNumbers,lineNumbers:this.options.lineNumbers,theme:this.options.theme||"vibrant-ink",indentUnit:2,tabSize:2,keyMap:"console",lineWrapping:!0,undoDepth:0,autoFocus:this.options.autoFocus,extraKeys:{Enter:this.submit,"Ctrl-M":this.submit,Tab:this.noop,Left:keyActions.goCharLeft,"Ctrl-B":keyActions.goCharLeft,Backspace:keyActions.delCharBefore,"Cmd-Up":keyActions.goDocStart,"Cmd-Down":keyActions.goDocEnd,"Cmd-Left":keyActions.goLineStart,Home:keyActions.goLineStart,"Ctrl-A":keyActions.goLineStart,"Alt-Backspace":keyActions.delGroupBefore,"Ctrl-W":keyActions.delGroupBefore,"Cmd-Backspace":keyActions.deleteLine,Up:this.nextHistory,Down:this.previousHistory,"Ctrl-P":this.nextHistory,"Ctrl-N":this.previousHistory,"Shift-Cmd-Right":this.noop,"Shift-Cmd-Left":this.noop,"Shift-Right":this.noop,"Shift-Alt-Right":this.noop,"Shift-Alt-Left":this.noop,"Ctrl-Enter":this.noop,"Alt-Enter":this.noop,"Shift-Tab":this.noop,"Cmd-S":this.noop,"Ctrl-Z":this.noop,"Cmd-Z":this.noop}}),this.helpers=new CodeMirrorHelpers(this.console),keyActions.setConsole(this.console),this.console.on("keydown",this.focusInput),setTimeout(function(){return _this.console.refresh()},1),this.console.getScrollerElement().className+=" cs-console-height console-panel--height",this.console.getWrapperElement().className+=" cs-console-height cs-console-width console-panel--height console-panel--width",this.options.welcomeMessage&&this.showWelcomeMessage(),this.options.initialValue&&(this.setValue(this.options.initialValue),this.moveInputForward()),this.options.autoFocus&&setTimeout(function(){return _this.console.getInputField().focus()},10),this.moveInputForward()},CSConsole.prototype.focusInput=function(){var cursorPos;return cursorPos=this.console.getCursor(),cursorPos.line===this.lineNumber()?(this.storedCursorPosition=this.console.getCursor(),cursorPos.ch<this.promptLength()&&this.console.setCursor({line:cursorPos.line,ch:this.promptLength()})):this.console.setCursor(this.storedCursorPosition),!1},CSConsole.prototype.nextHistory=function(){return this.setValue(this.submitHistory.nextHistory())},CSConsole.prototype.previousHistory=function(){return this.setValue(this.submitHistory.previousHistory())},CSConsole.prototype.showWelcomeMessage=function(){var line;return this.console.setValue(""),line={content:this.options.welcomeMessage},this.buildWidget(1,line,{above:!0})},CSConsole.prototype.initCallbacks=function(options){return this.commandValidate=options.commandValidate,this.commandHandle=options.commandHandle},CSConsole.prototype.submit=function(){var input;return input=this.getAllInput(),void 0!==this.options.commandValidate&&!this.options.commandValidate(input)||this.submitInProgress?this.submitInProgress?this.nonReactingNewline():this.moveInputForward():(this.submitInProgress=!0,this.submitHistory.push(input),this.submitHistory.resetIndex(),this.commandHandle(input,this.responseObject(),this.options.prompt))},CSConsole.prototype.nonReactingNewline=function(){return this.currentLine=this.lineNumber(),this.setLine(this.currentLine,""+this.inputLine()+"\n")},CSConsole.prototype.promptLength=function(){return this.options.prompt.length},CSConsole.prototype.inputLine=function(){return this.console.doc.getLine(this.lineNumber())},CSConsole.prototype.lineNumber=function(){return this.console.lineCount()-1},CSConsole.prototype.responseObject=function(){var _this=this;return function(responseLines){return _this.renderResponse(responseLines)}},CSConsole.prototype.renderResponse=function(responseLines){var line,lineNumber,_i,_len;if(!responseLines)return this.moveInputForward(),this.submitInProgress=!1,void 0;if(lineNumber=this.lineNumber(),responseLines.constructor===Array)for(_i=0,_len=responseLines.length;_len>_i;_i++)line=responseLines[_i],this.buildWidget(lineNumber,line);else this.buildWidget(lineNumber,responseLines);return this.buildWidget(lineNumber,{content:document.createElement("p"),className:"cs-console-output-spacer bottom"}),this.moveInputForward(),this.submitInProgress=!1},CSConsole.prototype.htmlEscape=function(string){return(""+string).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},CSConsole.prototype.buildWidget=function(lineNumber,responseLine,widgetOptions){var widgetContent,widgetElement,_this=this;return null==widgetOptions&&(widgetOptions={}),widgetContent=responseLine?responseLine.content:"",this.isHtmlElement(widgetContent)?widgetElement=widgetContent:(widgetElement=document.createElement("div"),widgetElement.innerHTML=this.formatWidgetElementText(this.htmlEscape(widgetContent)),widgetElement.className="cs-console-output-element",widgetElement.style.whiteSpace="pre-wrap"),(null!=responseLine?responseLine.className:void 0)&&(widgetElement.className+=" "+responseLine.className),Object.keys(widgetOptions).indexOf("coverGutter")<0&&(widgetOptions.coverGutter=!1),Object.keys(widgetOptions).indexOf("noHScroll")<0&&(widgetOptions.noHScroll=!0),this.outputWidgets.push(this.console.addLineWidget(lineNumber,widgetElement,widgetOptions)),setTimeout(function(){return _this.console.scrollIntoView({line:_this.console.lineCount()-1,ch:0})},100)},CSConsole.prototype.isHtmlElement=function(obj){return obj&&obj.constructor.toString().search(/HTML.+Element/)>0},CSConsole.prototype.formatWidgetElementText=function(message){return message=message.replace(/^\s/,""),message="<p class='cs-console-output-spacer top'></p>"+message,this.addColors(message)},CSConsole.prototype.addColors=function(message){var filter;return filter=new window.ansi_to_html,filter.toHtml(message)},CSConsole.prototype.moveInputForward=function(){return this.currentLine=this.lineNumber()+1,this.setLine(this.currentLine-1,""+this.inputLine()+"\n"+this.options.prompt),this.storedCursorPosition={line:this.currentLine,ch:this.promptLength()},this.console.setCursor(this.storedCursorPosition)},CSConsole.prototype.noop=function(){},CodeMirrorHelpers=function(){function CodeMirrorHelpers(cmInstance){this.setLine=__bind(this.setLine,this),this.cmInstance=cmInstance}return CodeMirrorHelpers.prototype.setLine=function(lineNumber,content){var lineContent;return lineContent=this.cmInstance.doc.getLine(lineNumber),this.cmInstance.doc.replaceRange(content,{line:lineNumber,ch:0},{line:lineNumber,ch:lineContent.length})},CodeMirrorHelpers}(),KeyActions=function(){function KeyActions(options){this.isCursorAtPrompt=__bind(this.isCursorAtPrompt,this),this.promptLength=__bind(this.promptLength,this),this.consoleLineCount=__bind(this.consoleLineCount,this),this.deleteLine=__bind(this.deleteLine,this),this.delGroupBefore=__bind(this.delGroupBefore,this),this.goLineStart=__bind(this.goLineStart,this),this.goDocEnd=__bind(this.goDocEnd,this),this.goDocStart=__bind(this.goDocStart,this),this.delCharBefore=__bind(this.delCharBefore,this),this.goCharLeft=__bind(this.goCharLeft,this),this.setLine=__bind(this.setLine,this),this.setConsole=__bind(this.setConsole,this),this.options=options}return KeyActions.prototype._defaultCommands=CodeMirror.commands,KeyActions.prototype.setConsole=function(console){return this.console=console,this.helpers=new CodeMirrorHelpers(console)},KeyActions.prototype.setLine=function(lineNumber,content){return this.helpers.setLine(lineNumber,content)},KeyActions.prototype.goCharLeft=function(){return this.isCursorAtPrompt()?this._defaultCommands.goCharLeft(this.console):void 0},KeyActions.prototype.delCharBefore=function(){return this.isCursorAtPrompt()?this._defaultCommands.delCharBefore(this.console):void 0},KeyActions.prototype.goDocStart=function(){return this.console.scrollIntoView({line:0,ch:0})},KeyActions.prototype.goDocEnd=function(){return this.console.scrollIntoView({line:this.consoleLineCount(),ch:0})},KeyActions.prototype.goLineStart=function(){var cursorPos;return cursorPos=this.console.getCursor(),this.console.setCursor({line:cursorPos.line,ch:this.promptLength()})},KeyActions.prototype.delGroupBefore=function(){var cursorStartPos,futurePos;return cursorStartPos=this.console.getCursor(),this.console.moveH(-1,"group"),futurePos=this.console.getCursor().ch,this.console.setCursor(cursorStartPos),futurePos>=this.promptLength()?this._defaultCommands.delGroupBefore(this.console):void 0},KeyActions.prototype.deleteLine=function(){return this.setLine(this.console.getCursor().line,this.options.prompt)},KeyActions.prototype.consoleLineCount=function(){return this.console.lineCount()-1},KeyActions.prototype.promptLength=function(){return this.options.prompt.length},KeyActions.prototype.isCursorAtPrompt=function(){return this.console.getCursor().ch>this.promptLength()},KeyActions}(),CSConsoleHistory=function(){function CSConsoleHistory(options){this.previousHistory=__bind(this.previousHistory,this),this.nextHistory=__bind(this.nextHistory,this),this.getHistory=__bind(this.getHistory,this),this.push=__bind(this.push,this);var localHistory;this.options=options,this.options.historyLabel&&(this.historyLabel="cs-"+this.options.historyLabel+"-console-history"),this.options.maxEntries&&(this.maxEntries=options.maxHistoryEntries),this.localStorageExists()&&(this.storage=window.localStorage,localHistory=this.getHistory(),localHistory&&(this.cachedHistory=localHistory),this.currentIndex=this.cachedHistory.length-1)}return CSConsoleHistory.prototype.storage={},CSConsoleHistory.prototype.currentIndex=0,CSConsoleHistory.prototype.historyLabel="cs-console-history",CSConsoleHistory.prototype.cachedHistory=[],CSConsoleHistory.prototype.maxEntries=25,CSConsoleHistory.prototype.localStorageExists=function(){var e;try{return!(null===window.localStorage||!window.localStorage)}catch(_error){return e=_error,!1}},CSConsoleHistory.prototype.push=function(item){var currentHistory,startSlice;if(item&&(currentHistory=this.getHistory(),currentHistory[currentHistory.length-1]!==item))return currentHistory.push(item),currentHistory.length>=this.maxEntries&&(startSlice=currentHistory.length-this.maxEntries,currentHistory=currentHistory.slice(startSlice,currentHistory.length)),this.cachedHistory=currentHistory,this.storage[this.historyLabel]=JSON.stringify(currentHistory),this.currentIndex=currentHistory.length-1},CSConsoleHistory.prototype.getHistory=function(){return this.storage[this.historyLabel]?JSON.parse(this.storage[this.historyLabel]):[]},CSConsoleHistory.prototype.nextHistory=function(){var history;return history=this.cachedHistory.length>0?this.cachedHistory[this.currentIndex]:"",this.currentIndex>0&&this.currentIndex--,history},CSConsoleHistory.prototype.previousHistory=function(){return this.currentIndex<this.cachedHistory.length-1?(this.currentIndex++,this.cachedHistory[this.currentIndex]):""},CSConsoleHistory.prototype.clearHistory=function(){return this.storage[this.historyLabel]="[]",this.cachedHistory=[]},CSConsoleHistory.prototype.resetIndex=function(){return this.currentIndex=this.cachedHistory.length-1},CSConsoleHistory}(),CSConsole}.call(this)}.call(this),function(){function baseCompareAscending(value,other){if(value!==other){var valIsNull=null===value,valIsUndef=value===undefined,valIsReflexive=value===value,othIsNull=null===other,othIsUndef=other===undefined,othIsReflexive=other===other;if(value>other&&!othIsNull||!valIsReflexive||valIsNull&&!othIsUndef&&othIsReflexive||valIsUndef&&othIsReflexive)return 1;if(other>value&&!valIsNull||!othIsReflexive||othIsNull&&!valIsUndef&&valIsReflexive||othIsUndef&&valIsReflexive)return-1}return 0}function baseFindIndex(array,predicate,fromRight){for(var length=array.length,index=fromRight?length:-1;fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIndexOf(array,value,fromIndex){if(value!==value)return indexOfNaN(array,fromIndex);for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function baseIsFunction(value){return"function"==typeof value||!1}function baseToString(value){return null==value?"":value+""}function charsLeftIndex(string,chars){for(var index=-1,length=string.length;++index<length&&chars.indexOf(string.charAt(index))>-1;);return index}function charsRightIndex(string,chars){for(var index=string.length;index--&&chars.indexOf(string.charAt(index))>-1;);return index}function compareAscending(object,other){return baseCompareAscending(object.criteria,other.criteria)||object.index-other.index}function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=baseCompareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength)return result;var order=orders[index];return result*("asc"===order||order===!0?1:-1)}}return object.index-other.index}function deburrLetter(letter){return deburredLetters[letter]}function escapeHtmlChar(chr){return htmlEscapes[chr]}function escapeRegExpChar(chr,leadingChar,whitespaceChar){return leadingChar?chr=regexpEscapes[chr]:whitespaceChar&&(chr=stringEscapes[chr]),"\\"+chr}function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function indexOfNaN(array,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?0:-1);fromRight?index--:++index<length;){var other=array[index];if(other!==other)return index}return-1}function isObjectLike(value){return!!value&&"object"==typeof value}function isSpace(charCode){return 160>=charCode&&charCode>=9&&13>=charCode||32==charCode||160==charCode||5760==charCode||6158==charCode||charCode>=8192&&(8202>=charCode||8232==charCode||8233==charCode||8239==charCode||8287==charCode||12288==charCode||65279==charCode)}function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;)array[index]===placeholder&&(array[index]=PLACEHOLDER,result[++resIndex]=index);return result}function sortedUniq(array,iteratee){for(var seen,index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;index&&seen===computed||(seen=computed,result[++resIndex]=value)}return result}function trimmedLeftIndex(string){for(var index=-1,length=string.length;++index<length&&isSpace(string.charCodeAt(index)););return index}function trimmedRightIndex(string){for(var index=string.length;index--&&isSpace(string.charCodeAt(index)););return index}function unescapeHtmlChar(chr){return htmlUnescapes[chr]}function runInContext(context){function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__chain__")&&hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}function baseLodash(){}function LodashWrapper(value,chainAll,actions){this.__wrapped__=value,this.__actions__=actions||[],this.__chain__=!!chainAll}function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=POSITIVE_INFINITY,this.__views__=[]}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);return result.__actions__=arrayCopy(this.__actions__),result.__dir__=this.__dir__,result.__filtered__=this.__filtered__,result.__iteratees__=arrayCopy(this.__iteratees__),result.__takeCount__=this.__takeCount__,result.__views__=arrayCopy(this.__views__),result}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1,result.__filtered__=!0}else result=this.clone(),result.__dir__*=-1;return result}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=0>dir,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||LARGE_ARRAY_SIZE>arrLength||arrLength==length&&takeCount==length)return baseWrapperValue(array,this.__actions__);var result=[];outer:for(;length--&&takeCount>resIndex;){index+=dir;for(var iterIndex=-1,value=array[index];++iterIndex<iterLength;){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG)value=computed;else if(!computed){if(type==LAZY_FILTER_FLAG)continue outer;break outer}}result[resIndex++]=value}return result}function MapCache(){this.__data__={}}function mapDelete(key){return this.has(key)&&delete this.__data__[key]}function mapGet(key){return"__proto__"==key?undefined:this.__data__[key]}function mapHas(key){return"__proto__"!=key&&hasOwnProperty.call(this.__data__,key)}function mapSet(key,value){return"__proto__"!=key&&(this.__data__[key]=value),this}function SetCache(values){var length=values?values.length:0;for(this.data={hash:nativeCreate(null),set:new Set};length--;)this.push(values[length])}function cacheIndexOf(cache,value){var data=cache.data,result="string"==typeof value||isObject(value)?data.set.has(value):data.hash[value];return result?0:-1}function cachePush(value){var data=this.data;"string"==typeof value||isObject(value)?data.set.add(value):data.hash[value]=!0}function arrayConcat(array,other){for(var index=-1,length=array.length,othIndex=-1,othLength=other.length,result=Array(length+othLength);++index<length;)result[index]=array[index];for(;++othIndex<othLength;)result[index++]=other[othIndex];return result}function arrayCopy(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}function arrayEach(array,iteratee){for(var index=-1,length=array.length;++index<length&&iteratee(array[index],index,array)!==!1;);return array}function arrayEachRight(array,iteratee){for(var length=array.length;length--&&iteratee(array[length],length,array)!==!1;);return array}function arrayEvery(array,predicate){for(var index=-1,length=array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}function arrayExtremum(array,iteratee,comparator,exValue){for(var index=-1,length=array.length,computed=exValue,result=computed;++index<length;){var value=array[index],current=+iteratee(value);comparator(current,computed)&&(computed=current,result=value)}return result}function arrayFilter(array,predicate){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[++resIndex]=value)}return result}function arrayMap(array,iteratee){for(var index=-1,length=array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initFromArray){var index=-1,length=array.length;for(initFromArray&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arrayReduceRight(array,iteratee,accumulator,initFromArray){var length=array.length;for(initFromArray&&length&&(accumulator=array[--length]);length--;)accumulator=iteratee(accumulator,array[length],length,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function arraySum(array,iteratee){for(var length=array.length,result=0;length--;)result+=+iteratee(array[length])||0;return result}function assignDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:objectValue}function assignOwnDefaults(objectValue,sourceValue,key,object){return objectValue!==undefined&&hasOwnProperty.call(object,key)?objectValue:sourceValue}function assignWith(object,source,customizer){for(var index=-1,props=keys(source),length=props.length;++index<length;){var key=props[index],value=object[key],result=customizer(value,source[key],key,object,source);(result===result?result===value:value!==value)&&(value!==undefined||key in object)||(object[key]=result)}return object}function baseAssign(object,source){return null==source?object:baseCopy(source,keys(source),object)}function baseAt(collection,props){for(var index=-1,isNil=null==collection,isArr=!isNil&&isArrayLike(collection),length=isArr?collection.length:0,propsLength=props.length,result=Array(propsLength);++index<propsLength;){var key=props[index];result[index]=isArr?isIndex(key,length)?collection[key]:undefined:isNil?undefined:collection[key]}return result}function baseCopy(source,props,object){object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index];object[key]=source[key]}return object}function baseCallback(func,thisArg,argCount){var type=typeof func;return"function"==type?thisArg===undefined?func:bindCallback(func,thisArg,argCount):null==func?identity:"object"==type?baseMatches(func):thisArg===undefined?property(func):baseMatchesProperty(func,thisArg)}function baseClone(value,isDeep,customizer,key,object,stackA,stackB){var result;if(customizer&&(result=object?customizer(value,key,object):customizer(value)),result!==undefined)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=initCloneArray(value),!isDeep)return arrayCopy(value,result)}else{var tag=objToString.call(value),isFunc=tag==funcTag;if(tag!=objectTag&&tag!=argsTag&&(!isFunc||object))return cloneableTags[tag]?initCloneByTag(value,tag,isDeep):object?value:{};if(result=initCloneObject(isFunc?{}:value),!isDeep)return baseAssign(result,value)}stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==value)return stackB[length];return stackA.push(value),stackB.push(result),(isArr?arrayEach:baseForOwn)(value,function(subValue,key){result[key]=baseClone(subValue,isDeep,customizer,key,value,stackA,stackB)}),result}function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return setTimeout(function(){func.apply(undefined,args)},wait)}function baseDifference(array,values){var length=array?array.length:0,result=[];if(!length)return result;var index=-1,indexOf=getIndexOf(),isCommon=indexOf===baseIndexOf,cache=isCommon&&values.length>=LARGE_ARRAY_SIZE?createCache(values):null,valuesLength=values.length;cache&&(indexOf=cacheIndexOf,isCommon=!1,values=cache);outer:for(;++index<length;){var value=array[index];if(isCommon&&value===value){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===value)continue outer;result.push(value)}else indexOf(values,value,0)<0&&result.push(value)}return result}function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}function baseExtremum(collection,iteratee,comparator,exValue){var computed=exValue,result=computed;return baseEach(collection,function(value,index,collection){var current=+iteratee(value,index,collection);(comparator(current,computed)||current===exValue&&current===result)&&(computed=current,result=value)}),result}function baseFill(array,value,start,end){var length=array.length;
for(start=null==start?0:+start||0,0>start&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,0>end&&(end+=length),length=start>end?0:end>>>0,start>>>=0;length>start;)array[start++]=value;return array}function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}function baseFind(collection,predicate,eachFunc,retKey){var result;return eachFunc(collection,function(value,key,collection){return predicate(value,key,collection)?(result=retKey?key:value,!1):void 0}),result}function baseFlatten(array,isDeep,isStrict,result){result||(result=[]);for(var index=-1,length=array.length;++index<length;){var value=array[index];isObjectLike(value)&&isArrayLike(value)&&(isStrict||isArray(value)||isArguments(value))?isDeep?baseFlatten(value,isDeep,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}function baseForIn(object,iteratee){return baseFor(object,iteratee,keysIn)}function baseForOwn(object,iteratee){return baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return baseForRight(object,iteratee,keys)}function baseFunctions(object,props){for(var index=-1,length=props.length,resIndex=-1,result=[];++index<length;){var key=props[index];isFunction(object[key])&&(result[++resIndex]=key)}return result}function baseGet(object,path,pathKey){if(null!=object){pathKey!==undefined&&pathKey in toObject(object)&&(path=[pathKey]);for(var index=0,length=path.length;null!=object&&length>index;)object=object[path[index++]];return index&&index==length?object:undefined}}function baseIsEqual(value,other,customizer,isLoose,stackA,stackB){return value===other?!0:null==value||null==other||!isObject(value)&&!isObjectLike(other)?value!==value&&other!==other:baseIsEqualDeep(value,other,baseIsEqual,customizer,isLoose,stackA,stackB)}function baseIsEqualDeep(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=objToString.call(object),objTag==argsTag?objTag=objectTag:objTag!=objectTag&&(objIsArr=isTypedArray(object))),othIsArr||(othTag=objToString.call(other),othTag==argsTag?othTag=objectTag:othTag!=objectTag&&(othIsArr=isTypedArray(other)));var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&!objIsArr&&!objIsObj)return equalByTag(object,other,objTag);if(!isLoose){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped)return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,isLoose,stackA,stackB)}if(!isSameTag)return!1;stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==object)return stackB[length]==other;stackA.push(object),stackB.push(other);var result=(objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,isLoose,stackA,stackB);return stackA.pop(),stackB.pop(),result}function baseIsMatch(object,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=toObject(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1}else{var result=customizer?customizer(objValue,srcValue,key):undefined;if(!(result===undefined?baseIsEqual(srcValue,objValue,customizer,!0):result))return!1}}return!0}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}function baseMatches(source){var matchData=getMatchData(source);if(1==matchData.length&&matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){return null==object?!1:object[key]===value&&(value!==undefined||key in toObject(object))}}return function(object){return baseIsMatch(object,matchData)}}function baseMatchesProperty(path,srcValue){var isArr=isArray(path),isCommon=isKey(path)&&isStrictComparable(srcValue),pathKey=path+"";return path=toPath(path),function(object){if(null==object)return!1;var key=pathKey;if(object=toObject(object),!(!isArr&&isCommon||key in object)){if(object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;key=last(path),object=toObject(object)}return object[key]===srcValue?srcValue!==undefined||key in object:baseIsEqual(srcValue,object[key],undefined,!0)}}function baseMerge(object,source,customizer,stackA,stackB){if(!isObject(object))return object;var isSrcArr=isArrayLike(source)&&(isArray(source)||isTypedArray(source)),props=isSrcArr?undefined:keys(source);return arrayEach(props||source,function(srcValue,key){if(props&&(key=srcValue,srcValue=source[key]),isObjectLike(srcValue))stackA||(stackA=[]),stackB||(stackB=[]),baseMergeDeep(object,source,key,baseMerge,customizer,stackA,stackB);else{var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue),result===undefined&&(!isSrcArr||key in object)||!isCommon&&(result===result?result===value:value!==value)||(object[key]=result)}}),object}function baseMergeDeep(object,source,key,mergeFunc,customizer,stackA,stackB){for(var length=stackA.length,srcValue=source[key];length--;)if(stackA[length]==srcValue)return object[key]=stackB[length],void 0;var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue,isArrayLike(srcValue)&&(isArray(srcValue)||isTypedArray(srcValue))?result=isArray(value)?value:isArrayLike(value)?arrayCopy(value):[]:isPlainObject(srcValue)||isArguments(srcValue)?result=isArguments(value)?toPlainObject(value):isPlainObject(value)?value:{}:isCommon=!1),stackA.push(srcValue),stackB.push(result),isCommon?object[key]=mergeFunc(result,srcValue,customizer,stackA,stackB):(result===result?result!==value:value===value)&&(object[key]=result)}function baseProperty(key){return function(object){return null==object?undefined:object[key]}}function basePropertyDeep(path){var pathKey=path+"";return path=toPath(path),function(object){return baseGet(object,path,pathKey)}}function basePullAt(array,indexes){for(var length=array?indexes.length:0;length--;){var index=indexes[length];if(index!=previous&&isIndex(index)){var previous=index;splice.call(array,index,1)}}return array}function baseRandom(min,max){return min+nativeFloor(nativeRandom()*(max-min+1))}function baseReduce(collection,iteratee,accumulator,initFromCollection,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initFromCollection?(initFromCollection=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}function baseSlice(array,start,end){var index=-1,length=array.length;start=null==start?0:+start||0,0>start&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,0>end&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return result=predicate(value,index,collection),!result}),!!result}function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}function baseSortByOrder(collection,iteratees,orders){var callback=getCallback(),index=-1;iteratees=arrayMap(iteratees,function(iteratee){return callback(iteratee)});var result=baseMap(collection,function(value){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value)});return{criteria:criteria,index:++index,value:value}});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders)})}function baseSum(collection,iteratee){var result=0;return baseEach(collection,function(value,index,collection){result+=+iteratee(value,index,collection)||0}),result}function baseUniq(array,iteratee){var index=-1,indexOf=getIndexOf(),length=array.length,isCommon=indexOf===baseIndexOf,isLarge=isCommon&&length>=LARGE_ARRAY_SIZE,seen=isLarge?createCache():null,result=[];seen?(indexOf=cacheIndexOf,isCommon=!1):(isLarge=!1,seen=iteratee?[]:result);outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;if(isCommon&&value===value){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else indexOf(seen,computed,0)<0&&((iteratee||isLarge)&&seen.push(computed),result.push(value))}return result}function baseValues(object,props){for(var index=-1,length=props.length,result=Array(length);++index<length;)result[index]=object[props[index]];return result}function baseWhile(array,predicate,isDrop,fromRight){for(var length=array.length,index=fromRight?length:-1;(fromRight?index--:++index<length)&&predicate(array[index],index,array););return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;result instanceof LazyWrapper&&(result=result.value());for(var index=-1,length=actions.length;++index<length;){var action=actions[index];result=action.func.apply(action.thisArg,arrayPush([result],action.args))}return result}function binaryIndex(array,value,retHighest){var low=0,high=array?array.length:low;if("number"==typeof value&&value===value&&HALF_MAX_ARRAY_LENGTH>=high){for(;high>low;){var mid=low+high>>>1,computed=array[mid];(retHighest?value>=computed:value>computed)&&null!==computed?low=mid+1:high=mid}return high}return binaryIndexBy(array,value,identity,retHighest)}function binaryIndexBy(array,value,iteratee,retHighest){value=iteratee(value);for(var low=0,high=array?array.length:0,valIsNaN=value!==value,valIsNull=null===value,valIsUndef=value===undefined;high>low;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),isDef=computed!==undefined,isReflexive=computed===computed;if(valIsNaN)var setLow=isReflexive||retHighest;else setLow=valIsNull?isReflexive&&isDef&&(retHighest||null!=computed):valIsUndef?isReflexive&&(retHighest||isDef):null==computed?!1:retHighest?value>=computed:value>computed;setLow?low=mid+1:high=mid}return nativeMin(high,MAX_ARRAY_INDEX)}function bindCallback(func,thisArg,argCount){if("function"!=typeof func)return identity;if(thisArg===undefined)return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source)}}return function(){return func.apply(thisArg,arguments)}}function bufferClone(buffer){var result=new ArrayBuffer(buffer.byteLength),view=new Uint8Array(result);return view.set(new Uint8Array(buffer)),result}function composeArgs(args,partials,holders){for(var holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),leftIndex=-1,leftLength=partials.length,result=Array(leftLength+argsLength);++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)result[holders[argsIndex]]=args[argsIndex];for(;argsLength--;)result[leftIndex++]=args[argsIndex++];return result}function composeArgsRight(args,partials,holders){for(var holdersIndex=-1,holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),rightIndex=-1,rightLength=partials.length,result=Array(argsLength+rightLength);++argsIndex<argsLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)result[offset+holders[holdersIndex]]=args[argsIndex++];return result}function createAggregator(setter,initializer){return function(collection,iteratee,thisArg){var result=initializer?initializer():{};if(iteratee=getCallback(iteratee,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];setter(result,value,iteratee(value,index,collection),collection)}else baseEach(collection,function(value,key,collection){setter(result,value,iteratee(value,key,collection),collection)});return result}}function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=null==object?0:sources.length,customizer=length>2?sources[length-2]:undefined,guard=length>2?sources[2]:undefined,thisArg=length>1?sources[length-1]:undefined;for("function"==typeof customizer?(customizer=bindCallback(customizer,thisArg,5),length-=2):(customizer="function"==typeof thisArg?thisArg:undefined,length-=customizer?1:0),guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=3>length?undefined:customizer,length=1);++index<length;){var source=sources[index];source&&assigner(object,source,customizer)}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){var length=collection?getLength(collection):0;if(!isLength(length))return eachFunc(collection,iteratee);for(var index=fromRight?length:-1,iterable=toObject(collection);(fromRight?index--:++index<length)&&iteratee(iterable[index],index,iterable)!==!1;);return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;fromRight?index--:++index<length;){var key=props[index];if(iteratee(iterable[key],key,iterable)===!1)break}return object}}function createBindWrapper(func,thisArg){function wrapper(){var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(thisArg,arguments)}var Ctor=createCtorWrapper(func);return wrapper}function createCache(values){return nativeCreate&&Set?new SetCache(values):null}function createCompounder(callback){return function(string){for(var index=-1,array=words(deburr(string)),length=array.length,result="";++index<length;)result=callback(result,array[index],index);return result}}function createCtorWrapper(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurry(flag){function curryFunc(func,arity,guard){guard&&isIterateeCall(func,arity,guard)&&(arity=undefined);var result=createWrapper(func,flag,undefined,undefined,undefined,undefined,undefined,arity);return result.placeholder=curryFunc.placeholder,result}return curryFunc}function createDefaults(assigner,customizer){return restParam(function(args){var object=args[0];return null==object?object:(args.push(customizer),assigner.apply(undefined,args))})}function createExtremum(comparator,exValue){return function(collection,iteratee,thisArg){if(thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length){collection=isArray(collection)?collection:toIterable(collection);var result=arrayExtremum(collection,iteratee,comparator,exValue);if(!collection.length||result!==exValue)return result}return baseExtremum(collection,iteratee,comparator,exValue)}}function createFind(eachFunc,fromRight){return function(collection,predicate,thisArg){if(predicate=getCallback(predicate,thisArg,3),isArray(collection)){var index=baseFindIndex(collection,predicate,fromRight);return index>-1?collection[index]:undefined}return baseFind(collection,predicate,eachFunc)}}function createFindIndex(fromRight){return function(array,predicate,thisArg){return array&&array.length?(predicate=getCallback(predicate,thisArg,3),baseFindIndex(array,predicate,fromRight)):-1}}function createFindKey(objectFunc){return function(object,predicate,thisArg){return predicate=getCallback(predicate,thisArg,3),baseFind(object,predicate,objectFunc,!0)}}function createFlow(fromRight){return function(){for(var wrapper,length=arguments.length,index=fromRight?length:-1,leftIndex=0,funcs=Array(length);fromRight?index--:++index<length;){var func=funcs[leftIndex++]=arguments[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);!wrapper&&LodashWrapper.prototype.thru&&"wrapper"==getFuncName(func)&&(wrapper=new LodashWrapper([],!0))}for(index=wrapper?-1:length;++index<length;){func=funcs[index];var funcName=getFuncName(func),data="wrapper"==funcName?getData(func):undefined;wrapper=data&&isLaziable(data[0])&&data[1]==(ARY_FLAG|CURRY_FLAG|PARTIAL_FLAG|REARG_FLAG)&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value)&&value.length>=LARGE_ARRAY_SIZE)return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}}}function createForEach(arrayFunc,eachFunc){return function(collection,iteratee,thisArg){return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee):eachFunc(collection,bindCallback(iteratee,thisArg,3))}}function createForIn(objectFunc){return function(object,iteratee,thisArg){return("function"!=typeof iteratee||thisArg!==undefined)&&(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee,keysIn)}}function createForOwn(objectFunc){return function(object,iteratee,thisArg){return("function"!=typeof iteratee||thisArg!==undefined)&&(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee)}}function createObjectMapper(isMapKeys){return function(object,iteratee,thisArg){var result={};return iteratee=getCallback(iteratee,thisArg,3),baseForOwn(object,function(value,key,object){var mapped=iteratee(value,key,object);key=isMapKeys?mapped:key,value=isMapKeys?value:mapped,result[key]=value}),result}}function createPadDir(fromRight){return function(string,length,chars){return string=baseToString(string),(fromRight?string:"")+createPadding(string,length,chars)+(fromRight?"":string)}}function createPartial(flag){var partialFunc=restParam(function(func,partials){var holders=replaceHolders(partials,partialFunc.placeholder);return createWrapper(func,flag,undefined,partials,holders)});return partialFunc}function createReduce(arrayFunc,eachFunc){return function(collection,iteratee,accumulator,thisArg){var initFromArray=arguments.length<3;return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee,accumulator,initFromArray):baseReduce(collection,getCallback(iteratee,thisArg,4),accumulator,initFromArray,eachFunc)}}function createHybridWrapper(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){function wrapper(){for(var length=arguments.length,index=length,args=Array(length);index--;)args[index]=arguments[index];if(partials&&(args=composeArgs(args,partials,holders)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight)),isCurry||isCurryRight){var placeholder=wrapper.placeholder,argsHolders=replaceHolders(args,placeholder);if(length-=argsHolders.length,arity>length){var newArgPos=argPos?arrayCopy(argPos):undefined,newArity=nativeMax(arity-length,0),newsHolders=isCurry?argsHolders:undefined,newHoldersRight=isCurry?undefined:argsHolders,newPartials=isCurry?args:undefined,newPartialsRight=isCurry?undefined:args;bitmask|=isCurry?PARTIAL_FLAG:PARTIAL_RIGHT_FLAG,bitmask&=~(isCurry?PARTIAL_RIGHT_FLAG:PARTIAL_FLAG),isCurryBound||(bitmask&=~(BIND_FLAG|BIND_KEY_FLAG));var newData=[func,bitmask,thisArg,newPartials,newsHolders,newPartialsRight,newHoldersRight,newArgPos,ary,newArity],result=createHybridWrapper.apply(undefined,newData);return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,result}}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;return argPos&&(args=reorder(args,argPos)),isAry&&ary<args.length&&(args.length=ary),this&&this!==root&&this instanceof wrapper&&(fn=Ctor||createCtorWrapper(func)),fn.apply(thisBinding,args)}var isAry=bitmask&ARY_FLAG,isBind=bitmask&BIND_FLAG,isBindKey=bitmask&BIND_KEY_FLAG,isCurry=bitmask&CURRY_FLAG,isCurryBound=bitmask&CURRY_BOUND_FLAG,isCurryRight=bitmask&CURRY_RIGHT_FLAG,Ctor=isBindKey?undefined:createCtorWrapper(func);return wrapper}function createPadding(string,length,chars){var strLength=string.length;if(length=+length,strLength>=length||!nativeIsFinite(length))return"";var padLength=length-strLength;return chars=null==chars?" ":chars+"",repeat(chars,nativeCeil(padLength/chars.length)).slice(0,padLength)}function createPartialWrapper(func,bitmask,thisArg,partials){function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength);++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,args)}var isBind=bitmask&BIND_FLAG,Ctor=createCtorWrapper(func);return wrapper}function createRound(methodName){var func=Math[methodName];return function(number,precision){return precision=precision===undefined?0:+precision||0,precision?(precision=pow(10,precision),func(number*precision)/precision):func(number)}}function createSortedIndex(retHighest){return function(array,value,iteratee,thisArg){var callback=getCallback(iteratee);return null==iteratee&&callback===baseCallback?binaryIndex(array,value,retHighest):binaryIndexBy(array,value,callback(iteratee,thisArg,1),retHighest)}}function createWrapper(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&BIND_KEY_FLAG;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var length=partials?partials.length:0;if(length||(bitmask&=~(PARTIAL_FLAG|PARTIAL_RIGHT_FLAG),partials=holders=undefined),length-=holders?holders.length:0,bitmask&PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=undefined}var data=isBindKey?undefined:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data&&(mergeData(newData,data),bitmask=newData[1],arity=newData[9]),newData[9]=null==arity?isBindKey?0:func.length:nativeMax(arity-length,0)||0,bitmask==BIND_FLAG)var result=createBindWrapper(newData[0],newData[2]);else result=bitmask!=PARTIAL_FLAG&&bitmask!=(BIND_FLAG|PARTIAL_FLAG)||newData[4].length?createHybridWrapper.apply(undefined,newData):createPartialWrapper.apply(undefined,newData);var setter=data?baseSetData:setData;return setter(result,newData)}function equalArrays(array,other,equalFunc,customizer,isLoose,stackA,stackB){var index=-1,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isLoose&&othLength>arrLength))return!1;for(;++index<arrLength;){var arrValue=array[index],othValue=other[index],result=customizer?customizer(isLoose?othValue:arrValue,isLoose?arrValue:othValue,index):undefined;if(result!==undefined){if(result)continue;return!1}if(isLoose){if(!arraySome(other,function(othValue){return arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB)}))return!1}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB))return!1}return!0}function equalByTag(object,other,tag){switch(tag){case boolTag:case dateTag:return+object==+other;case errorTag:return object.name==other.name&&object.message==other.message;case numberTag:return object!=+object?other!=+other:object==+other;case regexpTag:case stringTag:return object==other+""}return!1}function equalObjects(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objProps=keys(object),objLength=objProps.length,othProps=keys(other),othLength=othProps.length;if(objLength!=othLength&&!isLoose)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isLoose?key in other:hasOwnProperty.call(other,key)))return!1}for(var skipCtor=isLoose;++index<objLength;){key=objProps[index];var objValue=object[key],othValue=other[key],result=customizer?customizer(isLoose?othValue:objValue,isLoose?objValue:othValue,key):undefined;if(!(result===undefined?equalFunc(objValue,othValue,customizer,isLoose,stackA,stackB):result))return!1;skipCtor||(skipCtor="constructor"==key)}if(!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor))return!1}return!0}function getCallback(func,thisArg,argCount){var result=lodash.callback||callback;return result=result===callback?baseCallback:result,argCount?result(func,thisArg,argCount):result}function getFuncName(func){for(var result=func.name+"",array=realNames[result],length=array?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}function getIndexOf(collection,target,fromIndex){var result=lodash.indexOf||indexOf;return result=result===indexOf?baseIndexOf:result,collection?result(collection,target,fromIndex):result}function getMatchData(object){for(var result=pairs(object),length=result.length;length--;)result[length][2]=isStrictComparable(result[length][1]);return result}function getNative(object,key){var value=null==object?undefined:object[key];return isNative(value)?value:undefined}function getView(start,end,transforms){for(var index=-1,length=transforms.length;++index<length;){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size)}}return{start:start,end:end}}function initCloneArray(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}function initCloneObject(object){var Ctor=object.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor||(Ctor=Object),new Ctor}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return bufferClone(object);case boolTag:case dateTag:return new Ctor(+object);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:var buffer=object.buffer;return new Ctor(isDeep?bufferClone(buffer):buffer,object.byteOffset,object.length);case numberTag:case stringTag:return new Ctor(object);case regexpTag:var result=new Ctor(object.source,reFlags.exec(object));result.lastIndex=object.lastIndex}return result}function invokePath(object,path,args){null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),path=last(path));var func=null==object?object:object[path];return null==func?undefined:func.apply(object,args)}function isArrayLike(value){return null!=value&&isLength(getLength(value))}function isIndex(value,length){return value="number"==typeof value||reIsUint.test(value)?+value:-1,length=null==length?MAX_SAFE_INTEGER:length,value>-1&&value%1==0&&length>value}function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;if("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object){var other=object[index];return value===value?value===other:other!==other}return!1}function isKey(value,object){var type=typeof value;if("string"==type&&reIsPlainProp.test(value)||"number"==type)return!0;if(isArray(value))return!1;var result=!reIsDeepProp.test(value);return result||null!=object&&value in toObject(object)}function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if("function"!=typeof other||!(funcName in LazyWrapper.prototype))return!1;if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&MAX_SAFE_INTEGER>=value}function isStrictComparable(value){return value===value&&!isObject(value)}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=ARY_FLAG>newBitmask,isCombo=srcBitmask==ARY_FLAG&&bitmask==CURRY_FLAG||srcBitmask==ARY_FLAG&&bitmask==REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(ARY_FLAG|REARG_FLAG)&&bitmask==CURRY_FLAG;if(!isCommon&&!isCombo)return data;srcBitmask&BIND_FLAG&&(data[2]=source[2],newBitmask|=bitmask&BIND_FLAG?0:CURRY_BOUND_FLAG);var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):arrayCopy(value),data[4]=partials?replaceHolders(data[3],PLACEHOLDER):arrayCopy(source[4])}return value=source[5],value&&(partials=data[5],data[5]=partials?composeArgsRight(partials,value,source[6]):arrayCopy(value),data[6]=partials?replaceHolders(data[5],PLACEHOLDER):arrayCopy(source[6])),value=source[7],value&&(data[7]=arrayCopy(value)),srcBitmask&ARY_FLAG&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask,data}function mergeDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:merge(objectValue,sourceValue,mergeDefaults)}function pickByArray(object,props){object=toObject(object);for(var index=-1,length=props.length,result={};++index<length;){var key=props[index];key in object&&(result[key]=object[key])}return result}function pickByCallback(object,predicate){var result={};return baseForIn(object,function(value,key,object){predicate(value,key,object)&&(result[key]=value)}),result}function reorder(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=arrayCopy(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}function shimKeys(object){for(var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length,allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object)),index=-1,result=[];++index<propsLength;){var key=props[index];(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key))&&result.push(key)}return result}function toIterable(value){return null==value?[]:isArrayLike(value)?isObject(value)?value:Object(value):values(value)}function toObject(value){return isObject(value)?value:Object(value)}function toPath(value){if(isArray(value))return value;var result=[];return baseToString(value).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)}),result}function wrapperClone(wrapper){return wrapper instanceof LazyWrapper?wrapper.clone():new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__,arrayCopy(wrapper.__actions__))}function chunk(array,size,guard){size=(guard?isIterateeCall(array,size,guard):null==size)?1:nativeMax(nativeFloor(size)||1,1);for(var index=0,length=array?array.length:0,resIndex=-1,result=Array(nativeCeil(length/size));length>index;)result[++resIndex]=baseSlice(array,index,index+=size);return result}function compact(array){for(var index=-1,length=array?array.length:0,resIndex=-1,result=[];++index<length;){var value=array[index];value&&(result[++resIndex]=value)}return result}function drop(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,0>n?0:n)):[]}function dropRight(array,n,guard){var length=array?array.length:0;
return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,0,0>n?0:n)):[]}function dropRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0,!0):[]}function dropWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0):[]}function fill(array,value,start,end){var length=array?array.length:0;return length?(start&&"number"!=typeof start&&isIterateeCall(array,value,start)&&(start=0,end=length),baseFill(array,value,start,end)):[]}function first(array){return array?array[0]:undefined}function flatten(array,isDeep,guard){var length=array?array.length:0;return guard&&isIterateeCall(array,isDeep,guard)&&(isDeep=!1),length?baseFlatten(array,isDeep):[]}function flattenDeep(array){var length=array?array.length:0;return length?baseFlatten(array,!0):[]}function indexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;if("number"==typeof fromIndex)fromIndex=0>fromIndex?nativeMax(length+fromIndex,0):fromIndex;else if(fromIndex){var index=binaryIndex(array,value);return length>index&&(value===value?value===array[index]:array[index]!==array[index])?index:-1}return baseIndexOf(array,value,fromIndex||0)}function initial(array){return dropRight(array,1)}function last(array){var length=array?array.length:0;return length?array[length-1]:undefined}function lastIndexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;var index=length;if("number"==typeof fromIndex)index=(0>fromIndex?nativeMax(length+fromIndex,0):nativeMin(fromIndex||0,length-1))+1;else if(fromIndex){index=binaryIndex(array,value,!0)-1;var other=array[index];return(value===value?value===other:other!==other)?index:-1}if(value!==value)return indexOfNaN(array,index,!0);for(;index--;)if(array[index]===value)return index;return-1}function pull(){var args=arguments,array=args[0];if(!array||!array.length)return array;for(var index=0,indexOf=getIndexOf(),length=args.length;++index<length;)for(var fromIndex=0,value=args[index];(fromIndex=indexOf(array,value,fromIndex))>-1;)splice.call(array,fromIndex,1);return array}function remove(array,predicate,thisArg){var result=[];if(!array||!array.length)return result;var index=-1,indexes=[],length=array.length;for(predicate=getCallback(predicate,thisArg,3);++index<length;){var value=array[index];predicate(value,index,array)&&(result.push(value),indexes.push(index))}return basePullAt(array,indexes),result}function rest(array){return drop(array,1)}function slice(array,start,end){var length=array?array.length:0;return length?(end&&"number"!=typeof end&&isIterateeCall(array,start,end)&&(start=0,end=length),baseSlice(array,start,end)):[]}function take(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,0,0>n?0:n)):[]}function takeRight(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,0>n?0:n)):[]}function takeRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!1,!0):[]}function takeWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3)):[]}function uniq(array,isSorted,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];null!=isSorted&&"boolean"!=typeof isSorted&&(thisArg=iteratee,iteratee=isIterateeCall(array,isSorted,thisArg)?undefined:isSorted,isSorted=!1);var callback=getCallback();return(null!=iteratee||callback!==baseCallback)&&(iteratee=callback(iteratee,thisArg,3)),isSorted&&getIndexOf()===baseIndexOf?sortedUniq(array,iteratee):baseUniq(array,iteratee)}function unzip(array){if(!array||!array.length)return[];var index=-1,length=0;array=arrayFilter(array,function(group){return isArrayLike(group)?(length=nativeMax(group.length,length),!0):void 0});for(var result=Array(length);++index<length;)result[index]=arrayMap(array,baseProperty(index));return result}function unzipWith(array,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];var result=unzip(array);return null==iteratee?result:(iteratee=bindCallback(iteratee,thisArg,4),arrayMap(result,function(group){return arrayReduce(group,iteratee,undefined,!0)}))}function xor(){for(var index=-1,length=arguments.length;++index<length;){var array=arguments[index];if(isArrayLike(array))var result=result?arrayPush(baseDifference(result,array),baseDifference(array,result)):array}return result?baseUniq(result):[]}function zipObject(props,values){var index=-1,length=props?props.length:0,result={};for(!length||values||isArray(props[0])||(values=[]);++index<length;){var key=props[index];values?result[key]=values[index]:key&&(result[key[0]]=key[1])}return result}function chain(value){var result=lodash(value);return result.__chain__=!0,result}function tap(value,interceptor,thisArg){return interceptor.call(thisArg,value),value}function thru(value,interceptor,thisArg){return interceptor.call(thisArg,value)}function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperPlant(value){for(var result,parent=this;parent instanceof baseLodash;){var clone=wrapperClone(parent);result?previous.__wrapped__=clone:result=clone;var previous=clone;parent=parent.__wrapped__}return previous.__wrapped__=value,result}function wrapperReverse(){var value=this.__wrapped__,interceptor=function(value){return value.reverse()};if(value instanceof LazyWrapper){var wrapped=value;return this.__actions__.length&&(wrapped=new LazyWrapper(this)),wrapped=wrapped.reverse(),wrapped.__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(wrapped,this.__chain__)}return this.thru(interceptor)}function wrapperToString(){return this.value()+""}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function every(collection,predicate,thisArg){var func=isArray(collection)?arrayEvery:baseEvery;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),("function"!=typeof predicate||thisArg!==undefined)&&(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function filter(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,predicate)}function findWhere(collection,source){return find(collection,baseMatches(source))}function includes(collection,target,fromIndex,guard){var length=collection?getLength(collection):0;return isLength(length)||(collection=values(collection),length=collection.length),fromIndex="number"!=typeof fromIndex||guard&&isIterateeCall(target,fromIndex,guard)?0:0>fromIndex?nativeMax(length+fromIndex,0):fromIndex||0,"string"==typeof collection||!isArray(collection)&&isString(collection)?length>=fromIndex&&collection.indexOf(target,fromIndex)>-1:!!length&&getIndexOf(collection,target,fromIndex)>-1}function map(collection,iteratee,thisArg){var func=isArray(collection)?arrayMap:baseMap;return iteratee=getCallback(iteratee,thisArg,3),func(collection,iteratee)}function pluck(collection,path){return map(collection,property(path))}function reject(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,function(value,index,collection){return!predicate(value,index,collection)})}function sample(collection,n,guard){if(guard?isIterateeCall(collection,n,guard):null==n){collection=toIterable(collection);var length=collection.length;return length>0?collection[baseRandom(0,length-1)]:undefined}var index=-1,result=toArray(collection),length=result.length,lastIndex=length-1;for(n=nativeMin(0>n?0:+n||0,length);++index<n;){var rand=baseRandom(index,lastIndex),value=result[rand];result[rand]=result[index],result[index]=value}return result.length=n,result}function shuffle(collection){return sample(collection,POSITIVE_INFINITY)}function size(collection){var length=collection?getLength(collection):0;return isLength(length)?length:keys(collection).length}function some(collection,predicate,thisArg){var func=isArray(collection)?arraySome:baseSome;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),("function"!=typeof predicate||thisArg!==undefined)&&(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function sortBy(collection,iteratee,thisArg){if(null==collection)return[];thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined);var index=-1;iteratee=getCallback(iteratee,thisArg,3);var result=baseMap(collection,function(value,key,collection){return{criteria:iteratee(value,key,collection),index:++index,value:value}});return baseSortBy(result,compareAscending)}function sortByOrder(collection,iteratees,orders,guard){return null==collection?[]:(guard&&isIterateeCall(iteratees,orders,guard)&&(orders=undefined),isArray(iteratees)||(iteratees=null==iteratees?[]:[iteratees]),isArray(orders)||(orders=null==orders?[]:[orders]),baseSortByOrder(collection,iteratees,orders))}function where(collection,source){return filter(collection,baseMatches(source))}function after(n,func){if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return n=nativeIsFinite(n=+n)?n:0,function(){return--n<1?func.apply(this,arguments):void 0}}function ary(func,n,guard){return guard&&isIterateeCall(func,n,guard)&&(n=undefined),n=func&&null==n?func.length:nativeMax(+n||0,0),createWrapper(func,ARY_FLAG,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return function(){return--n>0&&(result=func.apply(this,arguments)),1>=n&&(func=undefined),result}}function debounce(func,wait,options){function cancel(){timeoutId&&clearTimeout(timeoutId),maxTimeoutId&&clearTimeout(maxTimeoutId),lastCalled=0,maxTimeoutId=timeoutId=trailingCall=undefined}function complete(isCalled,id){id&&clearTimeout(id),maxTimeoutId=timeoutId=trailingCall=undefined,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=undefined))}function delayed(){var remaining=wait-(now()-stamp);0>=remaining||remaining>wait?complete(trailingCall,maxTimeoutId):timeoutId=setTimeout(delayed,remaining)}function maxDelayed(){complete(trailing,timeoutId)}function debounced(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),maxWait===!1)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=0>=remaining||remaining>maxWait;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):timeoutId||wait===maxWait||(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),!isCalled||timeoutId||maxTimeoutId||(args=thisArg=undefined),result}var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(wait=0>wait?0:+wait||0,options===!0){var leading=!0;trailing=!1}else isObject(options)&&(leading=!!options.leading,maxWait="maxWait"in options&&nativeMax(+options.maxWait||0,wait),trailing="trailing"in options?!!options.trailing:trailing);return debounced.cancel=cancel,debounced}function memoize(func,resolver){if("function"!=typeof func||resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result),result};return memoized.cache=new memoize.Cache,memoized}function negate(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){return!predicate.apply(this,arguments)}}function once(func){return before(2,func)}function restParam(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=nativeMax(start===undefined?func.length-1:+start||0,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);++index<length;)rest[index]=args[start+index];switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest)}var otherArgs=Array(start+1);for(index=-1;++index<start;)otherArgs[index]=args[index];return otherArgs[start]=rest,func.apply(this,otherArgs)}}function spread(func){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return function(array){return func.apply(this,array)}}function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return options===!1?leading=!1:isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:+wait,trailing:trailing})}function wrap(value,wrapper){return wrapper=null==wrapper?identity:wrapper,createWrapper(wrapper,PARTIAL_FLAG,undefined,[value],[])}function clone(value,isDeep,customizer,thisArg){return isDeep&&"boolean"!=typeof isDeep&&isIterateeCall(value,isDeep,customizer)?isDeep=!1:"function"==typeof isDeep&&(thisArg=customizer,customizer=isDeep,isDeep=!1),"function"==typeof customizer?baseClone(value,isDeep,bindCallback(customizer,thisArg,3)):baseClone(value,isDeep)}function cloneDeep(value,customizer,thisArg){return"function"==typeof customizer?baseClone(value,!0,bindCallback(customizer,thisArg,3)):baseClone(value,!0)}function gt(value,other){return value>other}function gte(value,other){return value>=other}function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")}function isBoolean(value){return value===!0||value===!1||isObjectLike(value)&&objToString.call(value)==boolTag}function isDate(value){return isObjectLike(value)&&objToString.call(value)==dateTag}function isElement(value){return!!value&&1===value.nodeType&&isObjectLike(value)&&!isPlainObject(value)}function isEmpty(value){return null==value?!0:isArrayLike(value)&&(isArray(value)||isString(value)||isArguments(value)||isObjectLike(value)&&isFunction(value.splice))?!value.length:!keys(value).length}function isEqual(value,other,customizer,thisArg){customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,customizer):!!result}function isError(value){return isObjectLike(value)&&"string"==typeof value.message&&objToString.call(value)==errorTag}function isFinite(value){return"number"==typeof value&&nativeIsFinite(value)}function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isMatch(object,source,customizer,thisArg){return customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined,baseIsMatch(object,getMatchData(source),customizer)}function isNaN(value){return isNumber(value)&&value!=+value}function isNative(value){return null==value?!1:isFunction(value)?reIsNative.test(fnToString.call(value)):isObjectLike(value)&&reIsHostCtor.test(value)}function isNull(value){return null===value}function isNumber(value){return"number"==typeof value||isObjectLike(value)&&objToString.call(value)==numberTag}function isPlainObject(value){var Ctor;if(!isObjectLike(value)||objToString.call(value)!=objectTag||isArguments(value)||!hasOwnProperty.call(value,"constructor")&&(Ctor=value.constructor,"function"==typeof Ctor&&!(Ctor instanceof Ctor)))return!1;var result;return baseForIn(value,function(subValue,key){result=key}),result===undefined||hasOwnProperty.call(value,result)}function isRegExp(value){return isObject(value)&&objToString.call(value)==regexpTag}function isString(value){return"string"==typeof value||isObjectLike(value)&&objToString.call(value)==stringTag}function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)]}function isUndefined(value){return value===undefined}function lt(value,other){return other>value}function lte(value,other){return other>=value}function toArray(value){var length=value?getLength(value):0;return isLength(length)?length?arrayCopy(value):[]:values(value)}function toPlainObject(value){return baseCopy(value,keysIn(value))}function create(prototype,properties,guard){var result=baseCreate(prototype);return guard&&isIterateeCall(prototype,properties,guard)&&(properties=undefined),properties?baseAssign(result,properties):result}function functions(object){return baseFunctions(object,keysIn(object))}function get(object,path,defaultValue){var result=null==object?undefined:baseGet(object,toPath(path),path+"");return result===undefined?defaultValue:result}function has(object,path){if(null==object)return!1;var result=hasOwnProperty.call(object,path);if(!result&&!isKey(path)){if(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;path=last(path),result=hasOwnProperty.call(object,path)}return result||isLength(object.length)&&isIndex(path,object.length)&&(isArray(object)||isArguments(object))}function invert(object,multiValue,guard){guard&&isIterateeCall(object,multiValue,guard)&&(multiValue=undefined);for(var index=-1,props=keys(object),length=props.length,result={};++index<length;){var key=props[index],value=object[key];multiValue?hasOwnProperty.call(result,value)?result[value].push(key):result[value]=[key]:result[value]=key}return result}function keysIn(object){if(null==object)return[];isObject(object)||(object=Object(object));var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object))&&length||0;for(var Ctor=object.constructor,index=-1,isProto="function"==typeof Ctor&&Ctor.prototype===object,result=Array(length),skipIndexes=length>0;++index<length;)result[index]=index+"";for(var key in object)skipIndexes&&isIndex(key,length)||"constructor"==key&&(isProto||!hasOwnProperty.call(object,key))||result.push(key);return result}function pairs(object){object=toObject(object);for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;){var key=props[index];result[index]=[key,object[key]]}return result}function result(object,path,defaultValue){var result=null==object?undefined:object[path];return result===undefined&&(null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),result=null==object?undefined:object[last(path)]),result=result===undefined?defaultValue:result),isFunction(result)?result.call(object):result}function set(object,path,value){if(null==object)return object;var pathKey=path+"";path=null!=object[pathKey]||isKey(path,object)?[pathKey]:toPath(path);for(var index=-1,length=path.length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=path[index];isObject(nested)&&(index==lastIndex?nested[key]=value:null==nested[key]&&(nested[key]=isIndex(path[index+1])?[]:{})),nested=nested[key]}return object}function transform(object,iteratee,accumulator,thisArg){var isArr=isArray(object)||isTypedArray(object);if(iteratee=getCallback(iteratee,thisArg,4),null==accumulator)if(isArr||isObject(object)){var Ctor=object.constructor;accumulator=isArr?isArray(object)?new Ctor:[]:baseCreate(isFunction(Ctor)?Ctor.prototype:undefined)}else accumulator={};return(isArr?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator}function values(object){return baseValues(object,keys(object))}function valuesIn(object){return baseValues(object,keysIn(object))}function inRange(value,start,end){return start=+start||0,end===undefined?(end=start,start=0):end=+end||0,value>=nativeMin(start,end)&&value<nativeMax(start,end)}function random(min,max,floating){floating&&isIterateeCall(min,max,floating)&&(max=floating=undefined);var noMin=null==min,noMax=null==max;if(null==floating&&(noMax&&"boolean"==typeof min?(floating=min,min=1):"boolean"==typeof max&&(floating=max,noMax=!0)),noMin&&noMax&&(max=1,noMax=!1),min=+min||0,noMax?(max=min,min=0):max=+max||0,floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max)}return baseRandom(min,max)}function capitalize(string){return string=baseToString(string),string&&string.charAt(0).toUpperCase()+string.slice(1)}function deburr(string){return string=baseToString(string),string&&string.replace(reLatin1,deburrLetter).replace(reComboMark,"")}function endsWith(string,target,position){string=baseToString(string),target+="";var length=string.length;return position=position===undefined?length:nativeMin(0>position?0:+position||0,length),position-=target.length,position>=0&&string.indexOf(target,position)==position}function escape(string){return string=baseToString(string),string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string}function escapeRegExp(string){return string=baseToString(string),string&&reHasRegExpChars.test(string)?string.replace(reRegExpChars,escapeRegExpChar):string||"(?:)"}function pad(string,length,chars){string=baseToString(string),length=+length;var strLength=string.length;if(strLength>=length||!nativeIsFinite(length))return string;var mid=(length-strLength)/2,leftLength=nativeFloor(mid),rightLength=nativeCeil(mid);return chars=createPadding("",rightLength,chars),chars.slice(0,leftLength)+string+chars}function parseInt(string,radix,guard){return(guard?isIterateeCall(string,radix,guard):null==radix)?radix=0:radix&&(radix=+radix),string=trim(string),nativeParseInt(string,radix||(reHasHexPrefix.test(string)?16:10))}function repeat(string,n){var result="";if(string=baseToString(string),n=+n,1>n||!string||!nativeIsFinite(n))return result;do n%2&&(result+=string),n=nativeFloor(n/2),string+=string;while(n);return result}function startsWith(string,target,position){return string=baseToString(string),position=null==position?0:nativeMin(0>position?0:+position||0,string.length),string.lastIndexOf(target,position)==position}function template(string,options,otherOptions){var settings=lodash.templateSettings;otherOptions&&isIterateeCall(string,options,otherOptions)&&(options=otherOptions=undefined),string=baseToString(string),options=assignWith(baseAssign({},otherOptions||options),settings,assignOwnDefaults);var isEscaping,isEvaluating,imports=assignWith(baseAssign({},options.imports),settings.imports,assignOwnDefaults),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g"),sourceURL="//# sourceURL="+("sourceURL"in options?options.sourceURL:"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(isEscaping=!0,source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable;variable||(source="with (obj) {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)});if(result.source=source,isError(result))throw result;return result}function trim(string,chars,guard){var value=string;return(string=baseToString(string))?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string),trimmedRightIndex(string)+1):(chars+="",string.slice(charsLeftIndex(string,chars),charsRightIndex(string,chars)+1)):string}function trimLeft(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string)):string.slice(charsLeftIndex(string,chars+"")):string}function trimRight(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(0,trimmedRightIndex(string)+1):string.slice(0,charsRightIndex(string,chars+"")+1):string}function trunc(string,options,guard){guard&&isIterateeCall(string,options,guard)&&(options=undefined);var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(null!=options)if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?+options.length||0:length,omission="omission"in options?baseToString(options.omission):omission}else length=+options||0;if(string=baseToString(string),length>=string.length)return string;var end=length-omission.length;if(1>end)return omission;var result=string.slice(0,end);if(null==separator)return result+omission;if(isRegExp(separator)){if(string.slice(end).search(separator)){var match,newEnd,substring=string.slice(0,end);for(separator.global||(separator=RegExp(separator.source,(reFlags.exec(separator)||"")+"g")),separator.lastIndex=0;match=separator.exec(substring);)newEnd=match.index;result=result.slice(0,null==newEnd?end:newEnd)}}else if(string.indexOf(separator,end)!=end){var index=result.lastIndexOf(separator);index>-1&&(result=result.slice(0,index))}return result+omission}function unescape(string){return string=baseToString(string),string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}function words(string,pattern,guard){return guard&&isIterateeCall(string,pattern,guard)&&(pattern=undefined),string=baseToString(string),string.match(pattern||reWords)||[]}function callback(func,thisArg,guard){return guard&&isIterateeCall(func,thisArg,guard)&&(thisArg=undefined),isObjectLike(func)?matches(func):baseCallback(func,thisArg)}function constant(value){return function(){return value}}function identity(value){return value}function matches(source){return baseMatches(baseClone(source,!0))}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,!0))}function mixin(object,source,options){if(null==options){var isObj=isObject(source),props=isObj?keys(source):undefined,methodNames=props&&props.length?baseFunctions(source,props):undefined;(methodNames?methodNames.length:isObj)||(methodNames=!1,options=source,source=object,object=this)}methodNames||(methodNames=baseFunctions(source,keys(source)));var chain=!0,index=-1,isFunc=isFunction(object),length=methodNames.length;options===!1?chain=!1:isObject(options)&&"chain"in options&&(chain=options.chain);for(;++index<length;){var methodName=methodNames[index],func=source[methodName];object[methodName]=func,isFunc&&(object.prototype[methodName]=function(func){return function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=arrayCopy(this.__actions__);return actions.push({func:func,args:arguments,thisArg:object}),result.__chain__=chainAll,result}return func.apply(object,arrayPush([this.value()],arguments))}}(func))}return object}function noConflict(){return root._=oldDash,this}function noop(){}function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path)}function propertyOf(object){return function(path){return baseGet(object,toPath(path),path+"")}}function range(start,end,step){step&&isIterateeCall(start,end,step)&&(end=step=undefined),start=+start||0,step=null==step?1:+step||0,null==end?(end=start,start=0):end=+end||0;for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);++index<length;)result[index]=start,start+=step;return result}function times(n,iteratee,thisArg){if(n=nativeFloor(n),1>n||!nativeIsFinite(n))return[];var index=-1,result=Array(nativeMin(n,MAX_ARRAY_LENGTH));for(iteratee=bindCallback(iteratee,thisArg,1);++index<n;)MAX_ARRAY_LENGTH>index?result[index]=iteratee(index):iteratee(index);return result}function uniqueId(prefix){var id=++idCounter;return baseToString(prefix)+id}function add(augend,addend){return(+augend||0)+(+addend||0)}function sum(collection,iteratee,thisArg){return thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length?arraySum(isArray(collection)?collection:toIterable(collection),iteratee):baseSum(collection,iteratee)}context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;{var Array=context.Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayProto=Array.prototype,objectProto=Object.prototype,stringProto=String.prototype,fnToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,idCounter=0,objToString=objectProto.toString,oldDash=root._,reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ArrayBuffer=context.ArrayBuffer,clearTimeout=context.clearTimeout,parseFloat=context.parseFloat,pow=Math.pow,propertyIsEnumerable=objectProto.propertyIsEnumerable,Set=getNative(context,"Set"),setTimeout=context.setTimeout,splice=arrayProto.splice,Uint8Array=context.Uint8Array,WeakMap=getNative(context,"WeakMap"),nativeCeil=Math.ceil,nativeCreate=getNative(Object,"create"),nativeFloor=Math.floor,nativeIsArray=getNative(Array,"isArray"),nativeIsFinite=context.isFinite,nativeKeys=getNative(Object,"keys"),nativeMax=Math.max,nativeMin=Math.min,nativeNow=getNative(Date,"now"),nativeParseInt=context.parseInt,nativeRandom=Math.random,NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,POSITIVE_INFINITY=Number.POSITIVE_INFINITY,MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH>>>1,MAX_SAFE_INTEGER=9007199254740991,metaMap=WeakMap&&new WeakMap,realNames={};lodash.support={}}lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var baseCreate=function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype=prototype;var result=new object;object.prototype=undefined}return result||{}}}(),baseEach=createBaseEach(baseForOwn),baseEachRight=createBaseEach(baseForOwnRight,!0),baseFor=createBaseFor(),baseForRight=createBaseFor(!0),baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity,getData=metaMap?function(func){return metaMap.get(func)}:noop,getLength=baseProperty("length"),setData=function(){var count=0,lastCalled=0;return function(key,value){var stamp=now(),remaining=HOT_SPAN-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=HOT_COUNT)return key}else count=0;return baseSetData(key,value)}}(),difference=restParam(function(array,values){return isObjectLike(array)&&isArrayLike(array)?baseDifference(array,baseFlatten(values,!1,!0)):[]}),findIndex=createFindIndex(),findLastIndex=createFindIndex(!0),intersection=restParam(function(arrays){for(var othLength=arrays.length,othIndex=othLength,caches=Array(length),indexOf=getIndexOf(),isCommon=indexOf===baseIndexOf,result=[];othIndex--;){var value=arrays[othIndex]=isArrayLike(value=arrays[othIndex])?value:[];
caches[othIndex]=isCommon&&value.length>=120?createCache(othIndex&&value):null}var array=arrays[0],index=-1,length=array?array.length:0,seen=caches[0];outer:for(;++index<length;)if(value=array[index],(seen?cacheIndexOf(seen,value):indexOf(result,value,0))<0){for(var othIndex=othLength;--othIndex;){var cache=caches[othIndex];if((cache?cacheIndexOf(cache,value):indexOf(arrays[othIndex],value,0))<0)continue outer}seen&&seen.push(value),result.push(value)}return result}),pullAt=restParam(function(array,indexes){indexes=baseFlatten(indexes);var result=baseAt(array,indexes);return basePullAt(array,indexes.sort(baseCompareAscending)),result}),sortedIndex=createSortedIndex(),sortedLastIndex=createSortedIndex(!0),union=restParam(function(arrays){return baseUniq(baseFlatten(arrays,!1,!0))}),without=restParam(function(array,values){return isArrayLike(array)?baseDifference(array,values):[]}),zip=restParam(unzip),zipWith=restParam(function(arrays){var length=arrays.length,iteratee=length>2?arrays[length-2]:undefined,thisArg=length>1?arrays[length-1]:undefined;return length>2&&"function"==typeof iteratee?length-=2:(iteratee=length>1&&"function"==typeof thisArg?(--length,thisArg):undefined,thisArg=undefined),arrays.length=length,unzipWith(arrays,iteratee,thisArg)}),wrapperConcat=restParam(function(values){return values=baseFlatten(values),this.thru(function(array){return arrayConcat(isArray(array)?array:[toObject(array)],values)})}),at=restParam(function(collection,props){return baseAt(collection,baseFlatten(props))}),countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:result[key]=1}),find=createFind(baseEach),findLast=createFind(baseEachRight,!0),forEach=createForEach(arrayEach,baseEach),forEachRight=createForEach(arrayEachRight,baseEachRight),groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):result[key]=[value]}),indexBy=createAggregator(function(result,value,key){result[key]=value}),invoke=restParam(function(collection,path,args){var index=-1,isFunc="function"==typeof path,isProp=isKey(path),result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value){var func=isFunc?path:isProp&&null!=value?value[path]:undefined;result[++index]=func?func.apply(value,args):invokePath(value,path,args)}),result}),partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]}),reduce=createReduce(arrayReduce,baseEach),reduceRight=createReduce(arrayReduceRight,baseEachRight),sortByAll=restParam(function(collection,iteratees){if(null==collection)return[];var guard=iteratees[2];return guard&&isIterateeCall(iteratees[0],iteratees[1],guard)&&(iteratees.length=1),baseSortByOrder(collection,baseFlatten(iteratees),[])}),now=nativeNow||function(){return(new Date).getTime()},bind=restParam(function(func,thisArg,partials){var bitmask=BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,bind.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(func,bitmask,thisArg,partials,holders)}),bindAll=restParam(function(object,methodNames){methodNames=methodNames.length?baseFlatten(methodNames):functions(object);for(var index=-1,length=methodNames.length;++index<length;){var key=methodNames[index];object[key]=createWrapper(object[key],BIND_FLAG,object)}return object}),bindKey=restParam(function(object,key,partials){var bitmask=BIND_FLAG|BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,bindKey.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(key,bitmask,object,partials,holders)}),curry=createCurry(CURRY_FLAG),curryRight=createCurry(CURRY_RIGHT_FLAG),defer=restParam(function(func,args){return baseDelay(func,1,args)}),delay=restParam(function(func,wait,args){return baseDelay(func,wait,args)}),flow=createFlow(),flowRight=createFlow(!0),modArgs=restParam(function(func,transforms){if(transforms=baseFlatten(transforms),"function"!=typeof func||!arrayEvery(transforms,baseIsFunction))throw new TypeError(FUNC_ERROR_TEXT);var length=transforms.length;return restParam(function(args){for(var index=nativeMin(args.length,length);index--;)args[index]=transforms[index](args[index]);return func.apply(this,args)})}),partial=createPartial(PARTIAL_FLAG),partialRight=createPartial(PARTIAL_RIGHT_FLAG),rearg=restParam(function(func,indexes){return createWrapper(func,REARG_FLAG,undefined,undefined,undefined,baseFlatten(indexes))}),isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&objToString.call(value)==arrayTag},merge=createAssigner(baseMerge),assign=createAssigner(function(object,source,customizer){return customizer?assignWith(object,source,customizer):baseAssign(object,source)}),defaults=createDefaults(assign,assignDefaults),defaultsDeep=createDefaults(merge,mergeDefaults),findKey=createFindKey(baseForOwn),findLastKey=createFindKey(baseForOwnRight),forIn=createForIn(baseFor),forInRight=createForIn(baseForRight),forOwn=createForOwn(baseForOwn),forOwnRight=createForOwn(baseForOwnRight),keys=nativeKeys?function(object){var Ctor=null==object?undefined:object.constructor;return"function"==typeof Ctor&&Ctor.prototype===object||"function"!=typeof object&&isArrayLike(object)?shimKeys(object):isObject(object)?nativeKeys(object):[]}:shimKeys,mapKeys=createObjectMapper(!0),mapValues=createObjectMapper(),omit=restParam(function(object,props){if(null==object)return{};if("function"!=typeof props[0]){var props=arrayMap(baseFlatten(props),String);return pickByArray(object,baseDifference(keysIn(object),props))}var predicate=bindCallback(props[0],props[1],3);return pickByCallback(object,function(value,key,object){return!predicate(value,key,object)})}),pick=restParam(function(object,props){return null==object?{}:"function"==typeof props[0]?pickByCallback(object,bindCallback(props[0],props[1],3)):pickByArray(object,baseFlatten(props))}),camelCase=createCompounder(function(result,word,index){return word=word.toLowerCase(),result+(index?word.charAt(0).toUpperCase()+word.slice(1):word)}),kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}),padLeft=createPadDir(),padRight=createPadDir(!0),snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()}),startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+(word.charAt(0).toUpperCase()+word.slice(1))}),attempt=restParam(function(func,args){try{return func.apply(undefined,args)}catch(e){return isError(e)?e:new Error(e)}}),method=restParam(function(path,args){return function(object){return invokePath(object,path,args)}}),methodOf=restParam(function(object,args){return function(path){return invokePath(object,path,args)}}),ceil=createRound("ceil"),floor=createRound("floor"),max=createExtremum(gt,NEGATIVE_INFINITY),min=createExtremum(lt,POSITIVE_INFINITY),round=createRound("round");return lodash.prototype=baseLodash.prototype,LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,MapCache.prototype["delete"]=mapDelete,MapCache.prototype.get=mapGet,MapCache.prototype.has=mapHas,MapCache.prototype.set=mapSet,SetCache.prototype.push=cachePush,memoize.Cache=MapCache,lodash.after=after,lodash.ary=ary,lodash.assign=assign,lodash.at=at,lodash.before=before,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.callback=callback,lodash.chain=chain,lodash.chunk=chunk,lodash.compact=compact,lodash.constant=constant,lodash.countBy=countBy,lodash.create=create,lodash.curry=curry,lodash.curryRight=curryRight,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defaultsDeep=defaultsDeep,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.drop=drop,lodash.dropRight=dropRight,lodash.dropRightWhile=dropRightWhile,lodash.dropWhile=dropWhile,lodash.fill=fill,lodash.filter=filter,lodash.flatten=flatten,lodash.flattenDeep=flattenDeep,lodash.flow=flow,lodash.flowRight=flowRight,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=forIn,lodash.forInRight=forInRight,lodash.forOwn=forOwn,lodash.forOwnRight=forOwnRight,lodash.functions=functions,lodash.groupBy=groupBy,lodash.indexBy=indexBy,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=invoke,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=mapKeys,lodash.mapValues=mapValues,lodash.matches=matches,lodash.matchesProperty=matchesProperty,lodash.memoize=memoize,lodash.merge=merge,lodash.method=method,lodash.methodOf=methodOf,lodash.mixin=mixin,lodash.modArgs=modArgs,lodash.negate=negate,lodash.omit=omit,lodash.once=once,lodash.pairs=pairs,lodash.partial=partial,lodash.partialRight=partialRight,lodash.partition=partition,lodash.pick=pick,lodash.pluck=pluck,lodash.property=property,lodash.propertyOf=propertyOf,lodash.pull=pull,lodash.pullAt=pullAt,lodash.range=range,lodash.rearg=rearg,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.restParam=restParam,lodash.set=set,lodash.shuffle=shuffle,lodash.slice=slice,lodash.sortBy=sortBy,lodash.sortByAll=sortByAll,lodash.sortByOrder=sortByOrder,lodash.spread=spread,lodash.take=take,lodash.takeRight=takeRight,lodash.takeRightWhile=takeRightWhile,lodash.takeWhile=takeWhile,lodash.tap=tap,lodash.throttle=throttle,lodash.thru=thru,lodash.times=times,lodash.toArray=toArray,lodash.toPlainObject=toPlainObject,lodash.transform=transform,lodash.union=union,lodash.uniq=uniq,lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.values=values,lodash.valuesIn=valuesIn,lodash.where=where,lodash.without=without,lodash.wrap=wrap,lodash.xor=xor,lodash.zip=zip,lodash.zipObject=zipObject,lodash.zipWith=zipWith,lodash.backflow=flowRight,lodash.collect=map,lodash.compose=flowRight,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.extend=assign,lodash.iteratee=callback,lodash.methods=functions,lodash.object=zipObject,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,mixin(lodash,lodash),lodash.add=add,lodash.attempt=attempt,lodash.camelCase=camelCase,lodash.capitalize=capitalize,lodash.ceil=ceil,lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.deburr=deburr,lodash.endsWith=endsWith,lodash.escape=escape,lodash.escapeRegExp=escapeRegExp,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=findLastKey,lodash.findWhere=findWhere,lodash.first=first,lodash.floor=floor,lodash.get=get,lodash.gt=gt,lodash.gte=gte,lodash.has=has,lodash.identity=identity,lodash.includes=includes,lodash.indexOf=indexOf,lodash.inRange=inRange,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isError=isError,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isMatch=isMatch,lodash.isNaN=isNaN,lodash.isNative=isNative,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isTypedArray=isTypedArray,lodash.isUndefined=isUndefined,lodash.kebabCase=kebabCase,lodash.last=last,lodash.lastIndexOf=lastIndexOf,lodash.lt=lt,lodash.lte=lte,lodash.max=max,lodash.min=min,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=now,lodash.pad=pad,lodash.padLeft=padLeft,lodash.padRight=padRight,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.repeat=repeat,lodash.result=result,lodash.round=round,lodash.runInContext=runInContext,lodash.size=size,lodash.snakeCase=snakeCase,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.sortedLastIndex=sortedLastIndex,lodash.startCase=startCase,lodash.startsWith=startsWith,lodash.sum=sum,lodash.template=template,lodash.trim=trim,lodash.trimLeft=trimLeft,lodash.trimRight=trimRight,lodash.trunc=trunc,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.words=words,lodash.all=every,lodash.any=some,lodash.contains=includes,lodash.eq=isEqual,lodash.detect=find,lodash.foldl=reduce,lodash.foldr=reduceRight,lodash.head=first,lodash.include=includes,lodash.inject=reduce,mixin(lodash,function(){var source={};return baseForOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(source[methodName]=func)}),source}(),!1),lodash.sample=sample,lodash.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(value){return sample(value,n)}):sample(this.value())},lodash.VERSION=VERSION,arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash}),arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){var filtered=this.__filtered__;if(filtered&&!index)return new LazyWrapper(this);n=null==n?1:nativeMax(nativeFloor(n)||0,0);var result=this.clone();return filtered?result.__takeCount__=nativeMin(result.__takeCount__,n):result.__views__.push({size:n,type:methodName+(result.__dir__<0?"Right":"")}),result},LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}),arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=type!=LAZY_MAP_FLAG;LazyWrapper.prototype[methodName]=function(iteratee,thisArg){var result=this.clone();return result.__iteratees__.push({iteratee:getCallback(iteratee,thisArg,1),type:type}),result.__filtered__=result.__filtered__||isFilter,result}}),arrayEach(["first","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}),arrayEach(["initial","rest"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}),arrayEach(["pluck","where"],function(methodName,index){var operationName=index?"filter":"map",createCallback=index?baseMatches:property;LazyWrapper.prototype[methodName]=function(value){return this[operationName](createCallback(value))}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.reject=function(predicate,thisArg){return predicate=getCallback(predicate,thisArg,1),this.filter(function(value){return!predicate(value)})},LazyWrapper.prototype.slice=function(start,end){start=null==start?0:+start||0;var result=this;return result.__filtered__&&(start>0||0>end)?new LazyWrapper(result):(0>start?result=result.takeRight(-start):start&&(result=result.drop(start)),end!==undefined&&(end=+end||0,result=0>end?result.dropRight(-end):result.take(end-start)),result)},LazyWrapper.prototype.takeRightWhile=function(predicate,thisArg){return this.reverse().takeWhile(predicate,thisArg).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(POSITIVE_INFINITY)},baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|map|reject)|While$/.test(methodName),retUnwrapped=/^(?:first|last)$/.test(methodName),lodashFunc=lodash[retUnwrapped?"take"+("last"==methodName?"Right":""):methodName];lodashFunc&&(lodash.prototype[methodName]=function(){var args=retUnwrapped?[1]:arguments,chainAll=this.__chain__,value=this.__wrapped__,isHybrid=!!this.__actions__.length,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value);useLazy&&checkIteratee&&"function"==typeof iteratee&&1!=iteratee.length&&(isLazy=useLazy=!1);var interceptor=function(value){return retUnwrapped&&chainAll?lodashFunc(value,1)[0]:lodashFunc.apply(undefined,arrayPush([value],args))},action={func:thru,args:[interceptor],thisArg:undefined},onlyLazy=isLazy&&!isHybrid;if(retUnwrapped&&!chainAll)return onlyLazy?(value=value.clone(),value.__actions__.push(action),func.call(value)):lodashFunc.call(undefined,this.value())[0];if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);return result.__actions__.push(action),new LodashWrapper(result,chainAll)}return this.thru(interceptor)})}),arrayEach(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(methodName){var func=(/^(?:replace|split)$/.test(methodName)?stringProto:arrayProto)[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:join|pop|replace|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;return retUnwrapped&&!this.__chain__?func.apply(this.value(),args):this[chainName](function(value){return func.apply(value,args)})}}),baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name+"",names=realNames[key]||(realNames[key]=[]);names.push({name:methodName,func:lodashFunc})}}),realNames[createHybridWrapper(undefined,BIND_KEY_FLAG).name]=[{name:"wrapper",func:undefined}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash.prototype.chain=wrapperChain,lodash.prototype.commit=wrapperCommit,lodash.prototype.concat=wrapperConcat,lodash.prototype.plant=wrapperPlant,lodash.prototype.reverse=wrapperReverse,lodash.prototype.toString=wrapperToString,lodash.prototype.run=lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue,lodash.prototype.collect=lodash.prototype.map,lodash.prototype.head=lodash.prototype.first,lodash.prototype.select=lodash.prototype.filter,lodash.prototype.tail=lodash.prototype.rest,lodash}var undefined,VERSION="3.10.1",BIND_FLAG=1,BIND_KEY_FLAG=2,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,CURRY_RIGHT_FLAG=16,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,ARY_FLAG=128,REARG_FLAG=256,DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...",HOT_COUNT=150,HOT_SPAN=16,LARGE_ARRAY_SIZE=200,LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2,FUNC_ERROR_TEXT="Expected a function",PLACEHOLDER="__lodash_placeholder__",argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39|#96);/g,reUnescapedHtml=/[&<>"'`]/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source),reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,reRegExpChars=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,reHasRegExpChars=RegExp(reRegExpChars.source),reComboMark=/[\u0300-\u036f\ufe20-\ufe23]/g,reEscapeChar=/\\(\\)?/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reHasHexPrefix=/^0[xX]/,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsUint=/^\d+$/,reLatin1=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,reWords=function(){var upper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",lower="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(upper+"+(?="+upper+lower+")|"+upper+"?"+lower+"|"+upper+"+|[0-9]+","g")}(),contextProps=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],templateCounter=-1,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[stringTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[mapTag]=cloneableTags[setTag]=cloneableTags[weakMapTag]=!1;var deburredLetters={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss"},htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},objectTypes={"function":!0,object:!0},regexpEscapes={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,freeGlobal=freeExports&&freeModule&&"object"==typeof global&&global&&global.Object&&global,freeSelf=objectTypes[typeof self]&&self&&self.Object&&self,freeWindow=objectTypes[typeof window]&&window&&window.Object&&window,moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports,root=freeGlobal||freeWindow!==(this&&this.window)&&freeWindow||freeSelf||this,_=runInContext();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(root._=_,define(function(){return _})):freeExports&&freeModule?moduleExports?(freeModule.exports=_)._=_:freeExports._=_:root._=_}.call(this),/**
 * two.js
 * a two-dimensional drawing api meant for modern browsers. It is renderer 
 * agnostic enabling the same api for rendering in multiple contexts: webgl, 
 * canvas2d, and svg.
 *
 * Copyright (c) 2012 - 2013 jonobr1 / http://jonobr1.com
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 */
function(){var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?(this._wrapped=obj,void 0):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.5.1";var each=_.each=_.forEach=function(obj,iterator,context){if(null!=obj)if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,l=obj.length;l>i;i++)if(iterator.call(context,obj[i],i,obj)===breaker)return}else for(var key in obj)if(_.has(obj,key)&&iterator.call(context,obj[key],key,obj)===breaker)return};_.map=_.collect=function(obj,iterator,context){var results=[];return null==obj?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results)};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);if(each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}if(each(obj,function(value,index,list){index=keys?keys[--length]:--length,initial?memo=iterator.call(context,memo,obj[index],index,list):(memo=obj[index],initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.find=_.detect=function(obj,iterator,context){var result;return any(obj,function(value,index,list){return iterator.call(context,value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,iterator,context){var results=[];return null==obj?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(iterator,context):(each(obj,function(value,index,list){iterator.call(context,value,index,list)&&results.push(value)}),results)},_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return!iterator.call(context,value,index,list)},context)},_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=!0;return null==obj?result:nativeEvery&&obj.every===nativeEvery?obj.every(iterator,context):(each(obj,function(value,index,list){return(result=result&&iterator.call(context,value,index,list))?void 0:breaker}),!!result)};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=!1;return null==obj?result:nativeSome&&obj.some===nativeSome?obj.some(iterator,context):(each(obj,function(value,index,list){return result||(result=iterator.call(context,value,index,list))?breaker:void 0}),!!result)};_.contains=_.include=function(obj,target){return null==obj?!1:nativeIndexOf&&obj.indexOf===nativeIndexOf?-1!=obj.indexOf(target):any(obj,function(value){return value===target})},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})},_.where=function(obj,attrs,first){return _.isEmpty(attrs)?first?void 0:[]:_[first?"find":"filter"](obj,function(value){for(var key in attrs)if(attrs[key]!==value[key])return!1;return!0})},_.findWhere=function(obj,attrs){return _.where(obj,attrs,!0)},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.max.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return-1/0;var result={computed:-1/0,value:-1/0};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>result.computed&&(result={value:value,computed:computed})}),result.value},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.min.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return 1/0;var result={computed:1/0,value:1/0};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})}),result.value},_.shuffle=function(obj){var rand,index=0,shuffled=[];return each(obj,function(value){rand=_.random(index++),shuffled[index-1]=shuffled[rand],shuffled[rand]=value}),shuffled};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index<right.index?-1:1}),"value")};var group=function(obj,value,context,behavior){var result={},iterator=lookupIterator(null==value?_.identity:value);return each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)}),result};_.groupBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){(_.has(result,key)?result[key]:result[key]=[]).push(value)})},_.countBy=function(obj,value,context){return group(obj,value,context,function(result,key){_.has(result,key)||(result[key]=0),result[key]++})},_.sortedIndex=function(array,obj,iterator,context){iterator=null==iterator?_.identity:lookupIterator(iterator);for(var value=iterator.call(context,obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(null==n||guard?1:n))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){return shallow&&_.every(input,_.isArray)?concat.apply(output,input):(each(input,function(value){_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,output):output.push(value)}),output)};_.flatten=function(array,shallow){return flatten(array,shallow,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iterator,context){_.isFunction(isSorted)&&(context=iterator,iterator=isSorted,isSorted=!1);var initial=iterator?_.map(array,iterator,context):array,results=[],seen=[];return each(initial,function(value,index){(isSorted?index&&seen[seen.length-1]===value:_.contains(seen,value))||(seen.push(value),results.push(array[index]))}),results},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})},_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){for(var length=_.max(_.pluck(arguments,"length").concat(0)),results=new Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,""+i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,l=list.length;l>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,l=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,l+isSorted):isSorted}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;l>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var hasIndex=null!=from;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);for(var i=hasIndex?from:array.length;i--;)if(array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;for(var len=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(len);len>idx;)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}},_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)))}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(0===funcs.length)throw new Error("bindAll must be passed function names");return each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:new Date,timeout=null,result=func.apply(context,args)};return function(){var now=new Date;previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var result,timeout=null;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||(result=func.apply(context,args))},callNow=immediate&&!timeout;return clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&(result=func.apply(context,args)),result}},_.once=function(func){var memo,ran=!1;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments),func=null,memo)}},_.wrap=function(func,wrapper){return function(){var args=[func];return push.apply(args,arguments),wrapper.apply(this,args)}},_.compose=function(){var funcs=arguments;return function(){for(var args=arguments,i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){var values=[];for(var key in obj)_.has(obj,key)&&values.push(obj[key]);return values},_.pairs=function(obj){var pairs=[];for(var key in obj)_.has(obj,key)&&pairs.push([key,obj[key]]);return pairs},_.invert=function(obj){var result={};for(var key in obj)_.has(obj,key)&&(result[obj[key]]=key);return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));return each(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy},_.omit=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj)_.contains(keys,key)||(copy[key]=obj[key]);return copy},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]==a)return bStack[length]==b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor))return!1;aStack.push(a),bStack.push(b);var size=0,result=!0;if("[object Array]"==className){if(size=a.length,result=size==b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{for(var key in a)if(_.has(a,key)&&(size++,!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))))break;if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"==toString.call(obj)},_.isObject=function(obj){return obj===Object(obj)},each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return!(!obj||!_.has(obj,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"==toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.times=function(n,iterator,context){for(var accum=Array(Math.max(0,n)),i=0;n>i;i++)accum[i]=iterator.call(context,i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){return null==string?"":(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}}),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value},_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]}),escape&&(source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"),interpolate&&(source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"),evaluate&&(source+="';\n"+evaluate+"\n__p+='"),index=offset+match.length,match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};return template.source="function("+(settings.variable||"obj")+"){\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!=name&&"splice"!=name||0!==obj.length||delete obj[0],result.call(this,obj)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this);var Backbone=Backbone||{};!function(){var array=[],slice=array.slice,triggerEvents=function(obj,events,args){var ev,i=-1,l=events.length;switch(args.length){case 0:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx);return;case 1:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,args[0]);return;case 2:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,args[0],args[1]);return;case 3:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,args[0],args[1],args[2]);return;default:for(;++i<l;)(ev=events[i]).callback.apply(ev.ctx,args)}},Events=Backbone.Events={on:function(name,callback,context){this._events||(this._events={});var list=this._events[name]||(this._events[name]=[]);return list.push({callback:callback,context:context,ctx:context||this}),this},once:function(name,callback,context){var self=this,once=_.once(function(){self.off(name,once),callback.apply(this,arguments)});return once._callback=callback,this.on(name,once,context),this},off:function(name,callback,context){var list,ev,events,names,i,l,j,k;if(!this._events)return this;if(!name&&!callback&&!context)return this._events={},this;for(names=name?[name]:_.keys(this._events),i=0,l=names.length;l>i;i++)if(name=names[i],list=this._events[name]){if(events=[],callback||context)for(j=0,k=list.length;k>j;j++)ev=list[j],(callback&&callback!==(ev.callback._callback||ev.callback)||context&&context!==ev.context)&&events.push(ev);this._events[name]=events}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1),events=this._events[name],allEvents=this._events.all;return events&&triggerEvents(this,events,args),allEvents&&triggerEvents(this,allEvents,arguments),this},listenTo:function(object,events,callback){var listeners=this._listeners||(this._listeners={}),id=object._listenerId||(object._listenerId=_.uniqueId("l"));return listeners[id]=object,object.on(events,callback||this,this),this},stopListening:function(object,events,callback){var listeners=this._listeners;if(listeners){if(object)object.off(events,callback,this),events||callback||delete listeners[object._listenerId];else{for(var id in listeners)listeners[id].off(null,null,this);this._listeners={}}return this}}};Events.bind=Events.on,Events.unbind=Events.off,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=Events),exports.Backbone=exports.Backbone||Backbone)}(),function(){function raf(callback){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=root.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id}var root=this,lastTime=0,vendors=["ms","moz","webkit","o"];if("undefined"!=typeof exports)return"undefined"!=typeof module&&module.exports&&(exports=module.exports=raf),exports.requestAnimationFrame=raf,void 0;for(var x=0;x<vendors.length&&!root.requestAnimationFrame;++x)root.requestAnimationFrame=root[vendors[x]+"RequestAnimationFrame"],root.cancelAnimationFrame=root[vendors[x]+"CancelAnimationFrame"]||root[vendors[x]+"CancelRequestAnimationFrame"];root.requestAnimationFrame||(root.requestAnimationFrame=raf),root.cancelAnimationFrame||(root.cancelAnimationFrame=function(id){clearTimeout(id)})}(),function(){function fitToWindow(){var wr=document.body.getBoundingClientRect(),width=this.width=wr.width,height=this.height=wr.height;this.renderer.setSize(width,height,this.ratio),this.trigger(Two.Events.resize,width,height)}function getNow(){return(root.performance&&root.performance.now?root.performance:Date).now()}var root=this,previousTwo=root.Two||{},sin=Math.sin,cos=Math.cos,atan2=Math.atan2,sqrt=Math.sqrt,abs=(Math.round,Math.abs),PI=Math.PI,TWO_PI=2*PI,HALF_PI=PI/2,pow=Math.pow,dom={hasEventListeners:_.isFunction(root.addEventListener),bind:function(elem,event,func,bool){return this.hasEventListeners?elem.addEventListener(event,func,!!bool):elem.attachEvent("on"+event,func),this},unbind:function(elem,event,func,bool){return this.hasEventListeners?elem.removeEventListeners(event,func,!!bool):elem.detachEvent("on"+event,func),this}},Two=root.Two=function(options){var params=_.defaults(options||{},{fullscreen:!1,width:640,height:480,type:Two.Types.svg,autostart:!1});if(_.each(params,function(v,k){"fullscreen"!==k&&"width"!==k&&"height"!==k&&"autostart"!==k&&(this[k]=v)},this),_.isElement(params.domElement)&&(this.type=Two.Types[params.domElement.tagName.toLowerCase()]),this.renderer=new Two[this.type](this),Two.Utils.setPlaying.call(this,params.autostart),this.frameCount=0,params.fullscreen){var fitted=_.bind(fitToWindow,this);_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),dom.bind(root,"resize",fitted),fitted()}else _.isElement(params.domElement)||(this.renderer.setSize(params.width,params.height,this.ratio),this.width=params.width,this.height=params.height);this.scene=new Two.Group,this.renderer.add(this.scene),Two.Instances.push(this)};_.extend(Two,{Array:root.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.3.0",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){return root.Two=previousTwo,this},Utils:{Curve:{CollinearityEpsilon:pow(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:.01}},setPlaying:function(b){_.defer(_.bind(function(){this.playing=!!b},this))},getComputedMatrix:function(object){for(var matrix=new Two.Matrix,parent=object;parent&&parent._matrix;){var e=parent._matrix.elements;matrix.multiply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9]),parent=parent.parent}return matrix},applySvgAttributes:function(node,elem){return elem.cap="butt",elem.join="bevel",_.each(node.attributes,function(v){var property=v.nodeName;switch(property){case"transform":break;case"visibility":elem.visible=!!v.nodeValue;break;case"stroke-linecap":elem.cap=v.nodeValue;break;case"stroke-linejoin":elem.join=v.nodeValue;break;case"stroke-miterlimit":elem.miter=v.nodeValue;break;case"stroke-width":elem.linewidth=parseFloat(v.nodeValue);break;case"stroke-opacity":case"fill-opacity":elem.opacity=v.nodeValue;break;case"fill":elem.fill=v.nodeValue;break;case"stroke":elem.stroke=v.nodeValue}}),elem},read:{svg:function(){return Two.Utils.read.g.apply(this,arguments)},g:function(node){var group=new Two.Group;return this.add(group),_.each(node.childNodes,function(n){var tag=n.nodeName;if(tag){var tagName=tag.replace(/svg\:/gi,"").toLowerCase();if(tagName in Two.Utils.read){var o=Two.Utils.read[tagName].call(this,n);group.add(o)}}},this),Two.Utils.applySvgAttributes(node,group)},polygon:function(node,open){var points=node.getAttribute("points"),verts=[];points.replace(/([\d\.?]+),([\d\.?]+)/g,function(match,p1,p2){verts.push(new Two.Anchor(parseFloat(p1),parseFloat(p2)))});var poly=new Two.Polygon(verts,!open).noStroke();return Two.Utils.applySvgAttributes(node,poly)},polyline:function(node){return Two.Utils.read.polygon(node,!0)},path:function(node){var coord,control,coords,path=node.getAttribute("d"),relative=!1,closed=!1,commands=path.match(/[a-df-z][^a-df-z]*/gi),last=commands.length-1,points=_.flatten(_.map(commands,function(command,i){var result,x,y,type=command[0],lower=type.toLowerCase();coords=command.slice(1).trim(),coords=coords.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(match,n1,n2){return parseFloat(n1)*Math.pow(10,n2)}),coords=coords.split(/[\s,]+|(?=\s?[+\-])/),relative=type===lower;var x1,y1,x2,y2,x3,y3,x4,y4,reflection;switch(lower){case"z":i>=last?closed=!0:(x=coord.x,y=coord.y,result=new Two.Anchor(x,y,void 0,void 0,void 0,void 0,Two.Commands.close));break;case"m":case"l":x=parseFloat(coords[0]),y=parseFloat(coords[1]),result=new Two.Anchor(x,y,void 0,void 0,void 0,void 0,"m"===lower?Two.Commands.move:Two.Commands.line),relative&&result.addSelf(coord),coord=result;break;case"h":case"v":var a="h"===lower?"x":"y",b="x"===a?"y":"x";result=new Two.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,Two.Commands.line),result[a]=parseFloat(coords[0]),result[b]=coord[b],relative&&(result[a]+=coord[a]),coord=result;break;case"s":case"c":x1=coord.x,y1=coord.y,control||(control=(new Two.Vector).copy(coord)),"c"===lower?(x2=parseFloat(coords[0]),y2=parseFloat(coords[1]),x3=parseFloat(coords[2]),y3=parseFloat(coords[3]),x4=parseFloat(coords[4]),y4=parseFloat(coords[5])):(reflection=Two.Utils.getReflection(coord,control,relative),x2=reflection.x,y2=reflection.y,x3=parseFloat(coords[0]),y3=parseFloat(coords[1]),x4=parseFloat(coords[2]),y4=parseFloat(coords[3])),relative&&(x2+=x1,y2+=y1,x3+=x1,y3+=y1,x4+=x1,y4+=y1),_.isObject(coord.controls)||Two.Anchor.AppendCurveProperties(coord),coord.controls.right.set(x2,y2),result=new Two.Anchor(x4,y4,x3,y3,void 0,void 0,Two.Commands.curve),coord=result,control=result.controls.left;break;case"t":case"q":x1=coord.x,y1=coord.y,control||(control=(new Two.Vector).copy(coord)),control.isZero()?(x2=x1,y2=y1):(x2=control.x,y1=control.y),"q"===lower?(x3=parseFloat(coords[0]),y3=parseFloat(coords[1]),x4=parseFloat(coords[1]),y4=parseFloat(coords[2])):(reflection=Two.Utils.getReflection(coord,control,relative),x3=reflection.x,y3=reflection.y,x4=parseFloat(coords[0]),y4=parseFloat(coords[1])),relative&&(x2+=x1,y2+=y1,x3+=x1,y3+=y1,x4+=x1,y4+=y1),_.isObject(coord.controls)||Two.Anchor.AppendCurveProperties(coord),coord.controls.right.set(x2,y2),result=new Two.Anchor(x4,y4,x3,y3,void 0,void 0,Two.Commands.curve),coord=result,control=result.controls.left;break;case"a":throw new Two.Utils.Error("not yet able to interpret Elliptical Arcs.")}return result}));if(!(points.length<=1)){points=_.compact(points);var poly=new Two.Polygon(points,closed,void 0,!0).noStroke();return Two.Utils.applySvgAttributes(node,poly)}},circle:function(node){var x=parseFloat(node.getAttribute("cx")),y=parseFloat(node.getAttribute("cy")),r=parseFloat(node.getAttribute("r")),amount=Two.Resolution,points=_.map(_.range(amount),function(i){var pct=i/amount,theta=pct*TWO_PI,x=r*cos(theta),y=r*sin(theta);return new Two.Anchor(x,y)},this),circle=new Two.Polygon(points,!0,!0).noStroke();return circle.translation.set(x,y),Two.Utils.applySvgAttributes(node,circle)},ellipse:function(node){var x=parseFloat(node.getAttribute("cx")),y=parseFloat(node.getAttribute("cy")),width=parseFloat(node.getAttribute("rx")),height=parseFloat(node.getAttribute("ry")),amount=Two.Resolution,points=_.map(_.range(amount),function(i){var pct=i/amount,theta=pct*TWO_PI,x=width*cos(theta),y=height*sin(theta);return new Two.Anchor(x,y)},this),ellipse=new Two.Polygon(points,!0,!0).noStroke();return ellipse.translation.set(x,y),Two.Utils.applySvgAttributes(node,ellipse)},rect:function(node){var x=parseFloat(node.getAttribute("x")),y=parseFloat(node.getAttribute("y")),width=parseFloat(node.getAttribute("width")),height=parseFloat(node.getAttribute("height")),w2=width/2,h2=height/2,points=[new Two.Anchor(w2,h2),new Two.Anchor(-w2,h2),new Two.Anchor(-w2,-h2),new Two.Anchor(w2,-h2)],rect=new Two.Polygon(points,!0).noStroke();return rect.translation.set(x+w2,y+h2),Two.Utils.applySvgAttributes(node,rect)},line:function(node){var x1=parseFloat(node.getAttribute("x1")),y1=parseFloat(node.getAttribute("y1")),x2=parseFloat(node.getAttribute("x2")),y2=parseFloat(node.getAttribute("y2")),width=x2-x1,height=y2-y1,w2=width/2,h2=height/2,points=[new Two.Anchor(-w2,-h2),new Two.Anchor(w2,h2)],line=new Two.Polygon(points).noFill();return line.translation.set(x1+w2,y1+h2),Two.Utils.applySvgAttributes(node,line)}},subdivide:function(x1,y1,x2,y2,x3,y3,x4,y4,level){var da1,da2,epsilon=Two.Utils.Curve.CollinearityEpsilon,limit=Two.Utils.Curve.RecursionLimit,cuspLimit=Two.Utils.Curve.CuspLimit,tolerance=Two.Utils.Curve.Tolerance;if(level=level||0,level>limit)return[];var x12=(x1+x2)/2,y12=(y1+y2)/2,x23=(x2+x3)/2,y23=(y2+y3)/2,x34=(x3+x4)/2,y34=(y3+y4)/2,x123=(x12+x23)/2,y123=(y12+y23)/2,x234=(x23+x34)/2,y234=(y23+y34)/2,x1234=(x123+x234)/2,y1234=(y123+y234)/2,dx=x4-x1,dy=y4-y1,d2=abs((x2-x4)*dy-(y2-y4)*dx),d3=abs((x3-x4)*dy-(y3-y4)*dx);if(level>0){if(d2>epsilon&&d3>epsilon&&(d2+d3)*(d2+d3)<=tolerance.distance*(dx*dx+dy*dy)){if(tolerance.angle<tolerance.epsilon)return[new Two.Anchor(x1234,y1234)];var a23=atan2(y3-y2,x3-x2);if(da1=abs(a23-atan2(y2-y1,x2-x1)),da2=abs(atan2(y4-y3,x4-x3)-a23),da1>=PI&&(da1=TWO_PI-da1),da2>=PI&&(da2=TWO_PI-da2),da1+da2<tolerance.angle)return[new Two.Anchor(x1234,y1234)];if(0!==cuspLimit){if(da1>cuspLimit)return[new Two.Anchor(x2,y2)];if(da2>cuspLimit)return[new Two.Anchor(x3,y3)]}}}else if(d2>epsilon)if(d2*d2<=tolerance.distance*(dx*dx+dy*dy)){if(tolerance.angle<tolerance.epsilon)return[new Two.Anchor(x1234,y1234)];if(da1=abs(atan2(y3-y2,x3-x2)-atan2(y2-y1,x2-x1)),da1>=PI&&(da1=TWO_PI-da1),da1<tolerance.angle)return[new Two.Anchor(x2,y2),new Two.Anchor(x3,y3)];
if(0!==cuspLimit&&da1>cuspLimit)return[new Two.Anchor(x2,y2)]}else if(d3>epsilon){if(d3*d3<=tolerance.distance*(dx*dx+dy*dy)){if(tolerance.angle<tolerance.epsilon)return[new Two.Anchor(x1234,y1234)];if(da1=abs(atan2(y4-y3,x4-x3)-atan2(y3-y2,x3-x2)),da1>=PI&&(da1=TWO_PI-da1),da1<tolerance.angle)return[new Two.Anchor(x2,y2),new Two.Anchor(x3,y3)];if(0!==cuspLimit&&da1>cuspLimit)return[new Two.Anchor(x3,y3)]}}else if(dx=x1234-(x1+x4)/2,dy=y1234-(y1+y4)/2,dx*dx+dy*dy<=tolerance.distance)return[new Two.Anchor(x1234,y1234)];return Two.Utils.subdivide(x1,y1,x12,y12,x123,y123,x1234,y1234,level+1).concat(Two.Utils.subdivide(x1234,y1234,x234,y234,x34,y34,x4,y4,level+1))},getCurveFromPoints:function(points,closed){for(var l=points.length,last=l-1,i=0;l>i;i++){var point=points[i];_.isObject(point.controls)||Two.Anchor.AppendCurveProperties(point);var prev=closed?mod(i-1,l):Math.max(i-1,0),next=closed?mod(i+1,l):Math.min(i+1,last),a=points[prev],b=point,c=points[next];getControlPoints(a,b,c),b._command=0===i?Two.Commands.move:Two.Commands.curve,b.controls.left.x=_.isNumber(b.controls.left.x)?b.controls.left.x:b.x,b.controls.left.y=_.isNumber(b.controls.left.y)?b.controls.left.y:b.y,b.controls.right.x=_.isNumber(b.controls.right.x)?b.controls.right.x:b.x,b.controls.right.y=_.isNumber(b.controls.right.y)?b.controls.right.y:b.y}},getControlPoints:function(a,b,c){var a1=angleBetween(a,b),a2=angleBetween(c,b),d1=distanceBetween(a,b),d2=distanceBetween(c,b),mid=(a1+a2)/2;return b.u=_.isObject(b.controls.left)?b.controls.left:new Two.Vector(b.x,b.y),b.v=_.isObject(b.controls.right)?b.controls.right:new Two.Vector(b.x,b.y),1e-4>d1||1e-4>d2?(b.controls.left.copy(b),b.controls.right.copy(b),b):(d1*=.33,d2*=.33,a1>a2?mid+=HALF_PI:mid-=HALF_PI,b.controls.left.x=b.x+cos(mid)*d1,b.controls.left.y=b.y+sin(mid)*d1,mid-=PI,b.controls.right.x=b.x+cos(mid)*d2,b.controls.right.y=b.y+sin(mid)*d2,b)},getReflection:function(a,b,relative){var d=a.distanceTo(b);if(1e-4>=d)return relative?new Two.Vector:a.clone();var theta=angleBetween(a,b);return new Two.Vector(d*Math.cos(theta)+(relative?0:a.x),d*Math.sin(theta)+(relative?0:a.y))},angleBetween:function(A,B){var dx=A.x-B.x,dy=A.y-B.y;return atan2(dy,dx)},distanceBetweenSquared:function(p1,p2){var dx=p1.x-p2.x,dy=p1.y-p2.y;return dx*dx+dy*dy},distanceBetween:function(p1,p2){return sqrt(distanceBetweenSquared(p1,p2))},mod:function(v,l){for(;0>v;)v+=l;return v%l},Collection:function(){Array.call(this),arguments.length>1?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(message){this.name="two.js",this.message=message}}}),Two.Utils.Error.prototype=new Error,Two.Utils.Error.prototype.constructor=Two.Utils.Error,Two.Utils.Collection.prototype=new Array,Two.Utils.Collection.constructor=Two.Utils.Collection,_.extend(Two.Utils.Collection.prototype,Backbone.Events,{pop:function(){var popped=Array.prototype.pop.apply(this,arguments);return this.trigger(Two.Events.remove,[popped]),popped},shift:function(){var shifted=Array.prototype.shift.apply(this,arguments);return this.trigger(Two.Events.remove,[shifted]),shifted},push:function(){var pushed=Array.prototype.push.apply(this,arguments);return this.trigger(Two.Events.insert,arguments),pushed},unshift:function(){var unshifted=Array.prototype.unshift.apply(this,arguments);return this.trigger(Two.Events.insert,arguments),unshifted},splice:function(){var inserted,spliced=Array.prototype.splice.apply(this,arguments);return this.trigger(Two.Events.remove,spliced),arguments.length>2&&(inserted=this.slice(arguments[0],arguments.length-2),this.trigger(Two.Events.insert,inserted)),spliced}});var distanceBetween=Two.Utils.distanceBetween,distanceBetweenSquared=Two.Utils.distanceBetweenSquared,angleBetween=Two.Utils.angleBetween,getControlPoints=Two.Utils.getControlPoints,mod=(Two.Utils.getCurveFromPoints,Two.Utils.solveSegmentIntersection,Two.Utils.decoupleShapes,Two.Utils.mod);_.extend(Two.prototype,Backbone.Events,{appendTo:function(elem){return elem.appendChild(this.renderer.domElement),this},play:function(){return Two.Utils.setPlaying.call(this,!0),this.trigger(Two.Events.play)},pause:function(){return this.playing=!1,this.trigger(Two.Events.pause)},update:function(){var animated=!!this._lastFrame,now=getNow();this.frameCount++,animated&&(this.timeDelta=parseFloat((now-this._lastFrame).toFixed(3))),this._lastFrame=now;var width=this.width,height=this.height,renderer=this.renderer;return(width!==renderer.width||height!==renderer.height)&&renderer.setSize(width,height,this.ratio),this.trigger(Two.Events.update,this.frameCount,this.timeDelta),_.defer(_.bind(function(){this.render()},this)),this},render:function(){return this.renderer.render(),this.trigger(Two.Events.render,this.frameCount)},add:function(o){var objects=o;return _.isArray(o)||(objects=_.toArray(arguments)),this.scene.add(objects),this},remove:function(o){var objects=o;return _.isArray(o)||(objects=_.toArray(arguments)),this.scene.remove(objects),this},clear:function(){return _.each(this.scene.children,function(child){child.remove()}),this},makeLine:function(x1,y1,x2,y2){var width=x2-x1,height=y2-y1,w2=width/2,h2=height/2,points=[new Two.Anchor(-w2,-h2),new Two.Anchor(w2,h2)],line=new Two.Polygon(points).noFill();return line.translation.set(x1+w2,y1+h2),this.scene.add(line),line},makeRectangle:function(x,y,width,height){var w2=width/2,h2=height/2,points=[new Two.Anchor(w2,h2),new Two.Anchor(-w2,h2),new Two.Anchor(-w2,-h2),new Two.Anchor(w2,-h2)],rect=new Two.Polygon(points,!0);return rect.translation.set(x,y),this.scene.add(rect),rect},makeCircle:function(ox,oy,r){return this.makeEllipse(ox,oy,r,r)},makeEllipse:function(ox,oy,width,height){var amount=Two.Resolution,points=_.map(_.range(amount),function(i){var pct=i/amount,theta=pct*TWO_PI,x=width*cos(theta),y=height*sin(theta);return new Two.Anchor(x,y)},this),ellipse=new Two.Polygon(points,!0,!0);return ellipse.translation.set(ox,oy),this.scene.add(ellipse),ellipse},makeCurve:function(p){var l=arguments.length,points=p;if(!_.isArray(p)){points=[];for(var i=0;l>i;i+=2){var x=arguments[i];if(!_.isNumber(x))break;var y=arguments[i+1];points.push(new Two.Anchor(x,y))}}var last=arguments[l-1],poly=new Two.Polygon(points,!(_.isBoolean(last)?last:void 0),!0),rect=poly.getBoundingClientRect(),cx=rect.left+rect.width/2,cy=rect.top+rect.height/2;return _.each(poly.vertices,function(v){v.x-=cx,v.y-=cy}),poly.translation.set(cx,cy),this.scene.add(poly),poly},makePolygon:function(p){var l=arguments.length,points=p;if(!_.isArray(p)){points=[];for(var i=0;l>i;i+=2){var x=arguments[i];if(!_.isNumber(x))break;var y=arguments[i+1];points.push(new Two.Anchor(x,y))}}var last=arguments[l-1],poly=new Two.Polygon(points,!(_.isBoolean(last)?last:void 0)),rect=poly.getBoundingClientRect();return poly.center().translation.set(rect.left+rect.width/2,rect.top+rect.height/2),this.scene.add(poly),poly},makeGroup:function(o){var objects=o;_.isArray(o)||(objects=_.toArray(arguments));var group=new Two.Group;return this.scene.add(group),group.add(objects),group},interpret:function(svgNode){var tag=svgNode.tagName.toLowerCase();if(!(tag in Two.Utils.read))return null;var node=Two.Utils.read[tag].call(this,svgNode);return this.add(node),node}}),function(){_.each(Two.Instances,function(t){t.playing&&t.update()}),requestAnimationFrame(arguments.callee)}(),"function"==typeof define&&define.amd?define(function(){return Two}):"undefined"!=typeof module&&module.exports&&(module.exports=Two)}(),function(){var Vector=Two.Vector=function(x,y){this.x=x||0,this.y=y||0};_.extend(Vector,{MakeGetterSetter:function(object,property,value){var secret="_"+property;Object.defineProperty(object,property,{get:function(){return this[secret]},set:function(v){this[secret]=v,this.trigger(Two.Events.change,property)}}),object[secret]=value}}),_.extend(Vector.prototype,Backbone.Events,{set:function(x,y){return this.x=x,this.y=y,this},copy:function(v){return this.x=v.x,this.y=v.y,this},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new Vector(this.x,this.y)},add:function(v1,v2){return this.x=v1.x+v2.x,this.y=v1.y+v2.y,this},addSelf:function(v){return this.x+=v.x,this.y+=v.y,this},sub:function(v1,v2){return this.x=v1.x-v2.x,this.y=v1.y-v2.y,this},subSelf:function(v){return this.x-=v.x,this.y-=v.y,this},multiplySelf:function(v){return this.x*=v.x,this.y*=v.y,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this},divideScalar:function(s){return s?(this.x/=s,this.y/=s):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(v){return this.x*v.x+this.y*v.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this.x-v.x,dy=this.y-v.y;return dx*dx+dy*dy},setLength:function(l){return this.normalize().multiplyScalar(l)},equals:function(v){return this.distanceTo(v)<1e-4},lerp:function(v,t){var x=(v.x-this.x)*t+this.x,y=(v.y-this.y)*t+this.y;return this.set(x,y)},isZero:function(){return this.length()<1e-4},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var BoundProto={set:function(x,y){return this._x=x,this._y=y,this.trigger(Two.Events.change)},copy:function(v){return this._x=v.x,this._y=v.y,this.trigger(Two.Events.change)},clear:function(){return this._x=0,this._y=0,this.trigger(Two.Events.change)},clone:function(){return new Vector(this._x,this._y)},add:function(v1,v2){return this._x=v1.x+v2.x,this._y=v1.y+v2.y,this.trigger(Two.Events.change)},addSelf:function(v){return this._x+=v.x,this._y+=v.y,this.trigger(Two.Events.change)},sub:function(v1,v2){return this._x=v1.x-v2.x,this._y=v1.y-v2.y,this.trigger(Two.Events.change)},subSelf:function(v){return this._x-=v.x,this._y-=v.y,this.trigger(Two.Events.change)},multiplySelf:function(v){return this._x*=v.x,this._y*=v.y,this.trigger(Two.Events.change)},multiplyScalar:function(s){return this._x*=s,this._y*=s,this.trigger(Two.Events.change)},divideScalar:function(s){return s?(this._x/=s,this._y/=s,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(v){return this._x*v.x+this._y*v.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this._x-v.x,dy=this._y-v.y;return dx*dx+dy*dy},setLength:function(l){return this.normalize().multiplyScalar(l)},equals:function(v){return this.distanceTo(v)<1e-4},lerp:function(v,t){var x=(v.x-this._x)*t+this._x,y=(v.y-this._y)*t+this._y;return this.set(x,y)},isZero:function(){return this.length()<1e-4},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){return this._bound||(Two.Vector.MakeGetterSetter(this,"x",this.x),Two.Vector.MakeGetterSetter(this,"y",this.y),_.extend(this,BoundProto),this._bound=!0),Backbone.Events.bind.apply(this,arguments),this}}(),function(){var commands=Two.Commands,Anchor=Two.Anchor=function(x,y,ux,uy,vx,vy,command){return Two.Vector.call(this,x,y),this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this),Object.defineProperty(this,"command",{get:function(){return this._command},set:function(c){return this._command=c,this._command!==commands.curve||_.isObject(this.controls)||Anchor.AppendCurveProperties(this),this.trigger(Two.Events.change)}}),this._command=command||commands.move,command?(Anchor.AppendCurveProperties(this),_.isNumber(ux)&&(this.controls.left.x=ux),_.isNumber(uy)&&(this.controls.left.y=uy),_.isNumber(vx)&&(this.controls.right.x=vx),_.isNumber(vy)&&(this.controls.right.y=vy),void 0):this};_.extend(Anchor,{AppendCurveProperties:function(anchor){var x=anchor._x||anchor.x,y=anchor._y||anchor.y;anchor.controls={left:new Two.Vector(x,y),right:new Two.Vector(x,y)}}}),_.extend(Anchor.prototype,Two.Vector.prototype,{listen:function(){return _.isObject(this.controls)||Anchor.AppendCurveProperties(this),_.each(this.controls,function(v){v.bind(Two.Events.change,this._broadcast)},this),this},ignore:function(){return _.each(this.controls,function(v){v.unbind(Two.Events.change,this._broadcast)},this),this},clone:function(){var controls=this.controls;return new Two.Anchor(this.x,this.y,controls&&controls.left.x,controls&&controls.left.y,controls&&controls.right.x,controls&&controls.right.y,this.command)}})}(),function(){var cos=(_.range(6),Math.cos),sin=Math.sin,tan=Math.tan,Matrix=Two.Matrix=function(a){this.elements=new Two.Array(9);var elements=a;_.isArray(elements)||(elements=_.toArray(arguments)),this.identity().set(elements)};_.extend(Matrix,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(A,B){if(B.length<=3){var x,y,z,a=B[0]||0,b=B[1]||0,c=B[2]||0,e=A;return x=e[0]*a+e[1]*b+e[2]*c,y=e[3]*a+e[4]*b+e[5]*c,z=e[6]*a+e[7]*b+e[8]*c,{x:x,y:y,z:z}}var A0=A[0],A1=A[1],A2=A[2],A3=A[3],A4=A[4],A5=A[5],A6=A[6],A7=A[7],A8=A[8],B0=B[0],B1=B[1],B2=B[2],B3=B[3],B4=B[4],B5=B[5],B6=B[6],B7=B[7],B8=B[8];return[A0*B0+A1*B3+A2*B6,A0*B1+A1*B4+A2*B7,A0*B2+A1*B5+A2*B8,A3*B0+A4*B3+A5*B6,A3*B1+A4*B4+A5*B7,A3*B2+A4*B5+A5*B8,A6*B0+A7*B3+A8*B6,A6*B1+A7*B4+A8*B7,A6*B2+A7*B5+A8*B8]}}),_.extend(Matrix.prototype,Backbone.Events,{set:function(a){{var elements=a;arguments.length}return _.isArray(elements)||(elements=_.toArray(arguments)),_.each(elements,function(v,i){_.isNumber(v)&&(this.elements[i]=v)},this),this.trigger(Two.Events.change)},identity:function(){return this.set(Matrix.Identity),this},multiply:function(a,b,c,d,e){var elements=arguments,l=elements.length;if(1>=l)return _.each(this.elements,function(v,i){this.elements[i]=v*a},this),this.trigger(Two.Events.change);if(3>=l){var x,y,z;return a=a||0,b=b||0,c=c||0,e=this.elements,x=e[0]*a+e[1]*b+e[2]*c,y=e[3]*a+e[4]*b+e[5]*c,z=e[6]*a+e[7]*b+e[8]*c,{x:x,y:y,z:z}}var A=this.elements,B=elements;return A0=A[0],A1=A[1],A2=A[2],A3=A[3],A4=A[4],A5=A[5],A6=A[6],A7=A[7],A8=A[8],B0=B[0],B1=B[1],B2=B[2],B3=B[3],B4=B[4],B5=B[5],B6=B[6],B7=B[7],B8=B[8],this.elements[0]=A0*B0+A1*B3+A2*B6,this.elements[1]=A0*B1+A1*B4+A2*B7,this.elements[2]=A0*B2+A1*B5+A2*B8,this.elements[3]=A3*B0+A4*B3+A5*B6,this.elements[4]=A3*B1+A4*B4+A5*B7,this.elements[5]=A3*B2+A4*B5+A5*B8,this.elements[6]=A6*B0+A7*B3+A8*B6,this.elements[7]=A6*B1+A7*B4+A8*B7,this.elements[8]=A6*B2+A7*B5+A8*B8,this.trigger(Two.Events.change)},inverse:function(out){var a=this.elements,out=out||new Two.Matrix,a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b01=a22*a11-a12*a21,b11=-a22*a10+a12*a20,b21=a21*a10-a11*a20,det=a00*b01+a01*b11+a02*b21;return det?(det=1/det,out.elements[0]=b01*det,out.elements[1]=(-a22*a01+a02*a21)*det,out.elements[2]=(a12*a01-a02*a11)*det,out.elements[3]=b11*det,out.elements[4]=(a22*a00-a02*a20)*det,out.elements[5]=(-a12*a00+a02*a10)*det,out.elements[6]=b21*det,out.elements[7]=(-a21*a00+a01*a20)*det,out.elements[8]=(a11*a00-a01*a10)*det,out):null},scale:function(sx,sy){var l=arguments.length;return 1>=l&&(sy=sx),this.multiply(sx,0,0,0,sy,0,0,0,1)},rotate:function(radians){var c=cos(radians),s=sin(radians);return this.multiply(c,-s,0,s,c,0,0,0,1)},translate:function(x,y){return this.multiply(1,0,x,0,1,y,0,0,1)},skewX:function(radians){var a=tan(radians);return this.multiply(1,a,0,0,1,0,0,0,1)},skewY:function(radians){var a=tan(radians);return this.multiply(1,0,0,a,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(fullMatrix){var elements=this.elements,a=parseFloat(elements[0].toFixed(3)),b=parseFloat(elements[1].toFixed(3)),c=parseFloat(elements[2].toFixed(3)),d=parseFloat(elements[3].toFixed(3)),e=parseFloat(elements[4].toFixed(3)),f=parseFloat(elements[5].toFixed(3));if(fullMatrix){var g=parseFloat(elements[6].toFixed(3)),h=parseFloat(elements[7].toFixed(3)),i=parseFloat(elements[8].toFixed(3));return[a,d,g,b,e,h,c,f,i]}return[a,d,b,e,c,f]},clone:function(){var a=this.elements[0],b=this.elements[1],c=this.elements[2],d=this.elements[3],e=this.elements[4],f=this.elements[5],g=this.elements[6],h=this.elements[7],i=this.elements[8];return new Two.Matrix(a,b,c,d,e,f,g,h,i)}})}(),function(){function getStyles(o){var styles={},id=o.id,translation=o.translation,rotation=o.rotation,scale=o.scale,stroke=o.stroke,linewidth=o.linewidth,fill=o.fill,opacity=o.opacity,visible=o.visible,cap=o.cap,join=o.join,miter=o.miter,closed=o.closed,vertices=o.vertices;return id&&(styles.id=Renderer.Identifier+id),translation&&_.isNumber(scale)&&_.isNumber(rotation)&&(styles.transform="matrix("+o._matrix.toString()+")"),stroke&&(styles.stroke=stroke),fill&&(styles.fill=fill),opacity&&(styles["stroke-opacity"]=styles["fill-opacity"]=opacity),styles.visibility=visible?"visible":"hidden",cap&&(styles["stroke-linecap"]=cap),join&&(styles["stroke-linejoin"]=join),miter&&(styles["stroke-miterlimit"]=miter),linewidth&&(styles["stroke-width"]=linewidth),vertices&&(styles.d=svg.toString(vertices,closed)),styles}function setStyles(elem,property,value,closed){switch(property){case"matrix":property="transform",value="matrix("+value.toString()+")";break;case"visible":property="visibility",value=value?"visible":"hidden";break;case"cap":property="stroke-linecap";break;case"join":property="stroke-linejoin";break;case"miter":property="stroke-miterlimit";break;case"linewidth":property="stroke-width";break;case"vertices":property="d",value=svg.toString(value,closed);break;case"opacity":return svg.setAttributes(elem,{"stroke-opacity":value,"fill-opacity":value}),void 0}elem.setAttribute(property,value)}function generateId(){var count=this.count;return this.count++,count}var mod=Two.Utils.mod,svg={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(name,attrs){var tag=name,elem=document.createElementNS(this.ns,tag);return"svg"===tag&&(attrs=_.defaults(attrs||{},{version:this.version})),_.isObject(attrs)&&this.setAttributes(elem,attrs),elem},setAttributes:function(elem,attrs){return _.each(attrs,function(v,k){this.setAttribute(k,v)},elem),this},removeAttributes:function(elem,attrs){return _.each(attrs,function(a){this.removeAttribute(a)},elem),this},toString:function(points,closed){var l=points.length,last=l-1;return _.map(points,function(b,i){var command,vx,vy,ux,uy,ar,bl,br,cl,prev=closed?mod(i-1,l):Math.max(i-1,0),next=closed?mod(i+1,l):Math.min(i+1,last),a=points[prev],c=points[next],x=b.x.toFixed(3),y=b.y.toFixed(3);switch(b._command){case Two.Commands.close:command=b._command;break;case Two.Commands.curve:var ar=a.controls&&a.controls.right||a,bl=b.controls&&b.controls.left||b;vx=ar.x.toFixed(3),vy=ar.y.toFixed(3),ux=bl.x.toFixed(3),uy=bl.y.toFixed(3),command=b._command+" "+vx+" "+vy+" "+ux+" "+uy+" "+x+" "+y;break;default:command=(b._command||(0===i?Two.Commands.move:Two.Commands.line))+" "+x+" "+y}return i>=last&&closed&&(b._command===Two.Commands.curve&&(br=b.controls&&b.controls.right||b,cl=c.controls&&c.controls.left||c,vx=br.x.toFixed(3),vy=br.y.toFixed(3),ux=cl.x.toFixed(3),uy=cl.y.toFixed(3),x=c.x.toFixed(3),y=c.y.toFixed(3),command+=" C "+vx+" "+vy+" "+ux+" "+uy+" "+x+" "+y),command+=" Z"),command}).join(" ")}},Renderer=Two[Two.Types.svg]=function(params){this.count=0,this.domElement=params.domElement||svg.createElement("svg"),this.elements=[],this.domElement.style.visibility="hidden",this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(Renderer,{Identifier:"two-",Utils:svg}),_.extend(Renderer.prototype,Backbone.Events,{setSize:function(width,height){return this.width=width,this.height=height,svg.setAttributes(this.domElement,{width:width,height:height}),this},add:function(o){var objects=(arguments.length,o),elements=this.elements,domElement=this.domElement;return _.isArray(o)||(objects=_.map(arguments,function(a){return a})),_.each(objects,function(object){var elem,tag,styles,isGroup=object instanceof Two.Group;_.isUndefined(object.id)&&(object.id=generateId.call(this)),isGroup?(tag="g",_.isUndefined(object.parent)&&(object.parent=this,object.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),styles=getStyles(object),delete styles.stroke,delete styles.fill,delete styles["fill-opacity"],delete styles["stroke-opacity"],delete styles["stroke-linecap"],delete styles["stroke-linejoin"],delete styles["stroke-miterlimit"],delete styles["stroke-width"]):(tag="path",styles=getStyles(object)),elem=svg.createElement(tag,styles),domElement.appendChild(elem),elements.push(elem)},this),this},update:function(id,property,value,closed){var elements=this.elements,elem=elements[id];switch(property){case Two.Properties.hierarchy:_.each(value,function(j){elem.appendChild(elements[j])});break;case Two.Properties.demotion:_.each(value,function(j){elem.removeChild(elements[j])});break;default:setStyles(elem,property,value,closed)}return this},render:function(){return this.unveil(),this}})}(),function(){function getStyles(o){var styles={},id=o.id,matrix=o._matrix,stroke=o.stroke,linewidth=o.linewidth,fill=o.fill,opacity=o.opacity,visible=o.visible,cap=o.cap,join=o.join,miter=o.miter,closed=o.closed,vertices=o.vertices;return id&&(styles.id=id),_.isObject(matrix)&&(styles.matrix=matrix.toArray()),stroke&&(styles.stroke=stroke),fill&&(styles.fill=fill),_.isNumber(opacity)&&(styles.opacity=opacity),cap&&(styles.cap=cap),join&&(styles.join=join),miter&&(styles.miter=miter),linewidth&&(styles.linewidth=linewidth),vertices&&(styles.commands=vertices),styles.visible=!!visible,styles.closed=!!closed,styles}function setStyles(elem,property,value,closed){switch(property){case"matrix":property="matrix",value=value.toArray();break;case"vertices":property="commands",elem.closed=closed}elem[property]=value}function generateId(){var count=this.count;return this.count++,count}var root=this,mod=Two.Utils.mod,Group=function(styles){_.each(styles,function(v,k){this[k]=v},this),this.children=[]};_.extend(Group.prototype,{appendChild:function(elem){{var parent=elem.parent;elem.id}return _.isUndefined(parent)||parent.removeChild(elem),this.children.push(elem),elem.parent=this,this},removeChild:function(elem){var index=_.indexOf(this.children,elem);return 0>index?this:this.children.splice(index,1)[0]},render:function(ctx){var matrix=this.matrix;return ctx.save(),ctx.transform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]),_.each(this.children,function(child){child.render(ctx)}),ctx.restore(),this}});var Element=function(styles){_.each(styles,function(v,k){this[k]=v},this)};_.extend(Element.prototype,{render:function(ctx){var matrix=this.matrix,stroke=this.stroke,linewidth=this.linewidth,fill=this.fill,opacity=this.opacity,visible=this.visible,cap=this.cap,join=this.join,miter=this.miter,closed=this.closed,commands=this.commands,length=commands.length,last=length-1;return visible?(ctx.save(),matrix&&ctx.transform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]),fill&&(ctx.fillStyle=fill),stroke&&(ctx.strokeStyle=stroke),linewidth&&(ctx.lineWidth=linewidth),miter&&(ctx.miterLimit=miter),join&&(ctx.lineJoin=join),cap&&(ctx.lineCap=cap),_.isNumber(opacity)&&(ctx.globalAlpha=opacity),ctx.beginPath(),_.each(commands,function(b,i){var next,prev,a,c,ux,uy,vx,vy,ar,bl,br,cl,x=b.x.toFixed(3),y=b.y.toFixed(3);switch(b._command){case Two.Commands.close:ctx.closePath();break;case Two.Commands.curve:prev=closed?mod(i-1,length):Math.max(i-1,0),next=closed?mod(i+1,length):Math.min(i+1,last),a=commands[prev],c=commands[next],ar=a.controls&&a.controls.right||a,bl=b.controls&&b.controls.left||b,vx=ar.x.toFixed(3),vy=ar.y.toFixed(3),ux=bl.x.toFixed(3),uy=bl.y.toFixed(3),ctx.bezierCurveTo(vx,vy,ux,uy,x,y),i>=last&&closed&&(br=b.controls&&b.controls.right||b,cl=c.controls&&c.controls.left||c,vx=br.x.toFixed(3),vy=br.y.toFixed(3),ux=cl.x.toFixed(3),uy=cl.y.toFixed(3),x=c.x.toFixed(3),y=c.y.toFixed(3),ctx.bezierCurveTo(vx,vy,ux,uy,x,y));break;case Two.Commands.line:ctx.lineTo(x,y);break;case Two.Commands.move:ctx.moveTo(x,y)}}),closed&&ctx.closePath(),ctx.fill(),ctx.stroke(),ctx.restore(),void 0):this}});var canvas={devicePixelRatio:root.devicePixelRatio||1,getBackingStoreRatio:function(ctx){return ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1},getRatio:function(ctx){return this.devicePixelRatio/this.getBackingStoreRatio(ctx)}},Renderer=Two[Two.Types.canvas]=function(params){this.count=0,this.domElement=params.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=!1,this.elements=[],this.stage=null};_.extend(Renderer,{Group:Group,Element:Element,getStyles:getStyles,setStyles:setStyles,Utils:canvas}),_.extend(Renderer.prototype,Backbone.Events,{setSize:function(width,height,ratio){return this.width=width,this.height=height,this.ratio=_.isUndefined(ratio)?canvas.getRatio(this.ctx):ratio,this.domElement.width=width*this.ratio,this.domElement.height=height*this.ratio,_.extend(this.domElement.style,{width:width+"px",height:height+"px"}),this},add:function(o){var proto=Object.getPrototypeOf(this);constructor=proto.constructor;var objects=(arguments.length,o),elements=this.elements,Group=(this.domElement,constructor.Group),Element=constructor.Element,getStyles=constructor.getStyles;return _.isArray(o)||(objects=_.map(arguments,function(a){return a})),_.each(objects,function(object){var elem,styles,isGroup=object instanceof Two.Group,isStage=_.isNull(this.stage);_.isUndefined(object.id)&&(object.id=generateId.call(this)),isGroup?(styles=getStyles.call(this,object),delete styles.stroke,delete styles.fill,delete styles.opacity,delete styles.cap,delete styles.join,delete styles.miter,delete styles.linewidth,elem=new Group(styles),isStage&&(this.stage=elem,this.stage.object=object,this.stage.parent=object.parent=this,object.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):elem=new Element(getStyles.call(this,object)),elements.push(elem),isStage||this.stage.appendChild(elem)},this),this},update:function(id,property,value,closed,strokeChanged){var proto=Object.getPrototypeOf(this),constructor=proto.constructor,elements=this.elements,elem=elements[id];switch(property){case Two.Properties.hierarchy:_.each(value,function(j){elem.appendChild(elements[j])});break;case Two.Properties.demotion:_.each(value,function(j){elem.removeChild(elements[j]),this.elements[j]=null},this);break;default:constructor.setStyles.call(this,elem,property,value,closed,strokeChanged)}return this},render:function(){if(_.isNull(this.stage))return this;var isOne=1===this.ratio;return isOne||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),this.stage.render(this.ctx),isOne||this.ctx.restore(),this}})}(),function(){function getStyles(o){var styles={},id=o.id,matrix=o._matrix,stroke=o.stroke,linewidth=o.linewidth,fill=o.fill,opacity=o.opacity,visible=o.visible,cap=o.cap,join=o.join,miter=o.miter,closed=o.closed,vertices=o.vertices;return id&&(styles.id=id),_.isObject(matrix)&&(styles.matrix=styles._matrix=matrix.toArray(!0),styles.scale=styles._scale=1),stroke&&(styles.stroke=stroke),fill&&(styles.fill=fill),_.isNumber(opacity)&&(styles.opacity=opacity),cap&&(styles.cap=cap),join&&(styles.join=join),miter&&(styles.miter=miter),linewidth&&(styles.linewidth=linewidth),vertices&&(styles.vertices=vertices,styles.commands=styles.vertices,styles.rect=webgl.getBoundingClientRect(styles.commands,styles.linewidth),styles.triangles=webgl.getTriangles(styles.rect)),styles.visible=!!visible,styles.closed=!!closed,o instanceof Two.Polygon&&(webgl.updateBuffer(this.ctx,styles,this.program),Element.prototype.updateTexture.call(styles,this.ctx)),styles}function setStyles(elem,property,value,closed,strokeChanged){var textureNeedsUpdate=!1;/matrix/.test(property)?(elem[property]=value.toArray(!0),_.isNumber(closed)&&(textureNeedsUpdate=elem.scale!==closed,elem.scale=closed),elem.updateMatrix()):/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(property)?(elem[property]=value,elem.rect=expand(webgl.getBoundingClientRect(elem.commands,elem.linewidth),elem.rect),elem.triangles=webgl.getTriangles(elem.rect),webgl.updateBuffer(this.ctx,elem,this.program),textureNeedsUpdate=!0):"vertices"===property?(_.isUndefined(closed)||(elem.closed=closed),strokeChanged?elem.commands=value:(elem.vertices=value,elem.commands=elem.vertices),elem.rect=expand(webgl.getBoundingClientRect(elem.vertices,elem.linewidth),elem.rect),elem.triangles=webgl.getTriangles(elem.rect),webgl.updateBuffer(this.ctx,elem,this.program),textureNeedsUpdate=!0):elem[property]=value,textureNeedsUpdate&&elem.updateTexture(this.ctx)}function expand(r1,r2){var top=Math.min(r1.top,r2.top),left=Math.min(r1.left,r2.left),right=Math.max(r1.right,r2.right),bottom=Math.max(r1.bottom,r2.bottom),width=right-left,height=bottom-top,centroid={x:-left,y:-top};return{top:top,left:left,right:right,bottom:bottom,width:width,height:height,centroid:centroid}}var CanvasRenderer=Two[Two.Types.canvas],multiplyMatrix=Two.Matrix.Multiply,mod=Two.Utils.mod,Group=function(styles){CanvasRenderer.Group.call(this,styles)};_.extend(Group.prototype,CanvasRenderer.Group.prototype,{appendChild:function(){return CanvasRenderer.Group.prototype.appendChild.apply(this,arguments),this.updateMatrix(),this},updateTexture:function(ctx){return _.each(this.children,function(child){child.updateTexture(ctx)}),this},updateMatrix:function(parent){var matrix=parent&&parent._matrix||this.parent&&this.parent._matrix,scale=parent&&parent._scale||this.parent&&this.parent._scale;return matrix?(this._matrix=multiplyMatrix(this.matrix,matrix),this._scale=this.scale*scale,_.each(this.children,function(child){child.updateMatrix(this)},this),this):this},render:function(gl,program){_.each(this.children,function(child){child.render(gl,program)})}});var Element=function(styles){CanvasRenderer.Element.call(this,styles)};_.extend(Element.prototype,CanvasRenderer.Element.prototype,{updateMatrix:function(parent){var matrix=parent&&parent._matrix||this.parent&&this.parent._matrix,scale=parent&&parent._scale||this.parent&&this.parent._scale;return matrix?(this._matrix=multiplyMatrix(this.matrix,matrix),this._scale=this.scale*scale,this):this},updateTexture:function(ctx){return webgl.updateTexture(ctx,this),this},render:function(gl,program){return this.visible&&this.opacity&&this.buffer?(gl.bindBuffer(gl.ARRAY_BUFFER,this.textureCoordsBuffer),gl.vertexAttribPointer(program.textureCoords,2,gl.FLOAT,!1,0,0),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.uniformMatrix3fv(program.matrix,!1,this._matrix),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.vertexAttribPointer(program.position,2,gl.FLOAT,!1,0,0),gl.drawArrays(gl.TRIANGLES,0,6),this):this}});var webgl={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(vertices,border){var left=1/0,right=-1/0,top=1/0,bottom=-1/0;_.each(vertices,function(v){var a,b,c,d,x=v.x,y=v.y,controls=v.controls;if(top=Math.min(y,top),left=Math.min(x,left),right=Math.max(x,right),bottom=Math.max(y,bottom),v.controls){var cl=controls.left,cr=controls.right;cl&&cr&&(a=cl.x,b=cl.y,c=cr.x,d=cr.y,a&&b&&c&&d&&(top=Math.min(b,d,top),left=Math.min(a,c,left),right=Math.max(a,c,right),bottom=Math.max(b,d,bottom)))}}),_.isNumber(border)&&(top-=border,left-=border,right+=border,bottom+=border);var width=right-left,height=bottom-top,centroid={x:-left,y:-top};return{top:top,left:left,right:right,bottom:bottom,width:width,height:height,centroid:centroid}},getTriangles:function(rect){var top=rect.top,left=rect.left,right=rect.right,bottom=rect.bottom;return new Two.Array([left,top,right,top,left,bottom,left,bottom,right,top,right,bottom])},updateCanvas:function(elem){var commands=elem.commands,canvas=this.canvas,ctx=this.ctx,scale=elem._scale,stroke=elem.stroke,linewidth=elem.linewidth*scale,fill=elem.fill,opacity=elem.opacity,cap=elem.cap,join=elem.join,miter=elem.miter,closed=elem.closed,length=commands.length,last=length-1;canvas.width=Math.max(Math.ceil(elem.rect.width*scale),1),canvas.height=Math.max(Math.ceil(elem.rect.height*scale),1);var centroid=elem.rect.centroid,cx=centroid.x*scale,cy=centroid.y*scale;ctx.clearRect(0,0,canvas.width,canvas.height),fill&&(ctx.fillStyle=fill),stroke&&(ctx.strokeStyle=stroke),linewidth&&(ctx.lineWidth=linewidth),miter&&(ctx.miterLimit=miter),join&&(ctx.lineJoin=join),cap&&(ctx.lineCap=cap),_.isNumber(opacity)&&(ctx.globalAlpha=opacity),ctx.beginPath(),_.each(commands,function(b,i){var next,prev,a,c,ux,uy,vx,vy,ar,bl,br,cl,x=(b.x*scale+cx).toFixed(3),y=(b.y*scale+cy).toFixed(3);
switch(b._command){case Two.Commands.close:ctx.closePath();break;case Two.Commands.curve:prev=closed?mod(i-1,length):Math.max(i-1,0),next=closed?mod(i+1,length):Math.min(i+1,last),a=commands[prev],c=commands[next],ar=a.controls&&a.controls.right||a,bl=b.controls&&b.controls.left||b,vx=(ar.x*scale+cx).toFixed(3),vy=(ar.y*scale+cy).toFixed(3),ux=(bl.x*scale+cx).toFixed(3),uy=(bl.y*scale+cy).toFixed(3),ctx.bezierCurveTo(vx,vy,ux,uy,x,y),i>=last&&closed&&(br=b.controls&&b.controls.right||b,cl=c.controls&&c.controls.left||c,vx=(br.x*scale+cx).toFixed(3),vy=(br.y*scale+cy).toFixed(3),ux=(cl.x*scale+cx).toFixed(3),uy=(cl.y*scale+cy).toFixed(3),x=(c.x*scale+cx).toFixed(3),y=(c.y*scale+cy).toFixed(3),ctx.bezierCurveTo(vx,vy,ux,uy,x,y));break;case Two.Commands.line:ctx.lineTo(x,y);break;case Two.Commands.move:ctx.moveTo(x,y)}}),closed&&ctx.closePath(),ctx.fill(),ctx.stroke()},updateTexture:function(gl,elem){this.updateCanvas(elem),elem.texture&&gl.deleteTexture(elem.texture),gl.bindBuffer(gl.ARRAY_BUFFER,elem.textureCoordsBuffer),elem.texture=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,elem.texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),this.canvas.width<=0||this.canvas.height<=0||gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(gl,elem,program){_.isObject(elem.buffer)&&gl.deleteBuffer(elem.buffer),elem.buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,elem.buffer),gl.enableVertexAttribArray(program.position),gl.bufferData(gl.ARRAY_BUFFER,elem.triangles,gl.STATIC_DRAW),_.isObject(elem.textureCoordsBuffer)&&gl.deleteBuffer(elem.textureCoordsBuffer),elem.textureCoordsBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,elem.textureCoordsBuffer),gl.enableVertexAttribArray(program.textureCoords),gl.bufferData(gl.ARRAY_BUFFER,this.uv,gl.STATIC_DRAW)},program:{create:function(gl,shaders){var program=gl.createProgram();_.each(shaders,function(s){gl.attachShader(program,s)}),gl.linkProgram(program);var linked=gl.getProgramParameter(program,gl.LINK_STATUS);if(!linked)throw error=gl.getProgramInfoLog(program),gl.deleteProgram(program),new Two.Utils.Error("unable to link program: "+error);return program}},shaders:{create:function(gl,source,type){var shader=gl.createShader(gl[type]);gl.shaderSource(shader,source),gl.compileShader(shader);var compiled=gl.getShaderParameter(shader,gl.COMPILE_STATUS);if(!compiled){var error=gl.getShaderInfoLog(shader);throw gl.deleteShader(shader),new Two.Utils.Error("unable to compile shader "+shader+": "+error)}return shader},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:["attribute vec2 a_position;","attribute vec2 a_textureCoords;","","uniform mat3 u_matrix;","uniform vec2 u_resolution;","","varying vec2 v_textureCoords;","","void main() {","   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;","   vec2 normal = projected / u_resolution;","   vec2 clipspace = (normal * 2.0) - 1.0;","","   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);","   v_textureCoords = a_textureCoords;","}"].join("\n"),fragment:["precision mediump float;","","uniform sampler2D u_image;","varying vec2 v_textureCoords;","","void main() {","  gl_FragColor = texture2D(u_image, v_textureCoords);","}"].join("\n")}};webgl.ctx=webgl.canvas.getContext("2d");var Renderer=Two[Two.Types.webgl]=function(options){this.count=0,this.domElement=options.domElement||document.createElement("canvas"),this.elements=[],this.stage=null,this._matrix=[1,0,0,0,1,0,0,0,1],this._scale=1;var params=_.defaults(options||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=params.overdraw;var gl=this.ctx=this.domElement.getContext("webgl",params)||this.domElement.getContext("experimental-webgl",params);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var vs=webgl.shaders.create(gl,webgl.shaders.vertex,webgl.shaders.types.vertex),fs=webgl.shaders.create(gl,webgl.shaders.fragment,webgl.shaders.types.fragment);this.program=webgl.program.create(gl,[vs,fs]),gl.useProgram(this.program),this.program.position=gl.getAttribLocation(this.program,"a_position"),this.program.matrix=gl.getUniformLocation(this.program,"u_matrix"),this.program.textureCoords=gl.getAttribLocation(this.program,"a_textureCoords"),gl.disable(gl.DEPTH_TEST),gl.enable(gl.BLEND),gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD),gl.blendFuncSeparate(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA)};_.extend(Renderer,{Group:Group,Element:Element,getStyles:getStyles,setStyles:setStyles}),_.extend(Renderer.prototype,Backbone.Events,CanvasRenderer.prototype,{setSize:function(width,height){CanvasRenderer.prototype.setSize.apply(this,arguments),width*=this.ratio,height*=this.ratio,this._matrix[0]=this._matrix[4]=this._scale=this.ratio,_.isNull(this.stage)||this.stage.updateMatrix(),this.ctx.viewport(0,0,width,height);var resolutionLocation=this.ctx.getUniformLocation(this.program,"u_resolution");return this.ctx.uniform2f(resolutionLocation,width,height),this},render:function(){if(_.isNull(this.stage))return this;var gl=this.ctx;return this.overdraw||gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),this.stage.render(gl,this.program),this}})}(),function(){var Shape=Two.Shape=function(limited){this._matrix=new Two.Matrix;var updateMatrix=_.debounce(_.bind(function(){var transform=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",transform,this.scale)},this),0);return this._rotation=0,Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(v){this._rotation=v,updateMatrix()}}),this._scale="scale",Object.defineProperty(this,"scale",{get:function(){return this._scale},set:function(v){this._scale=v,updateMatrix()}}),this.translation=new Two.Vector,this.rotation=0,this.scale=1,this.translation.bind(Two.Events.change,updateMatrix),limited?this:(Shape.MakeGetterSetter(this,Shape.Properties),this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.visible=!0,this.cap="round",this.join="round",this.miter=4,void 0)};_.extend(Shape,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter"],MakeGetterSetter:function(shape,properties){_.isArray(properties)||(properties=[properties]),_.each(properties,function(k){var secret="_"+k;Object.defineProperty(shape,k,{get:function(){return this[secret]},set:function(v){this[secret]=v,this.trigger(Two.Events.change,this.id,k,v,this)}})})}}),_.extend(Shape.prototype,Backbone.Events,{addTo:function(group){return group.add(this),this},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke="transparent",this},clone:function(){var clone=new Shape;return clone.translation.copy(this.translation),_.each(Shape.Properties,function(k){clone[k]=this[k]},this),this}})}(),function(){var min=Math.min,max=Math.max,Group=Two.Group=function(){Two.Shape.call(this,!0),delete this.stroke,delete this.fill,delete this.linewidth,delete this.opacity,delete this.cap,delete this.join,delete this.miter,Group.MakeGetterSetter(this,Two.Shape.Properties),this.children={}};_.extend(Group,{MakeGetterSetter:function(group,properties){_.isArray(properties)||(properties=[properties]),_.each(properties,function(k){var secret="_"+k;Object.defineProperty(group,k,{get:function(){return this[secret]},set:function(v){this[secret]=v,_.each(this.children,function(child){child[k]=v})}})})}}),_.extend(Group.prototype,Two.Shape.prototype,{clone:function(parent){parent=parent||this.parent;var children=_.map(this.children,function(child){return child.clone(parent)}),group=new Group;return parent.add(group),group.add(children),group.translation.copy(this.translation),group.rotation=this.rotation,group.scale=this.scale,group},corner:function(){var rect=this.getBoundingClientRect(!0),corner={x:rect.left,y:rect.top};return _.each(this.children,function(child){child.translation.subSelf(corner)}),this},center:function(){var rect=this.getBoundingClientRect(!0);return rect.centroid={x:rect.left+rect.width/2,y:rect.top+rect.height/2},_.each(this.children,function(child){child.translation.subSelf(rect.centroid)}),this},add:function(o){var objects=(arguments.length,o),children=this.children,grandparent=this.parent,ids=[];_.isArray(o)||(objects=_.toArray(arguments));var broadcast=_.bind(function(id,property,value,closed,strokeChanged){this.trigger(Two.Events.change,id,property,value,closed,strokeChanged)},this);return _.each(objects,function(object){if(object){var id=object.id,parent=object.parent;_.isUndefined(id)&&(grandparent.add(object),id=object.id),_.isUndefined(children[id])&&(parent&&delete parent.children[id],children[id]=object,object.parent=this,object.unbind(Two.Events.change).bind(Two.Events.change,broadcast),ids.push(id))}},this),ids.length>0&&this.trigger(Two.Events.change,this.id,Two.Properties.hierarchy,ids),this},remove:function(o){var l=arguments.length,objects=o,children=this.children,grandparent=this.parent,ids=[];return 0>=l&&grandparent?(grandparent.remove(this),this):(_.isArray(o)||(objects=_.toArray(arguments)),_.each(objects,function(object){{var id=object.id;object.children}id in children&&(delete children[id],delete object.parent,object.unbind(Two.Events.change),ids.push(id))}),ids.length>0&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,ids),this)},getBoundingClientRect:function(shallow){var left=1/0,right=-1/0,top=1/0,bottom=-1/0;_.each(this.children,function(child){var rect=child.getBoundingClientRect(!0);_.isNumber(rect.top)&&_.isNumber(rect.left)&&_.isNumber(rect.right)&&_.isNumber(rect.bottom)&&(top=min(rect.top,top),left=min(rect.left,left),right=max(rect.right,right),bottom=max(rect.bottom,bottom))},this);var matrix=shallow?this._matrix:Two.Utils.getComputedMatrix(this),a=matrix.multiply(left,top,1),b=matrix.multiply(right,top,1),c=matrix.multiply(right,bottom,1),d=matrix.multiply(left,bottom,1);return top=min(a.y,b.y,c.y,d.y),left=min(a.x,b.x,c.x,d.x),right=max(a.x,b.x,c.x,d.x),bottom=max(a.y,b.y,c.y,d.y),{top:top,left:left,right:right,bottom:bottom,width:right-left,height:bottom-top}},noFill:function(){return _.each(this.children,function(child){child.noFill()}),this},noStroke:function(){return _.each(this.children,function(child){child.noStroke()}),this},subdivide:function(){return _.each(this.children,function(child){child.subdivide()}),this}})}(),function(){var min=Math.min,max=Math.max,round=Math.round,Polygon=Two.Polygon=function(vertices,closed,curved,manual){Two.Shape.call(this),this._closed=!!closed,this._curved=!!curved,this._automatic=!manual;var verticesCollection,beginning=0,ending=1,strokeChanged=!1,verticesChanged=!1,renderedVertices=[],updateVertices=_.debounce(_.bind(function(){var l,ia,ib,last;if(this._automatic&&this.plot(),strokeChanged||verticesChanged){l=verticesCollection.length,last=l-1,ia=round(beginning*last),ib=round(ending*last),renderedVertices.length=0;for(var i=ia;ib+1>i;i++){var v=verticesCollection[i];renderedVertices.push(v)}}this.trigger(Two.Events.change,this.id,"vertices",renderedVertices,this._closed,strokeChanged),strokeChanged=!1,verticesChanged=!1},this),0);return Object.defineProperty(this,"closed",{get:function(){return this._closed},set:function(v){this._closed=!!v,updateVertices()}}),Object.defineProperty(this,"curved",{get:function(){return this._curved},set:function(v){this._curved=!!v,updateVertices()}}),Object.defineProperty(this,"automatic",{get:function(){return this._automatic},set:function(v){if(v!==this._automatic){this._automatic=!!v;var method=this._automatic?"ignore":"listen";_.each(this.vertices,function(v){v[method]()},this),updateVertices()}}}),Object.defineProperty(this,"beginning",{get:function(){return beginning},set:function(v){beginning=min(max(v,0),1),strokeChanged=!0,updateVertices()}}),Object.defineProperty(this,"ending",{get:function(){return ending},set:function(v){ending=min(max(v,0),1),strokeChanged=!0,updateVertices()}}),Object.defineProperty(this,"vertices",{get:function(){return verticesCollection},set:function(vertices){var bindVerts=_.bind(function(items){_.each(items,function(v){v.bind(Two.Events.change,updateVertices)},this),verticesChanged=!0,updateVertices()},this),unbindVerts=_.bind(function(items){_.each(items,function(v){v.unbind(Two.Events.change,updateVertices)},this),verticesChanged=!0,updateVertices()},this);verticesCollection&&verticesCollection.unbind(),verticesCollection=new Two.Utils.Collection(vertices.slice(0)),verticesCollection.bind(Two.Events.insert,bindVerts),verticesCollection.bind(Two.Events.remove,unbindVerts),verticesChanged=!0,bindVerts(verticesCollection)}}),this.vertices=vertices,this._automatic?(this.plot(),this):(_.each(this.vertices,function(v){_.isFunction(v.listen)&&v.listen()}),void 0)};_.extend(Polygon.prototype,Two.Shape.prototype,{clone:function(){var points=_.map(this.vertices,function(v){return v.clone()}),clone=new Polygon(points,this._closed,this._curved);return _.each(Two.Shape.Properties,function(k){clone[k]=this[k]},this),clone.translation.copy(this.translation),clone.rotation=this.rotation,clone.scale=this.scale,clone},corner:function(){var rect=this.getBoundingClientRect(!0),corner={x:rect.left,y:rect.top};return _.each(this.vertices,function(v){v.subSelf(corner)}),this},center:function(){var rect=this.getBoundingClientRect(!0);return rect.centroid={x:rect.left+rect.width/2,y:rect.top+rect.height/2},_.each(this.vertices,function(v){v.subSelf(rect.centroid)}),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(shallow){var border=this.linewidth/2,left=1/0,right=-1/0,top=1/0,bottom=-1/0;_.each(this.vertices,function(v){var x=v.x,y=v.y;top=min(y,top),left=min(x,left),right=max(x,right),bottom=max(y,bottom)}),top-=border,left-=border,right+=border,bottom+=border;var matrix=shallow?this._matrix:Two.Utils.getComputedMatrix(this),a=matrix.multiply(left,top,1),b=matrix.multiply(right,top,1),c=matrix.multiply(right,bottom,1),d=matrix.multiply(left,bottom,1);return top=min(a.y,b.y,c.y,d.y),left=min(a.x,b.x,c.x,d.x),right=max(a.x,b.x,c.x,d.x),bottom=max(a.y,b.y,c.y,d.y),{top:top,left:left,right:right,bottom:bottom,width:right-left,height:bottom-top}},plot:function(){return this._curved?(Two.Utils.getCurveFromPoints(this.vertices,this._closed),this):(_.each(this.vertices,function(p,i){p._command=0===i?Two.Commands.move:Two.Commands.line},this),this)},subdivide:function(){var b,last=this.vertices.length-1,closed=this._closed||this.vertices[last].command===Two.Commands.close,points=[];return _.each(this.vertices,function(a,i){var x1,y1,x2,y2,x3,y3,x4,y4;return 0>=i&&!closed?(b=a,void 0):(x1=b.x,y1=b.y,x2=(b.controls&&b.controls.right||b).x,y2=(b.controls&&b.controls.right||b).y,x3=(a.controls&&a.controls.left||a).x,y3=(a.controls&&a.controls.left||a).y,x4=a.x,y4=a.y,points.push(Two.Utils.subdivide(x1,y1,x2,y2,x3,y3,x4,y4)),b=a,void 0)},this),this._manual=!1,this._curved=!1,this.vertices=_.flatten(points),this.plot(),this}})}(),/*
string.js - Copyright (C) 2012-2013, JP Richardson <jprichardson@gmail.com>
*/
!function(){"use strict";function initialize(object,s){object.s=null!==s&&void 0!==s?"string"==typeof s?s:s.toString():s,object.orig=s,null!==s&&void 0!==s?object.__defineGetter__?object.__defineGetter__("length",function(){return object.s.length}):object.length=s.length:object.length=-1}function S(s){initialize(this,s)}function extendPrototype(){for(var name in __sp)!function(name){var func=__sp[name];__nsp.hasOwnProperty(name)||(methodsAdded.push(name),__nsp[name]=function(){return String.prototype.s=this,func.apply(this,arguments)})}(name)}function restorePrototype(){for(var i=0;i<methodsAdded.length;++i)delete String.prototype[methodsAdded[i]];methodsAdded.length=0}function getNativeStringProperties(){for(var names=getNativeStringPropertyNames(),retObj={},i=0;i<names.length;++i){var name=names[i],func=__nsp[name];try{var type=typeof func.apply("teststring",[]);retObj[name]=type}catch(e){}}return retObj}function getNativeStringPropertyNames(){var results=[];if(Object.getOwnPropertyNames)return results=Object.getOwnPropertyNames(__nsp),results.splice(results.indexOf("valueOf"),1),results.splice(results.indexOf("toString"),1),results;var stringNames={};for(var name in String.prototype)stringNames[name]=name;for(var name in Object.prototype)delete stringNames[name];for(var name in stringNames)results.push(name);return results}function Export(str){return new S(str)}function multiArgs(args,fn){var i,result=[];for(i=0;i<args.length;i++)result.push(args[i]),fn&&fn.call(args,args[i],i);return result}var VERSION="1.6.0",ENTITIES={},__nsp=String.prototype,__sp=S.prototype={between:function(left,right){var s=this.s,startPos=s.indexOf(left),endPos=s.indexOf(right),start=startPos+left.length;return new this.constructor(endPos>startPos?s.slice(start,endPos):"")},camelize:function(){var s=this.trim().s.replace(/(\-|_|\s)+(.)?/g,function(mathc,sep,c){return c?c.toUpperCase():""});return new this.constructor(s)},capitalize:function(){return new this.constructor(this.s.substr(0,1).toUpperCase()+this.s.substring(1).toLowerCase())},charAt:function(index){return this.s.charAt(index)},chompLeft:function(prefix){var s=this.s;return 0===s.indexOf(prefix)?(s=s.slice(prefix.length),new this.constructor(s)):this},chompRight:function(suffix){if(this.endsWith(suffix)){var s=this.s;return s=s.slice(0,s.length-suffix.length),new this.constructor(s)}return this},collapseWhitespace:function(){var s=this.s.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"");return new this.constructor(s)},contains:function(ss){return this.s.indexOf(ss)>=0},count:function(ss){for(var count=0,pos=this.s.indexOf(ss);pos>=0;)count+=1,pos=this.s.indexOf(ss,pos+1);return count},dasherize:function(){var s=this.trim().s.replace(/[_\s]+/g,"-").replace(/([A-Z])/g,"-$1").replace(/-+/g,"-").toLowerCase();return new this.constructor(s)},decodeHtmlEntities:function(){var s=this.s;return s=s.replace(/&#(\d+);?/g,function(_,code){return String.fromCharCode(code)}).replace(/&#[xX]([A-Fa-f0-9]+);?/g,function(_,hex){return String.fromCharCode(parseInt(hex,16))}).replace(/&([^;\W]+;?)/g,function(m,e){var ee=e.replace(/;$/,""),target=ENTITIES[e]||e.match(/;$/)&&ENTITIES[ee];return"number"==typeof target?String.fromCharCode(target):"string"==typeof target?target:m}),new this.constructor(s)},endsWith:function(suffix){var l=this.s.length-suffix.length;return l>=0&&this.s.indexOf(suffix,l)===l},escapeHTML:function(){return new this.constructor(this.s.replace(/[&<>"']/g,function(m){return"&"+reversedEscapeChars[m]+";"}))},ensureLeft:function(prefix){var s=this.s;return 0===s.indexOf(prefix)?this:new this.constructor(prefix+s)},ensureRight:function(suffix){var s=this.s;return this.endsWith(suffix)?this:new this.constructor(s+suffix)},humanize:function(){if(null===this.s||void 0===this.s)return new this.constructor("");var s=this.underscore().replace(/_id$/,"").replace(/_/g," ").trim().capitalize();return new this.constructor(s)},isAlpha:function(){return!/[^a-z\xC0-\xFF]/.test(this.s.toLowerCase())},isAlphaNumeric:function(){return!/[^0-9a-z\xC0-\xFF]/.test(this.s.toLowerCase())},isEmpty:function(){return null===this.s||void 0===this.s?!0:/^[\s\xa0]*$/.test(this.s)},isLower:function(){return this.isAlpha()&&this.s.toLowerCase()===this.s},isNumeric:function(){return!/[^0-9]/.test(this.s)},isUpper:function(){return this.isAlpha()&&this.s.toUpperCase()===this.s},left:function(N){if(N>=0){var s=this.s.substr(0,N);return new this.constructor(s)}return this.right(-N)},lines:function(){return this.replaceAll("\r\n","\n").s.split("\n")},pad:function(len,ch){if(ch=ch||" ",this.s.length>=len)return new this.constructor(this.s);len-=this.s.length;var left=Array(Math.ceil(len/2)+1).join(ch),right=Array(Math.floor(len/2)+1).join(ch);return new this.constructor(left+this.s+right)},padLeft:function(len,ch){return ch=ch||" ",this.s.length>=len?new this.constructor(this.s):new this.constructor(Array(len-this.s.length+1).join(ch)+this.s)},padRight:function(len,ch){return ch=ch||" ",this.s.length>=len?new this.constructor(this.s):new this.constructor(this.s+Array(len-this.s.length+1).join(ch))},parseCSV:function(delimiter,qualifier,escape,lineDelimiter){delimiter=delimiter||",",escape=escape||"\\","undefined"==typeof qualifier&&(qualifier='"');var i=0,fieldBuffer=[],fields=[],len=this.s.length,inField=!1,self=this,ca=function(i){return self.s.charAt(i)};if("undefined"!=typeof lineDelimiter)var rows=[];for(qualifier||(inField=!0);len>i;){var current=ca(i);switch(current){case escape:if(inField&&(escape!==qualifier||ca(i+1)===qualifier)){i+=1,fieldBuffer.push(ca(i));break}if(escape!==qualifier)break;case qualifier:inField=!inField;break;case delimiter:inField&&qualifier?fieldBuffer.push(current):(fields.push(fieldBuffer.join("")),fieldBuffer.length=0);break;case lineDelimiter:inField?fieldBuffer.push(current):rows&&(fields.push(fieldBuffer.join("")),rows.push(fields),fields=[],fieldBuffer.length=0);break;default:inField&&fieldBuffer.push(current)}i+=1}return fields.push(fieldBuffer.join("")),rows?(rows.push(fields),rows):fields},replaceAll:function(ss,r){var s=this.s.split(ss).join(r);return new this.constructor(s)},right:function(N){if(N>=0){var s=this.s.substr(this.s.length-N,N);return new this.constructor(s)}return this.left(-N)},setValue:function(s){return initialize(this,s),this},slugify:function(){var sl=new S(this.s.replace(/[^\w\s-]/g,"").toLowerCase()).dasherize().s;return"-"===sl.charAt(0)&&(sl=sl.substr(1)),new this.constructor(sl)},startsWith:function(prefix){return 0===this.s.lastIndexOf(prefix,0)},stripPunctuation:function(){return new this.constructor(this.s.replace(/[^\w\s]|_/g,"").replace(/\s+/g," "))},stripTags:function(){var s=this.s,args=arguments.length>0?arguments:[""];return multiArgs(args,function(tag){s=s.replace(RegExp("</?"+tag+"[^<>]*>","gi"),"")}),new this.constructor(s)},template:function(values,opening,closing){var s=this.s,opening=opening||Export.TMPL_OPEN,closing=closing||Export.TMPL_CLOSE,r=new RegExp(opening+"(.+?)"+closing,"g"),matches=s.match(r)||[];return matches.forEach(function(match){var key=match.substring(opening.length,match.length-closing.length);"undefined"!=typeof values[key]&&(s=s.replace(match,values[key]))}),new this.constructor(s)},times:function(n){return new this.constructor(new Array(n+1).join(this.s))},toBoolean:function(){if("string"==typeof this.orig){var s=this.s.toLowerCase();return"true"===s||"yes"===s||"on"===s}return this.orig===!0||1===this.orig},toFloat:function(precision){var num=parseFloat(this.s);return precision?parseFloat(num.toFixed(precision)):num},toInt:function(){return/^\s*-?0x/i.test(this.s)?parseInt(this.s,16):parseInt(this.s,10)},trim:function(){var s;return s="undefined"==typeof __nsp.trim?this.s.replace(/(^\s*|\s*$)/g,""):this.s.trim(),new this.constructor(s)},trimLeft:function(){var s;return s=__nsp.trimLeft?this.s.trimLeft():this.s.replace(/(^\s*)/g,""),new this.constructor(s)},trimRight:function(){var s;return s=__nsp.trimRight?this.s.trimRight():this.s.replace(/\s+$/,""),new this.constructor(s)},truncate:function(length,pruneStr){var str=this.s;if(length=~~length,pruneStr=pruneStr||"...",str.length<=length)return new this.constructor(str);var tmpl=function(c){return c.toUpperCase()!==c.toLowerCase()?"A":" "},template=str.slice(0,length+1).replace(/.(?=\W*\w*$)/g,tmpl);return template=template.slice(template.length-2).match(/\w\w/)?template.replace(/\s*\S+$/,""):new S(template.slice(0,template.length-1)).trimRight().s,(template+pruneStr).length>str.length?new S(str):new S(str.slice(0,template.length)+pruneStr)},toCSV:function(){function hasVal(it){return null!==it&&""!==it}var delim=",",qualifier='"',escape="\\",encloseNumbers=!0,keys=!1,dataArray=[];if("object"==typeof arguments[0]?(delim=arguments[0].delimiter||delim,delim=arguments[0].separator||delim,qualifier=arguments[0].qualifier||qualifier,encloseNumbers=!!arguments[0].encloseNumbers,escape=arguments[0].escape||escape,keys=!!arguments[0].keys):"string"==typeof arguments[0]&&(delim=arguments[0]),"string"==typeof arguments[1]&&(qualifier=arguments[1]),null===arguments[1]&&(qualifier=null),this.orig instanceof Array)dataArray=this.orig;else for(var key in this.orig)this.orig.hasOwnProperty(key)&&(keys?dataArray.push(key):dataArray.push(this.orig[key]));for(var rep=escape+qualifier,buildString=[],i=0;i<dataArray.length;++i){var shouldQualify=hasVal(qualifier);if("number"==typeof dataArray[i]&&(shouldQualify&=encloseNumbers),shouldQualify&&buildString.push(qualifier),null!==dataArray[i]&&void 0!==dataArray[i]){var d=new S(dataArray[i]).replaceAll(qualifier,rep).s;buildString.push(d)}else buildString.push("");shouldQualify&&buildString.push(qualifier),delim&&buildString.push(delim)}return buildString.length=buildString.length-1,new this.constructor(buildString.join(""))},toString:function(){return this.s},underscore:function(){var s=this.trim().s.replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase();return new S(this.s.charAt(0)).isUpper()&&(s="_"+s),new this.constructor(s)},unescapeHTML:function(){return new this.constructor(this.s.replace(/\&([^;]+);/g,function(entity,entityCode){var match;return entityCode in escapeChars?escapeChars[entityCode]:(match=entityCode.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(match[1],16)):(match=entityCode.match(/^#(\d+)$/))?String.fromCharCode(~~match[1]):entity}))},valueOf:function(){return this.s.valueOf()}},methodsAdded=[],nativeProperties=getNativeStringProperties();for(var name in nativeProperties)!function(name){var stringProp=__nsp[name];"function"==typeof stringProp&&(__sp[name]||(__sp[name]="string"===nativeProperties[name]?function(){return new this.constructor(stringProp.apply(this,arguments))}:stringProp))}(name);__sp.repeat=__sp.times,__sp.include=__sp.contains,__sp.toInteger=__sp.toInt,__sp.toBool=__sp.toBoolean,__sp.decodeHTMLEntities=__sp.decodeHtmlEntities,__sp.constructor=S,Export.extendPrototype=extendPrototype,Export.restorePrototype=restorePrototype,Export.VERSION=VERSION,Export.TMPL_OPEN="{{",Export.TMPL_CLOSE="}}",Export.ENTITIES=ENTITIES,"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=Export:"function"==typeof define&&define.amd?define([],function(){return Export}):window.S=Export;var escapeChars={lt:"<",gt:">",quot:'"',apos:"'",amp:"&"},reversedEscapeChars={};for(var key in escapeChars)reversedEscapeChars[escapeChars[key]]=key;ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,"OElig;":338,"oelig;":339,"Scaron;":352,"scaron;":353,"Yuml;":376,"fnof;":402,"circ;":710,"tilde;":732,"Alpha;":913,"Beta;":914,"Gamma;":915,"Delta;":916,"Epsilon;":917,"Zeta;":918,"Eta;":919,"Theta;":920,"Iota;":921,"Kappa;":922,"Lambda;":923,"Mu;":924,"Nu;":925,"Xi;":926,"Omicron;":927,"Pi;":928,"Rho;":929,"Sigma;":931,"Tau;":932,"Upsilon;":933,"Phi;":934,"Chi;":935,"Psi;":936,"Omega;":937,"alpha;":945,"beta;":946,"gamma;":947,"delta;":948,"epsilon;":949,"zeta;":950,"eta;":951,"theta;":952,"iota;":953,"kappa;":954,"lambda;":955,"mu;":956,"nu;":957,"xi;":958,"omicron;":959,"pi;":960,"rho;":961,"sigmaf;":962,"sigma;":963,"tau;":964,"upsilon;":965,"phi;":966,"chi;":967,"psi;":968,"omega;":969,"thetasym;":977,"upsih;":978,"piv;":982,"ensp;":8194,"emsp;":8195,"thinsp;":8201,"zwnj;":8204,"zwj;":8205,"lrm;":8206,"rlm;":8207,"ndash;":8211,"mdash;":8212,"lsquo;":8216,"rsquo;":8217,"sbquo;":8218,"ldquo;":8220,"rdquo;":8221,"bdquo;":8222,"dagger;":8224,"Dagger;":8225,"bull;":8226,"hellip;":8230,"permil;":8240,"prime;":8242,"Prime;":8243,"lsaquo;":8249,"rsaquo;":8250,"oline;":8254,"frasl;":8260,"euro;":8364,"image;":8465,"weierp;":8472,"real;":8476,"trade;":8482,"alefsym;":8501,"larr;":8592,"uarr;":8593,"rarr;":8594,"darr;":8595,"harr;":8596,"crarr;":8629,"lArr;":8656,"uArr;":8657,"rArr;":8658,"dArr;":8659,"hArr;":8660,"forall;":8704,"part;":8706,"exist;":8707,"empty;":8709,"nabla;":8711,"isin;":8712,"notin;":8713,"ni;":8715,"prod;":8719,"sum;":8721,"minus;":8722,"lowast;":8727,"radic;":8730,"prop;":8733,"infin;":8734,"ang;":8736,"and;":8743,"or;":8744,"cap;":8745,"cup;":8746,"int;":8747,"there4;":8756,"sim;":8764,"cong;":8773,"asymp;":8776,"ne;":8800,"equiv;":8801,"le;":8804,"ge;":8805,"sub;":8834,"sup;":8835,"nsub;":8836,"sube;":8838,"supe;":8839,"oplus;":8853,"otimes;":8855,"perp;":8869,"sdot;":8901,"lceil;":8968,"rceil;":8969,"lfloor;":8970,"rfloor;":8971,"lang;":9001,"rang;":9002,"loz;":9674,"spades;":9824,"clubs;":9827,"hearts;":9829,"diams;":9830}}.call(this),function(root,factory){"function"==typeof define&&define.amd?define(factory):"undefined"!=typeof exports?module.exports=factory():root.Autolinker=factory()}(this,function(){var Autolinker=function(cfg){cfg=cfg||{};for(var prop in cfg)cfg.hasOwnProperty(prop)&&(this[prop]=cfg[prop])};return Autolinker.prototype={constructor:Autolinker,newWindow:!0,stripPrefix:!0,twitter:!0,email:!0,urls:!0,className:"",matcherRegex:function(){var twitterRegex=/(^|[^\w])@(\w{1,15})/,emailRegex=/(?:[\-;:&=\+\$,\w\.]+@)/,protocolRegex=/(?:[A-Za-z]{3,9}:(?:\/\/)?)/,wwwRegex=/(?:www\.)/,domainNameRegex=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,tldRegex=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,urlSuffixRegex=/(?:[\-A-Za-z0-9+&@#\/%?=~_()|!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|])?/;return new RegExp(["(",twitterRegex.source,")","|","(",emailRegex.source,domainNameRegex.source,tldRegex.source,")","|","(","(?:","(?:",protocolRegex.source,domainNameRegex.source,")","|","(?:",wwwRegex.source,domainNameRegex.source,")","|","(?:",domainNameRegex.source,tldRegex.source,")",")",urlSuffixRegex.source,")"].join(""),"g")}(),htmlRegex:function(){var tagNameRegex=/[0-9a-zA-Z:]+/,attrNameRegex=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,attrValueRegex=/(?:".*?"|'.*?'|[^'"=<>`\s]+)/;return new RegExp(["<(/)?","("+tagNameRegex.source+")","(?:","\\s+",attrNameRegex.source,"(?:\\s*=\\s*"+attrValueRegex.source+")?",")*","\\s*",">"].join(""),"g")}(),urlPrefixRegex:/^(https?:\/\/)?(www\.)?/,link:function(textOrHtml){return this.processHtml(textOrHtml)},processHtml:function(html){for(var currentResult,inBetweenTagsText,htmlRegex=this.htmlRegex,lastIndex=0,anchorTagStackCount=0,resultHtml=[];null!==(currentResult=htmlRegex.exec(html));){var tagText=currentResult[0],tagName=currentResult[2],isClosingTag=!!currentResult[1];inBetweenTagsText=html.substring(lastIndex,currentResult.index),lastIndex=currentResult.index+tagText.length,"a"===tagName?isClosingTag?(anchorTagStackCount=Math.max(anchorTagStackCount-1,0),0===anchorTagStackCount&&resultHtml.push(inBetweenTagsText)):(anchorTagStackCount++,resultHtml.push(this.processTextNode(inBetweenTagsText))):0===anchorTagStackCount?resultHtml.push(this.processTextNode(inBetweenTagsText)):resultHtml.push(inBetweenTagsText),resultHtml.push(tagText)}if(lastIndex<html.length){var processedTextNode=this.processTextNode(html.substring(lastIndex));resultHtml.push(processedTextNode)}return resultHtml.join("")},processTextNode:function(text){var me=this,matcherRegex=this.matcherRegex,enableTwitter=this.twitter,enableEmailAddresses=this.email,enableUrls=this.urls;return text.replace(matcherRegex,function(matchStr,$1,$2,$3,$4,$5){var twitterMatch=$1,twitterHandlePrefixWhitespaceChar=$2,twitterHandle=$3,emailAddress=$4,urlMatch=$5,prefixStr="",suffixStr="",lastChar=matchStr.charAt(matchStr.length-1);if(")"===lastChar){var openParensMatch=matchStr.match(/\(/g),closeParensMatch=matchStr.match(/\)/g),numOpenParens=openParensMatch&&openParensMatch.length||0,numCloseParens=closeParensMatch&&closeParensMatch.length||0;numCloseParens>numOpenParens&&(matchStr=matchStr.substr(0,matchStr.length-1),suffixStr=")")}var anchorHref=matchStr,anchorText=matchStr;if(twitterMatch&&!enableTwitter||emailAddress&&!enableEmailAddresses||urlMatch&&!enableUrls||urlMatch&&-1===urlMatch.indexOf("."))return prefixStr+anchorText+suffixStr;var linkType="url";twitterMatch?(linkType="twitter",prefixStr=twitterHandlePrefixWhitespaceChar,anchorHref="https://twitter.com/"+twitterHandle,anchorText="@"+twitterHandle):emailAddress?(linkType="email",anchorHref="mailto:"+emailAddress,anchorText=emailAddress):/^[A-Za-z]{3,9}:/i.test(anchorHref)||(anchorHref="http://"+anchorHref);var anchorTag=me.createAnchorTag(linkType,anchorHref,anchorText);return prefixStr+anchorTag+suffixStr})},createAnchorTag:function(linkType,anchorHref,anchorText){var attributesStr=this.createAnchorAttrsStr(linkType,anchorHref);return anchorText=this.processAnchorText(anchorText),"<a "+attributesStr+">"+anchorText+"</a>"},createAnchorAttrsStr:function(linkType,anchorHref){var attrs=['href="'+anchorHref+'"'],cssClass=this.createCssClass(linkType);return cssClass&&attrs.push('class="'+cssClass+'"'),this.newWindow&&attrs.push('target="_blank"'),attrs.join(" ")},createCssClass:function(linkType){var className=this.className;return className?className+" "+className+"-"+linkType:""},processAnchorText:function(anchorText){return this.stripPrefix&&(anchorText=this.stripUrlPrefix(anchorText)),anchorText=this.removeTrailingSlash(anchorText),anchorText=this.doTruncate(anchorText)},stripUrlPrefix:function(text){return text.replace(this.urlPrefixRegex,"")},removeTrailingSlash:function(anchorText){return"/"===anchorText.charAt(anchorText.length-1)&&(anchorText=anchorText.slice(0,-1)),anchorText},doTruncate:function(anchorText){var truncateLen=this.truncate;return truncateLen&&anchorText.length>truncateLen&&(anchorText=anchorText.substring(0,truncateLen-2)+".."),anchorText}},Autolinker.link=function(text,options){var autolinker=new Autolinker(options);return autolinker.link(text)},Autolinker});var JSONTree=function(){var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},b=0,c=0;this.create=function(a){return c+=1,p(f(a,0,!1),{"class":"jstValue"})};var d=function(b){return b.replace(/[&<>'"]/g,function(b){return a[b]})},e=function(){return c+"_"+b++},f=function(a,b,c){if(null===a)return l(c?b:0);var d=typeof a;switch(d){case"boolean":return k(a,c?b:0);case"number":return j(a,c?b:0);case"string":return i(a,c?b:0);default:return a instanceof Array?h(a,b,c):g(a,b,c)}},g=function(a,b,c){var d=e(),f=Object.keys(a).map(function(c){return m(c,a[c],b+1,!0)}).join(o()),g=[r("{",c?b:0,d),p(f,{id:d}),s("}",b)].join("\n");return p(g,{})},h=function(a,b,c){var d=e(),g=a.map(function(a){return f(a,b+1,!0)}).join(o()),h=[r("[",c?b:0,d),p(g,{id:d}),s("]",b)].join("\n");return h},i=function(a,b){return p(t(n(d(a)),b),{"class":"jstStr"})},j=function(a,b){return p(t(a,b),{"class":"jstNum"})},k=function(a,b){return p(t(a,b),{"class":"jstBool"})},l=function(a){return p(t("null",a),{"class":"jstNull"})},m=function(a,b,c){var e=t(n(d(a))+": ",c),g=p(f(b,c,!1),{});return p(e+g,{"class":"jstProperty"})},n=function(a){return'"'+a+'"'},o=function(){return p(",\n",{"class":"jstComma"})},p=function(a,b){return q("span",b,a)},q=function(a,b,c){return"<"+a+Object.keys(b).map(function(a){return" "+a+'="'+b[a]+'"'}).join("")+">"+c+"</"+a+">"},r=function(a,b,c){return p(t(a,b),{"class":"jstBracket"})+p("",{"class":"jstFold",onclick:"JSONTree.toggle('"+c+"')"})};this.toggle=function(a){var b=document.getElementById(a),c=b.parentNode,d=b.previousElementSibling;""===b.className?(b.className="jstHiddenBlock",c.className="jstFolded",d.className="jstExpand"):(b.className="",c.className="",d.className="jstFold")};var s=function(a,b){return p(t(a,b),{})},t=function(a,b){return Array(2*b+1).join(" ")+a};return this}();!function(){angular.module("rails",["ng"])}(),function(){angular.module("rails").factory("RailsInflector",function(){function camelize(key){return angular.isString(key)?key.replace(/_[\w\d]/g,function(match,index,string){return 0===index?match:string.charAt(index+1).toUpperCase()}):key}function underscore(key){return angular.isString(key)?key.replace(/[A-Z]/g,function(match,index){return 0===index?match:"_"+match.toLowerCase()}):key}function pluralize(value){return value+"s"}return{camelize:camelize,underscore:underscore,pluralize:pluralize}})}(),function(undefined){angular.module("rails").factory("RailsResourceInjector",["$injector",function($injector){function getDependency(dependency){return dependency?angular.isString(dependency)?$injector.get(dependency):dependency:undefined}function createService(service){return service?$injector.instantiate(getDependency(service)):undefined}function getService(service){return angular.isObject(service)?service:service?createService(service):undefined}return{createService:createService,getService:getService,getDependency:getDependency}}])}(),function(){angular.module("rails").factory("railsUrlBuilder",["$interpolate",function($interpolate){return function(url){var expression;return angular.isFunction(url)||angular.isUndefined(url)?url:(-1===url.indexOf($interpolate.startSymbol())&&(url=url+"/"+$interpolate.startSymbol()+"id"+$interpolate.endSymbol()),expression=$interpolate(url),function(params){return url=expression(params),"/"===url.charAt(url.length-1)&&(url=url.substr(0,url.length-1)),url})}}])}(),function(undefined){angular.module("rails").provider("railsSerializer",function(){var defaultOptions={underscore:undefined,camelize:undefined,pluralize:undefined,exclusionMatchers:[]};this.underscore=function(fn){return defaultOptions.underscore=fn,this},this.camelize=function(fn){return defaultOptions.camelize=fn,this},this.pluralize=function(fn){return defaultOptions.pluralize=fn,this},this.exclusionMatchers=function(exclusions){return defaultOptions.exclusionMatchers=exclusions,this},this.$get=["$injector","RailsInflector","RailsResourceInjector",function($injector,RailsInflector,RailsResourceInjector){function railsSerializer(options,customizer){function Serializer(){angular.isFunction(options)&&(customizer=options,options={}),this.exclusions={},this.inclusions={},this.serializeMappings={},this.deserializeMappings={},this.customSerializedAttributes={},this.preservedAttributes={},this.customSerializers={},this.nestedResources={},this.options=angular.extend({excludeByDefault:!1},defaultOptions,options||{}),customizer&&customizer.call(this,this)}return Serializer.prototype.exclude=function(){var exclusions=this.exclusions;return angular.forEach(arguments,function(attributeName){exclusions[attributeName]=!1}),this},Serializer.prototype.only=function(){var inclusions=this.inclusions;return this.options.excludeByDefault=!0,angular.forEach(arguments,function(attributeName){inclusions[attributeName]=!0}),this},Serializer.prototype.nestedAttribute=function(){var self=this;return angular.forEach(arguments,function(attributeName){self.rename(attributeName,attributeName+"_attributes")}),this},Serializer.prototype.resource=function(attributeName,resource,serializer){return this.nestedResources[attributeName]=resource,serializer&&this.serializeWith(attributeName,serializer),this},Serializer.prototype.rename=function(javascriptName,jsonName,bidirectional){return this.serializeMappings[javascriptName]=jsonName,(bidirectional||bidirectional===undefined)&&(this.deserializeMappings[jsonName]=javascriptName),this},Serializer.prototype.add=function(attributeName,value){return this.customSerializedAttributes[attributeName]=value,this},Serializer.prototype.preserve=function(attributeName){return this.preservedAttributes[attributeName]=!0,this},Serializer.prototype.serializeWith=function(attributeName,serializer){return this.customSerializers[attributeName]=serializer,this},Serializer.prototype.isExcludedFromSerialization=function(attributeName){if(this.options.excludeByDefault&&!this.inclusions.hasOwnProperty(attributeName)||this.exclusions.hasOwnProperty(attributeName))return!0;if(this.options.exclusionMatchers){var excluded=!1;return angular.forEach(this.options.exclusionMatchers,function(matcher){angular.isString(matcher)?excluded=excluded||0===attributeName.indexOf(matcher):angular.isFunction(matcher)?excluded=excluded||matcher.call(undefined,attributeName):matcher instanceof RegExp&&(excluded=excluded||matcher.test(attributeName))}),excluded}return!1},Serializer.prototype.getSerializedAttributeName=function(attributeName){var mappedName=this.serializeMappings[attributeName]||attributeName,mappedNameExcluded=this.isExcludedFromSerialization(mappedName),attributeNameExcluded=this.isExcludedFromSerialization(attributeName);if(this.options.excludeByDefault){if(mappedNameExcluded&&attributeNameExcluded)return undefined}else if(mappedNameExcluded||attributeNameExcluded)return undefined;return this.underscore(mappedName)},Serializer.prototype.isExcludedFromDeserialization=function(){return!1},Serializer.prototype.getDeserializedAttributeName=function(attributeName){var camelizedName=this.camelize(attributeName);return camelizedName=this.deserializeMappings[attributeName]||this.deserializeMappings[camelizedName]||camelizedName,this.isExcludedFromDeserialization(attributeName)||this.isExcludedFromDeserialization(camelizedName)?undefined:camelizedName},Serializer.prototype.getNestedResource=function(attributeName){return RailsResourceInjector.getDependency(this.nestedResources[attributeName])},Serializer.prototype.getAttributeSerializer=function(attributeName){var resource=this.getNestedResource(attributeName),serializer=this.customSerializers[attributeName];return serializer?RailsResourceInjector.createService(serializer):resource?resource.config.serializer:undefined},Serializer.prototype.serializeValue=function(data){var result=data,self=this;if(angular.isArray(data))result=[],angular.forEach(data,function(value){result.push(self.serializeValue(value))});else if(angular.isObject(data)){if(angular.isDate(data))return data;result={},angular.forEach(data,function(value,key){angular.isFunction(value)||self.serializeAttribute(result,key,value)})}return result},Serializer.prototype.serializeAttribute=function(data,attribute,value){var serializer=this.getAttributeSerializer(attribute),serializedAttributeName=this.getSerializedAttributeName(attribute);serializedAttributeName!==undefined&&(data[serializedAttributeName]=serializer?serializer.serialize(value):this.serializeValue(value))},Serializer.prototype.serialize=function(data){var result=this.serializeValue(data),self=this;return angular.isObject(result)&&angular.forEach(this.customSerializedAttributes,function(value,key){angular.isFunction(value)&&(value=value.call(data,data)),self.serializeAttribute(result,key,value)}),result},Serializer.prototype.deserializeValue=function(data,Resource){var result=data,self=this;if(angular.isArray(data))result=[],angular.forEach(data,function(value){result.push(self.deserializeValue(value,Resource))});else if(angular.isObject(data)){if(angular.isDate(data))return data;result={},Resource&&(result=new Resource.config.resourceConstructor),angular.forEach(data,function(value,key){self.deserializeAttribute(result,key,value)})}return result},Serializer.prototype.deserializeAttribute=function(data,attribute,value){var serializer,NestedResource,attributeName=this.getDeserializedAttributeName(attribute);attributeName!==undefined&&(serializer=this.getAttributeSerializer(attributeName),NestedResource=this.getNestedResource(attributeName),data[attributeName]=this.preservedAttributes[attributeName]?value:serializer?serializer.deserialize(value,NestedResource):this.deserializeValue(value,NestedResource))},Serializer.prototype.deserialize=function(data,Resource){return this.deserializeValue(data,Resource)},Serializer.prototype.pluralize=function(value){return this.options.pluralize?this.options.pluralize(value):value},Serializer.prototype.underscore=function(value){return this.options.underscore?this.options.underscore(value):value},Serializer.prototype.camelize=function(value){return this.options.camelize?this.options.camelize(value):value},Serializer}return defaultOptions.underscore=defaultOptions.underscore||RailsInflector.underscore,defaultOptions.camelize=defaultOptions.camelize||RailsInflector.camelize,defaultOptions.pluralize=defaultOptions.pluralize||RailsInflector.pluralize,railsSerializer.defaultOptions=defaultOptions,railsSerializer}]})}(),function(undefined){angular.module("rails").factory("railsRootWrapper",function(){return{wrap:function(data,resource){var result={};return result[angular.isArray(data)?resource.config.pluralName:resource.config.name]=data,result},unwrap:function(response,resource){return response.data&&response.data.hasOwnProperty(resource.config.name)?response.data=response.data[resource.config.name]:response.data&&response.data.hasOwnProperty(resource.config.pluralName)&&(response.data=response.data[resource.config.pluralName]),response}}}),angular.module("rails").provider("RailsResource",function(){var defaultOptions={rootWrapping:!0,updateMethod:"put",httpConfig:{},defaultParams:undefined,underscoreParams:!0,fullResponse:!1,extensions:[]};this.rootWrapping=function(value){return defaultOptions.rootWrapping=value,this},this.updateMethod=function(value){return defaultOptions.updateMethod=value,this},this.httpConfig=function(value){return defaultOptions.httpConfig=value,this},this.defaultParams=function(value){return defaultOptions.defaultParams=value,this
},this.underscoreParams=function(value){return defaultOptions.underscoreParams=value,this},this.fullResponse=function(value){return defaultOptions.fullResponse=value,this},this.extensions=function(){return defaultOptions.extensions=[],angular.forEach(arguments,function(value){defaultOptions.extensions=defaultOptions.extensions.concat(value)}),this},this.$get=["$http","$q","railsUrlBuilder","railsSerializer","railsRootWrapper","RailsResourceInjector",function($http,$q,railsUrlBuilder,railsSerializer,railsRootWrapper,RailsResourceInjector){function RailsResource(value){if(value){var response=this.constructor.deserialize({data:value});this.constructor.config.rootWrapping&&(response=railsRootWrapper.unwrap(response,this.constructor)),angular.extend(this,response.data)}}function appendPath(url,path){return path&&("/"!==path[0]&&(url+="/"),url+=path),url}function forEachDependency(list,callback){for(var dependency,i=0,len=list.length;len>i;i++)dependency=list[i],angular.isString(dependency)&&(dependency=list[i]=RailsResourceInjector.getDependency(dependency)),callback(dependency)}function addMixin(Resource,destination,mixin,callback){var excludedKeys=["included","extended,","configure"];Resource.$mixins||(Resource.$mixins=[]),angular.isString(mixin)&&(mixin=RailsResourceInjector.getDependency(mixin)),mixin&&-1===Resource.$mixins.indexOf(mixin)&&(angular.forEach(mixin,function(value,key){-1===excludedKeys.indexOf(key)&&(destination[key]=value)}),Resource.$mixins.push(mixin),angular.isFunction(callback)&&callback(Resource,mixin))}function loadExtensions(extensions){var modules=[];return angular.forEach(extensions,function(extensionName){extensionName="RailsResource"+extensionName.charAt(0).toUpperCase()+extensionName.slice(1)+"Mixin",modules.push(RailsResourceInjector.getDependency(extensionName))}),modules}function booleanParam(value,defaultValue){return angular.isUndefined(value)?defaultValue:value}function createInterceptorSuccessCallback(thenFn,resourceConstructor,context){return function(data){return(thenFn||angular.identity)(data,resourceConstructor,context)}}function createInterceptorRejectionCallback(rejectFn,resourceConstructor,context){return function(rejection){return rejectFn?rejectFn(rejection,resourceConstructor,context):$q.reject(rejection)}}return RailsResource.extendTo=function(child){function ctor(){this.constructor=child}return angular.forEach(this,function(value,key){child[key]=value}),angular.isArray(this.$modules)&&(child.$modules=this.$modules.slice(0)),ctor.prototype=this.prototype,child.prototype=new ctor,child.__super__=this.prototype,child},RailsResource.extend=function(){return angular.forEach(arguments,function(mixin){addMixin(this,this,mixin,function(Resource,mixin){angular.isFunction(mixin.extended)&&mixin.extended(Resource)})},this),this},RailsResource.include=function(){return angular.forEach(arguments,function(mixin){addMixin(this,this.prototype,mixin,function(Resource,mixin){angular.isFunction(mixin.included)&&mixin.included(Resource)})},this),this},RailsResource.configure=function(cfg){cfg=cfg||{},this.config&&(cfg=angular.extend({},this.config,cfg)),this.config={},this.config.url=cfg.url,this.config.rootWrapping=booleanParam(cfg.rootWrapping,defaultOptions.rootWrapping),this.config.httpConfig=cfg.httpConfig||defaultOptions.httpConfig,this.config.httpConfig.headers=angular.extend({Accept:"application/json","Content-Type":"application/json"},this.config.httpConfig.headers||{}),this.config.defaultParams=cfg.defaultParams||defaultOptions.defaultParams,this.config.underscoreParams=booleanParam(cfg.underscoreParams,defaultOptions.underscoreParams),this.config.updateMethod=(cfg.updateMethod||defaultOptions.updateMethod).toLowerCase(),this.config.fullResponse=booleanParam(cfg.fullResponse,defaultOptions.fullResponse),this.config.requestTransformers=cfg.requestTransformers?cfg.requestTransformers.slice(0):[],this.config.responseInterceptors=cfg.responseInterceptors?cfg.responseInterceptors.slice(0):[],this.config.afterResponseInterceptors=cfg.afterResponseInterceptors?cfg.afterResponseInterceptors.slice(0):[],this.config.interceptors=cfg.interceptors?cfg.interceptors.slice(0):[],this.config.serializer=RailsResourceInjector.getService(cfg.serializer||railsSerializer()),this.config.name=this.config.serializer.underscore(cfg.name),this.config.name&&(this.config.pluralName=this.config.serializer.underscore(cfg.pluralName||this.config.serializer.pluralize(this.config.name))),this.config.urlBuilder=railsUrlBuilder(this.config.url),this.config.resourceConstructor=this,this.extend.apply(this,loadExtensions((cfg.extensions||[]).concat(defaultOptions.extensions))),angular.forEach(this.$mixins,function(mixin){angular.isFunction(mixin.configure)&&mixin.configure(this.config,cfg)},this)},RailsResource.setUrl=function(url){this.configure({url:url})},RailsResource.buildUrl=function(context){return this.config.urlBuilder(context)},RailsResource.addInterceptor=function(interceptor){this.config.interceptors.push(interceptor)},RailsResource.intercept=function(phase,fn){var interceptor={};fn=RailsResourceInjector.getDependency(fn),interceptor[phase]=function(value,resourceConstructor,context){return fn(value,resourceConstructor,context)||value},this.addInterceptor(interceptor)},RailsResource.interceptBeforeRequest=function(fn){this.intercept("beforeRequest",fn)},RailsResource.interceptBeforeRequestWrapping=function(fn){this.intercept("beforeRequestWrapping",fn)},RailsResource.interceptRequest=function(fn){this.intercept("request",fn)},RailsResource.interceptBeforeResponse=function(fn){this.intercept("beforeResponse",fn)},RailsResource.interceptBeforeResponseDeserialize=function(fn){this.intercept("beforeResponseDeserialize",fn)},RailsResource.interceptResponse=function(fn){this.intercept("response",fn)},RailsResource.interceptAfterResponse=function(fn){this.intercept("afterResponse",fn)},RailsResource.beforeResponse=function(fn){fn=RailsResourceInjector.getDependency(fn),this.interceptResponse(function(response,resource,context){return fn(response.data,resource.config.resourceConstructor,context),response})},RailsResource.afterResponse=function(fn){fn=RailsResourceInjector.getDependency(fn),this.interceptAfterResponse(function(response,resource,context){return fn(response,resource.config.resourceConstructor,context),response})},RailsResource.beforeRequest=function(fn){fn=RailsResourceInjector.getDependency(fn),this.interceptBeforeRequestWrapping(function(httpConfig,resource){return httpConfig.data=fn(httpConfig.data,resource.config.resourceConstructor)||httpConfig.data,httpConfig})},RailsResource.serialize=function(httpConfig){return httpConfig.data&&(httpConfig.data=this.config.serializer.serialize(httpConfig.data)),httpConfig},RailsResource.deserialize=function(response){return response.data=this.config.serializer.deserialize(response.data,this.config.resourceConstructor),response},RailsResource.callResponseInterceptors=function(promise,context){var config=this.config;return forEachDependency(config.responseInterceptors,function(interceptor){promise.resource=config.resourceConstructor,promise.context=context,promise=interceptor(promise)}),promise},RailsResource.callAfterResponseInterceptors=function(promise){var config=this.config;return forEachDependency(config.afterResponseInterceptors,function(interceptor){promise.resource=config.resourceConstructor,promise=interceptor(promise)}),promise},RailsResource.runInterceptorPhase=function(phase,context,promise){var config=this.config,chain=[];for(forEachDependency(config.interceptors,function(interceptor){(interceptor[phase]||interceptor[phase+"Error"])&&chain.push(interceptor[phase],interceptor[phase+"Error"])});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(createInterceptorSuccessCallback(thenFn,config.resourceConstructor,context),createInterceptorRejectionCallback(rejectFn,config.resourceConstructor,context))}return promise},RailsResource.$http=function(httpConfig,context,resourceConfigOverrides){var config=angular.extend(angular.copy(this.config),resourceConfigOverrides||{}),resourceConstructor=config.resourceConstructor,promise=$q.when(httpConfig);return promise=this.runInterceptorPhase("beforeRequest",context,promise).then(function(httpConfig){return httpConfig=resourceConstructor.serialize(httpConfig),forEachDependency(config.requestTransformers,function(transformer){httpConfig.data=transformer(httpConfig.data,config.resourceConstructor)}),httpConfig}),promise=this.runInterceptorPhase("beforeRequestWrapping",context,promise),config.rootWrapping&&(promise=promise.then(function(httpConfig){return httpConfig.data=railsRootWrapper.wrap(httpConfig.data,config.resourceConstructor),httpConfig})),promise=this.runInterceptorPhase("request",context,promise).then(function(httpConfig){return $http(httpConfig)}),promise=this.runInterceptorPhase("beforeResponse",context,promise),promise=this.runInterceptorPhase("beforeResponse",context,promise).then(function(response){return response.originalData=response.data,response}),config.rootWrapping&&(promise=promise.then(function(response){return railsRootWrapper.unwrap(response,config.resourceConstructor)})),promise=this.runInterceptorPhase("beforeResponseDeserialize",context,promise).then(function(response){return resourceConstructor.deserialize(response)}),promise=this.callResponseInterceptors(promise,context),promise=this.runInterceptorPhase("response",context,promise).then(function(response){return context&&response.hasOwnProperty("data")&&angular.isObject(response.data)&&angular.extend(context,response.data),config.fullResponse?response:context||response.data}),promise=this.callAfterResponseInterceptors(promise,context),promise=this.runInterceptorPhase("afterResponse",context,promise),promise.resource=config.resourceConstructor,promise.context=context,promise},RailsResource.processParameters=function(queryParams){var newParams={};return angular.isObject(queryParams)&&this.config.underscoreParams?(angular.forEach(queryParams,function(v,k){newParams[this.config.serializer.underscore(k)]=v},this),newParams):queryParams},RailsResource.getParameters=function(queryParams){var params;return this.config.defaultParams&&(params=angular.copy(this.config.defaultParams)),angular.isObject(queryParams)&&(params=angular.extend(params||{},queryParams)),this.processParameters(params)},RailsResource.getHttpConfig=function(queryParams){var params=this.getParameters(queryParams);return params?angular.extend({params:params},this.config.httpConfig):angular.copy(this.config.httpConfig)},RailsResource.$url=RailsResource.resourceUrl=function(context,path){return angular.isObject(context)||(context={id:context}),appendPath(this.buildUrl(context||{}),path)},RailsResource.$get=function(url,queryParams){return this.$http(angular.extend({method:"get",url:url},this.getHttpConfig(queryParams)))},RailsResource.query=function(queryParams,context){return this.$get(this.resourceUrl(context),queryParams)},RailsResource.get=function(context,queryParams){return this.$get(this.resourceUrl(context),queryParams)},RailsResource.prototype.$url=function(path){return appendPath(this.constructor.resourceUrl(this),path)},RailsResource.prototype.$http=function(httpConfig){return this.constructor.$http(httpConfig,this,resourceConfigOvverides)},angular.forEach(["post","put","patch"],function(method){RailsResource["$"+method]=function(url,data){return data=angular.copy(data),this.$http(angular.extend({method:method,url:url,data:data},this.getHttpConfig()))},RailsResource.prototype["$"+method]=function(url){var data=angular.copy(this,{});return this.constructor.$http(angular.extend({method:method,url:url,data:data},this.constructor.getHttpConfig()),this)}}),RailsResource.prototype.create=function(){return this.$post(this.$url(),this)},RailsResource.prototype.update=function(){return this["$"+this.constructor.config.updateMethod](this.$url(),this)},RailsResource.prototype.isNew=function(){return angular.isUndefined(this.id)||null===this.id},RailsResource.prototype.save=function(){return this.isNew()?this.create():this.update()},RailsResource.$delete=function(url,queryParams){return this.$http(angular.extend({method:"delete",url:url},this.getHttpConfig(queryParams)))},RailsResource.prototype.$delete=function(url,queryParams){return this.constructor.$http(angular.extend({method:"delete",url:url},this.constructor.getHttpConfig(queryParams)),this)},RailsResource.prototype.remove=RailsResource.prototype["delete"]=function(){return this.$delete(this.$url())},RailsResource}]}),angular.module("rails").factory("railsResourceFactory",["RailsResource",function(RailsResource){return function(config){function Resource(){Resource.__super__.constructor.apply(this,arguments)}return RailsResource.extendTo(Resource),Resource.configure(config),Resource}}])}(),angular.module("campusLib",[]),function(){angular.module("campusLib").directive("activityPanel",["$rootScope",function($rootScope){return{replace:!0,restrict:"E",scope:!0,transclude:!0,controller:["$scope","$timeout",function($scope){return this.fullscreen=function(isFullscreen){return isFullscreen?$rootScope.$emit("page:editor:fullscreen"):$rootScope.$emit("page:editor:collapse"),$scope.fullscreen=isFullscreen},this.collapse=function(){return $scope.collapsed=!0},this.expand=function(){return $scope.collapsed=!1},this}],template:'<div class="panel panel--activity panelList" ng-class=\'{"is-fullscreen": fullscreen, "is-collapsed": collapsed}\' ng-transclude>\n\n</div>',link:function(scope,element){return element.hasClass("is-collapsed")&&(scope.collapsed=!0),scope.$on("editor:fixed",function(){return element.addClass("is-fixed"),element.css({top:""})}),scope.$on("editor:notFixed",function(evt,eventData){return element.removeClass("is-fixed"),eventData.top?element.css({top:eventData.top}):void 0})}}}])}.call(this),function(){angular.module("campusLib").directive("fixed",["$timeout",function(){return{restrict:"A",require:"^activityPanel",link:function(scope,element,attrs,activityPanelCtrl){return activityPanelCtrl.expand()}}}])}.call(this),function(){angular.module("campusLib").directive("panelElement",["$compile",function(){return{restrict:"E",replace:!0,transclude:!0,require:"^activityPanel",scope:!0,controller:["$scope",function($scope){return this.fullScreenOff=function(){return $scope.disableFullScreen()},this}],template:"<div class='panel panelList-item' ng-class=\"{'is-fullscreen': isFullScreen}\">\n  <a href='' class='panelList-item-toggle panel-toggle toggle' ng-click='toggleFullscreen()' ng-if='controls.indexOf(\"fullscreen\") > -1' analytics-on analytics-event=\"Panel Fullscreen\">\n    <b class='srt'>Fullscreen</b>\n  </a>\n  <div ng-transclude></div>\n</div>",link:function(scope,element,attrs,activityPanelCtrl){var _ref;return scope.controls=null!=(_ref=attrs.controls)?_ref.split(/\s?,\s?/):void 0,scope.cachedTotalElements=0,scope.cachedIndex=0,attrs.fullScreen&&"true"===attrs.fullScreen?(scope.isFullScreen=!0,activityPanelCtrl.fullscreen(!0)):scope.isFullScreen=!1,scope.disableFullScreen=function(){return scope.isFullScreen=!1,activityPanelCtrl.fullscreen(!1),scope.index=scope.cachedIndex,scope.totalElements=scope.cachedTotalElements},scope.toggleFullscreen=function(){scope.isFullScreen?scope.disableFullScreen():(scope.isFullScreen=!0,activityPanelCtrl.fullscreen(!0),scope.cachedIndex=scope.index,scope.index=0,scope.cachedTotalElements=scope.totalElements,scope.totalElements=1)}}}}])}.call(this),function(){angular.module("campusLib").directive("panelTabControls",["$timeout",function($timeout){return{restrict:"A",require:"^activityPanel",link:function(scope,element,attrs,activityPanelCtrl){return element.on("click",function(evt){return $timeout(function(){return $(evt.target).hasClass("is-open")?(activityPanelCtrl.collapse(),$(evt.target).removeClass("is-open")):(activityPanelCtrl.expand(),$(element).find(".is-open").removeClass("is-open"),$(evt.target).addClass("is-open"))})}),scope.$on("#destroy",function(){return element.off()})}}}])}.call(this),function(){angular.module("campusLib").directive("codeMirror",["$compile","$parse","$timeout","KeyboardShortcuts",function($compile,$parse,$timeout){return{replace:!1,require:"?ngModel",restrict:"E",scope:!0,template:'<div class="cm-s-default"></div>',link:function(scope,element,attrs,ngModelCtrl){var clearHighlighting,codeEditor,codeMirrorEvents,configureHighlighting,highlightingMarks,setOptions,unWatchOnInit;return highlightingMarks=[],codeMirrorEvents={change:["$instance","$changeObj"],changes:["$instance","$changes"],beforeChange:["$instance","$changeObj"],cursorActivity:["$instance"],keyHandled:["$instance","$name","$event"],inputRead:["$instance","$changeObj"],electricInput:["$instance","$line"],beforeSelectionChange:["$instance","$obj"],viewportChange:["$instance","$from","$to"],swapDoc:["$instance","$oldDoc"],gutterClick:["$instance","$line","$gutter","$clickEvent"],gutterContextMenu:["$instance","$line","$gutter","$contextMenu"],focus:["$instance"],blur:["$instance"],scroll:["$instance"],scrollCursorIntoView:["$instance","$event"],update:["$instance"],renderLine:["$instance","$line","$element"],mousedown:["$instance","$event"],dblclick:["$instance","$event"],contextmenu:["$instance","$event"],keydown:["$instance","$event"],keypress:["$instance","$event"],keyup:["$instance","$event"],dragstart:["$instance","$event"],dragenter:["$instance","$event"],dragover:["$instance","$event"],drop:["$instance","$event"]},codeEditor=scope.$instance=scope.$editor=CodeMirror(element[0],{}),ngModelCtrl&&(codeEditor.setValue(ngModelCtrl.$viewValue||""),ngModelCtrl.$render=function(){return codeEditor.setValue(ngModelCtrl.$viewValue||"")},codeEditor.on("change",function(codeMirror){var newValue;return newValue=codeMirror.getValue(),newValue!==ngModelCtrl.$viewValue?ngModelCtrl.$setViewValue(newValue):void 0})),setOptions=function(newOptions,oldOptions){return _.each(oldOptions,function(option,name){return codeEditor.setOption(name,CodeMirror.defaults[name])}),_.each(newOptions,function(option,name){return codeEditor.setOption(name,option)})},scope.$watch($parse(attrs.options),setOptions,!0),$timeout(function(){return _.each(codeMirrorEvents,function(eventArgs,eventName){var eventHandler,normalizedName;return normalizedName="on"+(eventName.charAt(0).toUpperCase()+eventName.slice(1)),attrs[normalizedName]?(eventHandler=$parse(attrs[normalizedName]),codeEditor.on(eventName,function(){var argMap,args;return args=arguments,argMap=_.reduce(eventArgs,function(argMap,value,index){return argMap[value]=args[index],argMap},{}),$timeout(function(){return eventHandler(scope,argMap)})})):void 0})}),codeEditor.on("update",_.debounce(function(){return _.each(highlightingMarks,function(textMarker){var highlight,highlightElement;return highlight=textMarker.__highlight,(null!=highlight?highlight.message:void 0)?(highlightElement=element.find("."+textMarker.__id),highlightElement.attr("popover",""),highlightElement.attr("popover-trigger","hover"),highlightElement.attr("popover-message",highlight.message),highlightElement.attr("popover-placement","bottom"),highlightElement.replaceWith($compile(highlightElement)(scope))):void 0})})),attrs.onInit&&(unWatchOnInit=scope.$watch(attrs.onInit,function(val){return $parse(val)(scope.$parent,{$editor:codeEditor,$instance:codeEditor}),unWatchOnInit()})),scope.isVisible=function(){return $(element).find(".cm-s-default").is(":visible")},scope.$watch("isVisible()",function(isVisible){return isVisible?codeEditor.refresh():void 0}),clearHighlighting=function(){return _.each(highlightingMarks,function(textMarker){return textMarker.clear()}),highlightingMarks=[]},configureHighlighting=function(highlighting,value,property){return _.each(value,function(highlight,index){var configuredHighlighting,highlightConfig,id;return id="cm-"+property+"--"+index,highlightConfig={options:{__id:id,__highlight:highlight,className:"cm-"+property+" "+id}},configuredHighlighting=_.extend({},highlight,highlightConfig),highlighting.push(configuredHighlighting)}),highlighting},scope.$watch($parse(attrs.highlighting),function(highlighting){return clearHighlighting(),highlighting?(highlighting=_.reduce(highlighting,configureHighlighting,[]),_.each(highlighting,function(highlight){return highlightingMarks.push(codeEditor.markText(highlight.from,highlight.to,highlight.options))})):void 0}),scope.$on("$destroy",function(){var handlersByName;return handlersByName=codeEditor._handlers,_.each(handlersByName,function(handlers,name){return _.each(handlers.slice(0),function(handler){return codeEditor.off(name,handler)})})})}}}])}.call(this),function(){angular.module("campusLib").directive("compileHtml",["$compile","CampusUtil",function($compile,CampusUtil){return{restrict:"A",link:function(scope,element,attrs){return attrs.$observe("compileHtml",function(val){var compileScope,_ref;return val&&(element.empty(),element.html(val)),compileScope=(null!=(_ref=scope[attrs.scope])?_ref.$new():void 0)||scope.$new(),compileScope.contents=[],element.find("code").attr("ng-non-bindable",""),element.find("code-highlight").each(function(index,codeHighlightElement){var codeHighlight,decodedContents;return codeHighlight=$(codeHighlightElement),decodedContents=CampusUtil.decodeHtml(codeHighlight.html()),compileScope.contents.push(decodedContents),codeHighlight.empty(),codeHighlight.attr("bind-content","contents["+index+"]")}),$compile(element.contents())(compileScope)})}}}])}.call(this),function(){angular.module("campusLib").directive("convertToCodemirror",["CurrentCourseConfig","$timeout","$parse","CampusUtil",function(CurrentCourseConfig,$timeout,$parse,CampusUtil){return{replace:!1,restrict:"A",require:"?ngModel",scope:!0,link:function(scope,element,attrs,ctrl){var content,lineWidgets,ngModelGet,options,syntax,theme;return options=$parse(attrs.convertToCodemirror)(scope)||{},syntax=options.syntax||attrs.syntax||"default",theme=options.theme||attrs.theme||"default",content=ctrl&&ctrl.$viewValue||element.val(),lineWidgets=[],attrs.bindSyntax&&(syntax=CampusUtil.filterSyntax($parse(attrs.bindSyntax)(scope)),scope.$watch(attrs.bindSyntax,function(boundSyntax){return scope.codemirrorEditor?(scope.codemirrorEditor.setOption("mode",CampusUtil.filterSyntax(boundSyntax)),scope.codemirrorEditor.refresh()):void 0})),attrs.bindOptions&&(options=$parse(attrs.bindOptions)(scope),scope.$watch(attrs.bindOptions,function(boundOptions){return options=boundOptions,scope.codemirrorEditor?(_.each(bindOptions,function(value,key){return scope.codemirrorEditor.setOption(key,value)}),scope.codemirrorEditor.refresh()):void 0})),attrs.ngModel&&(ngModelGet=$parse(attrs.ngModel),content=ngModelGet(scope)),scope.elementIsVisible=function(){return scope.codemirrorEditor?$(scope.codemirrorEditor.getWrapperElement()).is(":visible"):void 0},scope.getContent=function(){return scope.codemirrorEditor?scope.codemirrorEditor.doc.getValue():void 0},scope.$watch("elementIsVisible()",function(isVisible){return isVisible?$timeout(function(){return scope.codemirrorEditor.refresh()}):void 0}),new CurrentCourseConfig(scope.courseIdentifier).data().then(function(configData){return theme=options.theme||configData.default_editor_theme||"default",scope.codemirrorEditor=CodeMirror.fromTextArea(element[0],{value:content,mode:CampusUtil.filterSyntax(syntax),theme:theme,tabSize:2,lineNumbers:!0,readOnly:options.readOnly||!1,foldGutter:!0,electricChars:!1,lineWrapping:!!attrs.wrap,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]}),$timeout(function(){return scope.codemirrorEditor.refresh()},1e3),options.collapse&&_.each(options.collapse,function(option){var el,mark;if(option)return mark=scope.codemirrorEditor.markText(option[0],option[1],option[2]),el=$("<a href=''>...</a>")[0],lineWidgets.push({widget:scope.codemirrorEditor.addLineWidget(option[0].line,el),mark:mark,el:el}),$(el).on("click",function(evt){var foundWidget,thisEl;return evt.preventDefault(),thisEl=this,foundWidget=_.find(lineWidgets,function(widget){return widget.el===thisEl}),foundWidget.mark.clear(),foundWidget.widget.clear()})}),ctrl?(scope.codemirrorEditor.on("change",function(){return ctrl.$setViewValue(scope.getContent())}),ctrl.$render=function(){return scope.codemirrorEditor.setValue(ctrl.$viewValue||"")},$timeout(function(){return ctrl&&ctrl.$viewValue?void 0:ctrl.$setViewValue(content)})):void 0}),scope.$on("$destroy",function(){return scope.codemirrorEditor.off("change"),_.each(lineWidgets,function(widget){return widget.mark.clear(),widget.widget.clear(),widget=null})})}}}])}.call(this),function(){angular.module("campusLib").directive("spanInput",["$cookies","$timeout","Submitter",function($cookies,$timeout,Submitter){return{replace:!0,restrict:"E",require:"?ngModel",scope:!0,template:'<input class="form-input form-input--inline stateInput" type="text" />',link:function(scope,element,attrs,ngModelCtrl){var clone,elementStyles,submitter,updateWidth,_ref;return clone=$("<span></span>"),elementStyles={},scope.$course&&scope.$page&&(submitter=Submitter.get(scope.$course,scope.$page),submitter.on("finally",function(){return $timeout(updateWidth)})),$timeout(function(){return elementStyles=element.css(["border-left-width","border-right-width","box-sizing","font-family","font-size","font-weight","padding-left","padding-right"]),elementStyles=$.extend({borderLeftStyle:"solid",borderRightStyle:"solid",display:"inline-block",minWidth:0,whiteSpace:"nowrap",position:"absolute",top:"-1000px"},elementStyles),clone.css(elementStyles),updateWidth()}),updateWidth=function(){var text;return text=element.val().replace(/\s/g,""),clone.text(text),clone.css("padding-right",element.css("padding-right")),element.after(clone),element.outerWidth(clone.outerWidth()),clone.detach()},ngModelCtrl?(scope.binding=null!=(_ref=scope.input)?_ref.binding:void 0,scope.binding&&(ngModelCtrl.$setViewValue($cookies[scope.binding]),scope.checkBinding=function(){return $cookies[scope.binding]},scope.$watch("checkBinding()",function(newValue){return ngModelCtrl.$viewValue!==$cookies[scope.binding]?(ngModelCtrl.$setViewValue(newValue),element.val(newValue)):void 0})),element.on("input",function(){return updateWidth(),ngModelCtrl.$setViewValue(element.val()),scope.binding?($cookies[scope.binding]=element.val(),scope.$apply()):void 0}),ngModelCtrl.$render=function(){return element.val(ngModelCtrl.$viewValue),updateWidth()},ngModelCtrl.$viewValue&&element.val(ngModelCtrl.$viewValue),scope.$on("$destroy",function(){return clone.remove(),clone=null})):void 0}}}])}.call(this),function(){angular.module("campusLib").filter("snippetify",function(){var compileCode;return compileCode=function(code,keys){var template;return(template=_.template(code.replace(/^\n+|\n+$/g,"")))(keys)},function(code,snippets,htmlEncode){var compiledSnippets;return null==htmlEncode&&(htmlEncode=!1),snippets&&snippets.length>0?code&&code.match(/<%.*%>/)?(compiledSnippets={},_.each(snippets,function(snippet){var snippetCode;return snippetCode=compileCode(snippet.content,compiledSnippets),htmlEncode&&(snippetCode=$("<div/>").append(snippetCode).html()),compiledSnippets[snippet.name]=snippetCode}),compileCode(code,compiledSnippets)):code:code}})}.call(this),function(){angular.module("campusLib").provider("Logger",function(){var options;options={errorEnabled:!0,infoEnabled:!0,debuggerEnabled:!0,warnEnabled:!0},this.errorEnabled=function(value){return options.errorEnabled=value},this.infoEnabled=function(value){return options.infoEnabled=value},this.debugEnabled=function(value){return options.debugEnabled=value},this.warnEnabled=function(value){return options.warnEnabled=value},this.$get=["$log",function($log){var logger;return logger=$log,new function(){return{error:options.errorEnabled?logger.error:function(){return{}},info:options.infoEnabled?logger.info:function(){return{}},debug:options.debugEnabled?logger.debug:function(){return{}},warn:options.warnEnabled?logger.warn:function(){return{}}}}}]})}.call(this),function(){angular.module("campusFilters",["campusServices"])}.call(this),function(){angular.module("campusFilters").filter("markdown",["HTMLUtils",function(HTMLUtils){return function(text){return HTMLUtils.toHtml(text)}}])}.call(this),function(){angular.module("campusServices",[])}.call(this),function(){angular.module("campusServices").factory("ClientPersistence",["$parse",function($parse){var ClientPersistence,clientGet,clientGetAll,clientPersistenceObj,clientSet;return localStorage.ClientPersistence||(localStorage.ClientPersistence="{}"),clientPersistenceObj=function(){return JSON.parse(localStorage.ClientPersistence)},clientSet=function(courseIdentifier,key,value){var storeObj;return storeObj=clientPersistenceObj(),storeObj[courseIdentifier]||(storeObj[courseIdentifier]={}),storeObj[courseIdentifier][key]=value,localStorage.ClientPersistence=JSON.stringify(storeObj)},clientGet=function(courseIdentifier,key){var storeObj;return storeObj=clientPersistenceObj(),$parse(key)(storeObj[courseIdentifier])},clientGetAll=function(courseIdentifier){var storeObj;return storeObj=clientPersistenceObj(),storeObj[courseIdentifier]},ClientPersistence=function(){function ClientPersistence(courseIdentifier){if(!courseIdentifier)throw new Error("A courseIdentifier is required when creating a new ClientPersistence object.");this.courseIdentifier=courseIdentifier}return ClientPersistence.prototype.get=function(key){return clientGet(this.courseIdentifier,key)},ClientPersistence.prototype.getAll=function(){return clientGetAll(this.courseIdentifier)},ClientPersistence.prototype.set=function(key,value){return clientSet(this.courseIdentifier,key,value)},ClientPersistence}()}])}.call(this),function(){angular.module("campusServices").factory("CampusEvent",function(){var events;return events={},{on:function(eventName,callback){return events[eventName]||(events[eventName]=[]),events[eventName].indexOf(callback)<0&&events[eventName].push(callback),this},once:function(eventName,callback){var removeCallback;return removeCallback=function(_this){return function(data){return callback(data),_this.off(eventName,removeCallback)}}(this),this.on(eventName,removeCallback),this},off:function(eventName,callback){var cbIndex;return eventName?events[eventName]&&(callback?(cbIndex=events[eventName].indexOf(callback),cbIndex>=0&&events[eventName].splice(cbIndex,1)):callback||delete events[eventName]):(events=null,events={}),this},emit:function(eventName,data){var cb,_i,_len,_ref;if(events[eventName])for(_ref=events[eventName].slice(),_i=0,_len=_ref.length;_len>_i;_i++)(cb=_ref[_i])(data);return this},makeEventEmitter:function(emitter,namespaceFactory){var namespaces;return namespaces=[],emitter.on=function(_this){return function(eventName,callback){var namespace;return namespace=namespaceFactory(eventName),_.contains(namespaces,namespace)||namespaces.push(namespace),_this.on(namespace,callback)}}(this),emitter.once=function(_this){return function(eventName,callback){var namespace;return namespace=namespaceFactory(eventName),_.contains(namespaces,namespace)||namespaces.push(namespace),_this.once(namespace,callback)}}(this),emitter.off=function(_this){return function(eventName,callback){var namespace,_i,_len,_results;if(eventName)return _this.off(namespaceFactory(eventName),callback);for(_results=[],_i=0,_len=namespaces.length;_len>_i;_i++)namespace=namespaces[_i],_results.push(_this.off(namespace));return _results}}(this),emitter.emit=function(_this){return function(eventName,data){return _this.emit(namespaceFactory(eventName),data)}}(this),this}}})}.call(this),function(){angular.module("campusServices").factory("CancelError",["$q",function(){var CancelError;return CancelError=function(){function CancelError(reason){this.message=reason}return CancelError}()}])}.call(this),function(){angular.module("campusServices").factory("Canceller",["$q","CancelError",function($q,CancelError){var Canceller;return Canceller=function(){function Canceller(){this.cancelDeferred=$q.defer()}return Canceller.prototype.submit=function(executeCallback){var promise;return promise=this.cancelDeferred.promise,executeCallback(promise),this},Canceller.prototype.cancel=function(reason){return null==reason&&(reason=void 0),this.cancelDeferred.resolve(new CancelError(reason)),this.cancelDeferred.promise},Canceller.prototype.whenCancelled=function(onCancelCallback){return this.cancelDeferred.promise.then(onCancelCallback)},Canceller}()}])}.call(this),function(){angular.module("campusServices").factory("FlashMessage",["$rootScope",function(){return{flashOpen:void 0,isShow:function(cb){return this.isShowCb=cb},show:function(options){return this.isShowCb(options)},isClear:function(cb){return this.isClearCb=cb},clear:function(){return this.isClearCb()
}}}])}.call(this),function(){angular.module("campusServices").factory("HTMLUtils",["Markdown",function(Markdown){return{isHtml:function(string){return/^\s*<.+>[\s\S]*<\/.+>\s*$/.test(string)},toHtml:function(string){return this.isHtml(string)?string:Markdown.parse(string)}}}])}.call(this),function(){angular.module("campusServices").factory("Autolinker",function(){return{link:function(text,options){return options=options||{urls:!1},Autolinker.link(null!=text?text.replace(/\$/g,"&#36"):void 0,options)}}})}.call(this),function(){angular.module("campusServices").factory("BlackboardLoader",["$q",function($q){var isLoaded,loadingDeferred;return isLoaded=!1,loadingDeferred=$q.defer(),{load:function(){return function(playerUrl){return isLoaded||(isLoaded=!0,$.getScript(playerUrl).done(function(){return loadingDeferred.resolve()}).fail(function(){return isLoaded=!1,loadingDeferred.reject()})),loadingDeferred.promise}}(this)}}])}.call(this),function(){angular.module("campusServices").factory("CacheKey",function(){var CacheKey,cache;return cache={},CacheKey=function(){function CacheKey(){}return CacheKey.prototype.cacheKeyNamespace="key",CacheKey.prototype.setCacheKey=function(courseIdentifier,cacheKey){return cache[""+courseIdentifier+":"+this.cacheKeyNamespace]=cacheKey},CacheKey.prototype.getCacheKey=function(courseIdentifier){return cache[""+courseIdentifier+":"+this.cacheKeyNamespace]},CacheKey.prototype.validateCacheKey=function(courseIdentifier,cacheKey){var currentKey;return currentKey=this.getCacheKey(courseIdentifier),cacheKey!==currentKey?(this.clearCourse(courseIdentifier),this.setCacheKey(courseIdentifier,cacheKey)):void 0},CacheKey.prototype.clearCourse=function(){return _.each(cache,function(value,key,cache){return courseMatcher-new RegExp("^"+courseIdentidier),courseMatcher.test(key)?delete cache[key]:void 0})},CacheKey}()})}.call(this),function(){angular.module("campusServices").factory("CampusUrl",["$rootScope","CacheKey","CurrentCourseConfig","RailsAssets","$q",function($rootScope,CacheKey,CurrentCourseConfig,RailsAssets,$q){var cacheKeyService,configData;return cacheKeyService=new CacheKey,configData=null,$rootScope.courseIdentifier&&new CurrentCourseConfig($rootScope.courseIdentifier).data().then(function(data){return configData=data}),{initForCourse:function(courseIdentifier){var deferred;return deferred=$q.defer(),new CurrentCourseConfig(courseIdentifier).data().then(function(data){return configData=data,deferred.resolve(data)}),deferred.promise},currentUrl:function(){return""+this.protocol()+"//"+this.host()+"/courses/"+this.courseIdentifier()+"/"+$rootScope.queryString},badgeUrl:function(badgeName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/achievements/badges/"+this.fingerPrintFile(badgeName)},appImageUrl:function(imageName){return""+this.assetHost()+"/assets/"+RailsAssets.path(imageName)},imageUrl:function(imageName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/images/"+this.fingerPrintFile(imageName)},courseAssetUrl:function(assetName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/"+this.fingerPrintFile(assetName)},baseCourseAssetUrl:function(assetName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/"+assetName},javascriptUrl:function(fileName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/javascripts/"+this.fingerPrintFile(fileName)},appAssetUrl:function(assetName){return""+this.assetHost()+"/assets/"+RailsAssets.path(assetName)},subtitleUrl:function(fileName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/subtitles/"+this.fingerPrintFile(fileName)},pdfUrl:function(pdfName){return""+this.assetHost()+"/"+this.courseIdentifier()+"/assets/pdf/"+this.fingerPrintFile(pdfName)},pdfExternalUrl:function(pdfName){return""+this.protocol()+"//"+pdfName},authUrl:function(){return""+this.origin()+"/auth/"+configData.authentication_provider},iframeUrl:function(){return""+this.assetHost()+"/iframe.html"},sandboxScriptUrl:function(){return this.javascriptUrl(configData.sandbox_script)},courseStylesheetUrl:function(){return""+this.origin()+"/course-assets/"+this.courseIdentifier()+"/course.css"},host:function(){return window.location.host},protocol:function(){return window.location.protocol},origin:function(){var port;return port=window.location.port?":"+window.location.port:"",""+window.location.protocol+"//"+window.location.hostname+port},courseIdentifier:function(){return $rootScope.courseIdentifier.replace(/-/g,"_")},cacheKey:function(){return cacheKeyService.getCacheKey($rootScope.courseIdentifier)},fingerPrintFile:function(fileName){var extension,strArray;return strArray=fileName.split("."),extension=strArray.pop(),""+strArray.join(".")+"-"+this.cacheKey()+"."+extension},assetHost:function(){var railsAssetHost;return railsAssetHost="dhg7upb7j7jqa.cloudfront.net",railsAssetHost?""+this.protocol()+"//"+railsAssetHost:this.origin()}}}])}.call(this),function(){angular.module("campusServices").factory("CampusUtil",function(){return{escapeHTML:function(string){return(""+string).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},unescapeHTML:function(string){return(""+string).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,'"').replace(/&#x2F;/g,"/")},filterSyntax:function(syntax){var altSyntaxes;return altSyntaxes={handlebars:{name:"handlebars",base:"text/html"},html:"htmlmixed",sql:"text/x-sql",typescript:"application/typescript"},altSyntaxes[syntax]||syntax},uid:function(){var _p8;return _p8=function(s){var p;return p=(Math.random().toString(16)+"000000000").substr(2,8),s?"-"+p.substr(0,4)+"-"+p.substr(4,4):p},_p8()+_p8(!0)+_p8(!0)+_p8()},nowDate:function(){var options;return options={weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},new Date(Date.now()).toLocaleDateString("en-US",options)},encodeHtml:function(html){return $("<div/>").text(html).html()},decodeHtml:function(html){return $("<div/>").html(html).text()}}})}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("CourseMap",["$q","ApiHelper","CourseContentUserData","CourseIndexData","ClientExecutorData","CampusEvent","ModelFactory",function($q,ApiHelper,CourseContentUserData,CourseIndexData,ClientExecutorData,CampusEvent,ModelFactory){var CourseMap,courseByUids,expandedUids,requiredExceptions;return expandedUids={},courseByUids={},requiredExceptions=["video"],CourseMap=function(){function CourseMap(course){this.collapse=__bind(this.collapse,this),this.expand=__bind(this.expand,this);var courseByUidBuilder,_name;this.course=course,this.courseIndexData=new CourseIndexData(course.identifier),this.courseContentUserData=new CourseContentUserData(course.identifier),CampusEvent.makeEventEmitter(this,function(eventName){return"courseMap:"+eventName+":"+course.$meta.uid}),courseByUids[course.identifier]||(courseByUids[_name=course.identifier]||(courseByUids[_name]={}),courseByUidBuilder=function(node){return-1!==["course","level","section","page"].indexOf(node.$meta.type)?courseByUids[course.identifier][node.$meta.uid]=ModelFactory.get(course.identifier,node):void 0},this.courseIndexData.traverse(this.courseIndexData.get(),courseByUidBuilder))}return CourseMap.hasMeta=function(node){return _.contains(_.keys(node),"$meta")},CourseMap.isCourse=function(node){return"course"===node.$meta.type},CourseMap.isLevel=function(page){return"level"===page.$meta.type},CourseMap.isLevelWrapUp=function(page){return"level_wrap_up"===page.type},CourseMap.isSection=function(page){return"section"===page.$meta.type},CourseMap.isChallenge=function(page){return page.required&&-1===requiredExceptions.indexOf(page.type)},CourseMap.isAttempt=function(page){return-1!==["success","attempt"].indexOf(page.$meta.type)},CourseMap.isRequired=function(page){return page.required},CourseMap.isVideo=function(page){return"video"===page.type},CourseMap.not=function(check){return function(page){return!check(page)}},CourseMap.prototype.isExpanded=function(uidable){return expandedUids[uidable.$meta.uid]},CourseMap.prototype.expand=function(uidable){var uid;return uid=uidable.$meta.uid,expandedUids[uid]=uidable,this.emit("expanded:"+uid,uidable),this.emit("expanded",uidable)},CourseMap.prototype.expandAll=function(uidables){return null==uidables&&(uidables=[]),_.isEmpty(uidables)&&(uidables=_.values(courseByUids[this.course.identifier])),_.each(uidables,this.expand)},CourseMap.prototype.collapse=function(uidable){var uid;return uid=uidable.$meta.uid,delete expandedUids[uid],this.emit("collapsed:"+uid,uidable),this.emit("collapsed",uidable)},CourseMap.prototype.collapseAll=function(uidables){return null==uidables&&(uidables=[]),_.isEmpty(uidables)&&(uidables=_.values(expandedUids)),_.each(uidables,this.collapse)},CourseMap}()}])}.call(this),function(){angular.module("campusServices").factory("CurrentPage",function(){return{course:null,level:null,section:null,page:null}})}.call(this),function(){angular.module("campusServices").factory("ApiHelper",function(){var has,isEmptyDescriptor;return isEmptyDescriptor=function(descriptor){var hasAttributes,noAttributes,noValue;return hasAttributes=_.has(descriptor,"attributes"),noValue=_.has(descriptor,"value")&&_.isNull(descriptor.value),noAttributes=!hasAttributes||hasAttributes&&_.isNull(descriptor.attributes),noValue&&noAttributes},has=function(descriptor,property){return _.has(descriptor,property)&&!_.isNull(descriptor[property])},{normalizeData:function(rawData){var attr,attribute,data,_i,_j,_len,_len1,_ref,_ref1;if(_.isNull(rawData))return null;if(_.isArray(rawData))return _.collect(rawData,function(_this){return function(item){return _this.normalizeData(item)}}(this));if(isEmptyDescriptor(rawData))return null;if(has(rawData,"attributes")){for(data={},_ref=Object.keys(rawData.attributes||{}),_i=0,_len=_ref.length;_len>_i;_i++)attr=_ref[_i],attribute=rawData.attributes[attr]&&rawData.attributes[attr].attributes&&1===Object.keys(rawData.attributes[attr].attributes).length&&rawData.attributes[attr].attributes[attr]||rawData.attributes[attr],data[attr]=this.normalizeData(attribute);for(_ref1=Object.keys(rawData||{}),_j=0,_len1=_ref1.length;_len1>_j;_j++)attr=_ref1[_j],data.$meta||(data.$meta={}),"attributes"!==attr&&(data.$meta[attr]=rawData[attr]);return data}return _.has(rawData,"value")&&_.has(rawData,"type")?"boolean"===rawData.type?_.isString(rawData.value)?"true"===rawData.value:rawData.value:rawData.value:rawData}}})}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("AttemptData",["Logger","$q","$timeout","CampusApi","CourseQueryStringIndex",function(Logger,$q,$timeout,CampusApi,CourseQueryStringIndex){var AttemptData,retryDelay;return retryDelay=2e3,AttemptData=function(){function AttemptData(courseIdentifier){this.recordAttempt=__bind(this.recordAttempt,this),this.courseIdentifier=courseIdentifier,this.dataApi=new CampusApi(courseIdentifier)}return AttemptData.prototype.recordAttempt=function(uid,report,contentArray){var params;return params={query_string:CourseQueryStringIndex.getQueryString(this.courseIdentifier,uid),course_identifier:this.courseIdentifier,service:"attempts",service_method:"post_create_attempt_for_uid",service_args:JSON.stringify([uid,contentArray,{failures:report.success()?[]:[report.message()]}])},this.dataApi.post({data:params}).success(function(){return function(){return Logger.info("Attempt recorded successfully"),!0}}(this)).error(function(_this){return function(){return $timeout(function(){return _this.recordAttempt(report,contentArray)},retryDelay),Logger.error("Attempt failed to be recorded")}}(this))},AttemptData}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("CampusApi",["$http","$state",function($http){var CampusApi;return CampusApi=function(){function CampusApi(courseIdentifier){this.filterErrors=__bind(this.filterErrors,this),this.http=__bind(this.http,this),this.post=__bind(this.post,this),this.get=__bind(this.get,this),this.courseIdentifier=courseIdentifier}return CampusApi.prototype.get=function(options){return options.method="GET",this.http(options)},CampusApi.prototype.post=function(options){return options.method="POST",this.http(options)},CampusApi.prototype.http=function(options){var promise;return options.url="/courses/content/"+this.courseIdentifier,promise=$http(options),this.filterErrors(promise),promise},CampusApi.prototype.filterErrors=function(promise){return promise.error(function(data,status){return 0!==status?401!==status?(console.log("Api call has resulted in an error:"),console.log(data)):void 0:void 0})},CampusApi}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("ClientExecutorData",["Logger","$q","ApiHelper","CampusApi","CourseQueryStringIndex",function(Logger,$q,ApiHelper,CampusApi,CourseQueryStringIndex){var ClientExecutorData;return ClientExecutorData=function(){function ClientExecutorData(courseIdentifier){this.fetchExecutorData=__bind(this.fetchExecutorData,this),this.courseIdentifier=courseIdentifier,this.dataApi=new CampusApi(this.courseIdentifier)}return ClientExecutorData.prototype.get=function(uid,options){var deferred;return deferred=$q.defer(),this.fetchExecutorData(uid,options).then(function(data){var executorData;return executorData=data.data,executorData.attempts=ApiHelper.normalizeData(executorData.attempts),executorData.failures=ApiHelper.normalizeData(executorData.failures),deferred.resolve(executorData)})["catch"](function(data){return deferred.reject(data)}),deferred.promise},ClientExecutorData.prototype.fetchExecutorData=function(uid,options){return null==options&&(options={}),options.params={query_string:CourseQueryStringIndex.getQueryString(this.courseIdentifier,uid),course_identifier:this.courseIdentifier,service:"executor",service_method:"get_executor_data_for_uid",service_args:JSON.stringify([uid])},options.cache=!0,Logger.info("Fetching executor data from the server"),this.dataApi.get(options)},ClientExecutorData}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("ContentCache",function(){var ContentCache,cacheStore,getCache;return cacheStore={},getCache=function(nameSpace){return cacheStore[nameSpace]||(cacheStore[nameSpace]={})},ContentCache=function(){function ContentCache(nameSpace){this.loadData=__bind(this.loadData,this),this.cache=__bind(this.cache,this),this.nameSpace=nameSpace}return ContentCache.prototype.get=function(label){return getCache(this.nameSpace)[label]},ContentCache.prototype.set=function(label,data){return getCache(this.nameSpace)[label]=data},ContentCache.prototype.flush=function(label){return delete getCache(this.nameSpace)[label]},ContentCache.prototype.flushAll=function(){return cacheStore[this.nameSpace]={}},ContentCache.prototype.cache=function(label,callback){var cached_data;return cached_data=this.get(label),cached_data?cached_data:this.set(label,callback.call)},ContentCache.prototype.loadData=function(data){return _.extend(getCache(this.nameSpace),data)},ContentCache}()})}.call(this),function(){angular.module("campusServices").factory("ContentEdit",["CampusApi","$q",function(CampusApi,$q){return{saveData:function(editObj,contentData,startCb){return this.saveContentData(editObj.courseIdentifier,editObj.queryString,contentData,startCb)},saveContentData:function(courseIdentifier,queryString,contentData,startCb){var deferred;return deferred=$q.defer(),this._postContentData(courseIdentifier,queryString,contentData,deferred,startCb),deferred.promise},_postContentData:_.debounce(function(courseIdentifier,queryString,contentData,deferred,startCb){var params;return startCb&&startCb(),params={query_string:queryString,course_identifier:courseIdentifier,service:"content_edit",service_method:"save_page_content",service_args:JSON.stringify([contentData])},new CampusApi(params.course_identifier).post({data:params}).success(function(){return function(data){return deferred.resolve(data)}}(this)).error(function(){return function(data){return deferred.reject(data)}}(this))["finally"](function(){return deferred.startCb=null})},2e3)}}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("CourseContentData",["$q","ApiHelper","CampusApi","ContentCache","CourseQueryStringIndex",function($q,ApiHelper,CampusApi,ContentCache,CourseQueryStringIndex){var CourseContentData,inProgressRequests;return inProgressRequests={},CourseContentData=function(){function CourseContentData(courseIdentifier){this.getParents=__bind(this.getParents,this),this.findParent=__bind(this.findParent,this),this.get=__bind(this.get,this),this.courseIdentifier=courseIdentifier,this.cache=new ContentCache(""+this.courseIdentifier+":CourseContentData"),this.dataApi=new CampusApi(courseIdentifier)}return CourseContentData.prototype.load=function(data){return _.each(data,function(rawData,key){return data[key]=ApiHelper.normalizeData(rawData)}),this.cache.loadData(data),data},CourseContentData.prototype.getBuilder=function(uid){var deferred;return deferred=$q.defer(),uid?(this._fetchDataFromRemote(uid,{post_process:"raw"}).then(function(){return function(data){return deferred.resolve(data[uid])}}(this))["catch"](function(err){return deferred.reject(err)}),deferred.promise):(deferred.resolve(null),deferred.promise)},CourseContentData.prototype.get=function(uid,options){var deferred,requestedData;return null==options&&(options={}),deferred=$q.defer(),uid?(requestedData=this.cache.get(uid),requestedData&&options.cache!==!1?deferred.resolve(requestedData):this._fetchDataFromRemote(uid,options).then(function(_this){return function(data){return _this.load(data),deferred.resolve(_this.cache.get(uid))}}(this))["catch"](function(err){return deferred.reject(err)}),deferred.promise):(deferred.resolve(null),deferred.promise)},CourseContentData.prototype.findParent=function(uid,predicate){return this.getParents(uid).then(function(parents){return _.find(parents,function(parent){return predicate(parent)})})},CourseContentData.prototype.getParents=function(uid){var deferred,getParentData,parents;return deferred=$q.defer(),parents={},getParentData=function(_this){return function(uid){return _this.get(uid).then(function(contentData){var parentUid;return parents[contentData.$meta.type]=contentData,parentUid=contentData.$meta.parent,parentUid?getParentData(parentUid).then:deferred.resolve(parents)})}}(this),getParentData(uid),deferred.promise},CourseContentData.prototype._responseDataHasData=function(data){return"null"!==data&&!!data},CourseContentData.prototype._fetchDataFromRemote=function(uid,options){var params;return null==options&&(options={}),inProgressRequests[uid]?inProgressRequests[uid]:(void 0===options.cache&&(options.cache=!0),params={query_string:CourseQueryStringIndex.getQueryString(this.courseIdentifier,uid),course_identifier:this.courseIdentifier,service:"content_data",service_method:"get_client_json_by_uid",service_args:JSON.stringify([uid,options])},inProgressRequests[uid]=this.dataApi.get({params:params,cache:options.cache}).then(function(){return function(data){return data.data}}(this))["finally"](function(){return delete inProgressRequests[uid]}))},CourseContentData}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("CourseContentUserData",["$q","ApiHelper","ContentCache","CampusApi","CampusEvent","CourseQueryStringIndex",function($q,ApiHelper,ContentCache,CampusApi,CampusEvent,CourseQueryStringIndex){var CourseContentUserData,inProgressRequest;return inProgressRequest={},CourseContentUserData=function(){function CourseContentUserData(courseIdentifier){this._fetchAllDataFromRemote=__bind(this._fetchAllDataFromRemote,this),this._fetchDataFromRemote=__bind(this._fetchDataFromRemote,this),this.getAll=__bind(this.getAll,this),this.get=__bind(this.get,this),this.all=__bind(this.all,this),this.load=__bind(this.load,this),this.flushAll=__bind(this.flushAll,this),this.flushEach=__bind(this.flushEach,this),this.flushData=__bind(this.flushData,this),this.courseIdentifier=courseIdentifier,this.cache=new ContentCache(""+this.courseIdentifier+":CourseContentUserData"),this.dataApi=new CampusApi(courseIdentifier),CampusEvent.makeEventEmitter(this,function(event){return""+courseIdentifier+":contentUserData:"+event})}return CourseContentUserData.prototype.flushData=function(uid){return this.cache.flush(uid)},CourseContentUserData.prototype.flushEach=function(uids){return null==uids&&(uids=[]),_.each(uids,function(_this){return function(uid){return _this.flushData(uid)}}(this))},CourseContentUserData.prototype.flushAll=function(){return this.cache.flushAll()},CourseContentUserData.prototype.load=function(data){return _.each(data,function(rawData){return rawData.hints.used_hints=ApiHelper.normalizeData(rawData.hints.used_hints),rawData.tasks=ApiHelper.normalizeData(rawData.tasks)}),this.cache.loadData(data),this.emit("update"),data},CourseContentUserData.prototype.all=function(){var params;return inProgressRequest[this.courseIdentifier]?inProgressRequest[this.courseIdentifier]:(params={query_string:"/",course_identifier:this.courseIdentifier,service:"content_data",service_method:"get_user_content_data"},inProgressRequest[this.courseIdentifier]=this.dataApi.get({params:params}).then(function(_this){return function(data){return _this.load(data.data)}}(this))["finally"](function(_this){return function(){return delete inProgressRequest[_this.courseIdentifier]}}(this)))},CourseContentUserData.prototype.get=function(uid){var deferred,requestedData;return deferred=$q.defer(),requestedData=this.cache.get(uid),requestedData?deferred.resolve(requestedData):this._fetchDataFromRemote(uid).then(function(_this){return function(){return deferred.resolve(_this.cache.get(uid))}}(this))["catch"](function(err){return deferred.reject(err)}),deferred.promise},CourseContentUserData.prototype.getAll=function(uids,options){var deferred,missingUids,requestedData,requestedDataMap;return options||(options={}),deferred=$q.defer(),requestedDataMap={},requestedData=_.compact(_.map(uids,function(_this){return function(uid){var cachedData;return cachedData=_this.cache.get(uid),options.refresh?null:(cachedData&&(requestedDataMap[uid]=cachedData),cachedData)}}(this))),requestedData.length!==uids.length?(missingUids=_.filter(uids,function(uid){return!requestedDataMap[uid]}),this._fetchAllDataFromRemote(missingUids).then(function(){return function(missingUserData){return _.each(missingUserData,function(userData,uid){return requestedDataMap[uid]=userData}),deferred.resolve(requestedDataMap)}}(this))):deferred.resolve(requestedDataMap),deferred.promise},CourseContentUserData.prototype.updateAttribute=function(uid,label,value){var cachedData,data,dataObj,key,keys;if(cachedData=this.cache.get(uid),data=cachedData){for(keys=label.split(".");keys.length>0;)key=keys.shift(),0===keys.length?data[key]=value:data=data[key];return dataObj={},dataObj[uid]=cachedData,this.load(dataObj),value}},CourseContentUserData.prototype._responseDataHasData=function(data){return"null"!==data&&!!data},CourseContentUserData.prototype._fetchDataFromRemote=function(uid){var params;return inProgressRequest[this.courseIdentifier]?inProgressRequest[this.courseIdentifier].then(function(_this){return function(){return _this.cache.get(uid)}}(this)):inProgressRequest[uid]?inProgressRequest[uid]:(params={query_string:CourseQueryStringIndex.getQueryString(this.courseIdentifier,uid),course_identifier:this.courseIdentifier,service:"content_data",service_method:"get_user_content_data_for_uid",service_args:JSON.stringify([uid])},inProgressRequest[uid]=this.dataApi.get({params:params}).then(function(_this){return function(data){var result;return result={},result[uid]=data.data,_this.load(result)}}(this))["finally"](function(){return delete inProgressRequest[uid]}),inProgressRequest[uid])},CourseContentUserData.prototype._fetchAllDataFromRemote=function(uids){var allRequested,deferreds,inProgressRequests,params,requestedUidPromises;return inProgressRequest[this.courseIdentifier]?inProgressRequest[this.courseIdentifier].then(function(_this){return function(){var data;return data={},_.each(uids,function(uid){return data[uid]=_this.cache.get(uid)}),data}}(this)):(allRequested=_.every(uids,function(uid){return!!inProgressRequest[uid]}),requestedUidPromises=_.map(uids,function(uid){return inProgressRequest[uid]}),allRequested?$q.all(requestedUidPromises):(params={query_string:"/",course_identifier:this.courseIdentifier,service:"content_data",service_method:"get_user_content_data_for_uids",service_args:JSON.stringify([uids])},deferreds={},inProgressRequests=[],_.each(uids,function(uid){return deferreds[uid]=$q.defer(),inProgressRequest[uid]=deferreds[uid].promise,inProgressRequests.push(inProgressRequest[uid])}),this.dataApi.get({params:params}).then(function(_this){return function(data){return _this.load(data.data),_.each(data.data,function(item,uid){return deferreds[uid].resolve(item)}),data.data}}(this))["finally"](function(){return _.each(uids,function(uid){return delete inProgressRequest[uid]})})))},CourseContentUserData}()}])}.call(this),function(){angular.module("campusServices").factory("CourseIndexData",["ApiHelper",function(ApiHelper){var CourseIndexData,courseIndexData,nodesByUids,traverse;return courseIndexData={},nodesByUids={},traverse=function(node,callback){var visitNode;return null==callback&&(callback=function(){}),(visitNode=function(currentNode){var hasUid,sortedChildren;return hasUid=currentNode&&currentNode.$meta&&currentNode.$meta.uid,hasUid?(callback(currentNode),_.each(currentNode,function(childNode){return visitNode(childNode)})):_.isArray(currentNode)?(sortedChildren=_.sortBy(currentNode,function(childNode){return childNode.$meta.attribute_order}),_.each(sortedChildren,function(childNode){return visitNode(childNode)})):void 0})(node)},CourseIndexData=function(){function CourseIndexData(courseIdentifier){this.courseIdentifier=courseIdentifier}return CourseIndexData.prototype.load=function(data){var normalizedData,_name;return normalizedData=ApiHelper.normalizeData(data),courseIndexData[this.courseIdentifier]=normalizedData,nodesByUids[_name=this.courseIdentifier]||(nodesByUids[_name]={}),_.isEmpty(nodesByUids[this.courseIdentifier])?traverse(normalizedData,function(_this){return function(node){return nodesByUids[_this.courseIdentifier][node.$meta.uid]=node}}(this)):void 0},CourseIndexData.prototype.get=function(){return courseIndexData[this.courseIdentifier]},CourseIndexData.prototype.getParents=function(node){var getParent,parents;return parents={},getParent=function(_this){return function(node){var parent,parentUid;return parentUid=node.$meta.parent,parentUid?(parent=_this.find(parentUid),parents[parent.$meta.type]=parent,getParent(parent)):void 0}}(this),getParent(node),parents},CourseIndexData.prototype.find=function(uid){return nodesByUids[this.courseIdentifier]&&nodesByUids[this.courseIdentifier][uid]},CourseIndexData.prototype.collect=function(node){var nodeCollector,nodes;return null==node&&(node=this.get()),nodes=[],nodeCollector=function(node){return nodes.push(node)},this.traverse(node,nodeCollector),nodes},CourseIndexData.prototype.traverse=function(node,callback){return null==node&&(node=this.get()),null==callback&&(callback=function(){}),traverse(node,callback)},CourseIndexData}()}])}.call(this),function(){angular.module("campusServices").factory("CourseQueryStringIndex",["CampusApi","CourseIndexData","$q",function(CampusApi,CourseIndexData,$q){var queryStringCache,uidCache;return uidCache={},queryStringCache={},{load:function(courseIdentifier,indexData){return uidCache[courseIdentifier]||(uidCache[courseIdentifier]={}),queryStringCache[courseIdentifier]||(queryStringCache[courseIdentifier]={}),indexData.traverse(null,function(node){return _.isUndefined(node.$meta.uid)||_.isUndefined(node.$meta.query_string)?void 0:(uidCache[courseIdentifier][node.$meta.query_string]=node.$meta.uid,"course"===node.$meta.type&&(uidCache[courseIdentifier]["/"]=node.$meta.uid),queryStringCache[courseIdentifier][node.$meta.uid]=node.$meta.query_string)})},preload:function(courseIdentifier,cache){var deferred,params;return null==cache&&(cache=!0),deferred=$q.defer(),params={query_string:"/",course_identifier:courseIdentifier,service:"content_data",service_method:"get_index_json"},new CampusApi(courseIdentifier).get({params:params,cache:!1}).then(function(_this){return function(data){var courseIndex;return courseIndex=new CourseIndexData(courseIdentifier),courseIndex.load(data.data),_this.load(courseIdentifier,courseIndex),deferred.resolve(_this)}}(this)),deferred.promise},getUid:function(courseIdentifier,queryString){var _ref;return queryString=(null!=(_ref=/(.*)(\/)$/.exec(queryString))?_ref[1]:void 0)||queryString,uidCache[courseIdentifier][queryString]},getQueryString:function(courseIdentifier,uid){return queryStringCache[courseIdentifier][uid]}}}])}.call(this),function(){angular.module("campusServices").factory("CurrentCourseConfig",["$q","CourseContentData","CourseQueryStringIndex","ApiHelper",function($q,CourseContentData,CourseQueryStringIndex){var CurrentCourseConfig;return CurrentCourseConfig=function(){function CurrentCourseConfig(courseIdentifier){this.courseIdentifier=courseIdentifier,this.courseContentService=new CourseContentData(courseIdentifier),this.courseUid=CourseQueryStringIndex.getUid(courseIdentifier,"")}return CurrentCourseConfig.prototype.data=function(){var deferred;return deferred=this.newDeferred(),this.courseContentService.get(this.courseUid).then(function(courseData){return deferred.resolve(courseData.config)}),deferred.promise},CurrentCourseConfig.prototype.newDeferred=function(){return $q.defer()},CurrentCourseConfig.prototype.get=function(configAttribute){var deferred;return deferred=this.newDeferred(),this.courseContentService.get(this.courseUid).then(function(courseData){return deferred.resolve(courseData.config[configAttribute])}),deferred.promise},CurrentCourseConfig}()}])}.call(this),function(){angular.module("campusServices").factory("HintsData",["ApiHelper","CampusApi","CampusEvent",function(ApiHelper,CampusApi){var HintsData;return HintsData=function(){function HintsData(courseIdentifier){this.courseIdentifier=courseIdentifier,this.dataApi=new CampusApi(courseIdentifier)}return HintsData.prototype.getNextHint=function(queryString){var params;return params={query_string:queryString,course_identifier:this.courseIdentifier,service:"hints",service_method:"get_next_hint_data"},this.dataApi.get({params:params}).then(function(hint){return ApiHelper.normalizeData(hint.data[0])})},HintsData}()}])}.call(this),function(){angular.module("campusServices").factory("ProgressData",["CampusApi","CourseQueryStringIndex","Logger",function(CampusApi,CourseQueryStringIndex,Logger){var ProgressData,inProgressRequest;return inProgressRequest={},ProgressData=function(){function ProgressData(courseIdentifier){this.courseIdentifier=courseIdentifier,this.dataApi=new CampusApi(courseIdentifier)}return ProgressData.prototype.completeNonRequiredPage=function(uid){var params,queryString;return queryString=CourseQueryStringIndex.getQueryString(this.courseIdentifier,uid),params={query_string:queryString,course_identifier:this.courseIdentifier,service:"progress",service_method:"post_complete_non_required_item"},Logger.info("Attempting to complete non-required page: "+this.courseIdentifier+":"+queryString),this.dataApi.post({data:params}).then(function(_this){return function(){return Logger.info("Successfully completed non-required page: "+_this.courseIdentifier+":"+queryString),!0}}(this))["catch"](function(){return function(data,status,headers,config){return Logger.error("Error completing non-required page: ",[data,status,headers,config]),!1}}(this))},ProgressData}()}])}.call(this),function(){angular.module("campusServices").factory("ProjectorVideo",["CampusApi",function(CampusApi){var ProjectorVideo;return ProjectorVideo=function(){function ProjectorVideo(courseIdentifier){this.courseIdentifier=courseIdentifier,this.dataApi=new CampusApi(courseIdentifier)}return ProjectorVideo.prototype.get=function(video_ids){var params,videoIds;return videoIds=_.unique(_.compact(_.flatten([video_ids]))),params={query_string:"/",course_identifier:this.courseIdentifier,service:"video",service_method:"get_projector_data",service_args:JSON.stringify([videoIds])},this.dataApi.get({params:params,cache:!0})
},ProjectorVideo}()}])}.call(this),function(){angular.module("campusServices").factory("TaskData",["ApiHelper","CampusApi","CampusEvent",function(ApiHelper,CampusApi,CampusEvent){var TaskData;return TaskData=function(){function TaskData(courseIdentifier){this.courseIdentifier=courseIdentifier,this.dataApi=new CampusApi(courseIdentifier),CampusEvent.makeEventEmitter(this,function(event){return""+courseIdentifier+":taskData:"+event})}return TaskData.prototype.getTaskData=function(queryString,taskName){var params;return params={query_string:queryString,course_identifier:this.courseIdentifier,service:"tasks",service_method:"get_task_data",service_args:taskName},this.dataApi.get({params:params}).then(function(response){return ApiHelper.normalizeData(response.data)})},TaskData}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("UserData",["$http","$q","ApiHelper","CampusApi","CampusEvent","ContentCache","CourseQueryStringIndex",function($http,$q,ApiHelper,CampusApi,CampusEvent,ContentCache){var UserData,inProgressRequest;return inProgressRequest=null,UserData=function(){function UserData(courseIdentifier){this._fetchDataFromRemote=__bind(this._fetchDataFromRemote,this),this.updateAttribute=__bind(this.updateAttribute,this),this.get=__bind(this.get,this),this.load=__bind(this.load,this),this.flushData=__bind(this.flushData,this),this.courseIdentifier=courseIdentifier,this.cache=new ContentCache(""+this.courseIdentifier+":UserData"),this.dataApi=new CampusApi(courseIdentifier),CampusEvent.makeEventEmitter(this,function(event){return""+courseIdentifier+":userData:"+event})}return UserData.prototype.flushData=function(){return this.cache.flushAll()},UserData.prototype.load=function(data){return _.each(data,function(rawData){return _.each(rawData.achievements.awarded,function(item,index,items){return items[index]=ApiHelper.normalizeData(item)}),_.each(rawData.achievements.unawarded,function(item,index,items){return items[index]=ApiHelper.normalizeData(item)})}),this.cache.loadData(data),this.emit("update"),data},UserData.prototype.get=function(options){var deferred,requestedData;return options||(options={}),deferred=$q.defer(),requestedData=this.cache.get("data"),!requestedData||options.refresh?this._fetchDataFromRemote().then(function(){return function(data){return deferred.resolve(data.data)}}(this))["catch"](function(err){return deferred.reject(err)}):deferred.resolve(requestedData),deferred.promise},UserData.prototype.updateAttribute=function(label,value){var cachedData,data,dataObj,key,keys;if(cachedData=this.cache.get("data"),data=cachedData){for(keys=label.split(".");keys.length>0;)key=keys.shift(),0===keys.length?data[key]=value:data=data[key];return dataObj={},dataObj.data=cachedData,this.load(dataObj),value}},UserData.prototype._responseDataHasData=function(data){return"null"!==data&&!!data},UserData.prototype._fetchDataFromRemote=function(){var params;return inProgressRequest?inProgressRequest:(params={query_string:"/",course_identifier:this.courseIdentifier,service:"content_data",service_method:"get_user_data"},inProgressRequest=this.dataApi.get({params:params}).then(function(_this){return function(data){var result;return result={},result.data=_this._responseDataHasData(data)?data.data:null,_this.load(result)}}(this))["finally"](function(){return inProgressRequest=null}))},UserData}()}])}.call(this),function(){angular.module("campusServices").factory("DataBootstrapper",["$templateCache","GoogleAnalytics","CourseIndexData","CourseContentData","CourseQueryStringIndex",function($templateCache,GoogleAnalytics,CourseIndexData,CourseContentData,CourseQueryStringIndex){var DataBootstrapper;return DataBootstrapper=function(){function DataBootstrapper(){}var getLoadedDataFor;return getLoadedDataFor=function(id){return JSON.parse($templateCache.get(id))},DataBootstrapper.prototype.load=function(courseIdentifier){var courseIndexData;return GoogleAnalytics.load(getLoadedDataFor("_googleAnalyticsData")),courseIndexData=new CourseIndexData(courseIdentifier),courseIndexData.load(getLoadedDataFor("_courseIndexData")),new CourseContentData(courseIdentifier).load(getLoadedDataFor("_courseContentData")),CourseQueryStringIndex.load(courseIdentifier,courseIndexData)},DataBootstrapper}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("DeferredQueue",["$q",function($q){var DeferredQueue,removeFromArray;return removeFromArray=function(array,item){return array.splice($.inArray(item,array),1)},DeferredQueue=function(){function DeferredQueue(batchSize){this.run=__bind(this.run,this),this.done=__bind(this.done,this),this.remove=__bind(this.remove,this),this.push=__bind(this.push,this),this._queue=[],this._batchSize=batchSize,this._queueDeferred=$q.defer(),this.promise=this._queueDeferred.promise}return DeferredQueue.prototype.push=function(execute){return this._queue.push(execute)},DeferredQueue.prototype.remove=function(execute){return removeFromArray(this._queue,execute)},DeferredQueue.prototype.done=function(){return 0===this._queue.length},DeferredQueue.prototype.run=function(){var runAll,runBatch,runErrors,runResults;return runResults=[],runErrors=[],runBatch=function(_this){return function(batch){var batchDeferred,batchErrors,batchResults;return batchDeferred=$q.defer(),batchResults=[],batchErrors=[],_.each(batch,function(execute){var promise;return promise=execute(),promise.then(function(result){return batchResults=batchResults.concat(result)}),promise["catch"](function(error){return batchErrors=batchErrors.concat(error)}),promise["finally"](function(){return _this.remove(execute),removeFromArray(batch,execute),0===batch.length?0===batchErrors.length?batchDeferred.resolve(batchResults):batchDeferred.reject(batchErrors):void 0})}),batchDeferred.promise}}(this),runAll=function(_this){return function(){var batch,batchPromise;return _this.done()?0===runErrors.length?_this._queueDeferred.resolve(runResults):_this._queueDeferred.reject(runErrors):(batch=_.first(_this._queue,_this._batchSize),batchPromise=runBatch(batch),batchPromise.then(function(results){return runResults=runResults.concat(results),runAll()}),batchPromise["catch"](function(error){return runErrors=runErrors.concat(error),runAll()}))}}(this),runAll(),this._queueDeferred.promise},DeferredQueue}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("DrawBadgeProgress",function(){var Progress;return Progress=function(){function Progress(options){this.options=options,this.arc=__bind(this.arc,this)}return Progress.prototype.init=function(options){return this.options=options,this.container=this.options.id?document.getElementById(this.options.id):this.options.element,this.svg=this.buildSvg(this.container),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.radius=this.options.radius||this.container.clientWidth/2,this.progressStart=0,this.progressEnd=this.options.progress,this.container.appendChild(this.svg),this.svg.appendChild(this.path),this.svg.setAttribute("height",2*this.radius),this.svg.setAttribute("width",2*this.radius),this.arc(!0),setTimeout(function(_this){return function(){return _this.draw()}}(this),this.options.delay||0)},Progress.prototype.buildSvg=function(container){var classList,existingSvg,svg,svgClass,_i,_len,_ref,_ref1,_ref2;for(svgClass="badge-progress-svg",svg=null,_ref=container.getElementsByTagName("svg"),_i=0,_len=_ref.length;_len>_i;_i++)if(existingSvg=_ref[_i],classList=(null!=(_ref1=existingSvg.classList)?_ref1.toString():void 0)||(null!=(_ref2=existingSvg.className)?_ref2.animVal:void 0),classList.match(new RegExp(svgClass))){svg=existingSvg,svg.innerHTML="";break}return svg||(svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),svg.setAttribute("class",svgClass)),svg},Progress.prototype.draw=function(){return this.progressStart<this.progressEnd?(this.animateId=requestAnimationFrame(this.arc),this.progressStart++):void 0},Progress.prototype.arc=function(once){var angle,d,flag,x2,y2;return d="",0===this.progressStart?d="M 0 "+this.radius+"\na "+this.radius+" "+this.radius+" 0 1 0 "+2*this.radius+" 0\na "+this.radius+" "+this.radius+" 0 1 0 -"+2*this.radius+" 0":(angle=this.progressStart/100*Math.PI*2-2*Math.PI,x2=this.radius+this.radius*Math.sin(angle),y2=this.radius-this.radius*Math.cos(angle),flag=angle>-Math.PI?0:1,d="M "+this.radius+", "+this.radius+"\nL "+this.radius+", 0\nA "+this.radius+", "+this.radius+" 1 "+flag+" 0 "+x2+", "+y2+"\nZ"),this.path.setAttribute("d",d),once!==!0?this.draw():void 0},Progress.prototype.update=function(progressEnd){return this.progressEnd=progressEnd,this.draw()},Progress.prototype.teardown=function(){return this.container.removeChild(this.svg),this.svg=null,window.cancelAnimationFrame(this.animateId)},Progress}()})}.call(this),function(){angular.module("campusServices").factory("ClientExecutor",["$q","CampusEvent","CampusUrl","Canceller","ClientExecutorData","Report",function($q,CampusEvent,CampusUrl,Canceller,ClientExecutorData,Report){var ClientExecutor,normalize;return normalize=function(report,executorData,contentArray){return{attempts:executorData.failures,details:report.details,failures:report.failures,passes:report.passes,replaceErrorMessageData:executorData.replace_error_messages,submission:contentArray,successes:_.filter(executorData.attempts,function(attempt){return"success"===attempt.$meta.type})}},ClientExecutor=function(){function ClientExecutor(course,page){this.course=course,this.page=page,this.sandbox=null,this.element=null,this.canceller=null,this.executorData=new ClientExecutorData(this.course.identifier),CampusEvent.makeEventEmitter(this,function(eventName){return"clientExecutor:"+eventName+":"+page.$meta.uid})}return ClientExecutor.prototype.submit=function(contentArray,options){var deferred,promise,recycleSandbox;return null==options&&(options={}),recycleSandbox=options.recycleSandbox||!1,this.emit("start"),deferred=$q.defer(),promise=deferred.promise,this.canceller=new Canceller,this.canceller.submit(function(_this){return function(timeout){var executorDataPromise,executorDeferred;return options.executorData?(executorDeferred=$q.defer(),executorDeferred.resolve(options.executorData),executorDataPromise=executorDeferred.promise):executorDataPromise=_this.executorData.get(_this.page.$meta.uid,{timeout:timeout}),$q.all([executorDataPromise,_this.course.$getAllConfig()]).then(function(data){var executorData,sandboxOptions,sandboxScript,systemjsConfigs;return executorData=data[0],sandboxOptions=$.extend({},executorData.options),sandboxScript=data[1].sandbox_script,sandboxScript||(systemjsConfigs=data[1].systemjs_configs,sandboxOptions=$.extend({},executorData.options,{systemjs:!0,systemjs_configs:systemjsConfigs})),_this.sandbox&&recycleSandbox||(_this.sandbox=_this.createSandbox(sandboxOptions)),_this.sandbox.once("complete",function(report){return report=new Report(normalize(report,executorData,contentArray)),deferred.resolve(report)}),_this.sandbox.once("error",function(error){return deferred.reject(error)}),_this.sandbox.run(contentArray,executorData.tests,_this.page.$getTestData())})["catch"](function(error){return null==error&&(error={}),deferred.reject(error)})}}(this)).whenCancelled(function(_this){return function(cancelError){return deferred.reject(cancelError),_this.emit("cancelled",cancelError)}}(this)),promise.then(function(_this){return function(report){return _this.emit("complete",report)}}(this)),promise["catch"](function(_this){return function(error){return _this.emit("error",error)}}(this)),promise["finally"](function(_this){return function(){return _this.sandbox.removeAllListeners(),_this.sandbox&&!recycleSandbox&&_this.destroySandbox(),_this.canceller=null,_this.emit("finally")}}(this)),promise},ClientExecutor.prototype.cancel=function(reason){var deferred;return null==reason&&(reason="Another submission occurred"),deferred=$q.defer(),this.canceller?(this.canceller.cancel(reason).then(function(){return deferred.resolve(reason)}),this.canceller=null):deferred.resolve(reason),deferred.promise},ClientExecutor.prototype.createSandbox=function(options){var sandboxHtml;return null==options&&(options={}),this.element=document.createElement("div"),this.element.className="clientexecutor--sandbox",document.body.appendChild(this.element),options.element=this.element,sandboxHtml=this.generateSandboxHtml(options),delete options.systemjs_configs,new window.Abecedary(CampusUrl.iframeUrl(),sandboxHtml,options)},ClientExecutor.prototype.destroySandbox=function(){return this.sandbox.close(),this.sandbox=null,this.element=null},ClientExecutor.prototype.generateSandboxHtml=function(options){var configIncludes;return options.systemjs?(configIncludes=_.collect(options.systemjs_configs,function(config){return'<script src="'+CampusUrl.javascriptUrl(config)+'"></script>'}).join("\n"),'<!DOCTYPE html>\n<html>\n  <head>\n    <title>Sandbox</title>\n    <meta cache-key="'+CampusUrl.cacheKey()+'"/>\n  </head>\n  <body>\n    <script src="'+this.page.$jsTemplateName()+'"></script>\n    <script src="'+CampusUrl.javascriptUrl("jspm_packages/system.js")+'"></script>\n    <script src="'+CampusUrl.appAssetUrl("systemJS/system.js")+'"></script>\n    '+configIncludes+'\n    <script src="'+CampusUrl.appAssetUrl("abecedary/abecedary.js")+'"></script>\n  </body>\n</html>'):'<!DOCTYPE html>\n<html>\n  <head>\n    <title>Sandbox</title>\n  </head>\n  <body>\n    <script src="'+this.page.$jsTemplateName()+'"></script>\n    <script src="'+CampusUrl.sandboxScriptUrl()+'"></script>\n  </body>\n</html>'},ClientExecutor}()}])}.call(this),function(){angular.module("campusServices").factory("RemoteExecutor",["$q","CampusApi","CampusEvent","Canceller","ClientExecutorData","Report",function($q,CampusApi,CampusEvent,Canceller,ClientExecutorData,Report){var RemoteExecutor,normalize;return normalize=function(report,executorData,contentArray){return{attempts:executorData.failures,details:report.details||{output:{result:report.output}},failures:_.map(report.failures,function(failure){return{title:failure.title||failure,err:failure.err||{name:"AssertionError",message:"UnspecifiedAssertionError"}}}),replaceErrorMessageData:executorData.replace_error_messages,submission:contentArray,successes:_.filter(executorData.attempts,function(attempt){return"success"===attempt.$meta.type}),playbackSafe:report.playback_safe}},RemoteExecutor=function(){function RemoteExecutor(course,page){this.course=course,this.page=page,this.canceller=null,this.dataApi=new CampusApi(course.identifier),this.executorData=new ClientExecutorData(this.course.identifier),CampusEvent.makeEventEmitter(this,function(eventName){return"remoteExecutor:"+eventName+":"+page.$meta.uid})}return RemoteExecutor.prototype.submit=function(contentArray,options){var deferred,promise;return null==options&&(options={}),this.emit("start"),deferred=$q.defer(),this.canceller=new Canceller,this.canceller.submit(function(_this){return function(timeout){var executorDataPromise,executorDeferred;return options.executorData?(executorDeferred=$q.defer(),executorDeferred.resolve(options.executorData),executorDataPromise=executorDeferred.promise):executorDataPromise=_this.executorData.get(_this.page.$meta.uid,{timeout:timeout}),executorDataPromise.then(function(executorData){var params;return params={query_string:_this.page.$meta.query_string,course_identifier:_this.course.identifier,service:"submission",service_method:"post_submission",service_args:JSON.stringify([contentArray,options.executorData&&options.executorData.tests])},_this.dataApi.post({data:params,timeout:timeout}).success(function(report){return report=new Report(normalize(report,executorData,contentArray)),deferred.resolve(report)}).error(function(data){return deferred.reject(data)})})["catch"](function(error){return deferred.reject(error)})}}(this)).whenCancelled(function(_this){return function(cancelError){return deferred.reject(cancelError),_this.emit("cancelled",cancelError)}}(this)),promise=deferred.promise,promise.then(function(_this){return function(report){return _this.emit("complete",report)}}(this)),promise["catch"](function(_this){return function(error){return _this.emit("error",error)}}(this)),promise["finally"](function(_this){return function(){return _this.canceller=null,_this.emit("finally")}}(this)),promise},RemoteExecutor.prototype.cancel=function(reason){var deferred;return null==reason&&(reason="Another submission occurred"),deferred=$q.defer(),this.canceller?(this.canceller.cancel(reason).then(function(){return deferred.resolve(reason)}),this.canceller=null):deferred.resolve(reason),deferred.promise},RemoteExecutor}()}])}.call(this),function(){angular.module("campusServices").factory("Report",["$interpolate","Autolinker","Markdown","HTMLUtils",function($interpolate,Autolinker,Markdown,HTMLUtils){var Report;return Report=function(){function Report(report){var attemptNameMapper;this.report=report,this.submission=this.report.submission,this._messages={},attemptNameMapper=function(){return function(map,attempt){return map[attempt.name]=attempt,map}}(this),this.attemptsByName=_.reduce(this.report.attempts,attemptNameMapper,{}),this.report.replaceErrorMessageData=this.report.replaceErrorMessageData||[],_.each(this.report.attempts,function(_this){return function(attempt){return attempt.replace_if_pattern?_this.report.replaceErrorMessageData.push({pattern:attempt.replace_if_pattern,"with":attempt.name}):void 0}}(this))}return Report.prototype.details=function(){return this.report.details},Report.prototype.failureCount=function(){return this.failures().length},Report.prototype.failedAttempt=function(index){var failure;return null==index&&(index=0),failure=this._failure(index),this._attemptFor(failure)},Report.prototype.failedTask=function(index){var _ref;return null==index&&(index=0),null!=(_ref=this.failedAttempt())?_ref.task:void 0},Report.prototype.htmlMessage=function(index){var message;return null==index&&(index=0),message=this.message(index),message?Autolinker.link(HTMLUtils.toHtml(message),{urls:!0,stripPrefix:!1}):null},Report.prototype.isAssertionError=function(error){var _ref;return error=error||(null!=(_ref=this._failure(0))?_ref.err:void 0),error?_.isUndefined(null!=error?error.message:void 0)||/AssertionError/.test(null!=error?error.message:void 0):void 0},Report.prototype.message=function(index){var failedAttempt,failure,isAssertionError,isReplacementAttempt,message;return null==index&&(index=0),this._messages[index]?this._messages[index]:(failedAttempt=this.failedAttempt(index),failure=this._failure(index),isAssertionError=this.isAssertionError(null!=failure?failure.err:void 0),isReplacementAttempt=failedAttempt&&!!failedAttempt.replace_if_pattern,message=failedAttempt&&(isReplacementAttempt||isAssertionError)?failedAttempt.message:isAssertionError?failure.title:failure.err.message,this._messages[index]=null!=message?message.replace(/^\s+|\s+$/g,"").replace(/\\n/g,"\n"):void 0)},Report.prototype.success=function(){return 0===this.failures().length},Report.prototype.target=function(index){var _ref;return null==index&&(index=0),null!=(_ref=this.failedAttempt(index))?_ref.target:void 0},Report.prototype.toJson=function(){return JSON.stringify(this,void 0,2)},Report.prototype.failures=function(){return this.report.failures||[]},Report.prototype.taskPassed=function(taskName){var failures,passes,taskAttempts;return this.success()?!0:(taskAttempts=_.filter(this.report.attempts,function(attempt){return attempt.task===taskName}),failures=this.report.failures,passes=this.report.passes,_.isEmpty(failures)||_.all(taskAttempts,function(attempt){return _.find(passes,function(pass){return pass.title===attempt.name})}))},Report.prototype.failedAttemptWithoutTask=function(){return this._attemptWhere(function(attempt){return!attempt.task})},Report.prototype.hasFailureWithoutTask=function(index){return null==index&&(index=0),!!this.failedAttemptWithoutTask()},Report.prototype.failedAttemptWithoutTarget=function(){return this._attemptWhere(function(attempt){return!attempt.target})},Report.prototype.failedAttemptForTarget=function(target){return this._attemptWhere(function(attempt){return attempt.target===target})},Report.prototype.hasFailureWithoutTarget=function(index){return null==index&&(index=0),!!this.failedAttemptWithoutTarget()},Report.prototype.htmlMessageWithoutTarget=function(){return this._findHtmlMessage(function(_this){return function(failure){var attempt;return attempt=_this._attemptFor(failure),!(null!=attempt?attempt.target:void 0)}}(this))},Report.prototype.htmlMessageForTarget=function(target){return target?this._findHtmlMessage(function(_this){return function(failure){var _ref;return(null!=(_ref=_this._attemptFor(failure))?_ref.target:void 0)===target}}(this)):null},Report.prototype._failure=function(index){return null==index&&(index=0),this.failures()[index]},Report.prototype._findHtmlMessage=function(predicate){var failure,failureIndex,failures;return failures=this.failures(),failure=this._failureWhere(predicate),failureIndex=_.indexOf(failures,failure),-1!==failureIndex?this.htmlMessage(failureIndex):void 0},Report.prototype._failureWhere=function(predicate){var failures;return failures=this.failures(),_.find(failures,predicate)},Report.prototype._attemptWhere=function(predicate){var failure,failures;return failures=this.failures(),failure=_.find(failures,function(_this){return function(failure){var attempt;return attempt=_this._attemptFor(failure),attempt?predicate(attempt):void 0}}(this)),this._attemptFor(failure)},Report.prototype._attemptFor=function(failure){var replacementTest,replacementTitle,_ref;return failure?(replacementTest=function(replacement){return new RegExp(replacement.pattern).test(failure.err.message)},replacementTitle=null!=(_ref=_.find(this.report.replaceErrorMessageData,replacementTest))?_ref["with"]:void 0,this.attemptsByName[replacementTitle]||this.attemptsByName[failure.title]):null},Report}()}])}.call(this),function(){angular.module("campusServices").factory("fillInBlankInputFactory",["$compile",function($compile){var fillInBlankInputFactory;return fillInBlankInputFactory=function(scope,input){var childScope,template;return childScope=scope.$new(),childScope.input=input,template="<fill-in-blank-input class='fill-in-blank-content has-stateInput--"+input.name+"' data-fragment-name='"+input.name+"'></fill-in-blank-input>",$compile(template)(childScope)[0]}}])}.call(this),function(){angular.module("campusServices").factory("FillInBlankParser",["fillInBlankInputFactory",function(fillInBlankInputFactory){var convert,fillInBlankParser,hasInputs,inputs,jsonFillInBlankParser,parseInput,placeholderRegex,textFillInBlankParser,_replaceInput,_replaceInputWithFillInBlank,_replaceInputsWithSpans;return jsonFillInBlankParser=function(fragment){var parsedElement,result;return(parsedElement=fragment.match(/%(\{.*\})%/))?(result=JSON.parse(parsedElement[1]),result.type="text",result):!1},textFillInBlankParser=function(fragment){var parsedElement;return(parsedElement=fragment.match(/%([a-zA-Z_]*):\s*([a-zA-z0-9:\s\.\-_\/]*)?%/))?{name:parsedElement[2],type:parsedElement[1]}:!1},parseInput=function(input){return textFillInBlankParser(input)||jsonFillInBlankParser(input)},inputs=function(el){return $(el).text().match(placeholderRegex())},_replaceInputsWithSpans=function(el,rawInputs){return inputs=_.map(rawInputs,function(){return function(rawInput){return _replaceInput(el,rawInput)}}(this)),$(el).addClass("inputs-replaced"),inputs},_replaceInput=function(el,rawInput){var input;return input=parseInput(rawInput),$(el).replaceText(rawInput,"<script id='fill-in-the-"+input.name+"'></script>"),input},_replaceInputWithFillInBlank=function(scope,wrapper,input,inputCallback){var compiledTemplate;return inputCallback&&(input=inputCallback(input)),compiledTemplate=fillInBlankInputFactory(scope,input),$(wrapper).find("#fill-in-the-"+input.name).replaceWith(compiledTemplate)},convert=function(scope,rawInput){var input;return input=parseInput(rawInput),input=scope.prefillInput(input),fillInBlankInputFactory(scope,input)},hasInputs=function(text){return!!text.match(placeholderRegex())},placeholderRegex=function(){return/(%[a-zA-Z_]*):\s*([a-zA-z0-9:\s\.\-_\/]*?%)|(%\{.*?\}%)/g},fillInBlankParser=function(scope,contentEl,inputCallback){var spanInputs,wrapper;return wrapper=$("<div/>").append(contentEl),spanInputs=_.map(wrapper.find("*:not(.inputs-replaced)"),function(){return function(el){var rawInputs;return(rawInputs=$(el).text().match(placeholderRegex()))?_replaceInputsWithSpans(el,rawInputs):!1}}(this)),_.each(_.flatten(spanInputs),function(){return function(spanInput){return spanInput?_replaceInputWithFillInBlank(scope,wrapper,spanInput,inputCallback):void 0}}(this)),wrapper.children()},{convert:convert,parseInput:parseInput,parse:fillInBlankParser,hasInputs:hasInputs,placeholderRegex:placeholderRegex,inputs:inputs}}])}.call(this),function(){angular.module("campusServices").factory("GoogleAnalytics",function(){var GoogleAnalytics;return GoogleAnalytics=function(){function GoogleAnalytics(){}return GoogleAnalytics.skipLoad=!0,GoogleAnalytics.load=function(trackers){this.trackers=trackers},GoogleAnalytics.trackCoursePageview=function(courseIdentifier,queryString){var fullQuery;return this.skipLoad?this.skipLoad=!1:(fullQuery="/courses/"+courseIdentifier+"/"+queryString,_.each(this.trackers,function(_this){return function(tracker){return window._gaq.push([""+_this._uniqueIdentifier(tracker.id)+"._trackPageview",_this._buildQuery(tracker,fullQuery)])}}(this)))},GoogleAnalytics._uniqueIdentifier=function(trackerID){return trackerID.replace(/-/g,"").toLowerCase()},GoogleAnalytics._buildQuery=function(tracker,query){var e;try{return tracker.path_modifier.replace("%{path}",query)}catch(_error){return e=_error,query}},GoogleAnalytics}()})}.call(this),function(){angular.module("campusServices").factory("KeyboardShortcuts",function(){return{key:window.key,unbind:window.key.unbind}})}.call(this),function(){angular.module("campusServices").factory("Markdown",function(){return{parse:function(text){return markdown.toHTML(text||"")}}})}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("BaseModel",["$q","ApiHelper","AttemptData","CampusEvent","ClientExecutorData","CourseContentUserData","CourseIndexData","CourseContentData","CurrentCourseConfig","CourseQueryStringIndex","HintsData","ModelFactory","ProgressData","ProjectorVideo","TaskData","UserData",function($q,ApiHelper,AttemptData,CampusEvent,ClientExecutorData,CourseContentUserData,CourseIndexData,CourseContentData,CurrentCourseConfig,CourseQueryStringIndex,HintsData,ModelFactory,ProgressData,ProjectorVideo,TaskData,UserData){var BaseModel,dataServices,instances;return dataServices={},instances=[],BaseModel=function(){function BaseModel(courseIdentifier,data){this.$progress=__bind(this.$progress,this),this.$preload=__bind(this.$preload,this),this._courseIdentifier=courseIdentifier,_.extend(this,data),dataServices[courseIdentifier]||(dataServices[courseIdentifier]={},dataServices[courseIdentifier].configData=new CurrentCourseConfig(this._courseIdentifier),dataServices[courseIdentifier].indexData=new CourseIndexData(this._courseIdentifier),dataServices[courseIdentifier].contentData=new CourseContentData(this._courseIdentifier),dataServices[courseIdentifier].contentUserData=new CourseContentUserData(this._courseIdentifier),dataServices[courseIdentifier].hintsData=new HintsData(this._courseIdentifier),dataServices[courseIdentifier].taskData=new TaskData(this._courseIdentifier),dataServices[courseIdentifier].attemptData=new AttemptData(this._courseIdentifier),dataServices[courseIdentifier].progressData=new ProgressData(this._courseIdentifier),dataServices[courseIdentifier].userData=new UserData(courseIdentifier),dataServices[courseIdentifier].executorData=new ClientExecutorData(courseIdentifier),dataServices[courseIdentifier].videoData=new ProjectorVideo(courseIdentifier)),this.$configData=dataServices[courseIdentifier].configData,this.$indexData=dataServices[courseIdentifier].indexData,this.$contentData=dataServices[courseIdentifier].contentData,this.$contentUserData=dataServices[courseIdentifier].contentUserData,this.$hintsData=dataServices[courseIdentifier].hintsData,this.$taskData=dataServices[courseIdentifier].taskData,this.$attemptData=dataServices[courseIdentifier].attemptData,this.$progressData=dataServices[courseIdentifier].progressData,this.$userData=dataServices[courseIdentifier].userData,this.$executorData=dataServices[courseIdentifier].executorData,this.$videoData=dataServices[courseIdentifier].videoData,instances.push(this)}return BaseModel.fromQueryString=function(identifier,queryString){var dataService,uid;return null==queryString&&(queryString="/"),uid=CourseQueryStringIndex.getUid(identifier,queryString),dataService=new CourseContentData(identifier),dataService.get(uid).then(function(courseData){return ModelFactory.get(identifier,courseData)})},BaseModel.cleanUp=function(courseIdentifier){return _.each(dataServices[courseIdentifier],function(value){return value.off&&value.off()}),_.each(instances,function(instance){return instance.$destroy()}),instances=[]},BaseModel.prototype.$destroy=function(){return this.off&&this.off()},BaseModel.prototype.$findParent=function(predicate){return this.$contentData.findParent(this.$meta.uid,predicate)},BaseModel.prototype.$allChildren=function(predicate){var children,me;return null==predicate&&(predicate=function(){return!0}),children=[],me=this.$indexData.find(this.$meta.uid),this.$indexData.traverse(me,function(child){return predicate(child)?children.push(child):void 0}),children},BaseModel.prototype.$parents=function(){return this._makePromise(this.$indexData.getParents(this))},BaseModel.prototype.$preload=function(){return this.$contentUserData.get(this.$meta.uid)},BaseModel.prototype.$progress=function(){var progress;return progress=function(_this){return function(){return _this.$contentUserData.get(_this.$meta.uid).then(function(userData){return userData.progress})}}(this),this._bindResult(progress,this.$contentUserData,"update")},BaseModel.prototype.$refresh=function(){return this.$parents().then(function(_this){return function(parents){var uids,_ref;return uids=_.map(parents,function(parent){return parent.$meta.uid}),uids.push(null!=(_ref=_this.$meta)?_ref.uid:void 0),$q.all([_this.$contentUserData.getAll(uids,{refresh:!0}),_this.$userData.get({refresh:!0})])}}(this))},BaseModel.prototype._makePromise=function(value){var defer;return defer=$q.defer(),defer.resolve(value),defer.promise},BaseModel.prototype._bindResult=function(execute,emitter,eventName){var promise;return promise=execute(),{thens:[],catches:[],finallys:[],bind:function(scope,scopeKey){var bindPromise,bindScope;return bindScope=function(result){return scope&&scopeKey?scope[scopeKey]=result:void 0},bindPromise=function(_this){return function(currentPromise){return currentPromise.then(bindScope),_.each(_this.thens,function(currentThen){return currentPromise.then.apply(currentPromise,currentThen)}),_.each(_this.catches,function(currentCatch){return currentPromise["catch"].apply(currentPromise,currentCatch)}),_.each(_this.finallys,function(currentFinally){return currentPromise["finally"].apply(currentPromise,currentFinally)}),_this}}(this),emitter&&eventName&&emitter.on(eventName,function(){return bindPromise(execute())}),bindPromise(promise)},then:function(){return this.thens.push(arguments),promise.then.apply(promise,arguments)},"catch":function(){return this.catches.push(arguments),promise["catch"].apply(promise,arguments)},"finally":function(){return this.finallys.push(arguments),promise["finally"].apply(promise,arguments)}}},BaseModel}()}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("campusServices").factory("Course",["ApiHelper","BaseModel","CourseContentData","CourseQueryStringIndex","DeferredQueue","ModelFactory","$q","CourseMap",function(ApiHelper,BaseModel,CourseContentData,CourseQueryStringIndex,DeferredQueue,ModelFactory,$q,CourseMap){var CourseModel;return CourseModel=function(_super){function CourseModel(){return this.$totalRequiredPages=__bind(this.$totalRequiredPages,this),CourseModel.__super__.constructor.apply(this,arguments)
}return __extends(CourseModel,_super),CourseModel.subtractOnLastHint="last_hint",CourseModel.subtractOnEachHint="each_hint",CourseModel.fromIdentifier=function(identifier){var contentData,uid;return uid=CourseQueryStringIndex.getUid(identifier,"/"),contentData=new CourseContentData(identifier),contentData.get(uid).then(function(courseData){return ModelFactory.get(identifier,courseData)})},CourseModel.prototype.$getAllConfig=function(){var getAllConfig;return getAllConfig=function(_this){return function(){return _this.$configData.data()}}(this),this._bindResult(getAllConfig)},CourseModel.prototype.$getConfig=function(property){var getConfig;return getConfig=function(_this){return function(){return _this.$configData.get(property)}}(this),this._bindResult(getConfig)},CourseModel.prototype.$achievement=function(){return this.$achievementFor(this)},CourseModel.prototype.$achievementFor=function(node){var achievementFor;return achievementFor=function(_this){return function(){var achievement,deferred;return achievement=_.find(_this.achievements,function(achievement){return achievement.label===node.$meta.uid}),deferred=$q.defer(),deferred.resolve(achievement),deferred.promise}}(this),this._bindResult(achievementFor)},CourseModel.prototype.$achievements=function(){var achievements;return achievements=function(_this){return function(){var deferred;return deferred=$q.defer(),deferred.resolve(_this.achievements),deferred.promise}}(this),this._bindResult(achievements)},CourseModel.prototype.$videoPages=function(){var videoPages;return videoPages=function(_this){return function(){var deferred;return videoPages=[],_this.$indexData.traverse(_this.$indexData.get(),function(node){return"video"===node.type?videoPages.push(node):void 0}),deferred=$q.defer(),deferred.resolve(videoPages),deferred.promise}}(this),this._bindResult(videoPages)},CourseModel.prototype.$videoPagesCount=function(){var videoPagesCount;return videoPagesCount=function(_this){return function(){return _this.$videoPages().then(function(videoPages){return videoPages.length})}}(this),this._bindResult(videoPagesCount)},CourseModel.prototype.$completedVideoPagesCount=function(){var completedVideoPages;return completedVideoPages=function(_this){return function(){return _this.$videoPages().then(function(videoPages){var uids;return uids=_.map(videoPages,function(videoPage){return videoPage.$meta.uid}),videoPages.length,_this.$contentUserData.getAll(uids).then(function(videoUserData){var completedVideos;return completedVideos=_.filter(videoUserData,function(data){return 100===data.progress}),completedVideos.length})})}}(this),this._bindResult(completedVideoPages,this.$contentUserData,"update")},CourseModel.prototype.$levels=function(){var levels;return levels=function(_this){return function(){var levelModels,rawLevels;return rawLevels=_this.$indexData.get(_this.$meta.uid).levels,levelModels=_.collect(rawLevels,function(rawLevel){return ModelFactory.get(_this._courseIdentifier,rawLevel)}),_this._makePromise(levelModels)}}(this),this._bindResult(levels)},CourseModel.prototype.$pageForQueryString=function(queryString){var pageUid;return pageUid=CourseQueryStringIndex.getUid(this.identifier,queryString),this.$contentData.get(pageUid).then(function(_this){return function(pageData){return ModelFactory.get(_this.identifier,pageData)}}(this))},CourseModel.prototype.$levelForQueryString=function(queryString){return this.$levels().then(function(){return function(levels){return _.find(levels,function(level){return new RegExp("^"+level.$meta.query_string).test(queryString)})}}(this))},CourseModel.prototype.$levelIndex=function(level){return _.indexOf(this.levels,level.$meta.uid)+1},CourseModel.prototype.$preload=function(){return this.$contentUserData.all()},CourseModel.prototype.$preloadLevels=function(){return this.$levels().then(function(){return function(levels){var queue;return queue=new DeferredQueue(1),_.each(levels,function(level){return queue.push(function(){return level.$preload()})}),queue.run().then(function(){return levels})}}(this))},CourseModel.prototype.$preloadLevelForQueryString=function(queryString){return this.$levelForQueryString(queryString).then(function(level){return level?level.$preload().then(function(){return level}):null})},CourseModel.prototype.$totalRequiredPages=function(){var totalRequiredPages;return totalRequiredPages=function(_this){return function(){var deferred,requiredPages;return requiredPages=[],_this.$indexData.traverse(_this.$indexData.get(),function(node){return node.required?requiredPages.push(node):void 0}),deferred=$q.defer(),deferred.resolve(requiredPages.length),deferred.promise}}(this),this._bindResult(totalRequiredPages)},CourseModel.prototype.$incompleteChallenges=function(){var incompleteChallenges;return incompleteChallenges=function(_this){return function(){var challengeUids,incompleted;return challengeUids=[],_this.$indexData.traverse(_this.$indexData.get(),function(node){return CourseMap.isChallenge(node)?challengeUids.push(node.$meta.uid):void 0}),incompleted=[],_this.$contentUserData.getAll(challengeUids).then(function(challengeUserData){return _.each(challengeUserData,function(data,uid){return data.progress<100?incompleted.push(_this.$indexData.find(uid)):void 0}),incompleted})}}(this),this._bindResult(incompleteChallenges)},CourseModel.prototype.$userPages=function(){var userPages;return userPages=function(_this){return function(){var courseIndexData,userPageUids;return courseIndexData=_this.$indexData.find(_this.$meta.uid),userPageUids=_.map(_.first(courseIndexData.users).pages,function(userPage){return userPage.$meta.uid}),$q.all(_.map(userPageUids,function(userPageUid){return _this.$contentData.get(userPageUid)})).then(function(userPageContentData){return _.sortBy(userPageContentData,function(page){return page.$meta.attribute_order})})}}(this),this._bindResult(userPages)},CourseModel}(BaseModel)}])}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("campusServices").factory("Level",["ApiHelper","BaseModel","CourseMap","CourseQueryStringIndex","ModelFactory","$q",function(ApiHelper,BaseModel,CourseMap,CourseQueryStringIndex,ModelFactory,$q){var LevelModel;return LevelModel=function(_super){function LevelModel(){return LevelModel.__super__.constructor.apply(this,arguments)}return __extends(LevelModel,_super),LevelModel.prototype.$isEnabled=function(){var isEnabled;return isEnabled=function(_this){return function(){return _this.$configData.data().then(function(configData){var isFreePage;return"paid"!==configData.course_type?!0:isFreePage=!!_.find(configData.free_pages,function(freePage){return new RegExp(freePage).test(_this.$meta.query_string)})})}}(this),this._bindResult(isEnabled)},LevelModel.prototype.$indexInCourse=function(){var indexInCourse;return indexInCourse=function(_this){return function(){var course,level;return course=_this.$indexData.find(CourseQueryStringIndex.getUid(_this._courseIdentifier,"/")),level=_.find(course.levels,function(level){return level.$meta.uid===_this.$meta.uid}),_this._makePromise(course.levels.indexOf(level)+1)}}(this),this._bindResult(indexInCourse)},LevelModel.prototype.$preload=function(){return $q.all([this.$contentUserData.get(this.$meta.uid),this.$contentData.get(this.$meta.uid)])},LevelModel.prototype.$completeChallengeCount=function(){var completeChallengeCount;return completeChallengeCount=function(_this){return function(){var challengeUids,completedChallengeCount;return challengeUids=[],_this.$indexData.traverse(_this,function(node){return CourseMap.isChallenge(node)?challengeUids.push(node.$meta.uid):void 0}),completedChallengeCount=0,_this.$contentUserData.getAll(challengeUids).then(function(challengeUserData){return _.each(challengeUserData,function(data){return 100===data.progress?completedChallengeCount++:void 0}),completedChallengeCount})}}(this),this._bindResult(completeChallengeCount)},LevelModel.prototype.$incompletePages=function(){var incompletePages;return incompletePages=function(_this){return function(){var pageUids;return pageUids=[],_this.$indexData.traverse(_this,function(node){return CourseMap.isVideo(node)||CourseMap.isChallenge(node)?pageUids.push(node.$meta.uid):void 0}),_this._incompleteIndexDataFor(pageUids)}}(this),this._bindResult(incompletePages)},LevelModel.prototype.$incompleteChallenges=function(){var incompleteChallenges;return incompleteChallenges=function(_this){return function(){var challengeUids;return challengeUids=[],_this.$indexData.traverse(_this,function(node){return CourseMap.isChallenge(node)?challengeUids.push(node.$meta.uid):void 0}),_this._incompleteIndexDataFor(challengeUids)}}(this),this._bindResult(incompleteChallenges)},LevelModel.prototype.$totalChallengeCount=function(){var totalChallengeCount;return totalChallengeCount=function(_this){return function(){var challengeCount;return challengeCount=0,_this.$indexData.traverse(_this,function(node){return CourseMap.isChallenge(node)?challengeCount++:void 0}),_this._makePromise(challengeCount)}}(this),this._bindResult(totalChallengeCount)},LevelModel.prototype.$contents=function(options){var filters;return null==options&&(options={display:!0}),filters=[],options.display&&(filters=[CourseMap.not(CourseMap.isLevelWrapUp)]),this._contents(filters)},LevelModel.prototype.$tests=function(){return this._contents([CourseMap.isSection,CourseMap.isRequired])},LevelModel.prototype.$wrapUp=function(){return this.wrap_up_page},LevelModel.prototype._incompleteIndexDataFor=function(uids){var incompleted;return incompleted=[],this.$contentUserData.getAll(uids).then(function(_this){return function(userData){return _.each(userData,function(data,uid){return data.progress<100?incompleted.push(_this.$indexData.find(uid)):void 0}),incompleted}}(this))},LevelModel.prototype._contents=function(filters){var contents,filteredContents,models,sortedContents;return null==filters&&(filters=[function(){return!0}]),contents=_.compact(_.flatten(_.union(this.sections,this.pages))),sortedContents=_.sortBy(contents,function(orderable){return orderable.$meta.attribute_order}),filteredContents=_.filter(sortedContents,function(data){return _.any(filters,function(filter){return filter(data)})}),models=_.map(filteredContents,function(_this){return function(item){return ModelFactory.get(_this._courseIdentifier,item)}}(this)),this._makePromise(models)},LevelModel}(BaseModel)}])}.call(this),function(){angular.module("campusServices").factory("ModelFactory",["$injector","$filter",function($injector,$filter){return{get:function(courseIdentifier,data){var model,type;if(type=data&&data.$meta&&data.$meta.type,model=type&&$injector.get(this._normalizeModelName(type)))return new model(courseIdentifier,data);throw new Error("Model not found for type: "+type)},_normalizeModelName:function(value){return""+$filter("uppercase")(value.slice(0,1))+value.slice(1,value.length)}}}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("campusServices").factory("Page",["ApiHelper","BaseModel","CampusEvent","CourseContentData","CourseQueryStringIndex","ModelFactory","$q","CampusUrl",function(ApiHelper,BaseModel,CampusEvent,CourseContentData,CourseQueryStringIndex,ModelFactory,$q,CampusUrl){var PageModel;return PageModel=function(_super){function PageModel(courseIdentifier){this._updateLevelProgress=__bind(this._updateLevelProgress,this),this._updateSectionProgress=__bind(this._updateSectionProgress,this),this.$isComplete=__bind(this.$isComplete,this),this.$complete=__bind(this.$complete,this),this.$taskIndex=__bind(this.$taskIndex,this),this.$indexInLevel=__bind(this.$indexInLevel,this),this.$challengeIndex=__bind(this.$challengeIndex,this),this.$recentAttempt=__bind(this.$recentAttempt,this),this.$recordAttempt=__bind(this.$recordAttempt,this),this.$usedTaskAnswer=__bind(this.$usedTaskAnswer,this),this.$taskAnswer=__bind(this.$taskAnswer,this),this.$possiblePoints=__bind(this.$possiblePoints,this),this.$points=__bind(this.$points,this),this.$usedHints=__bind(this.$usedHints,this),this.$isAnswer=__bind(this.$isAnswer,this),this.$nextHint=__bind(this.$nextHint,this),this.$jsTemplateName=__bind(this.$jsTemplateName,this),this.$isHtmlSelect=__bind(this.$isHtmlSelect,this),this.$isMultipleSelect=__bind(this.$isMultipleSelect,this),this.$isMultipleChoice=__bind(this.$isMultipleChoice,this),this.$isFillInBlank=__bind(this.$isFillInBlank,this),this.$isChallenge=__bind(this.$isChallenge,this),this.$isVideo=__bind(this.$isVideo,this);var sortedTasks;PageModel.__super__.constructor.apply(this,arguments),sortedTasks=_.sortBy(this.tasks.tasks,function(task){return task.$meta.attribute_order}),this.$sortedTaskNames=_.pluck(sortedTasks,"name"),CampusEvent.makeEventEmitter(this,function(_this){return function(eventName){return""+courseIdentifier+":page:"+_this.$meta.uid+":"+eventName}}(this))}return __extends(PageModel,_super),PageModel.fromQueryString=function(identifier,queryString,options){var contentData,getPage;return null==queryString&&(queryString="/"),null==options&&(options={}),contentData=new CourseContentData(identifier),(getPage=function(queryString){var uid;return uid=CourseQueryStringIndex.getUid(identifier,queryString),contentData.get(uid,options).then(function(pageData){var deferred,isRenderTemplate,renderMatches;return pageData?"page"!==pageData.$meta.type?(renderMatches=/render\((.*)\)/.exec(pageData.template),isRenderTemplate=2===(null!=renderMatches?renderMatches.length:void 0),isRenderTemplate?getPage(renderMatches[1]):getPage(pageData.$meta.next_query_string)):ModelFactory.get(identifier,pageData):(deferred=$q.defer(),deferred.resolve(null),deferred.promise)})})(queryString)},PageModel.prototype.$isVideo=function(){return"video"===this.type},PageModel.prototype.$isChallenge=function(){return this.required&&!this.$isVideo()},PageModel.prototype.$isFillInBlank=function(){return"fill_in_blank_challenge"===this.type},PageModel.prototype.$isMultipleChoice=function(){return"multiple_choice_challenge"===this.type},PageModel.prototype.$isMultipleSelect=function(){return-1!==["multiple_select_table_challenge","multiple_select_challenge"].indexOf(this.type)},PageModel.prototype.$isHtmlSelect=function(){return"html_select_challenge"===this.type},PageModel.prototype.$jsTemplateName=function(){return this.$isMultipleChoice()?CampusUrl.appAssetUrl("sandbox/multiple-choice.js"):this.$isMultipleSelect()?CampusUrl.appAssetUrl("sandbox/multiple-select.js"):this.$isFillInBlank()?CampusUrl.appAssetUrl("sandbox/fill-in-blank.js"):this.$isHtmlSelect()?CampusUrl.appAssetUrl("sandbox/html-select.js"):""},PageModel.prototype.$nextHint=function(){var nextHint;return nextHint=function(_this){return function(){return _this.$hintsData.getNextHint(_this.$meta.query_string).then(function(hint){return _this.$refresh().then(function(){return _this.emit("newHint",hint),hint})})}}(this),this._bindResult(nextHint)},PageModel.prototype.$isTaskBased=function(){var _ref,_ref1;return(null!=(_ref=this.tasks)?null!=(_ref1=_ref.tasks)?_ref1.length:void 0:void 0)>0},PageModel.prototype.$isAnswer=function(hint){var isAnswer;return isAnswer=function(_this){return function(){return _this.$usedHints().then(function(usedHints){var allHintsUsed,isLastHint,sortedHints,_ref;return sortedHints=_.sortBy(usedHints,function(hint){return hint.$meta.attribute_order}),allHintsUsed=_this.hints.count===sortedHints.length,isLastHint=(null!=(_ref=_.last(sortedHints))?_ref.$meta.attribute_order:void 0)===(null!=hint?hint.$meta.attribute_order:void 0),allHintsUsed&&isLastHint})}}(this),this._bindResult(isAnswer,this.$contentUserData,"update")},PageModel.prototype.$usedHints=function(){var usedHints;return usedHints=function(_this){return function(){return _this.$contentUserData.get(_this.$meta.uid).then(function(userData){return userData.hints.used_hints})}}(this),this._bindResult(usedHints,this.$contentUserData,"update")},PageModel.prototype.$points=function(){var points;return points=function(_this){return function(){return _this.$contentUserData.get(_this.$meta.uid).then(function(userData){return userData.points.points})}}(this),this._bindResult(points,this.$contentUserData,"update")},PageModel.prototype.$possiblePoints=function(){var possiblePoints;return possiblePoints=function(_this){return function(){return _this.$contentUserData.get(_this.$meta.uid).then(function(userData){return userData.points.available_points})}}(this),this._bindResult(possiblePoints,this.$contentUserData,"update")},PageModel.prototype.$taskAnswer=function(taskName){var taskAnswer;return taskAnswer=function(_this){return function(){return _this.$taskData.getTaskData(_this.$meta.query_string,taskName).then(function(task){return _this.$refresh().then(function(){return{answer:task.answer,rawAnswer:task.raw_answer}})})}}(this),this._bindResult(taskAnswer)},PageModel.prototype.$usedTaskAnswer=function(taskName){var usedTaskAnswer;return usedTaskAnswer=function(_this){return function(){return _this.$contentUserData.get(_this.$meta.uid).then(function(userData){var task;return task=_.find(userData.tasks,function(task){return task.name===taskName}),{answer:null!=task?task.answer:void 0,rawAnswer:null!=task?task.raw_answer:void 0}})}}(this),this._bindResult(usedTaskAnswer,this.$contentUserData,"update")},PageModel.prototype.$recordAttempt=function(report,content){var promise;return promise=this._makePromise(null),report.success()&&this.$complete(),this.$attemptData.recordAttempt(this.$meta.uid,report,content)["finally"](function(_this){return function(){return report.success()?_this.$refresh():void 0}}(this)),promise},PageModel.prototype.$recentAttempt=function(){var recentAttempt;return recentAttempt=function(_this){return function(){return _this.$contentUserData.get(_this.$meta.uid).then(function(userData){return userData.attempts.recent_attempt})}}(this),this._bindResult(recentAttempt,this.$contentUserData,"update")},PageModel.prototype.$challengeIndex=function(){var challengePredicate;return challengePredicate=function(child){return child.required&&"video"!==child.type},this._indexInLevel(challengePredicate)},PageModel.prototype.$indexInLevel=function(){var pagePredicate;return pagePredicate=function(child){return"page"===child.$meta.name},this._indexInLevel(pagePredicate)},PageModel.prototype.$taskIndex=function(taskName){return _.indexOf(this.$sortedTaskNames,taskName)},PageModel.prototype.$complete=function(){return this.$progress().then(function(_this){return function(progress){return 100>progress?(_this.progress=100,_this.$contentUserData.updateAttribute(_this.$meta.uid,"progress",100),$q.all([_this.$configData.data(),_this.$userData.get()]).then(function(data){var config,pagePoints,userData;return config=data[0],userData=data[1],_this.$userData.updateAttribute("pages.required_completed",userData.pages.required_completed+1),pagePoints=config.points_per_page-userData.hints.used_count*config.hint_point_value,_this.$userData.updateAttribute("points.total_points",userData.points.total_points+pagePoints)}),_this.$level().then(function(level){return level?_this._updateLevelProgress(level):void 0}),_this.required?void 0:_this.$progressData.completeNonRequiredPage(_this.$meta.uid).then(function(result){return _this.$refresh().then(function(){return result})})):!0}}(this))},PageModel.prototype.$isComplete=function(){var isComplete;return isComplete=function(_this){return function(){return _this.$progress().then(function(progress){return!(100!==progress&&!_this.pending)})}}(this),this._bindResult(isComplete,this.$contentUserData,"update")},PageModel.prototype.$level=function(){return this.$parents().then(function(_this){return function(parents){return parents.level?ModelFactory.get(_this._courseIdentifier,parents.level):void 0}}(this))},PageModel.prototype.$section=function(){return this.$parents().then(function(_this){return function(parents){return parents.section?ModelFactory.get(_this._courseIdentifier,parents.section):void 0}}(this))},PageModel.prototype.$nextPage=function(){return PageModel.fromQueryString(this._courseIdentifier,this.$meta.next_query_string)},PageModel.prototype.$attempts=function(){return this.$executorData.get(this.$meta.uid).then(function(){return function(executorData){return _.sortBy(executorData.attempts,function(attempt){return attempt.$meta.attribute_order})}}(this))},PageModel.prototype.$preload=function(){var loading,videoIds;return videoIds=_.compact(_.pluck(this.$allVideos(),"id")),loading=[PageModel.__super__.$preload.apply(this,arguments)],_.isEmpty(videoIds)||loading.push(this.$videoData.get(videoIds)),$q.all(loading)},PageModel.prototype.$allVideos=function(){var videos;return videos=[],this._traverse(function(property){var _ref;return"projector_video"===(null!=property?null!=(_ref=property.$meta)?_ref.type:void 0:void 0)?videos.push(property):void 0}),videos},PageModel.prototype.$editorByFileName=function(fileName){return _.find(this.editors,function(editor){return editor.file_name===fileName})},PageModel.prototype.$subjects=function(){var subjectsTab;return subjectsTab=_.find(this.resources.tabs,function(tab){return tab.subjects.length>0}),null!=subjectsTab?subjectsTab.subjects:void 0},PageModel.prototype.$getTestData=function(){return"regex_challenge"===this.type?{subjects:this.$subjects()}:{}},PageModel.prototype._updateSectionProgress=function(section){var completePages,deferred,p,promises,totalPages,_i,_len,_ref;for(deferred=$q.defer(),completePages=0,totalPages=0,promises=[],_ref=section.pages,_i=0,_len=_ref.length;_len>_i;_i++)p=_ref[_i],p.required&&(totalPages+=1,promises.push(this.$contentUserData.get(p.$meta.uid)));return $q.all(promises).then(function(_this){return function(userDatas){var progress,ud,_j,_len1;for(_j=0,_len1=userDatas.length;_len1>_j;_j++)ud=userDatas[_j],100===ud.progress&&(completePages+=1);return progress=completePages/totalPages*100,_this.$contentUserData.updateAttribute(section.$meta.uid,"progress",progress),_this.progress=progress,deferred.resolve({completePages:completePages,totalPages:totalPages})}}(this)),deferred.promise},PageModel.prototype._updateLevelProgress=function(level){var completePages,deferred,p,promises,sectionPromises,totalPages,_i,_len,_ref;for(deferred=$q.defer(),completePages=0,totalPages=0,promises=[],sectionPromises=[],_ref=level.pages,_i=0,_len=_ref.length;_len>_i;_i++)p=_ref[_i],p.required&&(totalPages+=1);return $q.all(promises).then(function(_this){return function(userPageDatas){var s,upd,_j,_k,_len1,_len2,_ref1;for(_j=0,_len1=userPageDatas.length;_len1>_j;_j++)upd=userPageDatas[_j],100===upd.progress&&(completePages+=1);for(_ref1=level.sections,_k=0,_len2=_ref1.length;_len2>_k;_k++)s=_ref1[_k],sectionPromises.push(_this._updateSectionProgress(s));return $q.all(sectionPromises).then(function(sectionDatas){var progress,sd,_l,_len3;for(_l=0,_len3=sectionDatas.length;_len3>_l;_l++)sd=sectionDatas[_l],totalPages+=sd.totalPages,completePages+=sd.completePages;return progress=completePages/totalPages*100,_this.$contentUserData.updateAttribute(level.$meta.uid,"progress",progress),_this.progress=progress,deferred.resolve({completePages:completePages,totalPages:totalPages})}),deferred.promise}}(this))},PageModel.prototype._traverse=function(callback){var visitProperties;return null==callback&&(callback=function(){}),(visitProperties=function(currentProperty,propertyName){var allowedPropertyName,traversable;return null==propertyName&&(propertyName="this"),allowedPropertyName=_.isNumber(propertyName)||-1===["$","_"].indexOf(propertyName.charAt(0)),traversable=_.isObject(currentProperty)&&!_.isFunction(currentProperty)&&allowedPropertyName,traversable?(callback(currentProperty,propertyName),_.each(currentProperty,function(propertyValue,propertyName){return visitProperties(propertyValue,propertyName)})):void 0})(this)},PageModel.prototype._indexInLevel=function(predicate){var indexInLevel;return null==predicate&&(predicate=function(){return!0}),indexInLevel=function(_this){return function(){return _this.$level().then(function(levelData){var children,filteredChildren,indexLevel,uids;return levelData?(indexLevel=_this.$indexData.find(levelData.$meta.uid),children=_this.$indexData.collect(indexLevel),filteredChildren=_.filter(children,function(child){return predicate(child)}),uids=_.collect(filteredChildren,function(page){return page.$meta.uid}),uids.indexOf(_this.$meta.uid)+1):0})}}(this),this._bindResult(indexInLevel)},PageModel}(BaseModel)}])}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("campusServices").factory("Section",["ApiHelper","BaseModel","CourseMap","ModelFactory","$q",function(ApiHelper,BaseModel,CourseMap,ModelFactory){var SectionModel;return SectionModel=function(_super){function SectionModel(){return SectionModel.__super__.constructor.apply(this,arguments)}return __extends(SectionModel,_super),SectionModel.prototype.$contents=function(){return this._contents()},SectionModel.prototype.$tests=function(){return this._contents([CourseMap.not(CourseMap.isVideo)])},SectionModel.prototype._contents=function(filters){var filteredPages,pageModels,pages;return null==filters&&(filters=[function(){return!0}]),pages=this.$indexData.collect(this),pages=_.filter(pages,function(_this){return function(page){return page.$meta.uid!==_this.$meta.uid}}(this)),filteredPages=_.filter(pages,function(page){return _.any(filters,function(filter){return filter(page)})}),pageModels=_.map(filteredPages,function(_this){return function(page){return ModelFactory.get(_this._courseIdentifier,page)}}(this)),this._makePromise(pageModels)},SectionModel}(BaseModel)}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("campusServices").factory("User",["$http","$q","ApiHelper","BaseModel","CurrentCourseConfig","UserData",function($http,$q,ApiHelper,BaseModel){var UserModel;return UserModel=function(_super){function UserModel(){this.$featureEnabled=__bind(this.$featureEnabled,this),this.$recordLastPageViewed=__bind(this.$recordLastPageViewed,this),this.$userName=__bind(this.$userName,this),this.$usedHintsCount=__bind(this.$usedHintsCount,this),this.$totalPoints=__bind(this.$totalPoints,this),this.$requiredPagesCompleted=__bind(this.$requiredPagesCompleted,this),this.$possiblePoints=__bind(this.$possiblePoints,this),this.$isLoggedIn=__bind(this.$isLoggedIn,this),this.$gravatar=__bind(this.$gravatar,this),UserModel.__super__.constructor.apply(this,arguments)}return __extends(UserModel,_super),UserModel.prototype.$refresh=function(){return this.$userData.flushData(),this.$userData.get()},UserModel.prototype.$destroy=function(){return this.off&&this.off()},UserModel.prototype.$awardedAchievements=function(){var awardedAchievements;return awardedAchievements=function(_this){return function(){return _this.$userData.get().then(function(userData){return userData.achievements.awarded})}}(this),this._bindResult(awardedAchievements,this.$userData,"update")},UserModel.prototype.$unawardedAchievements=function(){var unawardedAchievements;return unawardedAchievements=function(_this){return function(){return _this.$userData.get().then(function(userData){return userData.achievements.unawarded})}}(this),this._bindResult(unawardedAchievements,this.$userData,"update")},UserModel.prototype.$gravatar=function(){var gravatar;return gravatar=function(_this){return function(){return _this.$userData.get().then(function(userData){return(null!=userData?userData.gravatar:void 0)||_this.$configData.get("default_gravatar")})}}(this),this._bindResult(gravatar,this.$userData,"update")},UserModel.prototype.$isLoggedIn=function(){var isLoggedIn;return isLoggedIn=function(_this){return function(){return _this.$userData.get().then(function(userData){return!!userData&&!userData.visitor})}}(this),this._bindResult(isLoggedIn,this.$userData,"update")},UserModel.prototype.$possiblePoints=function(){var possiblePoints;return possiblePoints=function(_this){return function(){return _this.$userData.get().then(function(userData){return userData.points.possible_points})}}(this),this._bindResult(possiblePoints,this.$userData,"update")},UserModel.prototype.$requiredPagesCompleted=function(){var requiredPagesCompleted;return requiredPagesCompleted=function(_this){return function(){return _this.$userData.get().then(function(userData){return userData.pages.required_completed})}}(this),this._bindResult(requiredPagesCompleted,this.$userData,"update")},UserModel.prototype.$totalPoints=function(){var totalPoints;return totalPoints=function(_this){return function(){return _this.$userData.get().then(function(userData){return userData.points.total_points})}}(this),this._bindResult(totalPoints,this.$userData,"update")},UserModel.prototype.$usedHintsCount=function(){var usedHints;return usedHints=function(_this){return function(){return _this.$userData.get().then(function(userData){return userData.hints.used_count})}}(this),this._bindResult(usedHints,this.$userData,"update")},UserModel.prototype.$userName=function(){var userName;return userName=function(_this){return function(){return _this.$userData.get().then(function(userData){return userData.user_name})}}(this),this._bindResult(userName,this.$userData,"update")},UserModel.prototype.$recordLastPageViewed=function(queryString){return this.$userData.get().then(function(userData){var params;return params={run_through:{last_page_viewed:queryString}},$http({method:"PUT",url:"/run_throughs/"+userData.current_run_through.id,params:params})})},UserModel.prototype.$featureEnabled=function(feature){return-1!==this.features.indexOf(feature)},UserModel}(BaseModel)}])}.call(this),function(){angular.module("campusServices").factory("NextChallengeButton",function(){var overrides;return overrides=[],{overrideNextQueryString:function(queryString){return overrides.push(queryString)},getFirstOverride:function(){return overrides.shift()}}})}.call(this),function(){angular.module("campusServices").factory("OpenModal",["$rootScope","$compile","$controller","$resolve","$q",function($rootScope,$compile,$controller,$resolve,$q){var OpenModal,createModal,modals,removeModal;return modals=[],createModal=function(options){var deferred,resolvePromise;return null==options&&(options={}),resolvePromise=null,options.resolve?resolvePromise=$resolve.resolve(options.resolve):(deferred=$q.defer(),deferred.resolve({}),resolvePromise=deferred.promise),resolvePromise.then(function(controllerLocals){var modal,modalElement,modalScope,modalWithContent,_ref;return modalScope=(null!=(_ref=options.scope)?_ref.$new():void 0)||$rootScope.$new(),modalScope.modalClass=options.modalClass,modalScope.fullScreen=options.fullScreen,modal=$("<modal></modal>"),modalWithContent=modal.append(options.template),options.controller&&(controllerLocals.$scope=modalScope,$controller(options.controller,controllerLocals)),modalElement=$compile(modalWithContent)(modalScope),modals.push(modalElement),modalElement.$hide=modalScope.$hide,modalElement.$show=modalScope.$show,$("body").append(modalElement),modalElement})},removeModal=function(modalElement){var cleanUp;return cleanUp=function(){return modalElement.remove(),modals.splice(modals.indexOf(modalElement),1)},modalElement.is(":visible")?(modalElement.one("hidden.bs.modal",cleanUp),modalElement.modal("hide")):cleanUp()},OpenModal=function(){function OpenModal(){}return OpenModal.open=function(options){return null==options&&(options={}),createModal(options).then(function(modal){return modal.scope().$on("$close",function(){return removeModal(modal)}),modal.scope().$on("$hidden",function(){return removeModal(modal)}),modal.scope().$show()})},OpenModal.show=function(options){return null==options&&(options={}),createModal(options).then(function(modal){return modal.scope().$on("$close",function(){return modal.scope().$hide()
}),modal})},OpenModal.close=function(options){return null==options&&(options={}),_.each(modals,function(modal){return removeModal(modal)})},OpenModal}()}])}.call(this),function(){angular.module("campusServices").factory("RailsAssets",["$templateCache",function($templateCache){var assetManifest;return assetManifest=JSON.parse($templateCache.get("_assetManifest")),{path:function(){return function(assetName){return assetManifest&&assetManifest[assetName]?assetManifest[assetName]:assetName}}(this)}}])}.call(this),function(){angular.module("campusServices").factory("SublimeLoader",["$q",function($q){var isLoaded,loadingDeferred;return isLoaded=!1,loadingDeferred=$q.defer(),{load:function(){return function(playerUrl){return isLoaded||(isLoaded=!0,$.getScript(playerUrl).done(function(){return loadingDeferred.resolve()}).fail(function(){return isLoaded=!1,loadingDeferred.reject()})),loadingDeferred.promise}}(this)}}])}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("campusServices").factory("Submitter",["$q","$timeout","CampusEvent","RemoteExecutor","Report","ClientExecutor","ClientPersistence",function($q,$timeout,CampusEvent,RemoteExecutor,Report,ClientExecutor,ClientPersistence){var Submitter,contentData,executors,instances,userSubmissionInProgress;return contentData={},executors={},instances={},userSubmissionInProgress=!1,Submitter=function(){function Submitter(course,page){this._dynamicContent=__bind(this._dynamicContent,this),this._updateClientStore=__bind(this._updateClientStore,this);var executor,uid;this.course=course,this.page=page,this.inProgressPromise=null,this.lastPromise=null,this.lastContent=null,this.clientStore=new ClientPersistence(this.course.identifier),CampusEvent.makeEventEmitter(this,function(eventName){return"submitter:"+eventName+":"+page.$meta.uid}),uid=this.page.$meta.uid,contentData[uid]||(contentData[uid]=[]),executors[uid]||(executor=executors[uid]="client_executor"===this.page.executor.executor_name?new ClientExecutor(this.course,this.page):new RemoteExecutor(this.course,this.page)),instances[uid]=this}return Submitter.get=function(course,page){return instances[page.$meta.uid]||new Submitter(course,page)},Submitter.cleanUp=function(){return contentData={},executors={},_.each(instances,function(instance){return instance.destroy()})},Submitter.prototype.content=function(){return _.collect(contentData[this.page.$meta.uid],function(callback){return callback()})},Submitter.prototype.executor=function(){return executors[this.page.$meta.uid]},Submitter.prototype.registerContent=function(content){return contentData[this.page.$meta.uid].push(content)},Submitter.prototype.userSubmit=function(options){var content;return null==options&&(options={}),userSubmissionInProgress=!0,this.emit("userSubmissionStarted"),content=this.content(),this._submit(content,options,function(_this){return function(report){var _ref,_ref1;return _this._updateClientStore(null!=(_ref=report.details())?null!=(_ref1=_ref.output)?_ref1.clientStore:void 0:void 0),_this.page.$recordAttempt(report,content).then(function(){return _this.emit("userSubmissionComplete",report),report})}}(this))["finally"](function(_this){return function(){return userSubmissionInProgress=!1,_this.emit("userSubmissionFinally")}}(this))},Submitter.prototype.submit=function(options){var content;return null==options&&(options={recordAttempt:!0}),userSubmissionInProgress?this.inProgressPromise:(content=this.content(),this._submit(content,options,function(_this){return function(report){var reportDetails,_ref,_ref1;return _this._updateClientStore(null!=(_ref=report.details())?null!=(_ref1=_ref.output)?_ref1.clientStore:void 0:void 0),report.success()?(reportDetails=report.details(),options.recordAttempt?_this.page.$recordAttempt(report,content).then(function(){return report}):report):report}}(this)))},Submitter.prototype.cancel=function(){var cancelPromise;return cancelPromise=this.executor().cancel(),cancelPromise.then(function(_this){return function(data){return _this.emit("cancelled",data)}}(this)),cancelPromise},Submitter.prototype.destroy=function(){return this.off(),delete contentData[this.page.$meta.uid],delete executors[this.page.$meta.uid],delete instances[this.page.$meta.uid]},Submitter.prototype._sameContent=function(content){return this.lastContent?this.lastContent.length!==content.length?!1:_.isEqual(this.lastContent,content):!1},Submitter.prototype._updateClientStore=function(data){var k,_i,_len,_ref,_results;if(data){for(_ref=Object.keys(data),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)k=_ref[_i],_results.push(this.clientStore.set(k,data[k]));return _results}},Submitter.prototype._dynamicContent=function(){var _ref;return null!=(_ref=this.page.template)?_ref.match(/server/):void 0},Submitter.prototype._submit=function(content,options,thenCallback,catchCallback,finallyCallback){var cancelledPromise,chainCallbacks,emitEvents,promise,runExecutor,sameResult,sameResultPromise;return null==thenCallback&&(thenCallback=function(){}),null==catchCallback&&(catchCallback=function(){}),null==finallyCallback&&(finallyCallback=function(){}),chainCallbacks=function(promise){return promise.then(thenCallback)["catch"](catchCallback)["finally"](finallyCallback)},emitEvents=function(_this){return function(promise){return promise.then(function(data){return _this.emit("complete",data)}),promise["catch"](function(data){return _this.emit("error",data)}),promise["finally"](function(data){return _this.emit("finally",data)})}}(this),this.emit("start"),!this._dynamicContent()&&this._sameContent(content)&&this.lastPromise?(sameResult=$q.defer(),sameResultPromise=sameResult.promise,chainCallbacks(sameResultPromise),emitEvents(sameResultPromise),this.lastPromise.then(function(report){return sameResult.resolve(new Report(report.report))})["catch"](sameResult.reject),sameResultPromise):(runExecutor=function(_this){return function(){return _this.lastContent=content,_this.inProgressPromise=_this.executor().submit(content,options),chainCallbacks(_this.inProgressPromise),emitEvents(_this.inProgressPromise),_this.inProgressPromise["finally"](function(){return _this.lastPromise=_this.inProgressPromise,_this.inProgressPromise=null})}}(this),promise=null,this.inProgressPromise?(cancelledPromise=this.inProgressPromise,promise=this.cancel().then(function(){var deferred;return deferred=$q.defer(),cancelledPromise["finally"](function(){return $timeout(function(){return runExecutor().then(function(report){return deferred.resolve(report)})["catch"](function(error){return deferred.reject(error)})})}),deferred.promise})):promise=runExecutor(),promise)},Submitter}()}])}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("campusServices").factory("TestService",["$q","ApiHelper","CampusEvent","CourseContentData","CourseMap","DeferredQueue","ModelFactory","Report","Submitter",function($q,ApiHelper,CampusEvent,CourseContentData,CourseMap,DeferredQueue,ModelFactory,Report,Submitter){var AggregateReport,AttemptReport,TestService,errors,isConsoleChallenge,isEditorChallenge,isMultipleSelectChallenge,reports;return reports={},errors={},isEditorChallenge=function(challenge){return-1!==["editor_challenge","editor_tasks_challenge"].indexOf(challenge.type)},isConsoleChallenge=function(node){return/console/.test(node.type)},isMultipleSelectChallenge=function(node){return-1!==["multiple_select_challenge","multiple_select_table_challenge"].indexOf(node.type)},AggregateReport=function(){function AggregateReport(reports){this.reports=reports,this.firstFailureReport=_.find(this.reports,function(report){return!report.success()})}return AggregateReport.prototype.success=function(){return!this.firstFailureReport},AggregateReport.prototype.message=function(){var _ref;return null!=(_ref=this.firstFailureReport)?_ref.message():void 0},AggregateReport}(),AttemptReport=function(_super){function AttemptReport(attempt,report){var failedAttemptMessageMatchesTestedAttemptMessage,failureMatchesTestedAttemptPattern,_ref,_ref1;AttemptReport.__super__.constructor.call(this,report.report),this.testedAttempt=attempt,failedAttemptMessageMatchesTestedAttemptMessage=(null!=(_ref=this.failedAttempt())?_ref.message:void 0)===this.testedAttempt.message,failureMatchesTestedAttemptPattern=!1,this.testedAttempt.pass_with_pattern&&(failureMatchesTestedAttemptPattern=new RegExp(this.testedAttempt.pass_with_pattern).test(null!=(_ref1=_.first(this.report.failures))?_ref1.err.message:void 0)),this.failureIsTestedAttempt=failedAttemptMessageMatchesTestedAttemptMessage||failureMatchesTestedAttemptPattern}return __extends(AttemptReport,_super),AttemptReport.prototype.failedAttempt=function(index){var failedAttempt,referencedAttemptName,_ref;return null==index&&(index=0),0===this.failureCount()?null:(failedAttempt=AttemptReport.__super__.failedAttempt.call(this,index),referencedAttemptName=null!=(_ref=/\%{(.*)}/.exec(this.testedAttempt.message))?_ref[1]:void 0,referencedAttemptName&&referencedAttemptName===(null!=failedAttempt?failedAttempt.name:void 0)?this.testedAttempt:failedAttempt)},AttemptReport.prototype.success=function(){return AttemptReport.__super__.success.call(this)?this.expectSuccess():this.expectSuccess()?!1:this.failureIsTestedAttempt},AttemptReport.prototype.expectSuccess=function(){return this.testedAttempt.success||!1},AttemptReport.prototype.message=function(){var _ref,_ref1,_ref2,_ref3,_ref4;return this.success()?null:_.isEmpty(this.testedAttempt.pass_with_pattern)?0===this.failureCount()?"(Success, no message)":(null!=(_ref1=this.failedAttempt())?_ref1.message:void 0)?this.failedAttempt().message:(null!=(_ref2=_.first(this.report.failures))?null!=(_ref3=_ref2.err)?_ref3.message:void 0:void 0)||(null!=(_ref4=_.first(this.report.failures))?_ref4.title:void 0):'Expected "'+(null!=(_ref=_.first(this.report.failures))?_ref.err.message:void 0)+'" to match /'+this.testedAttempt.pass_with_pattern+"/"},AttemptReport}(Report),TestService=function(){function TestService(course){this.course=course,this.courseContentData=new CourseContentData(course.identifier),CampusEvent.makeEventEmitter(this,function(eventName){return"testService:"+eventName})}return TestService.prototype.getReport=function(node,attempt){return attempt?reports[""+node.$meta.uid+":"+attempt.name]:reports[node.$meta.uid]},TestService.prototype.getError=function(node,attempt){return attempt?errors[""+node.$meta.uid+":"+attempt.name]:errors[node.$meta.uid]},TestService.prototype.run=function(rootNode,attempt,options){var buildAttemptQueue,buildChallengeQueue,buildEmptyQueue,buildNodeQueue,buildNodeQueueByType,startTime;return null==options&&(options={}),startTime=+new Date,this._clearReports(),this.emit("start"),buildEmptyQueue=function(){var emptyQueue;return emptyQueue=new DeferredQueue(1),emptyQueue.push(function(){var deferred;return deferred=$q.defer(),deferred.resolve(new AggregateReport([])),deferred.promise}),emptyQueue},buildAttemptQueue=function(_this){return function(challenge,attempt){var attemptQueue;return attemptQueue=new DeferredQueue(1),attemptQueue.push(function(){return _this._loadCourseData(challenge).then(function(loadedChallenge){return _this._runAttempt(loadedChallenge,attempt,options)})}),attemptQueue}}(this),buildChallengeQueue=function(_this){return function(indexChallenge){var challengeQueue;return challengeQueue=new DeferredQueue(1),challengeQueue.push(function(){return _this._loadCourseData(indexChallenge).then(function(challenge){return challenge.$attempts().then(function(attempts){var attemptQueue;return attemptQueue=new DeferredQueue(1),_.each(attempts,function(attempt){return attemptQueue.push(function(){return _this._runAttempt(challenge,attempt,options)})}),attemptQueue.run().then(function(attemptReports){var aggregateReport;return aggregateReport=_this._addReport(challenge,attemptReports),_this.emit("complete:"+challenge.$meta.uid,aggregateReport),aggregateReport})["catch"](function(errors){throw _this._addErrors(challenge,errors),_this.emit("error:"+challenge.$meta.uid,errors),errors})})})}),challengeQueue}}(this),buildNodeQueue=function(_this){return function(node,contentProvider){var nodeQueue;return nodeQueue=new DeferredQueue(1),nodeQueue.push(function(){return contentProvider(node).then(function(nodes){var contentsQueue;return contentsQueue=new DeferredQueue(1),_.each(nodes,function(node){return contentsQueue.push(function(){return buildNodeQueueByType(node).run()})}),contentsQueue.run().then(function(contentReports){var aggregateReport;return aggregateReport=_this._addReport(node,contentReports),_this.emit("complete:"+node.$meta.uid,aggregateReport),aggregateReport})["catch"](function(error){throw _this._addErrors(node,errors),_this.emit("error:"+node.$meta.uid,error),error})})}),nodeQueue}}(this),buildNodeQueueByType=function(){return function(node){return CourseMap.isChallenge(node)?attempt?buildAttemptQueue(node,attempt):buildChallengeQueue(node):CourseMap.isCourse(node)?buildNodeQueue(node,function(course){return course.$levels()}):CourseMap.isLevel(node)?buildNodeQueue(node,function(level){return level.$tests()}):CourseMap.isSection(node)?buildNodeQueue(node,function(section){return section.$tests()}):buildEmptyQueue(node)}}(this),buildNodeQueueByType(rootNode).run().then(function(_this){return function(report){var endTime;return endTime=+new Date,console.log("Took: "+(endTime-startTime)+"ms"),_this.emit("complete",report),report}}(this))["catch"](function(_this){return function(error){throw _this.emit("error",error),error}}(this))},TestService.prototype._loadCourseData=function(node){return this.courseContentData.get(node.$meta.uid).then(function(_this){return function(data){return ModelFactory.get(_this.course.identifier,ApiHelper.normalizeData(data))}}(this))},TestService.prototype._runAttempt=function(challenge,attempt,options){var lockedEditors,submitter,submitterPromise;return this.emit("start:"+challenge.$meta.uid+":"+attempt.name),submitter=Submitter.get(this.course,challenge),isEditorChallenge(challenge)?(lockedEditors=_.filter(challenge.editors,function(editor){return!!editor.locked}),_.each(attempt.files,function(file){return submitter.registerContent(function(){return{code:file.code,fileName:file.file_name,codeType:file.code_type}})}),_.each(lockedEditors,function(editor){return submitter.registerContent(function(){return{code:editor.content,fileName:editor.file_name,codeType:editor.syntax}})})):isConsoleChallenge(challenge)?submitter.registerContent(function(){return{code:eval(attempt.raw_input)}}):isMultipleSelectChallenge(challenge)?submitter.registerContent(function(){return JSON.parse(attempt.raw_input)}):submitter.registerContent(function(){return eval(attempt.raw_input)}),submitterPromise=submitter.submit({recordAttempt:!1,executorData:options.executorData}).then(function(_this){return function(report){var attemptReport;return attemptReport=_this._addAttemptReport(challenge,attempt,report),_this.emit("complete:"+challenge.$meta.uid+":"+attempt.name,attemptReport),attemptReport}}(this))["catch"](function(_this){return function(error){throw _this._addAttemptError(challenge,attempt,error),_this.emit("error:"+challenge.$meta.uid+":"+attempt.name,error),error}}(this)),submitter.destroy(),submitterPromise},TestService.prototype._clearReports=function(){var report,uid,_results;_results=[];for(uid in reports)report=reports[uid],_results.push(delete reports[uid]);return _results},TestService.prototype._addReport=function(node,childReports){var aggregateReport;return aggregateReport=new AggregateReport(childReports),reports[node.$meta.uid]=aggregateReport,aggregateReport},TestService.prototype._addErrors=function(node,error){return errors[node.$meta.uid]=error,error},TestService.prototype._addAttemptReport=function(challenge,attempt,report){var attemptReport;return attemptReport=new AttemptReport(attempt,report),reports[""+challenge.$meta.uid+":"+attempt.name]=attemptReport,attemptReport},TestService.prototype._addAttemptError=function(challenge,attempt,error){return errors[""+challenge.$meta.uid+":"+attempt.name]=error},TestService}()}])}.call(this),function(){angular.module("campusServices").factory("WebEngage",["$q",function($q){return{exists:function(){return!("undefined"==typeof _weq||null===_weq)},trackCourseCompletion:function($course){var deferred;return this.exists()?$course.$progress().then(function(progress){var course_complete;return course_complete=100===progress,_weq["webengage.ruleData"]={course_complete:course_complete},course_complete}):(deferred=$q.defer(),deferred.reject(),deferred.promise)},reload:function(){return"undefined"!=typeof webengage&&null!==webengage?"function"==typeof webengage.reload?webengage.reload():void 0:void 0}}}])}.call(this),function(){angular.module("campusTemplateDirectives",[])}.call(this),function(){angular.module("campusTemplateDirectives").controller("SelectionController",["$scope",function($scope){return $scope.currentActiveIndex=0,$scope.setCurrentActiveIndex=function(index){return $scope.currentActiveIndex=index},$scope.isActive=function(index){return $scope.currentActiveIndex===index}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("achievementsList",["CampusUrl",function(CampusUrl){return{restrict:"E",replace:!0,scope:!0,template:"<ul class='g achievementList'>\n  <li ng-repeat='achievement in awardedAchievements' class='g-b g-b--m--1of2 achievementList-item is-awarded'>\n    <div class='bucket bucket--flag'>\n      <div class='bucket-media'>\n        <div class='badge'>\n          <img class='badge-img' ng-src='{{badgeUrl(achievement.badge)}}' alt='badge for achievement {{achievement.name}}'/>\n        </div>\n      </div>\n      <div class='bucket-content'>\n        <h3 class='achievementList-item-title' ng-if='!!achievement.name'>{{achievement.name}}</h3>\n        <p class='achievementList-item-desc'>{{achievement.description}}</p>\n      </div>\n    </div>\n  </li>\n  <li ng-repeat='achievement in unawardedAchievements' class='g-b g-b--m--1of2 achievementList-item'>\n    <div class='bucket bucket--flag'>\n      <div class='bucket-media'>\n        <div class='badge'>\n          <img class='badge-img' ng-src='{{badgeUrl(placeholder)}}' alt='placeholder badge'/>\n        </div>\n      </div>\n      <div class='bucket-content'>\n        <h3 class='achievementList-item-title'>{{achievement.name}}</h3>\n        <p class='achievementList-item-desc'>{{achievement.description}}</p>\n      </div>\n    </div>\n  </li>\n</ul>",link:function(scope,element,attrs){return scope.$user.$awardedAchievements().bind(scope,"awardedAchievements"),scope.$user.$unawardedAchievements().bind(scope,"unawardedAchievements"),scope.placeholder=attrs.placeholder||"placeholder.png",scope.badgeUrl=function(path){return CampusUrl.badgeUrl(path)}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("adaptiveHint",["$compile","$interpolate",function($compile,$interpolate){return{replace:!0,restrict:"E",scope:!0,transclude:!0,template:"<div class=\"adaptive-hint\" ng-show=\"hint\">\n  <a href='' class='btn btn--hint btn--thin btn--offset btn--offset--thin' ng-click='showHint()' ng-hide=\"shownHint\" analytics-on analytics-event=\"Adaptive Hint\">\n    <span class='loader-text'>Use A Hint</span>\n  </a>\n  <div class='hint-content' ng-show=\"shownHint\"></div>\n</div>",link:function(scope,element,attrs,ctrl,$transclude){var hint;return hint=attrs.hint,$transclude(scope,function(clonedElement){var clonedContent,compileHtml,hasContent,hintContent,interpolatedElement,interpolatedHtml,isEmpty;return isEmpty=/^\s*$/,hintContent=element.find(".hint-content"),clonedContent=clonedElement.html(),hasContent=!!clonedContent&&!isEmpty.test(clonedContent),hasContent?(interpolatedHtml=$interpolate(clonedContent)(scope),interpolatedElement=angular.element("<div></div>").html(interpolatedHtml),interpolatedElement.find("code").each(function(index,element){return element=$(element),element.html(element.html().replace(/{{(.*)}}/g,"\\{\\{$1\\}\\}"))}),(compileHtml=$compile(interpolatedElement))(scope,function(compiledHtml){var hasCompiledContent;return hasCompiledContent=!!compiledHtml&&!isEmpty.test(compiledHtml.html()),hasCompiledContent?(scope.hint=!0,compiledHtml.find("code").each(function(index,element){return element=$(element),element.html(element.html().replace(/\\{\\{(.*)\\}\\}/g,"{{$1}}"))}),hintContent.html(compiledHtml)):(scope.hint=!1,hintContent.empty())})):(scope.hint=!1,hintContent.empty())}),scope.showHint=function(){return scope.shownHint=!0,void 0!==scope.$parent.shownHint?scope.$parent.shownHint=!0:void 0}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("adaptiveHints",function(){return{replace:!0,restrict:"E",scope:!0,template:"<div class=\"card card--error mbm\" ng-show=\"errorMessage\">\n  <h3>Error</h3>\n  <p ng-bind-html=\"errorMessage\"></p>\n  <a href='' class='btn btn--hint btn--thin btn--offset btn--offset--thin' ng-show='hint' ng-click='showHint()'>\n    <span class='loader-text'>Use A Hint</span>\n  </a>\n  <span ng-bind-html=\"shownHint\"></span>\n</div>",link:function(scope){return scope.$on("submission:success",function(){return scope.errorMessage=null,scope.shownHint="",scope.hint=null}),scope.$on("submission:fail",function(evt,submissionData){var failure,failureName;return failureName=submissionData.result.firstFailure.title,scope.errorMessage=submissionData.result.message(),scope.shownHint=null,failure=submissionData.executorData.failures[failureName],scope.hint=failure&&failure.hint?failure.hint:null}),scope.showHint=function(){return scope.shownHint=scope.hint,scope.hint=null}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("backToBeginningButton",["$state",function($state){return{restrict:"E",replace:!0,scope:!0,transclude:!0,template:'<div class="back-to-beginning-button">\n  <a class="btn btn--a btn--next" href="" ng-click="gotoBeginning()" ng-transclude analytics-on analytics-event="Back to Beginning"></a>\n</div>',link:function(scope){return scope.gotoBeginning=function(){return $state.go("root.courseContent",{queryString:scope.$course.$meta.query_string})}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("badgeCount",function(){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{achievements.length}}</span>",link:function(scope){return scope.$course.$achievements().bind(scope,"achievements")}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("badgeList",["CampusUrl",function(CampusUrl){return{replace:!0,restrict:"E",scope:!0,template:'<ol class="badgeList">\n  <li class="badgeList-item" ng-repeat="achievement in achievements">\n    <div class="badge">\n      <img class="badge-img" ng-src="{{badgeUrl(achievement.badge)}}" alt="{{achievement.name}}" />\n    </div>\n  </li>\n</ol>',link:function(scope){return scope.$course.$achievements().bind(scope,"achievements"),scope.badgeUrl=function(badge){return CampusUrl.badgeUrl(badge)}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("badgeProgress",["DrawBadgeProgress",function(DrawBadgeProgress){return{replace:!1,restrict:"A",scope:!0,link:function(scope,element,attrs){var badgeProgress;return badgeProgress=new DrawBadgeProgress,scope.$watch(attrs.badgeProgress,function(progress){return void 0!==progress?badgeProgress.init({element:element[0],progress:progress,delay:1e3,radius:55}):void 0})}}}])}.call(this),function(){var stringTrue;stringTrue=function(str){return"true"===(null!=str?str.toString().toLowerCase():void 0)},angular.module("campusTemplateDirectives").directive("blackboardVideoPlayer",["CampusUrl","$rootScope","$timeout","BlackboardLoader","ProjectorVideo",function(CampusUrl,$rootScope,$timeout,BlackboardLoader,ProjectorVideo){return{restrict:"E",replace:!0,scope:!0,template:"<div>\n  <div class='card card--a video-frame'></div>\n</div>",link:function(scope,element,attrs){var projectorVideo,videoData;return scope.playerUrl="//cdn.codeschool.com/blackboard/blackboard-0.17.0.js",scope.autoplay=stringTrue(attrs.autoplay),scope.allowDownloads=stringTrue(attrs.allowDownloads),scope.name=scope.$page.name,scope.startAtTime=attrs.startAtTime,projectorVideo=new ProjectorVideo(scope.$course.identifier),videoData=scope.$page.video,scope.initializeBlackboard=function(videoData){var _ref;return"undefined"==typeof Blackboard?BlackboardLoader.load(scope.playerUrl).then(function(){return scope.loadBlackboard(videoData)}):(null!=(_ref=scope.player)&&"function"==typeof _ref.destroy&&_ref.destroy(),scope.player=null,$timeout(function(){return scope.loadBlackboard(videoData)}))},scope.loadBlackboard=function(videoData){var root,_ref,_ref1,_ref2;return scope.uuid=null!=(_ref=scope.$user)?_ref.uuid:void 0,scope.startAtTime=null!=(_ref1=null!=(_ref2=videoData.start_at_time)?_ref2:scope.startAtTime)?_ref1:"0:00",root="undefined"!=typeof self&&null!==self?self:global,_.has(root,"Blackboard")?scope.player=new Blackboard(videoData.media,{placement:_.first(element).querySelector(".video-frame"),media:{title:scope.name},title:scope.$course.name,persistChanges:!0,allowDownloads:scope.allowDownloads,allowSubtitles:!0,pauseWhenHidden:!0,autoplay:!1,allowHeartbeat:!!videoData.heartbeat,heartbeat:{props:{uuid:scope.uuid,domain:"course",userAgent:root.navigator.userAgent,videoId:videoData.id,src:function(){return this.currentSrc}},route:videoData.heartbeat,payload:function(){return{userId:this.uuid,domain:this.domain,userAgent:this.userAgent,videoId:this.videoId,videoFormat:this.src.format,videoProfile:this.src.profile}}},callback:function(){return this.seekTo(scope.startAtTime,function(_this){return function(){return scope.autoplay?_this.play():void 0}}(this))}}):null},scope.videoData&&(videoData=scope.videoData),videoData.id&&projectorVideo.get(videoData.id).then(function(videoObj){return angular.extend(videoData,videoObj.data[videoData.id]),scope.initializeBlackboard(videoData)}),$rootScope.$on("video:stop",function(){var _ref;return null!=(_ref=scope.player)?"function"==typeof _ref.pause?_ref.pause():void 0:void 0}),scope.$on("$destroy",function(){var _ref;return null!=(_ref=scope.player)&&"function"==typeof _ref.destroy&&_ref.destroy(),scope.player=null})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("challengeFeed",["$compile","$q","$timeout","Submitter",function($compile,$q,$timeout,Submitter){return{restrict:"E",replace:!0,scope:!0,template:'<div class="feed">\n  <!-- These include or exclude themselves based on the item -->\n  <recent-attempt-feed-item ng-repeat-start="item in feedItems"></recent-attempt-feed-item>\n  <incorrect-submission-feed-item reports="reports"></incorrect-submission-feed-item>\n  <used-hint-feed-item ng-repeat-end></used-hint-feed-item>\n</div>',controllerAs:"challengeFeedController",controller:["$scope",function(){var openItems;return openItems=[],this.isOpen=function(item){return-1!==openItems.indexOf(item)},this.openItem=function(item){return openItems.push(item)},this.closeItem=function(item){return openItems.splice(openItems.indexOf(item),1)},this.closeAll=function(){return openItems.splice(0,openItems.length)},this}],link:function(scope,element,attrs,controller){var addNewFeedItem,dataRequests,errorWasScrolled,hideFailures,hideRecentAttempts,hintWasScrolled,page,scrollToNewFeedItem,submitter;return page=scope.$page,submitter=Submitter.get(scope.$course,scope.$page),hideFailures="false"===attrs.failures||!1,hideRecentAttempts="false"===attrs.recentAttempts||!1,scope.feedItems=[],scope.reports=[],dataRequests=[],dataRequests.push(page.$usedHints().then(function(usedHints){return _.each(usedHints,function(hint){return scope.feedItems.unshift(hint)})})),hideRecentAttempts||dataRequests.push(page.$recentAttempt().then(function(recentAttempt){return recentAttempt?scope.feedItems.unshift(recentAttempt):void 0})),hintWasScrolled=!1,errorWasScrolled=!1,addNewFeedItem=function(item){return scope.feedItems.unshift(item),controller.closeAll(),controller.openItem(item)},scrollToNewFeedItem=function(){return $timeout(function(){return scope.$emit("challengeFeed:scroll",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString,scrollToElement:element.children()[0]})})},page.on("newHint",function(hint){return addNewFeedItem(hint),hintWasScrolled?void 0:(scrollToNewFeedItem(),hintWasScrolled=!0)}),submitter.on("complete",function(report){return report.success()&&page.$isTaskBased()?scope.feedItems=_.difference(scope.feedItems,scope.reports):void 0}),hideFailures?void 0:submitter.on("userSubmissionComplete",function(report){var newReport;return newReport=-1===scope.feedItems.indexOf(report),report.success()||!newReport||(addNewFeedItem(report),scope.reports.unshift(report),errorWasScrolled)?void 0:(scrollToNewFeedItem(),errorWasScrolled=!0)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("incorrectSubmissionFeedItem",["$analytics","Report",function($analytics,Report){return{restrict:"E",replace:!0,scope:!0,template:'<div>\n  <feed-item item-title=\'Incorrect Submission\' class="widget--error {{classes}}" ng-if="isReport">\n    <span compile-html="{{report.htmlMessage()}}"></span>\n    <adaptive-hint class=\'mtm\'>{{report.failedAttempt().hint}}</adaptive-hint>\n  </feed-item>\n</div>',link:function(scope,element,attrs){var classes,firstTaskFailureIndex,isExisting,page,report,reports,taskFailures,_ref;return scope.isReport=scope.item instanceof Report,scope.isReport?(page=scope.$page,report=scope.item,reports=scope.$parent[attrs.reports],firstTaskFailureIndex=page.$taskIndex(report.failedTask()),classes=[],-1!==firstTaskFailureIndex&&(taskFailures=_.filter(reports,function(currentReport){return page.$taskIndex(currentReport.failedTask())===firstTaskFailureIndex}),isExisting=taskFailures.length>1,isExisting?classes.push("is-existing"):(classes.push("is-failure"),1===taskFailures.length&&classes.push("is-first"),classes.push("is-task-index-"+(firstTaskFailureIndex+1)))),scope.report=report,scope.classes=classes.join(" "),$analytics.eventTrack("Incorrect Submission",{course_identifier:scope.$course.identifier,page:page.$meta.query_string,message:report.message(),failure_name:null!=(_ref=report.failedAttempt())?_ref.name:void 0,task:report.failedTask()})):void 0}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("recentAttemptFeedItem",["Autolinker","Markdown","HTMLUtils",function(Autolinker,Markdown,HTMLUtils){return{restrict:"E",replace:!0,scope:!0,template:'<div>\n  <feed-item class=\'widget--{{recentAttempt.success ? "success" : "error"}}\' item-title=\'Recent {{recentAttempt.success ? "Successful" : "Failing"}} Attempt\' ng-if="isRecentAttempt">\n    <span compile-html="{{message}}"></span>\n    <div class=\'mtm\'>\n      <h4 ng-repeat-start="submission in submissions">{{submission.fileName}}</h4>\n      <code-highlight ng-repeat-end syntax={{submission.codeType}} bind-content="submission.code"></code-highlight>\n    </div>\n  </feed-item>\n</div>',link:function(scope){var editors,failure,isSyntaxError,message,page,recentAttempt;return scope.isRecentAttempt=_.has(scope.item,"run_through_id")&&_.has(scope.item,"id"),scope.isRecentAttempt&&(isSyntaxError=function(message){return!!_.unescape(message).match(/^#?<?[A-Za-z0-9]*[Ee]rror:/)},page=scope.$page,recentAttempt=scope.item,editors=_.compact(_.flatten([page.editor,page.editors])),scope.recentAttempt=recentAttempt,scope.submissions=_.filter(JSON.parse(recentAttempt.submission),function(submission){var matchingEditor;return matchingEditor=_.find(editors,function(editor){return submission.fileName===editor.file_name}),!(null!=matchingEditor?matchingEditor.locked:void 0)}),message=recentAttempt.success?null:failure=JSON.parse(recentAttempt.response).failures[0])?(message=HTMLUtils.toHtml(message.replace(/\\n/g,"\n")),scope.message=Autolinker.link(message,{urls:!0,stripPrefix:!1})):void 0}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("usedHintFeedItem",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div>\n  <feed-item class=\'widget--{{isAnswer? "answer" : "hint"}}\' item-title=\'{{isAnswer ? "Answer" : "Hint"}}\' ng-if="isHint">\n    <div compile-html="{{hint.body}}"></div>\n    <ul>\n      <li ng-repeat="file in hint.files">\n        <h3 ng-if="!!file.file_name">{{file.file_name}}</h3>\n        <code-highlight syntax=\'{{file.code_type}}\' bind-content="file.code" line-numbers="{{file.line_numbers}}" first-line-number="{{file.first_line_number}}"></code-highlight>\n      </li>\n    </ul>\n  </feed-item>\n</div>',link:function(scope){var hint,_ref,_ref1;
return scope.isHint="hint"===(null!=(_ref=scope.item)?null!=(_ref1=_ref.$meta)?_ref1.type:void 0:void 0),scope.isHint?(hint=scope.item,scope.hint=hint,scope.escape=_.escape,scope.$page.$isAnswer(hint).bind(scope,"isAnswer")):void 0}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("clientPersistenceDisplay",["ClientPersistence",function(ClientPersistence){return{replace:!0,restrict:"C",scope:!0,transclude:!0,template:"<span ng-transclude></span>",link:function(scope,element,attrs){var clientStore,key,updateElement;return key=attrs.key,clientStore=new ClientPersistence(scope.$course.identifier),updateElement=function(val){return val?element.html(val):void 0},scope.storeValue=function(){return clientStore.get(key)},scope.$watch("storeValue()",function(val){return updateElement(val)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("codeEditor",["CampusUtil","ClientPersistence","Submitter","$timeout","Logger","CampusEvent","$parse",function(CampusUtil,ClientPersistence,Submitter,$timeout,Logger,CampusEvent,$parse){return{restrict:"E",replace:!0,scope:!0,template:"<div class='codeEditor-pane' ng-class=\"{'is-locked': isLocked}\"></div>",link:function(scope,element,attrs){var clientStore,editorData,foldLines,markLines,setCursor,submit,submitter,_markDataFor,_markDataOption,_markDataOptionReadOnly;return submitter=Submitter.get(scope.$course,scope.$page),clientStore=new ClientPersistence(scope.$course.identifier),submit=function(){return submitter.userSubmit()},markLines=function(markedData){return _.each(markedData||[],function(data){var e;try{return _markDataFor(data)}catch(_error){return e=_error,Logger.error("Error marking lines: "+e+"\nTrace: "+e.stack+'")\nLogger.error("With mark data: '+JSON.stringify(data))}})},_markDataFor=function(data){var fetchedLine,from,fromLine,to,toCh,toLine;return fromLine=data.from[0],toLine=data.to?data.to[0]:fromLine,from={line:fromLine,ch:data.from[1]||0},void 0!==data.to?(fetchedLine=scope.codeEditor.getLine(toLine),toCh=void 0===data.to[1]?fetchedLine.length:data.to[1],to={line:toLine,ch:toCh}):(fetchedLine=scope.codeEditor.getLine(from.line),to={line:from.line,ch:fetchedLine.length}),_.each(data.options||{},function(value,key){return _markDataOption(data,from,to,key,value)}),scope.codeEditor.markText(from,to,data.options)},_markDataOption=function(data,from,to,option){return"readOnly"===option?(_markDataOptionReadOnly(from,to),data.options.className="is-locked"):void 0},_markDataOptionReadOnly=function(from,to){var endLineNum,fetchedToLine,lockingTheSameLine,partialLine,startLineNum;if(lockingTheSameLine=from.line===to.line)return scope.codeEditor.markText({line:from.line,ch:from.ch},{line:to.line,ch:to.ch},{className:"is-locked"});for(partialLine=null,startLineNum=from.ch>0?from.line+1:from.line,to&&(fetchedToLine=scope.codeEditor.getLine(to.line),endLineNum=to.ch<fetchedToLine.length-1?(partialLine=to,to.line-1):to.line);endLineNum>=startLineNum;)scope.codeEditor.addLineClass(startLineNum,"wrap","is-locked"),startLineNum+=1;return partialLine?scope.codeEditor.markText({line:partialLine.line,ch:0},{line:partialLine.line,ch:partialLine.ch},{className:"is-locked"}):void 0},setCursor=function(cursorData){var count,e,fetchedLine,indent,indentLength,toCh,whsp;if(cursorData)try{if(fetchedLine=scope.codeEditor.getLine(cursorData[0]),indent=fetchedLine.match(/(^\s*)/g),indentLength=indent.length>0?indent[0].length:0,toCh=void 0===cursorData[1]?indentLength:cursorData[1],fetchedLine.length<toCh){for(count=toCh-fetchedLine.length,whsp="";count;)whsp+=" ",count-=1;scope.codeEditor.replaceRange(whsp,{line:cursorData[0],ch:fetchedLine.length},{line:cursorData[0],ch:toCh})}return scope.codeEditor.setCursor(cursorData[0],toCh)}catch(_error){return e=_error,Logger.error("Error setting cursor position: "+e+"\nTrace: "+e.stack+'")\nLogger.error("With cursorData: '+JSON.stringify(cursorData))}},foldLines=function(lines){return lines?_.each(lines,function(line){return scope.codeEditor.foldCode(line)}):void 0},editorData=scope.$page.editor,scope.$course.$getAllConfig().then(function(configData){var scrollIntoView;return attrs.editor&&(editorData=scope.$parent[attrs.editor]),editorData&&configData?(scope.fileName=editorData.file_name,scope.syntax=editorData.syntax,scope.isLocked=editorData.locked,scope.codeEditor=CodeMirror(element[0],{value:editorData.content,mode:CampusUtil.filterSyntax(scope.syntax),theme:editorData.theme||configData.default_editor_theme||"default",indentUnit:configData.default_editor_indent_unit,tabSize:2,lineNumbers:!0,autofocus:!0,autoCloseBrackets:!0,matchBrackets:!0,matchTags:!0,readOnly:editorData.locked,foldGutter:!0,electricChars:!1,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{"Cmd-Enter":submit,"Ctrl-Enter":submit,Tab:function(cm){var spaces;return spaces=Array(cm.getOption("indentUnit")+1).join(" "),cm.replaceSelection(spaces)}}}),markLines(editorData.marked_content),foldLines(editorData.fold_lines),setCursor(editorData.set_cursor),submitter.registerContent(function(){return{code:scope.codeEditor.doc.getValue(),fileName:scope.fileName,codeType:scope.syntax,clientStore:clientStore.getAll()}}),attrs.autoSubmit&&scope.codeEditor.on("change",_.debounce(function(){return submitter.submit()},editorData.auto_submit_delay||configData.default_editor_auto_submit_delay)),scope.elementIsVisible=function(){return element.is(":visible")},scope.$watch($parse(attrs.isActive),function(result){return result&&scope.codeEditor?$timeout(function(){return scope.codeEditor.refresh(),scope.codeEditor.focus()}):void 0}),scope.$on("page:editor:activate",function(){return scope.elementIsVisible()?$timeout(function(){return scope.codeEditor.refresh(),scope.codeEditor.focus()},500):void 0}),scrollIntoView=function(){return $timeout(function(){return scope.codeEditor.scrollIntoView(scope.codeEditor.doc.getCursor())})},CampusEvent.on("tabbedResource:initialOpen",scrollIntoView),scope.$on("$destroy",function(){return scope.codeEditor?(scope.codeEditor.off("change"),CampusEvent.off("tabbedResource:initialOpen",scrollIntoView)):void 0})):void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("codeEditorTabs",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'codeEditor\'>\n  <div class=\'bar bar--editor\'>\n    <ul class=\'tabList tabList--editor has-toggle--fullscreen\' ng-class="tabClass">\n      <li class=\'tabList-item\' ng-repeat="editor in editors">\n        <a href=\'\' class=\'tabList-link\' ng-class="{\'is-locked\': editor.locked, \'is-active\': activeEditor == editor}" ng-click="activateEditor(editor)" title="{{editor.file_name}}">{{editor.file_name}}</a>\n      </li>\n    </ul>\n  </div>\n  <div ng-repeat="editor in editors" ng-show="editorIsShown(editor)">\n    <code-editor editor="editor" is-active="activeEditor === editor" auto-submit="{{autoSubmit}}"></code-editor>\n  </div>\n<div>',link:function(scope,element,attrs){return scope.autoSubmit=attrs.autoSubmit,scope.editors=scope.$page.editors||[],scope.$page.editor&&scope.$page.editor.file_name&&scope.$page.editor.content&&scope.editors.push(scope.$page.editor),scope.tabClass="tabList--"+scope.editors.length,scope.activeEditor=scope.editors[0],scope.editorIsShown=function(editor){return scope.activeEditor.file_name===editor.file_name},scope.activateEditor=function(editor){return scope.activeEditor=editor}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("collapsePanel",["$parse",function($parse){return{replace:!0,restrict:"E",scope:!0,transclude:!0,template:"<div class='card card--a widget is-closed'>\n  <header class='widget-header widget-section' ng-dblclick=\"toggle($event)\">\n    <div class='widget-row'>\n      <a href='' class='toggle widget-control widget-control--east widget-toggle' ng-click='toggle($event)'>\n        <b class='srt'>Toggle</b>\n      </a>\n      <h3 class='widget-title'>\n        <a class='widget-title-link' href=''>{{title}}</a>\n      </h3>\n    </div>\n  </header>\n  <div class='widget-content widget-row' ng-transclude>\n\n  </div>\n</div>",link:function(scope,element,attrs){return scope.title=attrs.title,$parse(attrs.open)()&&element.removeClass("is-closed"),scope.toggle=function(evt){return evt&&evt.preventDefault(),element.toggleClass("is-closed"),!1}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("completeNonRequiredPage",function(){return{restrict:"M",link:function(scope,element,attrs){var options,page;return page=scope.$page,options=attrs.completeNonRequiredPage.split(":")[1],"view"===options?page.$complete():void 0}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("confettiEffect",function(){return{replace:!0,restrict:"M",scope:!0,template:'<svg class="dn" if-progress-for="course == 100">\n  <defs>\n    <symbol id="svg-confetti">\n      <path fill="currentColor" d="M-.017 6.91L4.035.012l2.587 1.52L2.57 8.43z"></path>\n    </symbol>\n  </defs>\n</svg>\n',link:function(scope){var $confettiItem,$confettiItems,colors,height,i,randomize,scale,width;for($confettiItems=$('<div class="confetti"></div>'),colors=["#21abc7","#59bc69","#f45950","#F79d2a","#616db3"],height=8.4,width=6.6,randomize=function(collection){var randomNumber;return randomNumber=Math.floor(Math.random()*collection.length),collection[randomNumber]},i=0;100>i;)scale=1.75*Math.random()+1,$confettiItem=$("<svg class='confetti-item' width='"+width*scale+"' height='"+height*scale+"' viewbox='0 0 "+width+" "+height+"'>\n  <use transform='rotate("+360*Math.random()+", "+width/2+", "+height/2+")' xlink:href='#svg-confetti' />\n</svg>"),$confettiItem.css({animation:Math.random()+2+"s "+2*Math.random()+"s confetti-fall ease-in both",color:randomize(colors),left:100*Math.random()+"vw"}),$confettiItems.append($confettiItem),i++;return $("body").append($confettiItems),scope.$on("$destroy",function(){return $confettiItems.remove()})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("console",["$compile","$state","$timeout","ClientPersistence","OpenModal","Submitter","FlashMessage",function($compile,$state,$timeout,ClientPersistence,OpenModal,Submitter,FlashMessage){var referencedConsoles;return referencedConsoles={},{replace:!0,restrict:"E",scope:!0,template:'<div class="console console--single">\n  <div class="console-ui"></div>\n</div>',link:function(scope,element,attrs){var addStartingInput,buildConsoleFailure,buildConsoleSuccess,clientStore,commandPlayback,consoleData,consoleOptions,course,displayHelpMenu,displayHint,mainEl,nextPage,page,parseCommand,resetChallenge,scrollVal,showSuccessFlash,submitter,_name;return course=scope.$course,page=scope.$page,submitter=Submitter.get(scope.$course,scope.$page),clientStore=new ClientPersistence(course.identifier),commandPlayback=[],scope.currectReport=null,scope.currentHint="",scope.focus="false"===attrs.consoleFocus||void 0===attrs.consoleFocus?!1:!0,scope.successMessage=page.correct_message,consoleData=page.console,scope.consoleName=consoleData.name,scope.nextAfterSuccess=page.console.next_after_success,page.$possiblePoints().bind(scope,"points"),page.$progress().bind(scope,"progress"),addStartingInput=function(input){var cursorPosition,initialInput,innerConsole;if(input)return cursorPosition=input.indexOf("%c%"),initialInput=input.replace("%c%",""),scope.console.setValue(initialInput),cursorPosition>0?(innerConsole=scope.console.innerConsole(),innerConsole.setCursor({line:innerConsole.lineCount()-1,ch:cursorPosition+scope.console.promptLength()})):void 0},buildConsoleFailure=function(executorReport){var newEl,wrapper,_ref;return"false"!==attrs.errors?(newEl=$("<div></div>"),newEl.html(executorReport.message()),wrapper=$('<div class="console-msg console-msg--error"></div>'),wrapper.append($compile(newEl)(scope)),scope.currentHint=null!=(_ref=executorReport.failedAttempt())?_ref.hint:void 0,scope.console.buildWidget(scope.console.innerConsole().lineCount()-2,{content:wrapper[0]})):void 0},showSuccessFlash=function(successMessage){var title;return 100!==scope.progress?(title=scope.points>0?""+successMessage+" <span class='flash-label'>+"+scope.points+".</span>":""+successMessage,FlashMessage.show({htmlClass:"flash--success",closeButton:!1,closeDelay:2200,message:null,title:title})):void 0},buildConsoleSuccess=function(){var successMessage,wrapper;return successMessage=scope.successMessage.length>1?scope.successMessage:"Success!",wrapper=$("<div class='console-msg console-msg--success'>"+successMessage+"</div>"),$compile(wrapper)(scope),showSuccessFlash(successMessage),scope.console.buildWidget(scope.console.innerConsole().lineCount()-2,{content:wrapper[0]})},displayHelpMenu=function(report){return report({content:$compile('<div class="console-msg console-msg--help">\n  <p class="console-msg-title">The following commands are available:</p>\n  <ul>\n    <li><code>help</code> - Displays the help menu</li>\n    <li><code>hint</code> - Displays a hint related to the error that you see</li>\n    <li><code>next</code> - Moves to the next challenge</li>\n    <li><code>reset</code> - Resets the challenge as if you refreshed the page</li>\n  </ul>\n</div>')(scope)[0]})},displayHint=function(report){var hint;return scope.currentHint?(hint=$compile("<div class='console-hint'>"+scope.currentHint+"</div>")(scope)[0],report({content:hint})):submitter.submit().then(function(executorReport){var failureWithHint;return failureWithHint=_.find(executorReport.failures,function(f){return f.hint}),failureWithHint?(hint=$compile("<div class='console-hint'>"+failureWithHint.hint+"</div>")(scope)[0],report({content:hint})):report({content:$("<p class='console-msg console-msg--error'>There is no hint available for you yet<p>")[0]})})},nextPage=function(){return OpenModal.close({clear:!0}),$state.go("root.courseContent",{courseIdentifier:course.identifier,queryString:page.$meta.next_query_string})},resetChallenge=function(report){return scope.sandboxReset=!0,report(!1),scope.console.reset(),commandPlayback=[],scope.startingContent&&(scope.console.setValue(scope.startingContent),scope.console.moveInputForward()),addStartingInput(scope.startingInput)},parseCommand=function(line,report){switch(!1){case!(line.match(/^help\s*/)&&consoleData.disable_command.indexOf("help")<0):displayHelpMenu(report);break;case!(line.match(/^hint\s*/)&&consoleData.disable_command.indexOf("hint")<0):displayHint(report);break;case!(line.match(/^next\s*/)&&consoleData.disable_command.indexOf("next")<0):nextPage(),report(!1);break;case!(line.match(/^reset\s*/)&&consoleData.disable_command.indexOf("next")<0):resetChallenge(report);break;default:return!1}return!0},consoleOptions={prompt:consoleData.prompt||"> ",historyLabel:""+course.identifier+"-"+consoleData.type,syntax:consoleData.type,welcomeMessage:$(consoleData.welcome_message)[0],autoFocus:scope.focus,initialValue:consoleData.starting_content,commandValidate:function(line){return line.length>0},commandHandle:function(line,report){return scope.currentReport=report,parseCommand(line,report)?void 0:(submitter.userSubmit({recycleSandbox:!scope.sandboxReset})["catch"](function(){return scope.currentReport({content:"Uh oh, looks like there was an issue with the server. Contact support if this error persists",className:"console-msg console-msg--error"})}),scope.sandboxReset=!1)}},consoleData.reference_id&&referencedConsoles[course.identifier]&&referencedConsoles[course.identifier][consoleData.reference_id]?(scope.console=referencedConsoles[course.identifier][consoleData.reference_id],element.find(".console-ui").replaceWith(scope.console.console.getWrapperElement()),scope.console.console.setOption("mode",{name:consoleData.type,useCPP:!0}),_.extend(scope.console.options,consoleOptions),scope.console.initCallbacks(scope.console.options)):(scope.console=new CSConsole($(element).find(".console-ui")[0],consoleOptions),consoleData.reference_id&&(referencedConsoles[_name=course.identifier]||(referencedConsoles[_name]={}),referencedConsoles[course.identifier][consoleData.reference_id]=scope.console)),scope.startingContent=consoleData.starting_content,consoleData.input&&(scope.startingInput=consoleData.input,addStartingInput(scope.startingInput)),mainEl=$("main"),scrollVal=mainEl.scrollTop(),scope.console.focus(),$timeout(function(){return mainEl.scrollTop(scrollVal)}),submitter.on("userSubmissionComplete",function(executorReport){return page.console.playback&&executorReport.report.playbackSafe&&(commandPlayback=executorReport.submission[0].code),executorReport.success()?(scope.currentReport({content:executorReport.details().output.result}),buildConsoleSuccess(executorReport),scope.currentReport=null,scope.nextAfterSuccess?$state.go("root.courseContent",{courseIdentifier:course.identifier,queryString:page.$meta.next_query_string}):void 0):(scope.currentReport({content:executorReport.details().output.result}),buildConsoleFailure(executorReport),$timeout(function(){return scope.console.innerConsole().refresh()}),scope.currentReport=null)}),submitter.registerContent(function(){var code;return code=page.console.playback?_.union(commandPlayback,[scope.console.getValue()]):scope.console.getValue(),{code:code,clientStore:clientStore.getAll()}}),scope.$on("$destroy",function(){return scope.console.options={},scope.console.initCallbacks({})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("contentAside",["CampusUrl",function(CampusUrl){return{replace:!0,restrict:"CE",scope:!0,transclude:!0,template:"<blockquote>\n  <div class='bucket bucket--flag'>\n    <div class='bucket-media'>\n      <img src='{{avatar}}' alt='{{title}}' class='content-aside-thumb thumb'/>\n      <p class='content-aside-author'>\n        <strong>{{title}}</strong>\n      </p>\n    </div>\n    <div class='bucket-content'>\n      <p ng-transclude></p>\n    </div>\n  </div>\n</blockquote>",link:function(scope,element,attrs){return scope.avatar=CampusUrl.imageUrl(attrs.avatar),scope.title=attrs.title,element.hasClass("content-aside")?void 0:element.addClass("card card--a content-aside")}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("correctmessage",["$compile","$timeout",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'correct-message\' ng-if="isShown" compile-html="{{correctMessage}}"></div>',link:function(scope){var updateIsShown;return updateIsShown=function(contentData){return contentData.query_string===scope.queryString?scope.isShown=100===contentData.progress:void 0},scope.currentContent.data().then(function(contentData){return updateIsShown(contentData),scope.correctMessage=contentData.attributes.correct_message}),scope.$on("page:update:content",function(evt,evtData){return updateIsShown(evtData.data)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseLevelList",function(){return{replace:!0,restrict:"E",scope:!0,template:"<dl class='list levelList'>\n  <div class='list-item levelList-item' ng-repeat='level in levels'>\n    <dt class='levelList-item-title'>\n      Level {{formatIndex($index)}}\n    </dt>\n    <dd class='levelList-item-body'>{{level.name}}</dd>\n  </div>\n</dl>",link:function(scope){return scope.$course.$levels().bind(scope,"levels"),scope.formatIndex=function(index){return scope.levels?(index+=1,10>index&&scope.levels.length>9?""+index+"":""+index):void 0}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMap",["$rootScope","$timeout","CourseMap",function($rootScope,$timeout,CourseMap){return{replace:!0,restrict:"E",scope:!0,template:"<div class='map'>\n  <ol class='map-list'>\n    <course-map-level ng-repeat='level in levels' class=\"{{isExpanded(level)}}\" data='level' url-params=\"{{appendToUrls}}\" level-index='{{$index}}'></course-map-level>\n  </ol>\n</div>",link:function(scope,element,attrs){var course,courseMap;return scope.scrollElementSelector=attrs.scrollElementSelector,scope.urlParams=attrs.urlParams,course=scope.$course,courseMap=new CourseMap(course),course.$levels().then(function(levels){return scope.levels=levels,courseMap.expand(scope.$level||levels[0])}),scope.$on("$destroy",function(){return courseMap.collapseAll()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMapLevel",["$rootScope","$timeout","CourseMap","CampusUrl",function($rootScope,$timeout,CourseMap,CampusUrl){return{replace:!0,restrict:"E",scope:!0,template:"<li class='card card--a map-level' ng-class=\"{'is-complete': isComplete(progress), 'is-disabled': disabled, 'is-expanded': levelPages.length > 0}\">\n  <div class='badge badge--offset map-badge' badge-progress=\"progress\" ng-click='expandContainer($event)' analytics-on analytics-event=\"Course Map Level Badge\">\n    <img width=110 height=110 ng-src='{{badgeUrl(achievement.badge)}}' alt='Placeholder Badge' class='badge-img' ng-error='usePlaceholder($event)' />\n  </div>\n\n  <header class='map-level-header map-level-cell' ng-click='expandContainer($event)'>\n    <h2 class='map-level-label' analytics-on analytics-event=\"Course Map Level Index\">Level {{index}}</h2>\n    <h3 class='map-level-title'>\n      <a href='' class='expand-on-click' analytics-on analytics-event=\"Course Map Level Name\">{{level.name}}</a>\n      <span class='map-level-title-label' analytics-on analytics-event=\"Course Map Level Progress\">{{totalComplete}}/{{totalPages}} Complete</span>\n    </h3>\n  </header>\n\n  <div class='map-level-section map-level-cell'>\n    <ol class='map-level-section-list'>\n      <course-map-page ng-repeat-start='page in levelPages' ng-if=\"isPage(page)\" page=\"page\"></course-map-page>\n      <course-map-section ng-repeat-end ng-if=\"isSection(page)\" section=\"page\"></course-map-section>\n    </ol>\n  </div>\n</li>",link:function(scope,element,attrs){var collapse,course,courseMap,expand,level,uid;return course=scope.$course,level=scope.level,uid=level.$meta.uid,courseMap=new CourseMap(scope.$course),scope.index=parseInt(attrs.levelIndex,10)+1,scope.levelPages=[],scope.totalComplete=0,scope.badgeUrl=function(path){return path?CampusUrl.badgeUrl(path):void 0},course.$achievementFor(level).bind(scope,"achievement"),level.$progress().bind(scope,"progress"),scope.usePlaceholder=function(evt){$(evt.currentTarget).attr("src",CampusUrl.appImageUrl("badge-default.png"))},scope.expandContainer=function(){courseMap.isExpanded(level)?courseMap.collapse(level):courseMap.expand(level)},scope.isComplete=function(progress){return 100===progress},scope.isSection=function(page){return CourseMap.isSection(page)},scope.isPage=function(page){return!CourseMap.isSection(page)},level.$completeChallengeCount().bind(scope,"totalComplete"),level.$totalChallengeCount().bind(scope,"totalPages"),expand=function(level){return level.$contents({display:!0}).then(function(contents){return scope.levelPages=contents})},collapse=function(){return scope.levelPages=[]},$rootScope.userHasAccess?scope.disabled=!1:level.$isEnabled().bind(scope,"enabled").then(function(enabled){return scope.disabled=!enabled}),courseMap.isExpanded(level)?expand(level):collapse(level),courseMap.on("expanded:"+uid,expand),courseMap.on("collapsed:"+uid,collapse),scope.$on("$destroy",function(){return courseMap.off("expanded:"+uid,expand),courseMap.off("collapsed:"+uid,collapse)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMapPage",["$rootScope","$state","$timeout","OpenModal",function($rootScope,$state,$timeout,OpenModal){return{replace:!0,restrict:"E",scope:!0,template:"<li class='map-level-item map-level-item--{{pageType()}}' ng-class='{\"is-complete\": isComplete(progress), \"is-active\": isCurrentPage(), \"is-current\": isCurrentPage()}'>\n  <a href='{{queryString}}' ng-click='gotoPage($event)' analytics-on analytics-event=\"Course Map Page\">{{page.name}}</a>\n</li>",link:function(scope,element,attrs){var page;return page=scope.$parent[attrs.page],scope.page=page,scope.progress=null,scope.queryString=page.$meta.query_string,page.$progress().bind(scope,"progress"),scope.pageType=function(){return page.type.replace(/_/,"-")},scope.isComplete=function(progress){return 100===progress},scope.isCurrentPage=function(){return $rootScope.queryString===scope.queryString},scope.gotoPage=function(evt){var additionalParams,button,urlParams;return button=evt.which||evt.button,0!==button&&1!==button||evt.ctrlKey||evt.metaKey||evt.shiftKey?void 0:(evt.preventDefault(),additionalParams=scope.urlParams||{},urlParams=_.extend({queryString:scope.queryString},additionalParams),$state.go("root.courseContent",urlParams).then(function(){return OpenModal.close()}))},scope.scrollElementSelector&&scope.isCurrentPage()?$timeout(function(){return $(scope.scrollElementSelector).scrollTop(element.offset().top-110)},400):void 0}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMapSection",["$state",function($state){return{replace:!0,restrict:"E",scope:!0,template:"<li ng-class=\"{'is-complete': isComplete()}\">\n  <h4 class='map-level-section-title'>\n    <a href='{{queryString}}' ng-click='gotoPage($event)' analytics-on analytics-event=\"Course Map Section\">{{section.name}}</a>\n  </h4>\n  <ol class='map-level-list'>\n    <course-map-page ng-repeat='page in pages' page='page' append-to-urls=\"{{appendToUrls}}\"></course-map-page>\n  </ol>\n</li>",link:function(scope,element,attrs){var section;return section=scope.$parent[attrs.section],scope.queryString=section.$meta.query_string,scope.section=section,scope.progress=0,section.$contents().then(function(pages){return scope.pages=pages}),scope.gotoPage=function(evt){var additionalParams,button,urlParams;return button=evt.which||evt.button,0!==button&&1!==button||evt.ctrlKey||evt.metaKey||evt.shiftKey?void 0:(evt.preventDefault(),additionalParams=scope.urlParams||{},urlParams=_.extend({queryString:scope.queryString},additionalParams),$state.go("root.courseContent",urlParams))},scope.isComplete=function(){return 100===scope.progress}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseMapButton",["$rootScope","$stateParams","Page","OpenModal",function($rootScope,$stateParams,Page,OpenModal){return{replace:!0,restrict:"E",scope:!0,template:"<a class='toggle toggle--menu' href='' ng-click='openMapModal()'>\n  <b class='srt'>Menu</b>\n</a>",link:function(scope){return scope.openMapModal=function(){return $rootScope.$emit("video:stop"),OpenModal.open({scope:scope,modalClass:"modal--page modal--map",template:"<course-map scroll-element-selector='.modal'></course-map>",fullScreen:!0,resolve:{$page:function($stateParams){return Page.fromQueryString(scope.$course.identifier,$stateParams.queryString)},$level:function($page){return $page.$level()}},controller:function($scope,$level){return $scope.$course=scope.$course,$scope.$level=$level}})}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseResources",["CurrentCourseConfig",function(){return{replace:!0,restrict:"E",template:'<div class="cell cell--xs mbxl" ng-if="resources">\n  <div class="card card--a">\n    <h2>Resources</h2>\n    <ul class="list">\n      <li class="list-item" ng-repeat="resource in resources">\n        <i class="icn icn--middle mrs tcs" ng-class="getClassForResource(resource)"></i>\n        <a href="{{resource.url}}" analytics-on analytics-event="Course Resource" analytics-properties="{url: \'{{resource.url}}\', name: \'{{resource.name}}\'}">{{resource.name}}</a>\n      </li>\n    </ul>\n  </div>\n</div>',link:function(scope){return scope.$course.$getConfig("resources").bind(scope,"resources"),scope.getClassForResource=function(resource){var url;if(url=resource.url)switch(!1){case!url.match(/\.pdf$/):return"icn--slides";case!url.match(/\.mp4\?/):return"icn--video--alt--b"}}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("courseSrc",["CampusUrl",function(CampusUrl){return{restrict:"A",scope:!1,link:function(scope,element,attrs){return $(element).on("error",function(evt){return evt.preventDefault()}),$(element).attr("src",CampusUrl.courseAssetUrl(attrs.courseSrc)),scope.$on("$destroy",function(){return element.off("error")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("editorOffButton",function(){return{restrict:"E",replace:!0,scope:!0,template:"<a href='' class='panel-close close' ng-click='closeEditor()'>x</div>",link:function(scope){return scope.closeEditor=function(){return scope.$emit("page:editor:deactivate",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString})}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("feedScrollElement",function(){return{replace:!1,restrict:"A",scope:!0,link:function(scope,element){return scope.$on("challengeFeed:scroll",function(evt,evtData){var scrollToElement,scrollToPosition;return evt.stopPropagation(),scrollToElement=$(evtData.scrollToElement),scrollToPosition=scrollToElement.offset().top-element.height()-element.offset().top+scrollToElement.height(),element.animate({scrollTop:scrollToPosition},"500","swing")})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("fillInBlank",["$compile","Submitter","FillInBlankParser",function($compile,Submitter,FillInBlankParser){return{replace:!0,restrict:"E",scope:!0,transclude:!0,controllerAs:"fillInBlankController",controller:["$scope",function($scope){var submitter;return this.fieldContent=[],this.whitelistedElements="code-highlight",this.replaceWhitelistedDirectives=function(contentEl){var wrapper;return wrapper=$("<div/>").append(contentEl),_.each(wrapper.find(this.whitelistedElements),function(el){var template;return template=$compile(el)($scope.$new())[0],wrapper.find(el).replaceWith(template)}),wrapper.children()},submitter=Submitter.get($scope.$course,$scope.$page),submitter.registerContent(function(_this){return function(){return _.map(_this.fieldContent,function(content){return content()})}}(this)),this.registerFieldContent=function(_this){return function(contentCallback){return _this.fieldContent.push(contentCallback),_this.inputsCount===_this.fieldContent.length?_this.autosubmit():void 0}}(this),this.autosubmit=function(){return $scope.recentAttempt&&this._submissionHadContent(JSON.parse($scope.recentAttempt.submission)[0])?this.submit():void 0},this.submit=function(){return submitter.submit()},this.generateContent=function(el){return this.inputsCount=FillInBlankParser.inputs(el).length,FillInBlankParser.parse($scope,this.replaceWhitelistedDirectives(el),$scope.prefillInput)},this._submissionHadContent=function(inputs){return _.any(inputs,function(input){return!_.isEmpty(input.content)})},$scope.prefillInput=function(){return function(input){var lastAttemptForInput,lastSubmission;return $scope.recentAttempt&&(lastSubmission=JSON.parse($scope.recentAttempt.submission)[0],lastAttemptForInput=_.find(lastSubmission,function(submission){return submission.name===input.name}),input.recentAttempt=$scope.recentAttempt,input.success=(null!=lastAttemptForInput?lastAttemptForInput.success:void 0)||!1,input.value=(null!=lastAttemptForInput?lastAttemptForInput.content:void 0)||""),input}}(this),this}],template:'<div class="fill-in-blank" ng-transclude></div>',link:function(scope,element,attrs,ctrl,transclude){var page,parsedPage;return page=scope.$page,parsedPage=$(page.fill_in_blank),page.$recentAttempt().then(function(recentAttempt){return scope.recentAttempt=recentAttempt,transclude(scope,function(){return element.append(ctrl.generateContent(parsedPage))})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("fillInBlankInput",["$compile","$timeout","$parse","Submitter",function($compile,$timeout,$parse,Submitter){return{replace:!0,restrict:"E",scope:!0,template:'<span class="codeEditor-input has-stateInput" ng-class="{\'is-correct\': isCorrect, \'is-incorrect\': isIncorrect}">\n  <span-input ng-class="{\'is-incorrect\': isIncorrect, \'is-correct\': isCorrect}" ng-model="input.value" ng-keydown="handleKeyDown($event)"></span-input>\n  <span class="stateInput-icn">\n    <a ng-show="errorMessage" class="stateInput-icn-link" href="" popover popover-message="errorMessage" popover-placement="bottom" data-container="body"><b class="srt">X</b></a>\n    <a ng-show=\'isCorrect\' class="stateInput-icn-link" href=""><b class="srt">Correct</b></a>\n  </span>\n</span>',link:function(scope){var fillInBlankController,input,submitter;return input=scope.input,submitter=Submitter.get(scope.$course,scope.$page),fillInBlankController=scope.fillInBlankController,scope.shownHint=!1,scope.isCorrect=input.success,scope.isIncorrect=!1,fillInBlankController.registerFieldContent(function(){return scope.popoverClose(),scope.shownHint=!1,{name:input.name,content:input.value||"",binding:input.binding}
}),scope.handleKeyDown=function(evt){return 13===evt.which||13===evt.keyCode?(submitter.userSubmit(),event.preventDefault()):void 0},submitter.on("complete",function(report){var hasFailure;return scope.errorMessage="",hasFailure=!1,_.each(report.failures(),function(failure,index){var hint,hintHasText,target,_ref;return target=report.target(index),!hasFailure&&target===input.name&&(hasFailure=!0,scope.errorMessage=report.message(index),hint=null!=(_ref=report.failedAttempt(index))?_ref.hint:void 0,hintHasText=/[^\s]/.test(hint))?scope.errorMessage+="<adaptive-hint class='popover-precompile-hide'>"+hint+"</adaptive-hint>":void 0}),scope.isCorrect=!hasFailure,scope.isIncorrect=!scope.isCorrect})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("getTaskAnswerButton",["$parse","CampusEvent",function($parse,CampusEvent){return{restrict:"E",replace:!1,require:"ngModel",template:function(element,attrs){var useOverlayTemplate;return useOverlayTemplate=$parse(attrs.overlay)(),useOverlayTemplate?"<a class='widget-overlay-link' href='' ng-click='getTaskAnswer(task.name)' ng-if=\"((!taskAnswer && task.answer_available) || answerBy === 'event') && task.answer_available\" ng-class=\"{'is-submitting': answerIsSubmitting}\" analytics-on analytics-event=\"Get Task Answer (Overlay)\" analytics-properties=\"{task:'{{task.name}}'}\">\n  <i class='icn icn--hint--alt--a widget-overlay-icon mrxs'></i>\n  <span class='widget-overlay-link-text'>{{answerButtonLabel}}</span>\n</a>":"<a class='btn btn--hint btn--thin btn--offset btn--offset--thin btnList-btn' href='' ng-click='getTaskAnswer(task.name)' ng-if=\"!taskAnswer && task.answer_available\" ng-class=\"{'is-submitting': answerIsSubmitting}\"  analytics-on analytics-event=\"Get Task Answer\" analytics-properties=\"{task:'{{task.name}}'}\">\n  <span class='loader-el'></span>\n  <span class='loader-text'>{{answerButtonLabel}}</span>\n</a>"},link:function(scope,element,attrs,ngModelCtrl){var course,page,task,updateModel;return course=scope.$course,page=scope.$page,task=scope.task,scope.answerBy=attrs.answerBy,updateModel=function(taskAnswer){return ngModelCtrl.$setViewValue(null!=taskAnswer?taskAnswer.answer:void 0)},page.$usedTaskAnswer(task.name).then(function(taskAnswer){return updateModel(taskAnswer),scope.taskAnswer=null!=taskAnswer?taskAnswer.answer:void 0}),scope.getTaskAnswer=function(taskName){return scope.answerIsSubmitting=!0,page.$taskAnswer(taskName).then(function(taskAnswer){return scope.taskAnswer=null!=taskAnswer?taskAnswer.answer:void 0,"event"===attrs.answerBy&&CampusEvent.emit("task:answer",{task:task,answer:taskAnswer}),updateModel(taskAnswer)})["finally"](function(){return scope.answerIsSubmitting=!1})},attrs.label?scope.answerButtonLabel=attrs.label:course.$getConfig("points_per_task_answer").then(function(pointsPerTaskAnswer){return scope.answerButtonLabel=pointsPerTaskAnswer>0?"Solution (-"+pointsPerTaskAnswer+" pts)":"Solution"})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("hintButton",["$timeout","Course",function($timeout,Course){return{restrict:"E",replace:!0,scope:!0,template:"<a class='course-hint-button is-{{hintsRemaining}}-left' ng-class='{\"is-disabled\": buttonDisabled, \"is-submitting\": buttonDisabled, \"is-empty\": isEmpty()}' href='' ng-click='getNextHint()' analytics-on analytics-event=\"{{eventText}}\">\n  <i class='btn-icn icn icn--hint--alt--a widget-overlay-icon mrxs'></i>\n  <span class='loader-el'></span>\n  <span class='loader-text'>{{buttonText}}</span>\n</a>",link:function(scope){var course,page;return course=scope.$course,page=scope.$page,course.$getAllConfig().then(function(configData){var hintPointSubtractMode,hintPointValue;return hintPointSubtractMode=configData.subtract_points_on,hintPointValue=configData.hint_point_value,page.$usedHints().bind(scope,"usedHints").then(function(usedHints){var answerRemaining,hintsRemaining,pluralizedHintText,usedAllHints;return hintsRemaining=page.hints.count-usedHints.length,usedAllHints=0===hintsRemaining,answerRemaining=1===hintsRemaining,pluralizedHintText=1===Math.abs(hintsRemaining-1)?"Hint":"Hints",scope.hintsRemaining=hintsRemaining,scope.eventText=answerRemaining?"Answer":"Hint",scope.buttonText=usedAllHints?"":answerRemaining?"Buy Answer (-"+hintPointValue+" pts)":hintPointSubtractMode===Course.subtractOnEachHint?""+hintsRemaining+" "+pluralizedHintText+" Remaining (-"+hintPointValue+" pts)":""+(hintsRemaining-1)+" "+pluralizedHintText+" Remaining"})}),scope.isEmpty=function(){return 0===scope.hintsRemaining},scope.getNextHint=function(){return scope.usedHints.length!==page.hints.count?(scope.buttonDisabled=!0,page.$nextHint().bind(scope,"currentHint")["finally"](function(){return scope.buttonDisabled=!1})):void 0}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("html5VideoPlayer",["CampusUrl","$cookies","$rootScope","$timeout","SublimeLoader","ProjectorVideo",function(CampusUrl,$cookies,$rootScope,$timeout,SublimeLoader,ProjectorVideo){return{restrict:"E",replace:!0,scope:!0,template:"<div>\n  <div class='card card--a video-frame'>\n    <video data-autoresize='fit' title=\"{{name}}\" data-autoplay='{{autoplay}}' data-fullmode-priority='screen' controls autoplay></video>\n  </div>\n  <div class='btnList video-controls' ng-if='extraControlsEnabled()'>\n    <div class='btnList-btn video-speed'>\n      <dropdown class='video-download-dropdown' repeat='quality in [\"SD\", \"HD\"]' label='Quality' on-select='changeQuality($value)' model='currentQuality'>\n        <a href='' class='dropdown-link'>{{quality}}</a>\n      </dropdown>\n    </div>\n\n    <div class='btnList-btn video-speed' ng-if=\"usingVideoTag\">\n      <dropdown class='video-speed-dropdown' repeat='speed in speeds' label='Playback Speed' model='currentSpeed' on-select='updateSpeed($value)'>\n        <a href='' class='dropdown-link'>{{speed}}x</a>\n      </dropdown>\n    </div>\n    <div class='btnList-btn video-download'>\n      <dropdown class='video-download-dropdown' repeat='file in downloads' label='Download'>\n        <a href='{{file.url}}' target='_blank' class='dropdown-link'>{{file.label}}</a>\n      </dropdown>\n    </div>\n  </div>\n</div>",link:function(scope,element,attrs){var addVideoFiles,getDownloads,getEmbedElement,getVideoElement,initializeScopeVideoData,parseDownloadSizes,playHandler,preparedVideoElement,projectorVideo,resizePollInterval,sourceTagsSortedBy,timeUpdateHandler,videoData,videoEl;return scope.playerUrl=attrs.playerUrl,scope.downloadFileType=attrs.downloadFileType,scope.downloadSizes=attrs.downloadSizes,scope.autoplay=attrs.autoplay,scope.extraControls=attrs.extraControls,scope.startAtTime=attrs.startAtTime,projectorVideo=new ProjectorVideo(scope.$course.identifier),preparedVideoElement=null,resizePollInterval=null,videoEl=$(element).find(".video-frame"),getVideoElement=function(){return element.find("video")[0]},getEmbedElement=function(){return element.find("embed")[0]},parseDownloadSizes=function(){var downloadSizes;return downloadSizes=_.map(scope.downloadSizes.split(","),function(sizeStr){var labelArr;return labelArr=sizeStr.split(":"),{profile:labelArr[1],label:labelArr[0].replace(/^\s*/,"")}})},getDownloads=function(videoData){var allFiles,downloadFileTypes,downloadSizes,downloads;return allFiles=videoData.files,downloadFileTypes=_.filter(allFiles,function(file){return file.type.match(new RegExp(scope.downloadFileType))}),downloadSizes=parseDownloadSizes(),downloads=_.filter(downloadFileTypes,function(file){var foundItems;return foundItems=0,_.each(downloadSizes,function(size){return file.id===size.profile?(file.label=size.label,foundItems+=1):void 0}),foundItems>0})},sourceTagsSortedBy=function(videoData,quality){var sourceTags,videoFiles;return videoFiles=videoData.files,sourceTags=_.map(videoFiles,function(file){return"<source src='"+file.url+"' data-quality='"+file.quality+"'/>"}),"HD"===quality||"hd"===quality?sourceTags.sort(function(a){return a.match(/data-quality=['"]hd['"]/)?-1:1}):sourceTags.sort(function(a){return a.match(/data-quality=['"]hd['"]/)?1:-1}),sourceTags},addVideoFiles=function(videoData){var sourceTags,trackTags,video_element;return scope.currentQuality=localStorage["sublimeVideoPlayer:currentVideoQuality"],sourceTags=sourceTagsSortedBy(videoData,localStorage["sublimeVideoPlayer:currentVideoQuality"]),trackTags=_.map(videoData.subtitles,function(subtitle){var label;return label=subtitle.label?" label='"+subtitle.label+"' ":void 0,"<track src='"+CampusUrl.subtitleUrl(subtitle.path)+"' srclang='"+subtitle.lang+"' "+label+"/>"}),video_element=element.find("video"),video_element.append(sourceTags.join("\n")),video_element.append(trackTags.join("\n")),video_element=null},playHandler=function(){return scope.player.removeEventListener("playing",playHandler),scope.seekTo(scope.startAtTime)},timeUpdateHandler=function(){var videoElement,_ref;return videoElement=getVideoElement(),$(videoElement).is(":visible")||(null!=(_ref=$(getEmbedElement()))?_ref.is(":visible"):void 0)?videoElement=null:(scope.player.pause(),videoElement=null)},scope.speeds=[.5,1,1.5,2,3],scope.name=scope.$page.name,scope.changeQuality=function(quality){var currentTime,paused,playbackRate,qualityFound;currentTime=scope.player.currentTime,playbackRate=scope.player.playbackRate,paused=scope.player.paused,scope.currentQuality=quality,localStorage["sublimeVideoPlayer:currentVideoQuality"]=quality,qualityFound=!1,_.each(videoData.files,function(file){return file.quality&&file.quality.match(new RegExp(quality,"i"))&&scope.player.canPlayType(file.type).length>0&&!qualityFound&&(qualityFound=!0,scope.player.src=file.url,scope.player.currentTime=currentTime,scope.player.playbackRate=playbackRate,paused)?scope.player.pause():void 0})},scope.extraControlsEnabled=function(){return"hide"!==scope.extraControls},scope.currentSpeed=scope.extraControlsEnabled()?parseFloat($cookies.videoPlaybackSpeed)||1:1,scope.updateSpeed=function(speed){return $cookies.videoPlaybackSpeed=speed.toString(),getVideoElement().playbackRate=speed},scope.seekTo=function(time){var hours,minutes,seconds,timeArr;return time.constructor===String&&(timeArr=time.split(":"),hours=parseInt(3===timeArr.length?timeArr[0]:0,10),minutes=parseInt(3===timeArr.length?timeArr[1]:timeArr[0],10),seconds=parseInt(3===timeArr.length?timeArr[2]:timeArr[1],10),minutes+=60*hours,seconds+=60*minutes,time=seconds),scope.player.currentTime=time},scope.loadVideo=function(videoData){var videoElement;return"hide"!==scope.extraControls&&(scope.downloads=getDownloads(videoData)),addVideoFiles(videoData),scope.initializeVideoResize(),videoElement=element.find("video"),scope.usingVideoTag="none"!==videoElement.css("display")&&"hidden"!==videoElement.css("visibility"),$timeout(function(){return scope.updateSpeed(scope.currentSpeed)},200),scope.startAtTime&&scope.player.addEventListener("playing",playHandler),scope.player.addEventListener("timeupdate",timeUpdateHandler)},scope.initializeVideoResize=function(){var setWidth;if(!resizePollInterval)return setWidth=0,resizePollInterval=setInterval(function(){var newHeight,videoHeight,videoWidth,width;if(scope.player)return width=videoEl.width(),width!==setWidth?(videoHeight=scope.player.videoHeight||720,videoWidth=scope.player.videoWidth||1280,newHeight=videoHeight/videoWidth*width,scope.player.width=width,scope.player.height=newHeight,setWidth=width):void 0},100)},initializeScopeVideoData=function(videoData){var poster;return poster=videoData.files[0].thumb_nail,scope.player=$(element).find(".video-frame video")[0],$(scope.player).attr("poster",poster),scope.startAtTime=videoData.start_at_time,scope.loadVideo(videoData)},videoData=scope.$page.video,scope.videoData&&(videoData=scope.videoData),videoData.id&&projectorVideo.get(videoData.id).then(function(videoObj){return videoData.files=videoObj.data[videoData.id],initializeScopeVideoData(videoData)}),$rootScope.$on("video:stop",function(){return scope.player?scope.player.pause():void 0}),scope.$on("$destroy",function(){return window.clearInterval(resizePollInterval),resizePollInterval=null,scope.player.removeEventListener("playing",playHandler),scope.player.removeEventListener("timeupdate",timeUpdateHandler)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("htmlPreview",["$timeout","CampusEvent","CampusUrl","Submitter",function($timeout,CampusEvent,CampusUrl,Submitter){return{replace:!0,restrict:"E",scope:{$course:"=",$page:"=",html:"=",useIframe:"=sandbox",resource:"=",resourceIndex:"@",resources:"=",tabbedResource:"@"},template:'<div class=\'resource resource--preview\'>\n  <p class=\'resource-msg\' ng-if=\'!hasContent\'>Preview will automatically update.</p>\n  <iframe class="html-preview-sandbox" ng-if="useIframe">\n    <!DOCTYPE html>\n  </iframe>\n\n  <div class="html-preview-standard" compile-html="{{previewHtml}}" ng-if="!useIframe"></div>\n<div>',link:function(scope,element){var customElements,replaceCustomElements,submitter,updateHtmlPreview,updateIfActive,updateIframePreview;return scope.hasContent=!1,scope.baseUrl=CampusUrl.baseCourseAssetUrl("demo/"),submitter=Submitter.get(scope.$course,scope.$page),customElements=_.map(scope.html.match(/(%[a-zA-z0-9:\s\.\-_\/|]*%)/g),function(source){var parsedElements;return parsedElements=source.match(/^%([a-zA-Z_-]*): ([a-zA-z0-9:\s\.\-_\/]*)(\s*\|\s*([a-zA-Z]*))?/),{element:source,fileName:parsedElements[2].replace(/\s*$/,""),filter:parsedElements[3],type:parsedElements[1]}}),updateIfActive=function(){return scope.isActive()?(scope.hasContent=!0,scope.useIframe?updateIframePreview():updateHtmlPreview()):void 0},updateHtmlPreview=function(){return scope.previewHtml=replaceCustomElements(scope.html)},updateIframePreview=function(){var baseUrl,e,existingIframe,iframeEl,iframeHtml,scrollPos,submitData;submitData=submitter.content(),existingIframe=element.find("iframe");try{scrollPos=$(existingIframe[0].contentDocument).find("body").scrollTop()}catch(_error){e=_error,scrollPos=0}return existingIframe.remove(),iframeEl=$("<iframe></iframe>")[0],element.append(iframeEl),iframeEl.sandbox="allow-scripts",iframeHtml=replaceCustomElements(scope.html),baseUrl=scope.baseUrl,$timeout(function(){var existingBaseUrl,iframeDoc,iframeWindow;return iframeWindow=iframeEl.contentWindow,iframeWindow.$editors=submitData,iframeWindow._=_,iframeDoc=iframeEl.contentDocument,iframeDoc.innerHTML="",iframeDoc.open(),existingBaseUrl=iframeHtml.match(/<base\s+href=['|"](\D+)['|"]\s*\\?>/),existingBaseUrl?(baseUrl=""+scope.baseUrl+existingBaseUrl[1].replace(/^\//,""),iframeHtml.replace(existingBaseUrl[1],baseUrl)):iframeHtml="<base href='"+baseUrl+"'/>"+iframeHtml,iframeDoc.write(iframeHtml),iframeDoc.close(),$(iframeDoc).find("body").scrollTop(scrollPos)})},replaceCustomElements=function(html){var linkOverrideElements,sourceElements,submitData;return submitData=submitter.content(),sourceElements=[],linkOverrideElements=[],_.each(customElements,function(customElement){return"source"===customElement.type?sourceElements.push(customElement):"link_override"===customElement.type?linkOverrideElements.push(customElement):void 0}),_.each(sourceElements,function(sourceElement){var data,dataContent;return data=_.where(submitData,{fileName:sourceElement.fileName})[0],dataContent=sourceElement.filter?scope[sourceElement.filter](data.code):data&&data.code||"",html=html.replace(new RegExp(sourceElement.element),dataContent)}),_.each(linkOverrideElements,function(linkOverrideElement){var data,matchingLinkEl,tempEl;return tempEl=$("<div></div>"),matchingLinkEl=tempEl.html(html).find("link[href='"+linkOverrideElement.fileName+"']"),matchingLinkEl.length>0&&(data=_.where(submitData,{fileName:linkOverrideElement.fileName})[0],matchingLinkEl.replaceWith("<style>"+(data&&data.code||"")+"</style>"),html=tempEl.html()),html=html.replace(new RegExp(linkOverrideElement.element),"")}),html},scope.stripNewlines=function(str){return str.split("\n").join()},scope.isActive=function(){return element.is(":visible")},submitter.on("complete",updateIfActive),scope.$watch("isActive()",updateIfActive)}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("htmlSelect",["Submitter","CampusEvent",function(Submitter,CampusEvent){return{replace:!0,restrict:"E",scope:!0,controller:["$scope",function($scope){return $scope.selectedItems=[],$scope.registeredItems={},this.selectItem=function(){return function(item){return $scope.selectedItems.push(item),$scope.submit()}}(this),this.deselectItem=function(){return function(item){return $scope.selectedItems.splice($scope.selectedItems.indexOf(item),1),$scope.submit()}}(this),this.registerItem=function(){return function(name,callbacks){return $scope.registeredItems[name]=callbacks}}(this),this.wrapper=function(){return $scope.wrapperEl},this}],template:'<div class="html-select form">\n  <div compile-html="{{$page.html_select.html}}"></div>\n</div>',link:function(scope,element){var clearSelections,currentTask,submitter,tasks;return submitter=Submitter.get(scope.$course,scope.$page),tasks=scope.$page.tasks.tasks,currentTask=0,scope.wrapperEl=element,clearSelections=function(){return scope.selectedItems=[],_.each(scope.registeredItems,function(item){return item.clear()})},scope.submit=function(){return submitter.userSubmit()},submitter.on("userSubmissionComplete",function(report){var count,failureNum,targets;for(report.success()&&(currentTask===tasks.length-1?CampusEvent.emit("task:index:change",-1):(currentTask+=1,clearSelections(),CampusEvent.emit("task:index:change",currentTask))),failureNum=report.failures().length,count=0,targets=[];failureNum>count;)targets.push(report.target(count)),count+=1;return _.each(scope.selectedItems,function(item){return targets.indexOf(item)>=0?scope.registeredItems[item].failure(report.failedAttemptForTarget(item)):scope.registeredItems[item].success()})}),submitter.registerContent(function(){return[{choices:JSON.stringify(scope.selectedItems),task:currentTask+1}]}),scope.$on("$destroy",function(){return submitter.destroy()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("htmlSelectBoundingBox",["$timeout",function($timeout){return{replace:!0,restrict:"E",scope:{boundEl:"=",wrapper:"=",boundingBox:"="},template:'<div class="html-select-bounding-box-placeholder"></div>',link:function(scope,element){var height,leftValue,topValue,width,wrap;if(wrap=scope.wrapper[0],topValue=scope.boundEl.getBoundingClientRect().top-wrap.getBoundingClientRect().top,leftValue=scope.boundEl.getBoundingClientRect().left-wrap.getBoundingClientRect().left,width=scope.boundEl.getBoundingClientRect().width,height=scope.boundEl.getBoundingClientRect().height,scope.boundingBox)return scope.boundingBox.setAttributeNS(null,"class","html-select-bounding-box"),scope.boundingBox.setAttributeNS(null,"x",leftValue),scope.boundingBox.setAttributeNS(null,"y",topValue),scope.boundingBox.setAttributeNS(null,"height",height),scope.boundingBox.setAttributeNS(null,"width",width),scope.boundingBox.setAttributeNS(null,"fill","none"),$timeout(function(){return element.after(scope.boundingBox),element.remove()});throw new Error("a bounding-box attribute must be used when using the htmlSelectBoundingBox directive")}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("htmlSelectError",function(){return{replace:!0,restrict:"E",scope:{errorBindEl:"=",errorMessage:"=",wrapper:"="},template:'<span class="html-select-error">\n  <a ng-show="errorMessage" class="error-message html-select-error-link"  href="" popover popover-message="errorMessage" popover-placement="bottom" data-container="body"></a>\n</span>',link:function(scope,element){var rightValue,topValue,wrap;return wrap=scope.wrapper[0],topValue=scope.errorBindEl.getBoundingClientRect().top-wrap.getBoundingClientRect().top,rightValue=wrap.getBoundingClientRect().right-scope.errorBindEl.getBoundingClientRect().right,element.css({top:topValue,right:rightValue})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("htmlSelectItem",["CampusEvent","$compile",function(CampusEvent,$compile){return{replace:!0,restrict:"AC",scope:!0,require:"^htmlSelect",link:function(scope,element,attrs,htmlSelectCtrl){var $highlightEl,addBoundingBox,addClass,answerClass,clearSelection,errorDisplayButton,errorMessageClass,failureClass,handleAnswer,hasClass,itemName,labelMatch,removeClass,selectedClass,successClass,toggleSelect;return scope.errorMessage=null,selectedClass="selected",answerClass="is-answer",successClass="is-success",failureClass="is-failure",errorMessageClass="error-message",scope.errorBindEl=element[0],scope.wrapper=htmlSelectCtrl.wrapper(),attrs.htmlSelectItem?itemName=attrs.htmlSelectItem:(labelMatch=/hs--(.*)/.exec(attrs["class"]),itemName=labelMatch&&labelMatch[1]),addClass=function(el,klass){var $el,classes,newClasses;return $el=$(el),classes=$el.attr("class").split(" "),classes.indexOf(klass)<0?(classes.push(klass),newClasses=classes.join(" "),$el.attr("class",newClasses)):void 0},removeClass=function(el,klass){var $el,classIndex,classString,classes;return $el=$(el),classString=$el.attr("class"),classes=classString?classString.split(" "):[],classIndex=classes.indexOf(klass),classIndex>=0?(classes.splice(classes.indexOf(klass),1),$el.attr("class",classes.join(" "))):void 0},hasClass=function(el,klass){var classString;return classString=$(el).attr("class"),!!new RegExp("(^| )"+klass+"($| )").exec(classString)},clearSelection=function(){return removeClass($highlightEl[0],selectedClass),removeClass($highlightEl[0],answerClass),removeClass($highlightEl[0],successClass),removeClass($highlightEl[0],failureClass),scope.errorMessage=null},toggleSelect=function(evt){var $el;return evt.preventDefault(),evt.stopPropagation(),$el=$highlightEl,hasClass($(evt.target),errorMessageClass)?!1:hasClass($el,selectedClass)?(clearSelection(),htmlSelectCtrl.deselectItem(itemName)):(addClass($highlightEl[0],selectedClass),htmlSelectCtrl.selectItem(itemName))},handleAnswer=function(data){var answerArr;return data&&data.answer&&data.answer.rawAnswer&&(answerArr=JSON.parse(data.answer.rawAnswer),answerArr.indexOf(itemName)>-1)?addClass($highlightEl[0],answerClass):void 0},addBoundingBox=function(){var boundingBoxPlaceholder;return scope.boundingBox=document.createElementNS(element[0].namespaceURI,"rect"),boundingBoxPlaceholder=$compile('<html-select-bounding-box bound-el="errorBindEl" wrapper="wrapper" bounding-box="boundingBox"></html-select-bounding-box>')(scope),element.after(boundingBoxPlaceholder),scope.boundingBox},element[0]instanceof SVGElement?($highlightEl=$(addBoundingBox()),removeClass(element[0],"html-select-item"),addClass(element[0],"html-select--enablePointer")):$highlightEl=element,addClass($highlightEl[0],"html-select-item"),element.on("click",toggleSelect),errorDisplayButton=$compile('<html-select-error error-bind-el="errorBindEl" error-message="errorMessage" wrapper="wrapper"></html-select-error>')(scope),scope.wrapper.append(errorDisplayButton),htmlSelectCtrl.registerItem(itemName,{success:function(){return addClass($highlightEl[0],successClass)},failure:function(failure){return addClass($highlightEl[0],failureClass),scope.errorMessage=failure.message},clear:clearSelection}),CampusEvent.on("task:answer",handleAnswer),scope.$on("$destroy",function(){return element.off("click",toggleSelect),CampusEvent.off("task:answer",handleAnswer),$(errorDisplayButton).remove()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("ifProgressFor",["$parse",function($parse){return{replace:!1,restrict:"A",scope:!0,transclude:"element",link:function(scope,element,attrs,ctrl,transclude){var clonedEl,varName,varNameMatch;if(clonedEl=null,varNameMatch=attrs.ifProgressFor.match(/\s?([^\s=!<>]*)\s?/),varName=varNameMatch&&varNameMatch[1],"level"!==varName&&"section"!==varName&&"page"!==varName&&"course"!==varName)throw new Error("Argument for ifProgressFor directive must be 'level', 'section', 'course' or 'page' -- not '"+varName+"'");return scope["$"+varName].$progress().bind(scope,"progress").then(function(progress){return transclude(function(clone){var locals;return clonedEl&&clonedEl.remove(),clonedEl=null,locals={},locals[varName]=progress,$parse(attrs.ifProgressFor)(locals)?(clonedEl=clone,element.after(clone)):void 0})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("instructions",function(){return{restrict:"E",replace:!0,scope:!0,template:"<div class='objective-body' compile-html='{{$page.instructions}}'></div>"}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("keyShortcut",["$parse","KeyboardShortcuts",function($parse,KeyboardShortcuts){return scope.unbind=function(){return unbind()},scope.$on("$destroy",function(){var func,parentEl,shortCutObj;return unbind(),parentEl=null,func=null,shortCutObj=null})}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("levelBadge",["CampusUrl","$q",function(CampusUrl){return{restrict:"E",replace:!0,scope:!0,template:"<div class='badge'>\n  <img class='badge-img' ng-src='{{badgeUrl}}' width='110' height='110' />\n<div/>",link:function(scope){var badgeUrlFromAchievement;return badgeUrlFromAchievement=function(achievement){return scope.badgeUrl=CampusUrl.badgeUrl(null!=achievement?achievement.badge:void 0)},scope.$page.$level().then(function(level){return level?scope.$course.$achievementFor(level).then(badgeUrlFromAchievement):scope.$course.$achievement(level).then(badgeUrlFromAchievement)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("levelNumber",function(){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{levelNumber}}</span>",link:function(scope){return scope.$level.$indexInCourse().bind(scope,"levelNumber")}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("linkedinShare",["CampusUrl",function(){return{replace:!0,restrict:"E",scope:!0,template:'<div class="tac tsm">\n  <a href="" ng-click=\'openPopup()\' analytics-on analytics-event="Share LinkedIn">\n    Add to my LinkedIn Profile\n  </a>\n</li>',link:function(scope){return scope.openPopup=function(){scope.$course.$getConfig("share_url").then(function(shareUrl){var course_name,course_url,linkedin_token,options,url;return linkedin_token="0_1sDrviUAcAnrHMBMt0hpzcQvby45phqQAi-F2chZOFxk_z4513SxVdFJSGQrOYKCaSgvthvZk7wTBMS3S-m0L6A6mLjErM6PJiwMkk6nYZylU7__75hCVwJdOTZCAkdv",course_name=scope.$course.name,course_url=shareUrl,url="http://www.linkedin.com/profile/add?_ed="+linkedin_token+"&pfCertificationName="+course_name+"&pfCertificationUrl="+course_url,options="width="+scope.popupWidth+", height="+scope.popupHeight+", top="+scope.popupTop+", left="+scope.popupLeft,window.open(url,"Linkedin",options)})}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("markdown",["$sce","CampusUrl",function(){return{restrict:"E",replace:!0,scope:{$course:"=",$page:"=",content:"=",resource:"=",resourceIndex:"@",resources:"=",tabbedResource:"@"},template:"<div class='resource resource--markdown' ng-click=\"$event.stopPropagation()\">\n  <div compile-html>\n  </div>\n</div>",link:function(scope,element){return element.find("div").empty().append(scope.content)}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("mdFileList",function(){return{replace:!0,restrict:"C",scope:!0,transclude:!0,template:'<div class="card card--b card--s directoryList" ng-click="toggleExpansion($event)" ng-mousedown="cancelSelection($event)">\n  <ul ng-transclude></ul>\n</div>',link:function(scope,element){var dirParentHTMLClass,dirParentLinkHTMLClass,directoryListItems,isDirectoryElement;return dirParentHTMLClass="directoryList-parent",dirParentLinkHTMLClass="directoryList-parent-link",directoryListItems=$(element).find("ul li:has(ul)"),directoryListItems.addClass(dirParentHTMLClass),directoryListItems.each(function(){var liElement,linkEl;return liElement=$(this),linkEl=$("<a href='' class='"+dirParentLinkHTMLClass+"'></a>"),liElement.contents().filter(function(){return 3===this.nodeType}).wrap(linkEl).before("<a href='' class='icon'></a>").end()}),$(element).find(">ul>li:has(ul)").addClass("is-expanded"),isDirectoryElement=function(target){return target.hasClass(dirParentLinkHTMLClass)||target.find(">."+dirParentLinkHTMLClass)[0]},scope.toggleExpansion=function(evt){var target;evt.preventDefault(),target=$(evt.target),isDirectoryElement(target)&&target.closest("."+dirParentHTMLClass).toggleClass("is-expanded")},scope.cancelSelection=function(evt){isDirectoryElement($(evt.target))&&evt.preventDefault()}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("multipleChoice",["$compile","Submitter",function($compile,Submitter){return{replace:!0,restrict:"E",scope:!0,template:'<div class="multiple-choice">\n  <ul class="list selectList">\n    <li class="list-item selectList-item" ng-repeat="choice in choices" ng-class="selectedClassFor(choice)">\n      <a class="card card--b card--listItem selectList-item-link" href=\'\' ng-click="selectChoice($event, choice)" compile-html="{{choice.content | markdown}}"></a>\n    </li>\n  </ul>\n  <submit-button hide-next-challenge-button="true">Submit Answer</submit-button>\n</div>',link:function(scope,element){var clearErrors,page,submitter;return page=scope.$page,submitter=Submitter.get(scope.$course,scope.$page),clearErrors=function(){return $(element).find(".selectList-item-error, .selectList-error").remove()},scope.choices=page.multiple_choice,page.$recentAttempt().then(function(recentAttempt){return recentAttempt.success?(scope.isCorrect=!0,scope.selectedChoice=JSON.parse(recentAttempt.submission)[0]):void 0}),scope.selectedClassFor=function(choice){return scope.selectedChoice===choice.name?scope.isCorrect?"is-correct":scope.isCorrect===!1?"is-incorrect":"is-selected":""},scope.selectChoice=function(evt,choice){return scope.isSubmitting?void 0:(scope.isCorrect=null,clearErrors(),scope.selectedElement=evt.currentTarget,scope.selectedChoice=choice.name)},submitter.on("start",function(){return clearErrors(),scope.selectedChoice||element.find("ul").before("<div class='card card--a card--error selectList-error'><p>You need to select an element!</p></div>"),scope.isSubmitting=!0}),submitter.on("finally",function(){return scope.isSubmitting=!1}),submitter.on("complete",function(report){var errorElement;return report.success()?(clearErrors(),scope.isCorrect=!0,$(element).find(".error-message").remove()):(scope.isCorrect=!1,scope.selectedElement?(errorElement=$compile("<div class='selectList-item-error'>"+report.message()+"</div>")(scope),$(scope.selectedElement).append(errorElement)):void 0)}),submitter.registerContent(function(){return scope.selectedChoice})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("multipleSelect",["Submitter","$compile",function(Submitter,$compile){return{replace:!0,restrict:"E",scope:!0,template:'<div class="multiple-select">\n  <ul class=\'list selectList selectList--multiple\' ng-if="type === \'list\'">\n    <li class="list-item selectList-item" ng-class="selectedClassFor(choice)" ng-repeat="choice in choices">\n      <a id="{{choice.name}}" class="card card--b card--listItem selectList-item-link" href=\'\' ng-click="selectChoice($event, choice)" compile-html="{{choice.content}}"></a>\n    </li>\n  </ul>\n\n  <table class=\'table selectList selectList--multiple selectList--table\' ng-if="type === \'table\'">\n    <thead>\n      <tr>\n        <th></th>\n        <th ng-repeat="col in table_header">{{col.name}}</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr class="selectList-item" ng-class="selectedClassFor(choice)" ng-repeat="choice in choices" >\n        <td class=\'selectList-item-data\' ng-click="selectChoice($event, choice)">\n          <a id="{{choice.name}}" class="selectList-item-link" href=\'\' compile-html="{{content}}"></a>\n        </td>\n        <td ng-repeat="content in choice.content">\n          {{content}}\n        </td>\n      </tr>\n    </tbody>\n  </table>\n\n  <submit-button hide-next-challenge-button="true">Submit Answer</submit-button>\n</div>',link:function(scope,element,attrs){var clearErrors,markErrors,submitter;return submitter=Submitter.get(scope.$course,scope.$page),scope.selected=[],scope.type=attrs.type||"list",clearErrors=function(){return $(".content-objective").find(".selectList-item-error, .selectList-error").remove()},markErrors=function(report){var answers;return answers=_.flatten(_.collect(report.report.successes,function(success){return JSON.parse(JSON.parse(success.raw_input))})),_.each(scope.choices,function(choice){return choice.selected?choice.isAnswer=_.contains(answers,choice.name):void 0
})},scope.choices=angular.copy(scope.$page.multiple_choice),scope.table_header=scope.$page.table_header,scope.selectChoice=function(evt,choice){return _.each(scope.choices,function(choice){return delete choice.isAnswer}),scope.selected.indexOf(choice.name)<0?(scope.selected.push(choice.name),choice.selected=!0):(scope.selected.splice(scope.selected.indexOf(choice.name),1),choice.selected=!1),scope.isSubmitting?void 0:(scope.selectedElement=evt.currentTarget,scope.selectedChoice=scope.selected)},scope.selectedClassFor=function(choice){return choice.selected?null==choice.isAnswer?"is-selected":choice.isAnswer?"is-correct":"is-incorrect":""},submitter.on("userSubmissionStarted",function(){return 0===scope.selected.length?element.find("ul,table").before("<div class='card card--a card--error selectList-error'><p>You need to select an element!</p></div>"):scope.isSubmitting=!0}),submitter.on("userSubmissionFinally",function(){return scope.isSubmitting=!1}),submitter.on("userSubmissionComplete",function(report){var errorElement;return clearErrors(),report.success()?$(element).find(".error-message").remove():scope.selected.length>0&&(clearErrors(),errorElement=$compile("<div class='selectList-item-error mbm'>"+report.message()+"</div>")(scope),$(".content-objective").prepend(errorElement)),markErrors(report)}),submitter.registerContent(function(){return JSON.stringify(scope.selected)}),scope.$on("$destroy",function(){return submitter.destroy()})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("nextChallengeButton",["OpenModal","$state","Submitter","NextChallengeButton",function(OpenModal,$state,Submitter,NextChallengeButton){return{restrict:"E",replace:!0,transclude:!0,scope:!0,template:"<a href='' class='btn btn--a btn--next' ng-class='{\"is-inactive\": isInactive}' ng-click='gotoNextChallenge()' ng-transclude analytics-on analytics-event=\"Next Page Button\"></a>",link:function(scope,element,attrs){var page,submitter;return page=scope.$page,submitter=Submitter.get(scope.$course,page),scope.nextPagePath=NextChallengeButton.getFirstOverride()||page.$meta.next_query_string,attrs.waitForPageComplete&&(scope.isInactive=!0,page.$progress().bind(scope,"progress").then(function(progress){return scope.isInactive=100===progress&&scope.nextPagePath?!1:!0,100===progress?scope.isInactive=!scope.nextPagePath:void 0})),submitter.on("complete",function(report){return report.success()?scope.isInactive=!1:void 0}),scope.gotoNextChallenge=function(){return scope.isInactive?void 0:(OpenModal.close({clear:!0}),$state.go("root.courseContent",{queryString:scope.nextPagePath}))}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("objectiveHeader",function(){return{restrict:"E",replace:!0,scope:!0,template:"<header class='header'>\n  <h1 class='header-title'>\n    <b class='header-num' ng-if=\"!disableNumbers\">{{levelIndex}}{{divider}}{{indexInLevel}}</b>\n    {{$page.name}} <span class='header-label label' ng-if='$page.pending'>Pending</span>\n\n    <page-points possible-points=true class='header-label label' ng-if='$page.required'></page-points>\n  </h1>\n</header>",link:function(scope,element,attrs){return scope.disableNumbers=attrs.disableNumbers,scope.divider=attrs.numberDivider||"-",scope.$page.$indexInLevel().bind(scope,"indexInLevel"),scope.$level.$indexInCourse().bind(scope,"levelIndex")}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("outputResultsPreview",["Submitter","CampusEvent","$compile",function(Submitter,CampusEvent){return{replace:!0,restrict:"E",scope:{$course:"=",$page:"=",resource:"=",resourceIndex:"@",resources:"=",tabbedResource:"@"},template:"<div class='resource resource--m resource--preview resource--scroll'>\n  <p class='resource-msg' ng-if='!output'>Results will automatically update when you submit your code.</p>\n  <div ng-bind-html=\"results\" class='output-results'></div>\n<div>",link:function(scope,element){var formatToTree,parseHTML,parseTree,previousQueryJson,submitter,timeoutPromise,updatePreview;return previousQueryJson=null,timeoutPromise=null,updatePreview=function(report){var details,queryJson,queryResult,queryResults,resource,_i,_len,_results;if(report&&report.report.details.query_results){for(details=report.report.details,queryResults=details.query_results,queryJson=JSON.stringify(queryResults||"{}"),resource=scope.resources[parseInt(scope.resourceIndex,10)],previousQueryJson!==queryJson&&CampusEvent.emit("outputResultsPreview:update",{resource:resource}),previousQueryJson=queryJson,_results=[],_i=0,_len=queryResults.length;_len>_i;_i++)queryResult=queryResults[_i],queryResult&&queryResult.data?resource.name===queryResult.target?_results.push(formatToTree(queryResult)):_results.push(void 0):_results.push(void 0);return _results}},submitter=Submitter.get(scope.$course,scope.$page),submitter.on("complete",function(report){return scope.report=report,updatePreview(report)}),scope.isActive=function(){return element.is(":visible")},scope.$watch("isActive()",function(active){return active?updatePreview(scope.report):void 0}),formatToTree=function(queryResult){var e,res,_d,_i,_len;scope.results="";try{for(_d=JSON.parse(queryResult.data[0]),_d[0].documents&&(_d=_d[0].documents),_d.length||(scope.results+=_d),_i=0,_len=_d.length;_len>_i;_i++)res=_d[_i],parseTree(res)}catch(_error){e=_error,scope.results=parseHTML(queryResult.data[0])}return scope.output=!0},parseTree=function(res){var objId,pattern,tree;return pattern=/['"](ObjectId\(&#x27;\w+&#x27;\))['"]/,tree=JSONTree.create(res)+"<br/>",objId=tree.match(pattern),objId&&(tree=tree.replace(pattern,objId[1])),scope.results+=tree},parseHTML=function(data){return data.replace(/\n/g,"<br/>").replace(/\t/g,"&nbsp;&nbsp;")}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("outputTextPreview",["Submitter","CampusEvent","CampusUtil","$compile",function(Submitter,CampusEvent,CampusUtil){return{replace:!0,restrict:"E",scope:{$course:"=",$page:"=",resource:"=",resourceIndex:"@",resources:"=",tabbedResource:"@"},template:"<div class='resource resource--m resource--preview resource--scroll'>\n  <code-mirror ng-model='results.text' options='options'></code-mirror>\n<div>",link:function(scope){var resource,submitter,updatePreview;return resource=scope.resource,updatePreview=function(report){var results,_ref,_ref1;return report&&(null!=(_ref=report.details())?null!=(_ref1=_ref.output)?_ref1.result:void 0:void 0)?(results=report.details().output.result,scope.output=!0,scope.results={text:results}):void 0},submitter=Submitter.get(scope.$course,scope.$page),submitter.on("complete",function(report){return scope.report=report,updatePreview(report)}),scope.options={readOnly:!0,mode:CampusUtil.filterSyntax(resource.code_type)}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("pageContent",["$compile","$timeout","CampusUrl",function($compile,$timeout,CampusUrl){return{restrict:"A",transclude:!0,scope:!0,link:function(scope,element,attrs,ctrl,transclude){var childScope,pageContent,transferTextToHtml;return scope.courseAsset=function(assetName){return CampusUrl.fingerPrintFile(assetName)},scope.courseUrl=function(url){return CampusUrl.courseAssetUrl(url)},transferTextToHtml=function(){return element.find("span").html(element.find("span").text())},childScope=scope.$new(),pageContent=scope.$page.page_content,scope.pageContent=pageContent,_.each(_.pairs(pageContent),function(content){var contentName,contentValue;return contentName=content[0],contentValue=content[1],scope[contentName]=contentValue}),transclude(scope,function(clonedElement){return element.append(clonedElement),$compile(element.contents())(childScope),"html"===attrs.pageContent?$timeout(function(){return transferTextToHtml(),$compile(element.contents())(childScope)}):void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("pageCount",function(){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{totalPages}}</span>",link:function(scope,element,attrs){return scope.pages=attrs.pages,scope.required=attrs.required,scope.required?scope.$course.$totalRequiredPages().bind(scope,"totalPages"):scope.$course.$videoPagesCount().bind(scope,"totalPages")}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("pageHints",["$compile",function(){return{replace:!0,restrict:"E",scope:!0,template:"<div class='page-hints' ng-show='hints.length > 0'>\n  <ol class='feed has-widget'>\n    <page-hint ng-repeat=\"hint in hints\" data=\"hint\"></page-hint>\n  </ol>\n</div>",link:function(scope){return scope.$page.$usedHints().bind(scope,"hints")}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("pageHint",["$compile",function(){return{replace:!0,restrict:"E",scope:!0,template:"<li class='widget' ng-class=\"{'card': isAnswer, 'card--a': isAnswer, 'widget--hint': !isAnswer, 'widget--answer': isAnswer}\">\n  <div class='widget-header'>\n    <h3 class='widget-title feed-item-title' ng-if=\"!isAnswer\">Hint #{{$index + 1}}</h3>\n    <h3 class='widget-title' ng-if=\"isAnswer\">Answer</h3>\n  </div>\n\n  <div class='widget-content widget-md'>\n    <p compile-html=\"{{hint.body}}\"></p>\n    <div ng-repeat='file in hint.files'>\n      <h4>{{file.file_name}}</h4>\n      <code-highlight syntax=\"{{file.code_type}}\" bind-content='file.code'></code-highlight>\n    </div>\n  </div>\n</li>",link:function(scope){var hint,page;return page=scope.$page,hint=scope.hint,page.$isAnswer(hint).bind(scope,"isAnswer")}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("pagePoints",function(){return{replace:!0,restrict:"E",scope:!0,template:"<span>{{points}} pts</span>",link:function(scope,elements,attrs){return attrs.possiblePoints?scope.$page.$possiblePoints().bind(scope,"points"):scope.$page.$points().bind(scope,"points")}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("pageVideo",function(){return{replace:!0,restrict:"E",scope:!0,template:"<div class='page-video card card--a video-frame'>\n  <blackboard-video-player ng-if='normalVideoExists' player-url=\"{{playerUrl}}\" autoplay='{{autoplay}}' allow-downloads='{{allowDownloads}}'></blackboard-video-player>\n  <youtube-video ng-if='youtubeVideoExists'></youtube-video>\n</div>",link:function(scope,element,attrs){return scope.playerUrl=attrs.playerUrl,scope.autoplay=attrs.autoplay,scope.allowDownloads=attrs.allowDownloads,scope.startAtTime=attrs.startAtTime,scope.youtubeVideoExists=!!scope.$page.youtube_video,scope.normalVideoExists=!!scope.$page.video}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("pdf",["$sce","CampusUrl",function($sce,CampusUrl){return{restrict:"E",replace:!0,scope:{$course:"=",$page:"=",assetUrl:"=",externalUrl:"=",page:"=",resource:"=",resourceIndex:"@",resources:"=",tabbedResource:"@"},template:"<div class='resource resource--pdf'>\n  <iframe ng-src='{{pdfUrl}}'></iframe>\n</div>",link:function(scope,element){var pdfUrl;return pdfUrl=function(){var baseUrlString;return baseUrlString="/viewer.html?file=",scope.assetUrl&&"null"!==scope.assetUrl?baseUrlString+=CampusUrl.pdfUrl(scope.assetUrl):scope.externalUrl&&(baseUrlString+=CampusUrl.pdfExternalUrl(scope.externalUrl)),scope.page&&(baseUrlString+="#page="+scope.page),baseUrlString},scope.isActive=function(){return element.is(":visible")},scope.$watch("isActive()",function(isActive){return isActive?scope.pdfUrl=pdfUrl():void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("popover",["$compile","$timeout",function($compile,$timeout){return{replace:!1,restrict:"A",scope:!1,link:function(scope,element,attrs){var bodyClose,closeDelay,compilePopoverElement,delayedClose,isHoverPopover,popoverElement,resetDelayed,timer;return closeDelay=parseInt(attrs.popoverCloseDelay,10),popoverElement=angular.element("<span></span>"),$(element).popover({trigger:attrs.popoverTrigger||"click",html:!0,content:function(){return popoverElement.empty(),popoverElement.html(scope[attrs.popoverMessage]||attrs.popoverMessage),popoverElement.find(".popover-precompile-hide").hide(),popoverElement},title:function(){return scope[attrs.popoverTitle]||attrs.popoverTitle},placement:function(){return scope[attrs.popoverPlacement]||attrs.popoverPlacement||"right"},container:"body"}),compilePopoverElement=function(){return $timeout(function(){return $compile(popoverElement.contents())(scope),popoverElement.find(".popover-precompile-hide").show()})},timer=null,delayedClose=function(){return $timeout.cancel(timer),timer=$timeout(function(){return scope.popoverClose()},closeDelay)},resetDelayed=function(){return $timeout.cancel(timer)},$(element).on("shown.bs.popover",compilePopoverElement),closeDelay&&($(popoverElement).on("mouseout",delayedClose),$(popoverElement).on("mouseover",resetDelayed),$(element).on("mouseout",delayedClose)),scope.popoverClose=function(){return $(element).popover("hide")},isHoverPopover="hover"===attrs.popoverTrigger,isHoverPopover||(scope.elementIsVisible=function(){return element.is(":visible")},scope.$watch("elementIsVisible()",function(visible){return visible?void 0:$(element).popover("hide")})),bodyClose=function(event){var anotherPopoverLink,childOfPopover,popoverLink;return childOfPopover=$(event.target).parents(".popover").addBack(".popover").length>0,popoverLink=$(event.target).filter("[popover]")[0],anotherPopoverLink=$(popoverLink).scope()!==scope,childOfPopover||popoverLink&&!anotherPopoverLink?void 0:scope.popoverClose()},$("body").on("click",bodyClose),scope.$on("$destroy",function(){return $(element).off("shown.bs.popover",compilePopoverElement),$(element).off("mouseout",delayedClose),$("body").off("click",bodyClose),$(popoverElement).off("mouseout",delayedClose),$(popoverElement).off("mouseout",resetDelayed),$(element).popover("destroy")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("queryResultsPreview",["Submitter","CampusEvent",function(Submitter,CampusEvent){return{replace:!0,restrict:"E",scope:{$course:"=",$page:"=",preview:"=",resource:"=",resourceIndex:"@",resources:"=",tabbedResource:"@"},template:"<div class='resource resource--m resource--preview resource--scroll'>\n  <p class='resource-msg' ng-if='!rows'>Results will automatically update when you submit your code.</p>\n  <table class='table'>\n    <thead>\n      <tr>\n        <th ng-repeat=\"column in columns\">{{column}}</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat='row in rows'>\n        <td ng-repeat=\"column in columns\">{{row[column]}}</td>\n      </tr>\n    </tbody>\n  </table>\n<div>",link:function(scope,element){var preview,previousQueryJson,submitter,timeoutPromise,updatePreview;return previousQueryJson=null,timeoutPromise=null,scope.preview&&(preview=JSON.parse(scope.preview),scope.columns=preview.head,scope.rows=preview.body),updatePreview=function(report){var details,queryJson,queryResult,queryResults,resource,_i,_len,_results;if(report&&report.report.details.query_results){for(details=report.report.details,queryResults=details.query_results,queryJson=JSON.stringify(queryResults||"{}"),resource=scope.resources[parseInt(scope.resourceIndex,10)],previousQueryJson!==queryJson&&CampusEvent.emit("queryResultsPreview:update",{resource:resource}),previousQueryJson=queryJson,_results=[],_i=0,_len=queryResults.length;_len>_i;_i++)queryResult=queryResults[_i],queryResult&&queryResult.data?resource.name===queryResult.target?(scope.columns=Object.keys(angular.copy(queryResult.data[0])),_results.push(scope.rows=queryResult.data)):_results.push(void 0):_results.push(void 0);return _results}},submitter=Submitter.get(scope.$course,scope.$page),submitter.on("complete",function(report){return scope.report=report,updatePreview(report)}),scope.isActive=function(){return element.is(":visible")},scope.$watch("isActive()",function(active){return active?updatePreview(scope.report):void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("regexEditor",["CampusUtil","Submitter",function(CampusUtil,Submitter){return{replace:!0,restrict:"E",scope:!0,template:'<div>\n  <p class="mbs tsm ttu twb">Your Regular Expression</p>\n  <div class="regexEditor-field regexEditor-field--pattern">\n    <code-mirror ng-model="regex.expression"\n                 options="expressionOptions"\n                 highlighting="expressionHighlighting"\n                 on-change="expressionAutoSubmit()"\n                 tabindex="1">\n    </code-mirror>\n  </div>\n  <div class="regexEditor-field regexEditor-field--flags">\n    <code-mirror ng-model="regex.modifiers"\n                 options="modifiersOptions"\n                 highlighting="modifiersHighlighting"\n                 on-change="modifiersAutoSubmit()"\n                 tabindex="2">\n    </code-mirror>\n  </div>\n</div>',link:function(scope){var autoSubmitFactory,course,expression,extraKeys,ignoreInput,modifiers,page,submit,submitter;return course=scope.$course,page=scope.$page,submitter=Submitter.get(course,page),ignoreInput=function(codeMirror){return codeMirror.replaceSelection(codeMirror.getSelection())},submit=function(){return submitter.userSubmit()},autoSubmitFactory=function(editor){return _.debounce(function(){return submitter.submit()},editor.auto_submit_delay||0)},expression=page.$editorByFileName("expression"),modifiers=page.$editorByFileName("modifiers"),extraKeys={Enter:function(codeMirror){return ignoreInput(codeMirror),submitter.userSubmit()},"Shift-Enter":ignoreInput,"Alt-Enter":ignoreInput,Tab:!1,"Shift-Tab":!1,"Alt-Tab":!1,"Cmd-Enter":submit,"Ctrl-Enter":submit},scope.expressionOptions={mode:CampusUtil.filterSyntax(expression.syntax),autofocus:!0,extraKeys:extraKeys},scope.modifiersOptions={mode:CampusUtil.filterSyntax(modifiers.syntax),extraKeys:extraKeys},scope.regex={expression:expression.content,modifiers:modifiers.content},scope.submit=submit,scope.expressionAutoSubmit=autoSubmitFactory(expression),scope.modifiersAutoSubmit=autoSubmitFactory(modifiers),submitter.registerContent(function(){return[{expression:scope.regex.expression||"",modifiers:scope.regex.modifiers||""}]}),submitter.on("complete",function(report){var _ref,_ref1;return scope.expressionHighlighting=null!=(_ref=report.details().highlighting)?_ref.expression:void 0,scope.modifiersHighlighting=null!=(_ref1=report.details().highlighting)?_ref1.modifiers:void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("requireComplete",function(){return{restrict:"M",replace:!0,require:"^courseData",scope:!0,template:"<button class='btn btn--dev btn--control' ng-click='toggleIncompleteTemplate()' ng-if='isDevelopment'>render incomplete template</button>",link:function(scope,element,attrs,courseDataCtrl){var elseTemplateToRender,originalTemplate,requiredToComplete;return requiredToComplete=attrs.requireComplete.split(" ")[0],elseTemplateToRender=attrs.requireComplete.split(" ")[1].split(":")[1],originalTemplate=courseDataCtrl.getTemplate(),courseDataCtrl.setTemplate(),scope.$course.$getConfig("development_mode").then(function(developmentMode){var parent;return scope.isDevelopment=developmentMode,developmentMode?courseDataCtrl.setTemplate(originalTemplate):(parent=scope["$"+requiredToComplete],parent.$progress().then(function(progress){var isComplete;return isComplete=100===progress,isComplete?courseDataCtrl.setTemplate(originalTemplate):courseDataCtrl.setTemplate(elseTemplateToRender)}))}),scope.toggleIncompleteTemplate=function(){return courseDataCtrl.setTemplate(elseTemplateToRender)}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("resourceList",["CampusUrl",function(CampusUrl){return{restrict:"E",scope:!0,template:'<ul class="list">\n  <li ng-repeat=\'resource in resources\'>\n    <a class=\'btn btn--control btn--{{getResourceClass(resource)}} btn--thin btn--offset btn--offset--thin\' href="{{getResourceLink(resource)}}" target="_blank">{{resource.name}}</a>\n  </li>\n</ul>',link:function(scope){return scope.resources=scope.$page.resources.resources,scope.getResourceClass=function(resource){var _ref,_ref1;return(null!=(_ref=resource.pdf)?_ref.external_url:void 0)||(null!=(_ref1=resource.pdf)?_ref1.asset_url:void 0)?"slides":void 0},scope.getResourceLink=function(resource){var _ref,_ref1;return(null!=(_ref=resource.pdf)?_ref.external_url:void 0)?CampusUrl.pdfExternalUrl(resource.pdf.external_url):(null!=(_ref1=resource.pdf)?_ref1.asset_url:void 0)?CampusUrl.pdfUrl(resource.pdf.asset_url):void 0}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("safeImage",function(){return{replace:!1,restrict:"A",scope:!0,link:function(scope,element){return element.on("error",function(){return element.css("visibility","hidden")})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("socialShare",["$compile",function($compile){return{replace:!0,restrict:"E",transclude:!0,scope:!0,template:'<div class="share" ng-mouseenter=\'activate()\' ng-mouseleave=\'deactivate()\' ng-class=\'{"is-inactive": isBeta}\'>\n  <a class="btn btn--a btn--offset btn--share share-btn" href="" analytics-on="mouseenter" analytics-event="Share This">\n    <b>\n      Share This\n    </b>\n  </a>\n  <ul class="share-panel"></ul>\n</div>',link:function(scope,element,attrs,ctrl,transclude){var childScope;return scope.popupWidth=attrs.popupWidth||575,scope.popupHeight=attrs.popupHeight||400,scope.popupTop=attrs.popupTop||0,scope.popupLeft=attrs.popupLeft||0,scope.$course.$getConfig("state").then(function(courseState){return scope.isBeta="beta"===courseState||"alpha"===courseState}),scope.activate=function(){scope.isBeta||element.addClass("is-active")},scope.deactivate=function(){element.removeClass("is-active")},childScope=scope.$new(),transclude(scope,function(clonedElement){return $compile(clonedElement)(childScope),element.find(".share-panel").append(clonedElement)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("shareItemFacebook",function(){return{replace:!0,restrict:"E",scope:!0,template:'<li class="share-service">\n  <a class="share-service-item share-service-item--facebook" href="" ng-click=\'openPopup()\' analytics-on analytics-event="Share Facebook">\n    <b class="srt">\n      Facebook\n    </b>\n  </a>\n</li>',link:function(scope){return scope.openPopup=function(){scope.$course.$getConfig("share_url").then(function(shareUrl){var options,url;return url="https://www.facebook.com/sharer/sharer.php?u="+shareUrl,options="width="+scope.popupWidth+", height="+scope.popupHeight+", top="+scope.popupTop+", left="+scope.popupLeft,window.open(url,"Facebook",options)})}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("shareItemGoogle",function(){return{replace:!0,restrict:"E",scope:!0,template:'<li class="share-service">\n  <a class="share-service-item share-service-item--google" href="" ng-click=\'openPopup()\' analytics-on analytics-event="Share Google">\n    <b class="srt">\n      Google\n    </b>\n  </a>\n</li>',link:function(scope){return scope.openPopup=function(){scope.$course.$getConfig("share_url").then(function(shareUrl){var options,url;return url="https://plus.google.com/share?url="+shareUrl,options="width="+scope.popupWidth+", height="+scope.popupHeight+", top="+scope.popupTop+", left="+scope.popupLeft,window.open(url,"Google",options)})}}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("shareItemTwitter",["$interpolate",function($interpolate){return{replace:!0,restrict:"E",scope:!0,template:'<li class="share-service share-service--twitter" data-text="">\n  <a class="share-service-item share-service-item--twitter" href="" ng-click=\'openPopup()\' analytics-on analytics-event="Share Twitter">\n    <b class="srt">\n      Twitter\n    </b>\n  </a>\n</li>',link:function(scope,element,attrs){var attrMessage;return attrMessage=attrs.message,scope.$level&&(scope.levelName=scope.$level.name,scope.$level.$indexInCourse().bind(scope,"levelNumber")),scope.openPopup=function(){scope.$course.$getAllConfig().then(function(configData){var message,options,url;return message=$interpolate(configData.twitter_message)(scope),url="https://twitter.com/share?text="+(attrMessage||message)+"&url="+configData.share_url,options="width="+scope.popupWidth+", height="+scope.popupHeight+", top="+scope.popupTop+", left="+scope.popupLeft,window.open(url,"Twitter",options)})}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("splitCourseProgress",["CampusUrl","$compile","$rootScope","$q","$state",function(CampusUrl,$compile,$rootScope,$q,$state){return{restrict:"E",replace:!0,scope:!0,template:"<ol class='progressList progressList--{{levels.length}}'>\n  <li class='progressList-item progress' ng-repeat=\"level in levels\">\n    <a href='' ng-click=\"goToLevel(level)\" class='progressList-link' tooltip data-original-title='{{level.progress}}% of {{S(level.$meta.type).capitalize().s}} {{$index + 1}}' analytics-on analytics-event=\"Course Progress Bar\">\n      <div class='progress-bar' style='width: {{level.progress}}%;'></div>\n    </a>\n  </li>\n</ol>",link:function(scope){return scope.S=S,scope.goToLevel=function(level){return level.$incompletePages().then(function(incompletePages){var levelWrapUp;return incompletePages.length>0?$state.go("root.courseContent",{queryString:_.first(incompletePages).$meta.query_string}):(levelWrapUp=level.$wrapUp(),levelWrapUp?$state.go("root.courseContent",{queryString:levelWrapUp.$meta.query_string}):$state.go("root.courseContent",{queryString:level.$meta.query_string}))})},scope.$course.$levels().then(function(levels){return _.each(levels,function(level){return level.$progress().bind(level,"progress")}),scope.levels=levels})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("startEditButton",function(){return{replace:!0,restrict:"E",scope:!0,template:"<a href='' class='btn btn--a btn--offset content-codeEditor-btn' ng-click='showEditor()'><b>{{buttonLabel}}</b></a>",link:function(scope){var updateButtonText;return updateButtonText=function(contentData){var _ref;return scope.buttonLabel=100===contentData.progress?"Restart Challenge":(null!=(_ref=contentData.attempts)?_ref.recent_attempt:void 0)?"Resume Challenge":"Start Challenge"},scope.showEditor=function(){return scope.$emit("page:editor:activate",{courseIdentifier:scope.courseIdentifier,queryString:scope.queryString})},scope.$on("page:update:content",function(evt,eventData){return eventData.queryString===scope.queryString?scope.currentContent.data().then(function(contentData){return updateButtonText(contentData)}):void 0}),scope.currentContent.data().then(function(contentData){return updateButtonText(contentData)})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("subject",["HTMLUtils","Submitter",function(HTMLUtils,Submitter){return{replace:!0,restrict:"E",scope:!0,template:'<li class="card card--a subject">\n  <code-mirror class="db"\n               ng-model="subject.content"\n               options="{\n                 \'readOnly\': \'nocursor\',\n                 \'autofocus\': false,\n                 \'lineWrapping\': true\n               }"\n               highlighting="highlighting">\n  </code-mirror>\n  <div class="selectList-item-error" ng-if="subjectFailure">\n    <div class="bucket bucket--s">\n      <div class="bucket-media">\n        <i class=\'icn icn--warning tce\'></i>\n      </div>\n      <div class="bucket-content mbfld">\n        <span compile-html="{{subjectFailure}}"></span>\n        <span ng-if="subjectFailedAttempt.hint" compile-html="<adaptive-hint>{{subjectFailedAttempt.hint}}</adaptive-hint>"></span>\n      </div>\n    </div>\n  </div>\n</li>',link:function(scope){var clearFailure,subject,submitter;return submitter=Submitter.get(scope.$course,scope.$page),subject=scope.subject,clearFailure=function(){return scope.subjectFailure=null,scope.subjectFailedAttempt=null},submitter.on("complete",function(report){var currentFailedAttempt,differentFailure,previousFailedAttempt;return previousFailedAttempt=scope.subjectFailedAttempt,currentFailedAttempt=report.failedAttemptForTarget(subject.name),differentFailure=(null!=previousFailedAttempt?previousFailedAttempt.name:void 0)!==(null!=currentFailedAttempt?currentFailedAttempt.name:void 0),report.hasFailureWithoutTarget()||differentFailure?clearFailure():void 0}),submitter.on("userSubmissionComplete",function(report){return report.hasFailureWithoutTarget()?clearFailure():(scope.subjectFailure=report.htmlMessageForTarget(subject.name),scope.subjectFailedAttempt=report.failedAttemptForTarget(subject.name))}),submitter.on("complete",function(report){var _ref;return scope.highlighting=null!=(_ref=report.details().highlighting)?_ref[scope.subject.name]:void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("subjects",["$timeout","Submitter",function($timeout,Submitter){return{replace:!0,restrict:"E",scope:{$course:"=",$page:"=",resource:"=",resourceIndex:"@",resources:"=",tabbedResource:"@"},template:'<div class=\'resource resource--m resource--scroll resource--subjects\'>\n  <ul class="selectList has-widget mbm">\n    <li class="card card--error selectList-error" ng-if="failureMessageWithoutTarget">\n      <span compile-html="{{failureMessageWithoutTarget}}"></span>\n      <span ng-if="failedAttemptWithoutTarget.hint" compile-html="<adaptive-hint>{{failedAttemptWithoutTarget.hint}}</adaptive-hint>"></span>\n    </li>\n    <subject ng-repeat=\'subject in subjects track by $index\'></subject>\n  </ul>\n<div>',link:function(scope,element){var getGeneralFailureMessage,submitter;return submitter=Submitter.get(scope.$course,scope.$page),getGeneralFailureMessage=function(report){return report.htmlMessageWithoutTarget()||report.htmlMessageForTarget("expression")||report.htmlMessageForTarget("modifiers")},submitter.on("complete",function(report){var currentFailedAttempt,previousFailedAttempt;return previousFailedAttempt=scope.failedAttemptWithoutTarget,currentFailedAttempt=report.failedAttemptWithoutTarget(),(null!=previousFailedAttempt?previousFailedAttempt.name:void 0)!==(null!=currentFailedAttempt?currentFailedAttempt.name:void 0)?(scope.failureMessageWithoutTarget=null,scope.failedAttemptWithoutTarget=null):void 0}),submitter.on("userSubmissionComplete",function(report){return scope.failureMessageWithoutTarget=getGeneralFailureMessage(report),scope.failedAttemptWithoutTarget=report.failedAttemptWithoutTarget()}),scope.subjects=scope.resource,scope.isActive=function(){return element.is(":visible")}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("sublimeVideoPlayer",["CampusUrl","$cookies","$rootScope","$timeout","SublimeLoader","ProjectorVideo",function(CampusUrl,$cookies,$rootScope,$timeout,SublimeLoader,ProjectorVideo){return{restrict:"E",replace:!0,scope:!0,template:"<div>\n  <div class='card card--a video-frame'>\n    <video data-autoresize='fit' title=\"{{name}}\" data-autoplay='{{autoplay}}' data-fullmode-priority='screen'></video>\n  </div>\n  <div class='btnList video-controls' ng-if='extraControlsEnabled()'>\n    <div class='btnList-btn video-speed' ng-if=\"usingVideoTag\">\n      <dropdown class='video-speed-dropdown' repeat='speed in speeds' label='Playback Speed' ng-model='currentSpeed' on-select='updateSpeed($value)'>\n        <a href='' class='dropdown-link'>{{speed}}x</a>\n      </dropdown>\n    </div>\n    <div class='btnList-btn video-download'>\n      <dropdown class='video-download-dropdown' repeat='file in downloads' label='Download'>\n        <a href='{{file.url}}' target='_blank' class='dropdown-link'>{{file.label}}</a>\n      </dropdown>\n    </div>\n  </div>\n</div>",link:function(scope,element,attrs){var addVideoFiles,cacheVideoQuality,currentQuality,getDownloads,getEmbedElement,getVideoElement,initializeScopeVideoData,parseDownloadSizes,preparedVideoElement,projectorVideo,resizePollInterval,videoData,videoEl;return scope.playerUrl=attrs.playerUrl,scope.downloadFileType=attrs.downloadFileType,scope.downloadSizes=attrs.downloadSizes,scope.autoplay=attrs.autoplay,scope.extraControls=attrs.extraControls,scope.startAtTime=attrs.startAtTime,projectorVideo=new ProjectorVideo(scope.$course.identifier),preparedVideoElement=null,resizePollInterval=null,videoEl=$(element).find(".video-frame"),getVideoElement=function(){return element.find("video")[0]},getEmbedElement=function(){return element.find("embed")[0]},currentQuality=null,cacheVideoQuality=function(videoElement){return currentQuality=$(videoElement).find("[src='"+videoElement.currentSrc+"']").data("quality")||"sd",currentQuality!==localStorage["sublimeVideoPlayer:currentVideoQuality"]?localStorage["sublimeVideoPlayer:currentVideoQuality"]=currentQuality:void 0
},parseDownloadSizes=function(){var downloadSizes;return downloadSizes=_.map(scope.downloadSizes.split(","),function(sizeStr){var labelArr;return labelArr=sizeStr.split(":"),{profile:labelArr[1],label:labelArr[0].replace(/^\s*/,"")}})},getDownloads=function(videoData){var allFiles,downloadFileTypes,downloadSizes,downloads;return allFiles=videoData.files,downloadFileTypes=_.filter(allFiles,function(file){return file.type.match(new RegExp(scope.downloadFileType))}),downloadSizes=parseDownloadSizes(),downloads=_.filter(downloadFileTypes,function(file){var foundItems;return foundItems=0,_.each(downloadSizes,function(size){return file.id===size.profile?(file.label=size.label,foundItems+=1):void 0}),foundItems>0})},addVideoFiles=function(videoData){var sourceTags,trackTags,videoFiles,video_element;return videoFiles=videoData.files,sourceTags=_.map(videoFiles,function(file){return"<source src='"+file.url+"' data-quality='"+file.quality+"'/>"}),"hd"===localStorage["sublimeVideoPlayer:currentVideoQuality"]?sourceTags.sort(function(a){return a.match(/data-quality=['"]hd['"]/)?-1:1}):sourceTags.sort(function(a){return a.match(/data-quality=['"]hd['"]/)?1:-1}),trackTags=_.map(videoData.subtitles,function(subtitle){var label;return label=subtitle.label?" label='"+subtitle.label+"' ":void 0,"<track src='"+CampusUrl.subtitleUrl(subtitle.path)+"' srclang='"+subtitle.lang+"' "+label+"/>"}),video_element=element.find("video"),video_element.append(sourceTags.join("\n")),video_element.append(trackTags.join("\n")),video_element=null},scope.speeds=[.5,1,1.5,2,3],scope.name=scope.$page.name,scope.extraControlsEnabled=function(){return"hide"!==scope.extraControls},scope.currentSpeed=scope.extraControlsEnabled()?parseFloat($cookies.videoPlaybackSpeed)||1:1,scope.updateSpeed=function(speed){return $cookies.videoPlaybackSpeed=speed.toString(),getVideoElement().playbackRate=speed},scope.seekTo=function(time){var hours,minutes,seconds,timeArr;return time.constructor===String&&(timeArr=time.split(":"),hours=parseInt(3===timeArr.length?timeArr[0]:0,10),minutes=parseInt(3===timeArr.length?timeArr[1]:timeArr[0],10),seconds=parseInt(3===timeArr.length?timeArr[2]:timeArr[1],10),minutes+=60*hours,seconds+=60*minutes,time=seconds),scope.player&&scope.player.seekTo?scope.player.seekTo(time):void 0},scope.initializeSublime=function(videoData){return"undefined"==typeof sublime?SublimeLoader.load(scope.playerUrl).then(function(){return scope.loadSublime(videoData)}):(sublime.unprepare(preparedVideoElement),$timeout(function(){return scope.loadSublime(videoData)}))},scope.loadSublime=function(videoData){return"hide"!==scope.extraControls&&(scope.downloads=getDownloads(videoData)),addVideoFiles(videoData),sublime.load(),preparedVideoElement=getVideoElement(),sublime.ready(function(){return function(){return sublime.prepare(preparedVideoElement,function(player){var videoElement;if(player)return scope.player=player,videoElement=element.find("video"),scope.usingVideoTag="none"!==videoElement.css("display")&&"hidden"!==videoElement.css("visibility"),$timeout(function(){return scope.updateSpeed(scope.currentSpeed)},200),scope.startAtTime&&scope.player.on("metadata",function(){return scope.seekTo(scope.startAtTime)}),player.on("timeUpdate",function(){var _ref;return videoElement=getVideoElement(),cacheVideoQuality(videoElement),$(videoElement).is(":visible")||(null!=(_ref=$(getEmbedElement()))?_ref.is(":visible"):void 0)?videoElement=null:(scope.player.pause(),videoElement=null)})})}}(this))},scope.initializeVideoResize=function(){var setWidth;if(!resizePollInterval)return setWidth=0,resizePollInterval=setInterval(function(){var newHeight,videoHeight,videoWidth,width;if(scope.player)return width=videoEl.width(),width!==setWidth?(videoHeight=scope.player.videoHeight()||720,videoWidth=scope.player.videoWidth()||1280,newHeight=videoHeight/videoWidth*width,scope.player.setSize(width,newHeight),setWidth=width):void 0},100)},initializeScopeVideoData=function(videoData){var poster;return poster=videoData.files[0].thumb_nail,$(element).find(".video-frame video").attr("poster",poster),scope.startAtTime=videoData.start_at_time,scope.initializeVideoResize(),scope.initializeSublime(videoData)},videoData=scope.$page.video,scope.videoData&&(videoData=scope.videoData),videoData.id&&projectorVideo.get(videoData.id).then(function(videoObj){return videoData.files=videoObj.data[videoData.id],initializeScopeVideoData(videoData)}),$rootScope.$on("video:stop",function(){return scope.player?scope.player.pause():void 0}),scope.$on("$destroy",function(){return window.clearInterval(resizePollInterval),resizePollInterval=null,sublime&&sublime.unprepare?sublime.unprepare(preparedVideoElement):void 0})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("submitButton",["$rootScope","$q","KeyboardShortcuts","$timeout","Submitter","CancelError","FlashMessage","$analytics",function($rootScope,$q,KeyboardShortcuts,$timeout,Submitter,CancelError,FlashMessage,$analytics){return{restrict:"E",replace:!0,scope:!0,transclude:!0,template:"<div class=\"submit-button\">\n  <a title=\"Check My Work\" ng-click='submit($event)' href='' class='btn btn--a btn--next' ng-class=\"{'is-complete': pageIsComplete && !hideNextChallengeButton, 'is-submitting': isSubmitting}\" analytics-on analytics-event=\"Submit Button\">\n    <b class='loader-text' ng-transclude></b>\n    <span class='loader-el'></span>\n  </a>\n  <next-challenge-button ng-show='!hideNextChallengeButton && pageIsComplete'>Continue</next-challenge-button>\n</div>",link:function(scope,element,attrs){var page,pageWasComplete,showErrorFlash,showSuccessFlash,submitter,useFlashError;return useFlashError=attrs.flashError,pageWasComplete=!1,submitter=Submitter.get(scope.$course,scope.$page),scope.isSubmitting=!1,scope.hideNextChallengeButton=attrs.hideNextChallengeButton,scope.pageIsComplete=!1,page=scope.$page,scope.$page.$possiblePoints().bind(scope,"points"),page.$progress().bind(scope,"progress"),page.$isComplete().bind(scope,"pageIsComplete"),scope.submit=function(){return submitter.userSubmit()},scope.$on("$destroy",function(){return KeyboardShortcuts.unbind("+enter, ctrl+enter, ctrl+s, +s")}),showErrorFlash=function(errorMessage){return FlashMessage.show({htmlClass:"flash--error",closeButton:!0,closeDelay:1e6,title:"Incorrect Submission",message:_.unescape(errorMessage)})},showSuccessFlash=function(){var title;return title=100!==scope.progress&&scope.points>0?"Success! <span class='flash-label'>+"+scope.points+" pts.</span>":"Success!",FlashMessage.show({htmlClass:"flash--success",closeButton:!1,closeDelay:2200,message:null,title:title})},$rootScope.$on("page:editor:collapse",function(){return useFlashError=attrs.flashError}),$rootScope.$on("page:editor:fullscreen",function(){return useFlashError=!0}),KeyboardShortcuts.key("+enter, ctrl+enter, ctrl+s, +s",function(){return $analytics.eventTrack("Submit Button (+enter, ctrl+enter, ctrl+s, +s)"),scope.submit()}),submitter.on("start",function(){return page.$isComplete().then(function(isComplete){return pageWasComplete=isComplete})}),submitter.on("complete",function(report){return report.success()&&!pageWasComplete?showSuccessFlash():void 0}),submitter.on("userSubmissionStarted",function(){return scope.isSubmitting=!0}),submitter.on("userSubmissionComplete",function(report){return report.success()?showSuccessFlash():!report.success()&&useFlashError?showErrorFlash(report.htmlMessage()):void 0}),submitter.on("userSubmissionFinally",function(){return $timeout(function(){return scope.isSubmitting=!1},200)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("supportWidget",["CampusEvent",function(){return{replace:!0,restrict:"E",scope:!0,transclude:!0,template:"<div support-widget-manager class=\"card card--a widget widget--support has-widget-toggle\" ng-class=\"{'is-helping': supportOverlayOpen}\">\n  <support-widget-button></support-widget-button>\n  <support-widget-overlay>\n    <i class='icn icn--video--alt--b widget-overlay-icon mrxs'></i>\n    <watch-video-button class='widget-overlay-link widget-overlay-link-text' video-directive='blackboard-video-player' directive-options=\"autoplay='true' allow-downloads='true'\"></watch-video-button>\n    <hint-button class='widget-overlay-link widget-overlay-link-text' supportWidget></hint-button>\n  </support-widget-overlay>\n  <div ng-transclude></div>\n</div>"}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("supportWidgetButton",["CampusEvent",function(){return{replace:!0,restrict:"E",require:"^supportWidgetManager",scope:!0,template:"<a href='' class='card-toggle widget-toggle' ng-click='toggleOverlay()' analytics-on analytics-event=\"Support Overlay\" analytics-properties=\"{task: '{{task.name}}'}\">\n  <b class='srt'>Help</b>\n  <i class='icn icn--hint'></i>\n</a>"}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("supportWidgetOverlay",["CampusEvent",function(){return{replace:!0,restrict:"E",require:"^supportWidgetManager",scope:!0,transclude:!0,template:"<div class='widget-overlay' ng-click='toggleOverlay()'>\n  <div class='widget-overlay-content'>\n    <span ng-transclude></span>\n  </div>\n</div>"}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("supportWidgetManager",["CampusEvent",function(){return{restrict:"A",controller:["$scope",function($scope){return $scope.supportOverlayOpen=!1,$scope.toggleOverlay=function(){return $scope.supportOverlayOpen=!$scope.supportOverlayOpen},$scope.closeOverlay=function(){return $scope.supportOverlayOpen=!1},$scope.$watch("currentActiveIndex",function(newIndex,oldIndex){return $scope.index===oldIndex?$scope.closeOverlay():void 0})}],link:function(scope){var closeOverlay,supportWidget;return supportWidget=$(".widget--support"),closeOverlay=function(event){return 0===supportWidget.find(event.target).length?(scope.closeOverlay(),scope.$apply()):void 0},$("body").on("click",closeOverlay),scope.$on("$destroy",function(){return $("body").off("click",closeOverlay)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("tabbedResources",["$timeout","Submitter","CampusEvent",function($timeout,Submitter,CampusEvent){return{restrict:"E",replace:!0,require:["?^panelElement","?^activityPanel"],scope:!0,controller:["$scope",function($scope){return this.setActiveResource=function(resource){return $scope.activeResource=resource.name},this.getActiveResource=function(){return $scope.activeResource},this.activateResource=function(resource){return $scope.activateResource(resource.name)},this}],template:"<div ng-show='resourcesExist()'>\n  <div class='bar bar--resources'>\n    <ul class='tabList tabList--resources'>\n      <li class='tabList-item' ng-repeat='resource in resources'>\n        <a class='tabList-link {{classifyResourceName(resource.name)}}' ng-class=\"{'tabList-link--fixed': fixed, 'is-active': resourceIsActive(resource)}\" href='' ng-click='toggleActiveResource(resource)' analytics-on analytics-event=\"Resource Tab\" analytics-properties=\"{name: '{{resource.name}}'}\">{{resource.name}}</a>\n      </li>\n    </ul>\n  </div>\n  <resource-display resources='resources' active-resource='activeResource'></resources-display>\n</div>",link:function(scope,element,attrs,ctrls){var activatePreviewResource,activityCtrl,activityPanelCtrl,pulseClass,submitter;return activityCtrl=ctrls[0],activityPanelCtrl=ctrls[1],submitter=Submitter.get(scope.$course,scope.$page),scope.fixed=_.has(attrs,"fixed"),scope.defaultSelected=attrs.defaultSelected,scope.activeResource="",scope.resources=scope.$page.resources.tabs,scope.classifyResourceName=function(resourceName){return resourceName.replace(/\s/g,"-")},scope.toggleActiveResource=function(resource){scope.fixed?(scope.activeResource=resource.name,activityPanelCtrl.expand()):scope.activeResource===resource.name?(scope.activeResource=!1,activityCtrl&&activityCtrl.fullScreenOff()):scope.activeResource=resource.name},scope.resourcesExist=function(){return scope.resources&&scope.resources.length>0},scope.resourceIsActive=function(resource){return resource.name===scope.activeResource},activatePreviewResource=function(){var previewResource;return previewResource=_.find(scope.resources,function(resource){return!!resource.html_preview.html}),previewResource?scope.activateResource(previewResource.name):void 0},scope.activateResource=function(resourceName){return scope.activeResource!==resourceName?$timeout(function(){var resourceEl;return resourceEl=$(element).find("."+scope.classifyResourceName(resourceName)),resourceEl?$timeout(function(){return resourceEl.trigger("click"),CampusEvent.emit("tabbedResource:initialOpen")}):void 0}):void 0},submitter.once("userSubmissionComplete",function(report){return report.success()?activatePreviewResource():void 0}),pulseClass="pulse-bg-color",CampusEvent.on("queryResultsPreview:update",function(data){return $timeout(function(){var resourceEl,_ref;return resourceEl=null!=(_ref=$(element).next())?_ref.find("."+scope.classifyResourceName(data.resource.name)):void 0,resourceEl.removeClass(pulseClass),$timeout(function(){return resourceEl.addClass(pulseClass)},100)})}),CampusEvent.on("outputResultsPreview:update",function(data){return $timeout(function(){var resourceEl,_ref;return resourceEl=null!=(_ref=$(element).next())?_ref.find("."+scope.classifyResourceName(data.resource.name)):void 0,resourceEl.removeClass(pulseClass),$timeout(function(){return resourceEl.addClass(pulseClass)},100)})}),scope.defaultSelected&&scope.$watch("resources",function(resources){var index;return!scope.activeResource&&(null!=resources?resources.length:void 0)>0?(index=parseInt(scope.defaultSelected,10)-1||0,scope.activeResource=resources[index].name):$timeout(function(){return scope.$apply()})}),scope.$on("$destroy",function(){return CampusEvent.off("queryResultsPreview:update"),CampusEvent.off("outputResultsPreview:update")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("resourceDisplay",["$compile","CampusUtil",function($compile){return{restrict:"E",replace:!0,require:"^tabbedResources",scope:!0,template:"<div>\n</div>",link:function(scope,element,attrs,tabbedResourcesCtrl){return attrs.resources&&scope.$watch(attrs.resources,function(resources){return resources?scope.resources=resources:void 0}),scope.setActiveResource=function(resource){return tabbedResourcesCtrl.setActiveResource(resource)},scope.getActiveResource=function(){return tabbedResourcesCtrl.getActiveResource()},scope.renderedResources=[],scope.$watch("resources",function(resources){return _.each(resources,function(resource,index){var attributes,elementName,resourceElement,resourceKey,_i,_len,_ref;for(_ref=Object.keys(resource),_i=0,_len=_ref.length;_len>_i;_i++)if(resourceKey=_ref[_i],["html_class","name","open"].indexOf(resourceKey)<0&&!resourceKey.match(/^\$\$/)&&resource[resourceKey]&&scope.renderedResources.indexOf(resource.name)<0){elementName=resourceKey.replace(/_/g,"-"),attributes=[],scope.renderedResources.push(resource.name),resourceElement=angular.element("<"+elementName+" $course='$course' $page='$page' tabbed-resource='true' resource-index='"+index+"' ng-show='getActiveResource() === \""+resource.name+"\"'></"+elementName+">"),resourceElement.addClass(resource.html_class),resourceElement.attr("resources","resources"),resourceElement.attr("resource","resources["+index+"]['"+resourceKey+"']"),_.each(resource[resourceKey],function(value,contentName){return _.isString(contentName)&&!contentName.match(/^\$/)?resourceElement.attr(contentName.replace("_","-"),"resources["+index+"]['"+resourceKey+"']."+contentName):void 0}),element.append($compile(resourceElement)(scope));break}return resource.open?tabbedResourcesCtrl.activateResource(resource):void 0})})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskFeed",["$timeout","Submitter",function($timeout,Submitter){return{replace:!0,restrict:"E",scope:!0,controller:"SelectionController",template:'<div>\n  <p class="tsm">\n    <span class="dib mrxs ttu twb">Tasks</span>\n    <span class="tcs">( {{tasksCompletedCount}}/{{tasksCount}} Complete )</span>\n  </p>\n  <ol class="taskList has-widget mbm">\n    <task-feed-task ng-repeat="task in tasks" task-data="task" index="{{$index}}" ng-click="setCurrentTask(task)"></task-feed-task>\n  </ol>\n</div>',link:function(scope){var addTask,currentTask,firstTask,getNextTask,page,scrollToTask,scrolledTasks,setCurrentTask,submitter,tasks;return page=scope.$page,tasks=page.tasks.tasks,scrolledTasks=[],currentTask=null,submitter=Submitter.get(scope.$course,scope.$page),addTask=function(task){return task&&!_.contains(scope.tasks,task)?scope.tasks.push(task):void 0},getNextTask=function(task){var nextTaskIndex;return nextTaskIndex=_.indexOf(tasks,task)+1,nextTaskIndex<tasks.length?tasks[nextTaskIndex]:void 0},setCurrentTask=function(task){return task?(currentTask=task,scope.setCurrentActiveIndex(_.indexOf(tasks,currentTask))):void 0},scrollToTask=function(task){return _.contains(scrolledTasks,task)||scrolledTasks.push(task),$timeout(function(){var scrollToElement,taskIndex;return taskIndex=_.indexOf(tasks,task),scrollToElement=$(".taskList li[index="+taskIndex+"]"),scope.$emit("challengeFeed:scroll",{courseIdentifier:scope.$course.identifier,queryString:page.$meta.query_string,scrollToElement:scrollToElement})})},scope.tasks=[],scope.setCurrentTask=setCurrentTask,scope.tasksCompletedCount=0,scope.tasksCount=tasks.length,firstTask=_.first(tasks),addTask(firstTask),setCurrentTask(firstTask),submitter.on("complete",function(report){var completedTaskCount,lastTask,task;for(scope.report=report,task=currentTask||firstTask;task&&report.taskPassed(task.name);)task=getNextTask(task),addTask(task);return setCurrentTask(task),lastTask=_.last(scope.tasks),_.contains(scrolledTasks,lastTask)||scrollToTask(lastTask),completedTaskCount=0,_.each(scope.tasks,function(task){return report.taskPassed(task.name)?completedTaskCount++:void 0}),scope.tasksCompletedCount=completedTaskCount})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskFeedTask",["$timeout","Submitter","CampusEvent",function($timeout,Submitter){return{replace:!0,restrict:"E",require:"^taskFeed",scope:!0,template:"<li support-widget-manager class='card card--a widget widget--support taskList-item has-widget-toggle' ng-class=\"{'is-active': isActive(index), 'is-correct': isCorrect, 'is-incorrect': isIncorrect && !hasFailureWithoutTask, 'is-warning': isIncorrect && hasFailureWithoutTask, 'is-submitting': isSubmitting, 'is-helping': supportOverlayOpen}\">\n  <support-widget-button></support-widget-button>\n  <support-widget-overlay>\n    <i class='icn icn--video--alt--b widget-overlay-icon mrxs'></i>\n    <watch-video-button class='widget-overlay-link widget-overlay-link-text' video-data=\"task.video\" video-directive='blackboard-video-player' directive-options=\"autoplay='true' allow-downloads='true'\"></watch-video-button>\n    <get-task-answer-button ng-model=\"answer.content\" overlay=true></get-task-answer-button>\n  </support-widget-overlay>\n\n  <div class='widget-content widget-md'>\n    <div class='taskList-item-instructions' compile-html=\"{{task.body}}\"></div>\n  </div>\n\n  <div class='widget-footer widget-md' compile-html=\"{{answer.content}}\" ng-if=\"answer.content\"></div>\n</li>",link:function(scope,element,attrs){var checkComplete,clearStatus,course,page,report,submitter,task;return course=scope.$course,page=scope.$page,task=scope.task,report=scope.report,submitter=Submitter.get(course,page),scope.answer={},scope.index=parseInt(attrs.index,10),clearStatus=function(){return scope.hasFailureWithoutTask=null,scope.isCorrect=null,scope.isIncorrect=null},checkComplete=function(report){return scope.hasFailureWithoutTask=report.hasFailureWithoutTask(),scope.isCorrect=report.taskPassed(task.name),scope.isIncorrect=!scope.isCorrect},submitter.on("start",function(){return scope.isActive(scope.index)?(clearStatus(),scope.isSubmitting=!0):void 0}),submitter.on("complete",checkComplete),submitter.on("finally",function(){return scope.isSubmitting=!1}),clearStatus(),report&&report.taskPassed(task.name)?checkComplete(report):void 0}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskList",["Submitter","CampusEvent",function(Submitter,CampusEvent){return{replace:!0,restrict:"E",scope:!0,controller:"SelectionController",template:'<div class="task-list">\n  <div class="group mbs">\n    <h3 class="fl">Tasks</h3>\n    <ol class="list list--object dotList fr">\n      <task-list-dot ng-repeat="task in tasks" task-data="task" index="{{$index}}" detect-task="{{detectTask}}"></task-list-dot>\n    </ol>\n  </div>\n\n  <ol class="has-widget mbm" ng-show="currentActiveIndex >= 0">\n    <task-list-task ng-repeat="task in tasks" task-data="task" index="{{$index}}" answer-by="{{answerBy}}"></task-list-task>\n  </ol>\n  \n  <div class=\'card card--a mbm widget-content widget-md\' ng-show="currentActiveIndex < 0">\n    All tasks have been completed!\n  </div>\n</div>',link:function(scope,element,attrs){var page,submitter;return page=scope.$page,scope.detectTask=attrs.detectTask,scope.answerBy=attrs.answerBy,scope.tasks=page.tasks.tasks,scope.setCurrentActiveIndex(0),submitter=Submitter.get(scope.$course,scope.$page),"event"===attrs.detectTask?(scope.setCurrentActiveIndex(0),CampusEvent.on("task:index:change",scope.setCurrentActiveIndex),scope.$on("$destroy",function(){return CampusEvent.off("task:index:change",scope.setCurrentActiveIndex)})):submitter.on("complete",function(report){var failedTaskIndex;return report.success()?scope.setCurrentActiveIndex(-1):(failedTaskIndex=page.$taskIndex(report.failedTask()),-1!==failedTaskIndex?scope.setCurrentActiveIndex(failedTaskIndex):void 0)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskListDot",["$timeout","Submitter","CampusEvent",function($timeout,Submitter,CampusEvent){return{replace:!0,restrict:"E",require:"^taskList",scope:!0,template:'<li class="list-item dotList-item" ng-class="{\'is-active\': isActive(index), \'is-complete\': isComplete, \'is-submitting\': isSubmitting}">\n  <a href="" class="dotList-item-link" ng-click="activateResource()" analytics-on analytics-event="Task Dot" analytics-properties="{task: \'{{task.name}}\'}">\n    <b class="srt">Task {{index + 1}}</b>\n  </a>\n</li>',link:function(scope,element,attrs){var flashErrorIndicator,setActive,submitter;return submitter=Submitter.get(scope.$course,scope.$page),scope.index=parseInt(attrs.index,10),scope.isComplete=!1,scope.activateResource=function(){return scope.setCurrentActiveIndex(scope.index)},"event"===attrs.detectTask?(setActive=function(index){return scope.isComplete=scope.index<=index-1||-1===index?!0:!1},CampusEvent.on("task:index:change",setActive),scope.$on("$destroy",function(){return CampusEvent.off("task:index:change",setActive)})):(submitter.on("start",function(){return scope.isActive(scope.index)?flashErrorIndicator():void 0}),submitter.on("complete",function(report){var failedTaskIndex;return report.success()?(scope.isSubmitting=!1,scope.isComplete=!0):(failedTaskIndex=scope.$page.$taskIndex(report.failedTask()),-1!==failedTaskIndex&&(scope.isComplete=scope.index<failedTaskIndex?!0:!1),scope.isSubmitting=scope.index===failedTaskIndex)})),flashErrorIndicator=function(){return scope.isSubmitting=!1,$timeout(function(){return scope.isSubmitting=!0},300)}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskListTask",function(){return{replace:!0,restrict:"E",require:["^taskList"],scope:!0,template:"<li support-widget-manager class='card card--a widget widget--task widget--support has-widget-toggle task-list-task' ng-class=\"{'is-complete': isComplete, 'is-active': isActive(index), 'is-helping': supportOverlayOpen}\">\n  <support-widget-button></support-widget-button>\n  <support-widget-overlay>\n    <i class='icn icn--video--alt--b widget-overlay-icon mrxs'></i>\n    <watch-video-button class='widget-overlay-link widget-overlay-link-text' video-data=\"task.video\" video-directive='blackboard-video-player' directive-options=\"autoplay='true' allow-downloads='true'\"></watch-video-button>\n    <get-task-answer-button ng-model=\"answer.content\" overlay=true answer-by=\"{{answerBy}}\"></get-task-answer-button>\n  </support-widget-overlay>\n\n  <div class='widget-content widget-md'>\n    <div compile-html=\"{{task.body}}\"></div>\n  </div>\n\n  <div class='widget-footer widget-md' compile-html=\"{{answer.content}}\" ng-if=\"answer.content && answerBy != 'event'\"></div>\n</li>",link:function(scope,element,attrs){var course,page,task;return course=scope.$course,page=scope.$page,task=scope.task,scope.answerBy=attrs.answerBy,scope.answer={},scope.index=parseInt(attrs.index,10)}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("taskSummary",function(){return{replace:!0,restrict:"E",scope:!0,template:'<ul class="list list--md">\n  <li class="list-item" ng-repeat="task in tasks">\n    <h4>Objective {{$index + 1}}</h4>\n    <div compile-html="{{task.body}}"></div>\n  </li>\n</ul>',link:function(scope){return scope.currentContent.data().then(function(contentData){return scope.tasks=contentData.attributes.tasks})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("testControls",["$rootScope","$q","CourseMap","TestService",function($rootScope,$q,CourseMap,TestService){return{restrict:"E",replace:!0,scope:!0,template:"<div class=\"omnibar-btn btnList\">\n  <div class='btnList-btn'>\n    <a ng-click='collapseAll()' href='' class='btn btn--next'>\n      <b class='loader-text'>Collapse All</b>\n    </a>\n  </div>\n  <div class='btnList-btn'>\n    <a ng-click='expandAll()' href='' class='btn btn--next'>\n      <b class='loader-text'>Expand All</b>\n    </a>\n  </div>\n  <div class='btnList-btn'>\n    <a ng-click='runAll()' href='' class='btn btn--next' ng-class=\"{'is-submitting': isSubmitting}\">\n      <b class='loader-text'>Run All Levels</b>\n      <span class='loader-el'></span>\n    </a>\n  </div>\n</div>",link:function(scope){var completeSubmission,courseMap,startSubmission,testService;return courseMap=new CourseMap(scope.$course),testService=new TestService(scope.$course),scope.isSubmitting=!1,startSubmission=function(){return scope.isSubmitting=!0},completeSubmission=function(){return scope.isSubmitting=!1},testService.on("start",startSubmission),testService.on("complete",completeSubmission),testService.on("error",completeSubmission),scope.collapseAll=function(){return courseMap.collapseAll()},scope.expandAll=function(){return courseMap.expandAll()},scope.runAll=function(){return testService.run(scope.$course)},scope.$on("$destroy",function(){return testService.off("start",startSubmission),testService.off("complete",completeSubmission),testService.off("error",completeSubmission)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testMap",function(){return{replace:!0,restrict:"E",scope:!0,template:"<div class='map'>\n  <ol class='map-list'>\n    <test-map-level ng-repeat='level in levels' level=\"level\" url-params=\"{{appendToUrls}}\" level-index='{{$index}}'></test-map-level>\n  </ol>\n</div>",link:function(scope,element,attrs){return scope.urlParams=attrs.urlParams,scope.appendToUrls=null,scope.$course.$levels().then(function(levels){return scope.levels=levels})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("testMapAttempt",["TestService",function(TestService){return{replace:!0,restrict:"E",scope:!0,template:"<li class='map-level-item map-level-attempt-title map-level-item--{{pageType()}}' ng-class='{\"is-complete\": isComplete, \"is-incorrect\": isIncorrect}'>\n  <a ng-href='/admin/courses/{{$course.identifier}}/{{queryString}}/test' title='{{message}}' ng-click=\"runAttempt($event)\">{{attempt.name}}</a>\n</li>",link:function(scope,element,attrs){var attempt,completeReport,error,errorReport,level,page,report,section,startReport,testService;return level=scope.level,section=scope.section,page=scope.page,attempt=scope.$parent[attrs.attempt],testService=new TestService(scope.$course),report=testService.getReport(page,attempt),error=testService.getError(page,attempt),scope.attempt=attempt,scope.queryString=page.$meta.query_string,scope.isComplete=!!report||!!error,scope.isIncorrect=error||report&&!report.success(),scope.message=report&&report.message()||error,startReport=function(){return scope.isComplete=!1,scope.isIncorrect=!1},completeReport=function(report){return scope.isComplete=!0,scope.isIncorrect=!report.success(),scope.message=report.message()},errorReport=function(error){return scope.isComplete=!0,scope.isIncorrect=!0,scope.message=error},testService.on("start",startReport),testService.on("complete:"+page.$meta.uid+":"+attempt.name,completeReport),testService.on("error:"+page.$meta.uid+":"+attempt.name,errorReport),scope.pageType=function(){return page.type.replace(/_/,"-")},scope.runAttempt=function(event){return event.preventDefault(),testService.run(page,attempt),!1},scope.$on("$destroy",function(){return testService.off("start",startReport),testService.off("complete:"+page.$meta.uid+":"+attempt.name,completeReport),testService.off("error:"+page.$meta.uid+":"+attempt.name,errorReport)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testMapLevel",["CampusUrl","CourseMap","TestService",function(CampusUrl,CourseMap,TestService){return{replace:!0,restrict:"E",scope:!0,template:"<li class='card card--a map-level' title=\"{{message}}\" ng-class=\"{'is-complete': isCorrect, 'is-incorrect': isIncorrect, 'is-expanded': levelPages.length > 0}\">\n  <div class='badge badge--offset map-badge' badge-progress=\"progress\" ng-click='expandContainer($event)'>\n    <img width=110 height=110 ng-src='{{badgeUrl(achievement.badge)}}' alt='Placeholder Badge' class='badge-img' ng-error='usePlaceholder($event)' />\n  </div>\n\n  <header class='map-level-header map-level-cell' ng-click='expandContainer($event)'>\n    <h2 class='map-level-label'>Level {{index}}</h2>\n    <h3 class='map-level-title'>\n      <a href=\"#\" ng-click='runAll($event)'><i class=\"icn icn--video--alt--c\"></i></a>\n      <a ng-href='/admin/courses/{{$course.identifier}}/edit' ng-click=\"goToAdmin($event)\" class='expand-on-click'>{{level.name}}</a>\n      <!--<span class='map-level-title-label'>{{totalComplete}}/{{totalPages}} Complete</span>-->\n    </h3>\n  </header>\n\n  <div class='map-level-section map-level-cell'>\n    <ol class='map-level-section-list'>\n      <test-map-page ng-repeat-start='page in levelPages' ng-if=\"isPage(page)\" page=\"page\"></test-map-page>\n      <test-map-section ng-repeat-end ng-if=\"isSection(page)\" section=\"page\"></test-map-section>\n    </ol>\n  </div>\n</li>",link:function(scope,element,attrs){var collapse,completeReport,course,courseMap,errorReport,errors,expand,level,report,startReport,testService,uid,_ref;return course=scope.$course,level=scope.$parent[attrs.level],courseMap=new CourseMap(course),testService=new TestService(scope.$course),uid=level.$meta.uid,report=testService.getReport(level),errors=testService.getError(level),scope.level=level,scope.uid=attrs.uid,scope.index=parseInt(attrs.levelIndex,10)+1,scope.urlParams=attrs.urlParams,scope.isCorrect=null!=report?report.success():void 0,scope.isIncorrect=(null!=errors?errors.length:void 0)>0||report&&report.success(),scope.message=(null!=(_ref=_.first(errors))?_ref.message:void 0)||report&&report.message(),course.$achievementFor(level).bind(scope,"achievement"),scope.badgeUrl=function(path){return path?CampusUrl.badgeUrl(path):void 0},expand=function(level){return level.$tests().then(function(contents){return scope.levelPages=contents})},collapse=function(){return scope.levelPages=[]},courseMap.on("expanded:"+uid,expand),courseMap.on("collapsed:"+uid,collapse),startReport=function(){return scope.isCorrect=!1,scope.isIncorrect=!1},completeReport=function(report){return scope.isCorrect=report.success(),scope.isIncorrect=!scope.isCorrect,scope.message=report.message(),scope.isIncorrect?courseMap.expand(level):void 0},errorReport=function(errors){return scope.isCorrect=!1,scope.isIncorrect=!scope.isCorrect,scope.message=_.first(errors).message,scope.isIncorrect?courseMap.expand(level):void 0},testService.on("start",startReport),testService.on("complete:"+uid,completeReport),testService.on("error:"+uid,errorReport),courseMap.isExpanded(level)&&scope.isIncorrect?expand(level):collapse(level),scope.usePlaceholder=function(evt){$(evt.currentTarget).attr("src",CampusUrl.appImageUrl("badge-default.png"))
},scope.isSection=function(page){return CourseMap.isSection(page)},scope.isPage=function(page){return!CourseMap.isSection(page)},scope.expandContainer=function(){courseMap.isExpanded(level)?courseMap.collapse(level):courseMap.expand(level)},scope.runAll=function(evt){return evt.stopPropagation(),evt.preventDefault(),testService.run(level),!1},scope.goToAdmin=function(evt){return evt.preventDefault(),!1},scope.$on("$destroy",function(){return courseMap.off("expanded:"+uid,expand),courseMap.off("collapsed:"+uid,collapse),testService.off("start",startReport),testService.off("complete:"+uid,completeReport),testService.off("error:"+uid,errorReport)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testMapPage",["$q","$state","CourseMap","TestService",function($q,$state,CourseMap,TestService){return{replace:!0,restrict:"E",scope:!0,template:'<li class=\'map-level-item map-level-item--{{pageType()}}\' title="{{message}}" ng-class=\'{"is-complete": isComplete, "is-incorrect": isError, "is-closed": !isExpanded}\' ng-click="gotoPage($event)">\n  <a href="#" ng-click=\'runAll($event)\'><i class="icn icn--video--alt--c"></i></a>\n  <a ng-href=\'/admin/courses/{{$course.identifier}}/{{queryString}}/test\' class=\'expand-on-click\' ng-click=\'expandContainer($event)\'>{{page.name}}</a>\n  <ol class=\'map-level-attempt-list\' ng-if="isExpanded">\n    <test-map-attempt attempt="attempt" ng-repeat="attempt in attempts"></test-map-attempt>\n  </ol>\n</li>',link:function(scope,element,attrs){var collapse,completeReport,courseMap,errorReport,errors,expand,level,page,report,section,startReport,testService,uid,_ref;return level=scope.level,section=scope.section,page=scope.$parent[attrs.page],uid=page.$meta.uid,courseMap=new CourseMap(scope.$course),testService=new TestService(scope.$course),report=testService.getReport(page),errors=testService.getError(page),scope.page=page,scope.queryString=page.$meta.query_string,scope.isExpanded=courseMap.isExpanded(page),scope.isComplete=!!errors||!!report,scope.isError=(null!=errors?errors.length:void 0)>0||report&&!report.success(),scope.message=(null!=(_ref=_.first(errors))?_ref.message:void 0)||report&&report.message(),expand=function(page){return page.$attempts().then(function(attempts){return scope.isExpanded=!0,scope.attempts=attempts})},collapse=function(){return scope.isExpanded=!1,scope.attempts=[]},courseMap.on("expanded:"+uid,expand),courseMap.on("collapsed:"+uid,collapse),startReport=function(){return scope.isComplete=!1,scope.isError=!1},completeReport=function(report){return scope.isComplete=!0,scope.isError=!report.success(),scope.message=report.message(),scope.isError?courseMap.expand(page):void 0},errorReport=function(errors){return scope.isComplete=!0,scope.isError=!0,scope.message=_.first(errors).message,scope.isError?courseMap.expand(page):void 0},testService.on("start",startReport),testService.on("complete:"+uid,completeReport),testService.on("error:"+uid,errorReport),courseMap.isExpanded(page)||scope.isError?expand(page):collapse(page),scope.pageType=function(){return page.type.replace(/_/,"-")},scope.expandContainer=function(evt){return evt.preventDefault(),courseMap.isExpanded(page)?courseMap.collapse(page):courseMap.expand(page),!1},scope.runAll=function(evt){return evt.preventDefault(),testService.run(page),!1},scope.$on("$destroy",function(){return courseMap.off("expanded:"+uid,expand),courseMap.off("collapsed:"+uid,collapse),testService.off("start",startReport),testService.off("complete:"+uid,completeReport),testService.off("error:"+uid,errorReport)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testMapSection",["$q","$state","CourseMap","TestService",function($q,$state,CourseMap,TestService){return{replace:!0,restrict:"E",scope:!0,template:'<li class="map-level-item" title="{{message}}" ng-class=\'{"is-complete": isComplete, "is-correct": isCorrect, "is-incorrect": isIncorrect}\' ng-click="gotoPage($event)">\n  <h4 class=\'map-level-section-title\'>\n    <a href="#" ng-click=\'runAll($event)\'><i class="icn icn--video--alt--c"></i></a>\n    <a ng-href=\'/admin/courses/{{$course.identifier}}/edit\' ng-click=\'goToAdmin($event)\'>{{section.name}}</a>\n  </h4>\n  <ol class=\'map-level-list\'>\n    <test-map-page ng-repeat=\'page in pages\' page=\'page\' append-to-urls="{{appendToUrls}}"></test-map-page>\n  </ol>\n</li>',link:function(scope,element,attrs){var completeReport,courseMap,errorReport,errors,level,report,section,startReport,testService,uid,_ref;return courseMap=new CourseMap(scope.$course),testService=new TestService(scope.$course),level=scope.level,section=scope.$parent[attrs.section],uid=section.$meta.uid,report=testService.getReport(section),errors=testService.getError(section),scope.section=section,scope.queryString=section.$meta.query_string,scope.isComplete=!!errors||!!report,scope.isCorrect=null!=report?report.success():void 0,scope.isIncorrect=(null!=errors?errors.length:void 0)>0||report&&!report.success(),scope.message=(null!=(_ref=_.first(errors))?_ref.message:void 0)||report&&report.message(),section.$tests().then(function(pages){return scope.pages=pages}),startReport=function(){return scope.isComplete=!1,scope.isCorrect=!1,scope.isIncorrect=!1},completeReport=function(report){return scope.isComplete=!0,scope.isCorrect=report.success(),scope.isIncorrect=!scope.isCorrect,scope.message=report.message(),scope.isIncorrect?courseMap.expand(section):void 0},errorReport=function(errors){return scope.isComplete=!0,scope.isCorrect=!1,scope.isIncorrect=!scope.isCorrect,scope.message=_.first(errors).message,scope.isIncorrect?courseMap.expand(section):void 0},testService.on("start",startReport),testService.on("complete:"+uid,completeReport),testService.on("error:"+uid,errorReport),scope.runAll=function(evt){return evt.preventDefault(),testService.run(section),!1},scope.goToAdmin=function(evt){return evt.preventDefault(),!1},scope.$on("$destroy",function(){return testService.off("start",startReport),testService.off("complete:"+uid,completeReport),testService.off("error:"+uid,errorReport)})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("testRunLevels",["$rootScope","$q","TestService",function($rootScope,$q,TestService){return{restrict:"E",replace:!0,scope:!0,template:"<div class='omnibar-btn'>\n  <a ng-click='submit()' href='' class='btn btn--next' ng-class=\"{'is-submitting': isSubmitting}\">\n    <b class='loader-text'>Run All Levels</b>\n    <span class='loader-el'></span>\n  </a>\n</div>",link:function(scope){var testService;return testService=new TestService(scope.$course),scope.submit=function(){return scope.isSubmitting=!0,testService.run(rootNode).then(function(){return scope.isSubmitting=!1})}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("textContent",function(){return{restrict:"E",replace:!0,scope:!0,template:"<div class='course-text-content' ng-bind-html='textContent'></div>",link:function(scope){return scope.currentContent.attribute("text_content").then(function(textContent){return scope.textContent=textContent})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("textFile",["$compile",function(){return{restrict:"E",replace:!0,scope:{$course:"=",$page:"=",content:"=",syntax:"=",theme:"=",fileName:"=",resource:"=",resourceIndex:"@",resources:"=",tabbedResource:"@"},template:"<div class='resource resource--text'>\n  <p class='resource-fileName' ng-hide='tabbedResource'>{{fileName}}</p>\n  <code-highlight theme='{{theme}}' syntax='{{syntax}}' bind-content=\"content\"></code-highlight>\n</div>"}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("totalCourseProgress",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class="progress">\n  <div class="progress-bar" style="width: {{progress}}%;"></div>\n</div>',link:function(scope){return scope.$course.$progress().bind(scope,"progress")}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("userAchievementsEarned",["$q",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'course-user-data achievements-earned\'>\n  <span ng-if="awardedAchievementsCount != null && totalAchievementsCount() != null">\n    {{awardedAchievementsCount()}}/{{totalAchievementsCount()}}\n  </span>\n  <span ng-if="!(awardedAchievementsCount() != null && totalAchievementsCount() != null)">\n    N/A\n  </span>\n</div>',link:function(scope){return scope.$user.$awardedAchievements().bind(scope,"awardedAchievements"),scope.$user.$unawardedAchievements().bind(scope,"unawardedAchievements"),scope.awardedAchievementsCount=function(){return scope.awardedAchievements.length},scope.totalAchievementsCount=function(){return scope.awardedAchievements.length+scope.unawardedAchievements.length}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userAvatar",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'bucket-media user-media\'>\n  <img class=\'thumb thumb--m\' ng-src="http://www.gravatar.com/avatar/{{gravatar}}" width="{{width}}" height="{{height}}" />\n</div>',link:function(scope,element,attrs){return scope.height=attrs.height,scope.width=attrs.width,scope.$user.$gravatar().bind(scope,"gravatar")}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("userChallengesCompleted",["$q",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'course-user-data challenges-completed\'>\n  <span ng-if="totalRequiredPages">\n    {{requiredPagesCompleted}}/{{totalRequiredPages}}\n  </span>\n  <span ng-if="!totalRequiredPages">\n    N/A\n  </span>\n</div>',link:function(scope){return scope.$user.$requiredPagesCompleted().bind(scope,"requiredPagesCompleted"),scope.$course.$totalRequiredPages().bind(scope,"totalRequiredPages")}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userHintsUsed",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'course-user-data hints-used\'>\n  <span ng-if="usedHintsCount != null">\n    {{usedHintsCount}}\n  </span>\n  <span ng-if="usedHintsCount == null">\n    N/A\n  </span>\n</div>',link:function(scope){return scope.$user.$usedHintsCount().bind(scope,"usedHintsCount")}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("userLoginLink",["CampusUrl",function(CampusUrl){return{replace:!0,restrict:"E",scope:!0,transclude:!0,template:"<a href='{{authUrl()}}' ng-transclude analytics-on analytics-event=\"Wrap Up Login Link\"></a>",link:function(scope){return scope.authUrl=function(){return CampusUrl.authUrl()}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userName",function(){return{restrict:"E",replace:!0,scope:!0,template:"<h1 class='user-name'>{{userName}}</h1>",link:function(scope){return scope.$user.$userName().bind(scope,"userName")}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("userStats",["$templateCache","KeyboardShortcuts","$analytics",function($templateCache,KeyboardShortcuts,$analytics){return{replace:!0,restrict:"E",scope:!0,template:"<div>\n  <div ng-include='getTemplate()'></div>\n  <div class='pagerNav'>\n    <a class='toggle toggle--nav toggle--nav--prev pagerNav-toggle pagerNav-toggle--prev' href='' ng-click='getPreviousPage()' analytics-on anayltics-event=\"User Stats Previous Page\"><b class=\"srt\">Previous User Page</b></a>\n    <a class='toggle toggle--nav toggle--nav--next pagerNav-toggle pagerNav-toggle--next' href='' ng-click='getNextPage()' id='next' analytics-on anayltics-event=\"User Stats Next Page\"><b class=\"srt\">Next User Page</b></a>\n    <ol class='pagerNav-list'>\n      <li ng-repeat='node in userPages' class='pagerNav-list-item'>\n        <a class='pagerNav-list-link {{getPlaceHolderElementClass($index)}}' href='' ng-click='setIndex($index)' analytics-on analytics-event=\"User Stats Page Index\"></a>\n      </li>\n    </ol>\n  </div>\n</div>",link:function(scope){var course;return course=scope.$course,course.$userPages().then(function(userPages){return scope.userPages=userPages,scope.currentUserPageIndex=0,scope.setIndex=function(index){return scope.currentUserPageIndex=index},scope.currentUserPage=function(){return scope.userPages[scope.currentUserPageIndex]},scope.getTemplate=function(){var currentUserPage;return currentUserPage=scope.currentUserPage(),currentUserPage?currentUserPage.template:void 0},scope.getNextPage=function(){return scope.currentUserPageIndex+=1,scope.currentUserPageIndex===scope.userPages.length?scope.currentUserPageIndex=0:void 0},scope.getPreviousPage=function(){return scope.currentUserPageIndex-=1,scope.currentUserPageIndex<0?scope.currentUserPageIndex=scope.userPages.length-1:void 0},scope.getPlaceHolderElementClass=function(index){return index===scope.currentUserPageIndex?"is-active":void 0},KeyboardShortcuts.key("left",function(){return $analytics.eventTrack("Previous User Page(left)"),scope.getPreviousPage(),scope.$apply()}),KeyboardShortcuts.key("right",function(){return $analytics.eventTrack("Next User Page(right)"),scope.getNextPage(),scope.$apply()})}),scope.$on("$destroy",function(){return KeyboardShortcuts.unbind("right"),KeyboardShortcuts.unbind("left")})}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userTotalPoints",["$q",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'course-user-data total-points\'>\n  <span ng-if="possiblePoints">\n    {{totalPoints}}/{{possiblePoints}}\n  </span>\n  <span ng-if="!possiblePoints">\n    N/A\n  </span>\n</div>',link:function(scope){return scope.$user.$totalPoints().bind(scope,"totalPoints"),scope.$user.$possiblePoints().bind(scope,"possiblePoints")}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("userVideosWatched",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'course-user-data videos-watched\'>\n  <span ng-if="videoPagesCount">\n    {{completedVideoPagesCount}}/{{videoPagesCount}}\n  </span>\n  <span ng-if="!videoPagesCount">\n    N/A\n  </span>\n</div>',link:function(scope){return scope.$course.$videoPagesCount().bind(scope,"videoPagesCount"),scope.$course.$completedVideoPagesCount().bind(scope,"completedVideoPagesCount").then(function(){})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("watchVideoButton",["OpenModal",function(OpenModal){return{restrict:"E",replace:!0,scope:!0,template:"<a href='' class='' ng-click='showVideo()' analytics-on analytics-event=\"Rewatch Video\">Rewatch Video</a>",link:function(scope,element,attrs){var showModal;return showModal=null,scope.videoDirective=attrs.videoDirective,scope.directiveOptions=attrs.directiveOptions,attrs.videoData&&scope.$parent.$watch(attrs.videoData,function(videoData){return scope.videoData=videoData}),scope.showVideo=function(){return showModal||(showModal=OpenModal.show({modalClass:"modal--video",scope:scope,template:"<"+scope.videoDirective+" "+scope.directiveOptions+" class='video--modal'></"+scope.videoDirective+">"})),showModal.then(function(modal){return modal.$show()})}}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("whenLoggedIn",function(){return{restrict:"A",link:function(scope,element){return scope.currentUser.loggedIn().then(function(isLoggedIn){return isLoggedIn?void 0:element.remove()})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("whenNotLoggedIn",function(){return{restrict:"A",link:function(scope,element){return element.hide(),scope.$user.$isLoggedIn().then(function(isLoggedIn){return isLoggedIn?element.remove():element.show()})}}})}.call(this),function(){angular.module("campusTemplateDirectives").directive("youtubeVideo",["$sce",function($sce){return{replace:!0,restrict:"E",scope:!0,template:'<iframe width="1280" height="720" src="{{youtubeVideoId}}" frameborder="0" allowfullscreen></iframe>',link:function(scope){return scope.youtubeVideoId=$sce.trustAsResourceUrl("http://www.youtube.com/embed/"+scope.$page.youtube_video+"?rel=0&showinfo=0&autohide=1")}}}])}.call(this),function(){angular.module("campusTemplateDirectives").directive("incompleteChallengeList",["NextChallengeButton","$state",function(NextChallengeButton,$state){return{replace:!0,restrict:"E",scope:!0,template:'<div class="map map--f">\n  <ol class="map-list map-level-list">\n    <li class=\'map-level-item map-level-item--{{formatType(page.type)}}\' ng-repeat="page in pages">\n      <a href=\'\' ng-click="gotoPage(page)" analytics-on analytics-event="Incomplete Challenge" analytics-properties="{page: \'{{page.$meta.query_string}}\'}">{{page.name}}</a>\n    </li>\n  </ol>\n</div>',link:function(scope,element,attrs){var parent;return parent=attrs.parent||"level","level"===parent?scope.$level.$incompleteChallenges().bind(scope,"pages"):"course"===parent&&scope.$course.$incompleteChallenges().bind(scope,"pages"),scope.formatType=function(type){return type.split("_").join("-")},scope.gotoPage=function(page){return NextChallengeButton.overrideNextQueryString(scope.$page.$meta.query_string),$state.go("root.courseContent",{queryString:page.$meta.query_string})}}}}])}.call(this),function(){angular.module("campus",["ui.router","ngSanitize","ngCookies","campusServices","campusTemplateDirectives","campusFilters","campusLib","angulartics","angulartics.segment"]),angular.module("campus").run(["$rootScope","$state","$stateParams","Logger","$analytics",function($rootScope,$state,$stateParams,Logger,$analytics){return $rootScope.$state=$state,$rootScope.$stateParams=$stateParams,$rootScope.$on("$locationChangeSuccess",function(event,newUrl){return $analytics.pageTrack(newUrl)}),$rootScope.$on("$stateChangeError",function(event,toState,toParams,fromState,fromParams,error){return 401===error.status?$state.go("root.courseContent",{courseIdentifier:this.courseIdentifier,queryString:"subscribe"}):(Logger.error("An Error occurred while transitioning to state :"),Logger.error(error))})}])}.call(this),function(){angular.module("campus").config(["LoggerProvider","$httpProvider","$analyticsProvider",function(LoggerProvider,$httpProvider,$analyticsProvider){return LoggerProvider.debugEnabled(!1),LoggerProvider.errorEnabled(!1),LoggerProvider.infoEnabled(!1),LoggerProvider.warnEnabled(!1),$httpProvider.defaults.headers.common["X-CSRF-Token"]=$("meta[name=csrf-token]").attr("content"),$analyticsProvider.withBase(!0),$analyticsProvider.firstPageview(!1),$analyticsProvider.virtualPageviews(!1),$analyticsProvider.settings.pageTracking.basePath=$analyticsProvider.settings.pageTracking.basePath.replace(/\/$/g,""),$analyticsProvider.developerMode(!1)}])}.call(this),function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize){if(analytics.invoked)return window.console&&console.error&&console.error("Segment snippet included twice."),void 0;analytics.invoked=!0,analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"],analytics.factory=function(method){return function(){var args=Array.prototype.slice.call(arguments);return args.unshift(method),analytics.push(args),analytics}};for(var i=0;i<analytics.methods.length;i++){var key=analytics.methods[i];analytics[key]=analytics.factory(key)}analytics.load=function(key){var script=document.createElement("script");script.type="text/javascript",script.async=!0,script.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+key+"/analytics.min.js";var first=document.getElementsByTagName("script")[0];first.parentNode.insertBefore(script,first)},analytics.SNIPPET_VERSION="3.1.0",analytics.load("vGCNkxWxakg82FOF6Kfq3m9HL2PDpnRU")}}(),function(){angular.module("campus").controller("pageTitleController",["$scope","CourseContentData","CourseQueryStringIndex","$rootScope","$q",function($scope,CourseContentData,CourseQueryStringIndex,$rootScope,$q){var stopRootWatch,updateTitle;return $scope.pageTitle="",updateTitle=function(courseTitle,pageTitle){return $scope.pageTitle=pageTitle?""+pageTitle+" - "+courseTitle:courseTitle},stopRootWatch=$rootScope.$watch("queryString",function(queryString){var contentData,courseUid,queryStringUid;return $rootScope.courseIdentifier?(contentData=new CourseContentData($rootScope.courseIdentifier),courseUid=CourseQueryStringIndex.getUid($rootScope.courseIdentifier,"/"),queryString?(queryStringUid=CourseQueryStringIndex.getUid($rootScope.courseIdentifier,queryString),$q.all([contentData.get(courseUid),contentData.get(queryStringUid)]).then(function(data){var rootContentData;return rootContentData=data[0],contentData=data[1],updateTitle(rootContentData.name,contentData.name)})):contentData.get(courseUid).then(function(rootContentData){return updateTitle(rootContentData.name,null)})):void 0}),$scope.$on("$destroy",function(){return stopRootWatch()})}])}.call(this),function(){angular.module("campus").directive("builderOmnibar",["$state",function(){return{restrict:"E",replace:!0,scope:!0,template:"<div class='omnibar'>\n  <div class='omnibar-toggle'>\n    <course-map-button url-params=\"{'template': 'client_tests'}\"></course-map-button>\n  </div>\n</div>"}}])}.call(this),function(){angular.module("campus").directive("campus",["CurrentCourseConfig","$templateCache","CacheKey","DataBootstrapper","$rootScope",function(CurrentCourseConfig,$templateCache,CacheKey,DataBootstrapper,$rootScope){return{restrict:"E",replace:!0,transclude:!0,scope:{cacheKey:"@",courseIdentifier:"@",userHasAccess:"@"},template:"<div class='campus-course'>\n  <div class='campus-course-view' ui-view></div>\n</div>",link:function(scope,element){return $rootScope.courseIdentifier=scope.courseIdentifier,$rootScope.userHasAccess="true"===scope.userHasAccess?!0:!1,(new CacheKey).validateCacheKey(scope.courseIdentifier,scope.cacheKey),(new DataBootstrapper).load(scope.courseIdentifier),new CurrentCourseConfig(scope.courseIdentifier).get("course_state").then(function(courseState){return"beta"===courseState?element.addClass("is-beta"):"alpha"===courseState?element.addClass("is-alpha"):void 0})}}}])}.call(this),function(){angular.module("campus").directive("codeHighlight",["CampusUtil","FillInBlankParser","$interpolate",function(CampusUtil,FillInBlankParser){return{restrict:"E",replace:!0,transclude:!0,scope:!0,template:"<pre data-lang='{{syntax}}' class=\"code-highlight inputs-replaced\"></pre>",link:function(scope,element,attrs,ctrl,transclude){var isDomElement;return scope.syntax=attrs.syntax,scope.theme=attrs.theme,scope.bindContent=attrs.bindContent,isDomElement=function(object){return"object"==typeof HTMLElement?object instanceof HTMLElement:object&&"object"==typeof object&&null!==object&&1===object.nodeType&&"string"==typeof object.nodeName},scope.syntax=CampusUtil.filterSyntax(scope.syntax),"null"===scope.theme&&(scope.theme=null),scope.addFillInTheBlank=function(cursor){var widget;if(!scope.codeEditor.findMarksAt(cursor.from()).length)return widget=FillInBlankParser.convert(scope.$parent,scope.codeEditor.getRange(cursor.from(),cursor.to())),scope.codeEditor.markText(cursor.from(),cursor.to(),{replacedWith:widget,clearOnEnter:!1})},scope.updateHighlight=function(){return scope.$course.$getAllConfig().then(function(config){var content,firstLineNumber,foldGutter,gutters,hasInputs,hasLineNumbers,searchCursor;if(firstLineNumber=parseInt(attrs.firstLineNumber,10)||1,hasLineNumbers="true"===attrs.lineNumbers,hasInputs=FillInBlankParser.hasInputs(element.text()),hasLineNumbers||hasInputs){if(content=element.text(),element.empty(),foldGutter=!hasInputs,gutters=["CodeMirror-linenumbers"],foldGutter&&gutters.push("CodeMirror-foldgutter"),scope.codeEditor=new CodeMirror(element[0],{value:content,mode:CampusUtil.filterSyntax(scope.syntax),theme:scope.theme||config.default_editor_theme||"default",tabSize:2,lineNumbers:hasLineNumbers,firstLineNumber:firstLineNumber,autofocus:!1,readOnly:!0,cursorBlinkRate:0,foldGutter:!hasInputs,electricChars:!1,lineWrapping:!1,gutters:gutters}),hasInputs){for(searchCursor=scope.codeEditor.getSearchCursor(FillInBlankParser.placeholderRegex());searchCursor.findNext();)scope.addFillInTheBlank(searchCursor);element.addClass("codeEditor").addClass("codeEditor--fillInBlank")}return!0}return CodeMirror.runMode(element.text(),CampusUtil.filterSyntax(scope.syntax),element[0]),element.addClass("cm-s-"+(scope.theme||config.default_editor_theme||"default"))})},scope.bindContent?scope.$parent.$watch(scope.bindContent,function(content){return element.empty(),element.text(content),scope.updateHighlight()}):transclude(scope,function(clonedElement){return element.empty(),element.text(clonedElement.text()),scope.updateHighlight()})}}}])}.call(this),function(){angular.module("campus").directive("courseBar",["CampusUrl",function(CampusUrl){return{restrict:"E",replace:!0,scope:!0,template:"<header class='bar courseBar has-dropdown'>\n  <div class='bar-item bar-item--west'>\n    <div class='brand' itemscope itemtype='http://schema.org/Organization'>\n      <a itemprop='url' class='brand-link' ui-sref='root.courseContent({queryString: \"\"})'>\n        <img itemprop='logo' class='brand-img' ng-src='{{logoImage}}' />\n      </a>\n    </div>\n  </div>\n\n  <div class='bar-item bar-item--east'>\n    <session class='has-menu'></session>\n  </div>\n</header>",link:function(scope){return scope.$course.$getConfig("course_logo").then(function(courseLogo){return scope.logoImage=CampusUrl.imageUrl(courseLogo||"logo-course.png")})}}}])}.call(this),function(){angular.module("campus").directive("courseData",["$rootScope","$templateCache","$compile","$interpolate","$timeout",function($rootScope,$templateCache,$compile,$interpolate,$timeout){return{replace:!0,restrict:"E",scope:!0,template:"<div class= 'content-data' ng-class='{\"is-complete\": progress == 100, \"is-editing\": isEditing, \"is-loading\": isLoading}'>\n  <div class='course-content {{getTemplateUrl()}}'></div>\n</div>",link:function(scope,element,attrs){var compileHtml,courseContent,hasContent,interpolatedElement,templateHtml,templateName;return scope.isLoading=!0,courseContent=element.find(".course-content"),templateName=attrs.template||scope.template,templateHtml=$templateCache.get(templateName),hasContent=!!templateHtml&&!/^\s*$/.test(templateHtml),hasContent?(interpolatedElement=angular.element("<div></div>").html(templateHtml),compileHtml=$compile(interpolatedElement),compileHtml(scope,function(compiledHtml){return courseContent.empty(),courseContent.append(compiledHtml),$timeout(function(){return scope.isLoading=!1},200)}),scope.$page.$progress().bind(scope,"progress")):courseContent.empty(),scope.getTemplateUrl=function(){return $templateCache.get(scope.template)?scope.template.replace(/\//g,"-"):void 0}}}}])}.call(this),function(){angular.module("campus").directive("courseWindow",function(){return{restrict:"E",replace:!0,scope:!0,controller:["$scope","$rootScope","$stateParams",function($scope,$rootScope,$stateParams){var defaultUiOptions,rootListenerOff,setDefaultOptions;defaultUiOptions={omnibar:!0,courseBar:!0},rootListenerOff=$rootScope.$on("$stateChangeStart",function(){return setDefaultOptions()}),setDefaultOptions=function(){return $scope.optionalUi=_.clone(defaultUiOptions)},setDefaultOptions(),this.go=function(to,toParams,options,transitionClass){return $scope.go(to,toParams,options,transitionClass)},this.enableNav=function(navName){return $scope.optionalUi[navName]=!0},this.disableNav=function(navName){return $scope.optionalUi[navName]=!1},this.navEnabled=function(navName){return $scope.optionalUi[navName]},$scope.enabledUiClasses=function(){var classArray;return classArray=[],_.each($scope.optionalUi,function(value,uiName){return value?classArray.push("is-"+S(uiName).dasherize().s+"-enabled"):void 0}),classArray.join(" ")},void 0!==$stateParams.bars&&("false"===$stateParams.bars?(this.disableNav("omnibar"),this.disableNav("courseBar")):"true"===$stateParams.bars&&(this.enableNav("omnibar"),this.enableNav("courseBar"))),$scope.$on("$destroy",function(){return rootListenerOff()})}],template:"<div class='campus-course-window' ng-class='enabledUiClasses()'>\n  <course-bar ng-if='optionalUi.courseBar'></course-bar>\n  <flash-message></flash-message>\n  <main class='content' ui-view ></main>\n  <omnibar ng-if='optionalUi.omnibar'></omnibar>\n  <builder-omnibar ng-if='optionalUi.builderOmnibar'></builder-omnibar>\n</div>"}})}.call(this),function(){angular.module("campus").directive("disableOptionalNav",["$stateParams",function(){return{restrict:"M",require:"^courseWindow",link:function(scope,element,attrs,coursewindowCtrl){return coursewindowCtrl.disableNav(attrs.disableOptionalNav)}}}])}.call(this),function(){angular.module("campus").directive("dropdown",["$compile","$parse",function($compile,$parse){return{restrict:"E",replace:!0,require:"?ngModel",scope:{label:"@"},transclude:"true",template:"<div ng-mouseleave='hideDropdown()' class='dropdown'>\n  <a href='' class='btn btn--control btn--offset--after btn--thin dropdown-btn' ng-mouseover='showDropdown()'>{{label}}</a>\n  <ul class='dropdown-menu'></ul>\n</div>",link:function(scope,element,attrs,ngModelCtrl,transclude){var arrayString,containerElement,createMouseMask,maskElement,modelMatch,newScope,onSelectFn,removeMouseMask,repeatLoop,selectorElements,singleItemString,unWatchItems;return maskElement=angular.element('<div class="dropdown-mask"></div>'),onSelectFn=$parse(attrs.onSelect),ngModelCtrl&&(unWatchItems=scope.$watch("items",function(items){return items?(unWatchItems(),ngModelCtrl.$render=function(){var itemToSet;return itemToSet=attrs.valueKey?_.select(scope.items,function(item){return item[attrs.valueKey]===ngModelCtrl.$viewValue}):_.select(scope.items,function(item){return item===ngModelCtrl.$viewValue}),scope.setModel(null,itemToSet[0]||"")},ngModelCtrl.$render()):void 0})),createMouseMask=function(){var elementBounds,labelBounds,listBounds,mostBottom,mostLeft,mostRight,mostTop;return labelBounds=element.find("a")[0].getBoundingClientRect(),listBounds=element.find("ul")[0].getBoundingClientRect(),elementBounds=element[0].getBoundingClientRect(),mostLeft=labelBounds.left<listBounds.left?labelBounds.left:listBounds.left,mostRight=labelBounds.right>listBounds.right?labelBounds.right:listBounds.right,mostTop=labelBounds.top<listBounds.top?labelBounds.top:listBounds.top,mostBottom=labelBounds.bottom>listBounds.bottom?labelBounds.bottom:listBounds.bottom,maskElement.css({height:""+Math.abs(mostTop-mostBottom)+"px",width:""+Math.abs(mostLeft-mostRight)+"px",top:""+(mostTop-elementBounds.top)+"px",left:""+(mostLeft-elementBounds.left)+"px"}),element.append(maskElement)},removeMouseMask=function(){return maskElement.remove()},scope.setModel=function(evt,item){var modelValue;return modelValue=attrs.valueKey?item[attrs.valueKey]:item,evt&&ngModelCtrl&&ngModelCtrl.$setViewValue(modelValue),scope.selectedValue!==modelValue&&onSelectFn(scope.$parent,{$value:modelValue}),scope.selectedValue=modelValue},scope.showDropdown=function(){createMouseMask(),element.addClass("is-active")},scope.hideDropdown=function(){removeMouseMask(),element.removeClass("is-active")},repeatLoop=attrs.repeat,modelMatch=repeatLoop.match(/^\s*(.+)\s+in\s+(.*?)\s*(\s+track\s+by\s+(.+)\s*)?$/),singleItemString=modelMatch[1],arrayString=modelMatch[2],containerElement=element.find("ul"),selectorElements=[],newScope=null,scope.$parent.$watch(arrayString,function(array){return newScope&&(newScope.$destroy(),newScope=null),newScope=scope.$new(),selectorElements.length>0&&(_.each(selectorElements,function(selectorElement){return selectorElement.el.remove(),selectorElement.scope.$destroy()}),selectorElements=[]),scope.items=array,_.each(array,function(item,index){var childscope;return childscope=newScope.$new(),childscope[singleItemString]=item,transclude(childscope,function(clonedElement){var createdElement,listItemElement,valueString;return valueString=attrs.valueKey?"ng-class=\"{'is-active': selectedValue == items["+index+"]."+attrs.valueKey+'}"':"ng-class=\"{'is-active': selectedValue == items["+index+']}"',listItemElement=angular.element("<li class='dropdown-item' "+valueString+" ng-click='setModel($event, items["+index+"])'></li>"),listItemElement.append(clonedElement),containerElement.append(listItemElement),createdElement={},createdElement.el=listItemElement,createdElement.scope=childscope,selectorElements.push(createdElement)})}),$compile(containerElement)(newScope)})}}}])}.call(this),function(){angular.module("campus").directive("enableOptionalNav",["$stateParams",function(){return{restrict:"M",require:"^courseWindow",link:function(scope,element,attrs,coursewindowCtrl){return coursewindowCtrl.enableNav(attrs.enableOptionalNav)
}}}])}.call(this),function(){angular.module("campus").directive("feedItem",function(){return{restrict:"E",replace:!0,require:"^challengeFeed",transclude:!0,scope:{itemTitle:"@",state:"@"},template:"<div class=\"card card--a widget widget--feed\" ng-class=\"classifyTitle();\">\n  <div class=\"widget-header\">\n    <h3 class='widget-title'>\n      <a href='' class='widget-title-link' ng-click='toggle()'>{{itemTitle}}</a>\n    </h3>\n  </div>\n\n  <div class='widget-content widget-md' ng-transclude></div>\n</div>",link:function(scope,element,attrs,challengeFeedController){var item;return item=scope.$parent.item,scope.classifyTitle=function(){var classes;return classes=[scope.itemTitle.toLowerCase().replace(/\s/,"-")],challengeFeedController.isOpen(item)||classes.push("is-closed"),classes},scope.toggle=function(){return challengeFeedController.isOpen(item)?challengeFeedController.closeItem(item):challengeFeedController.openItem(item),null}}}})}.call(this),function(){angular.module("campus").directive("flashMessage",["FlashMessage","$timeout",function(FlashMessage,$timeout){return{replace:!1,restrict:"E",scope:{},template:"<div class='flash {{options.htmlClass}}' ng-class='{\"is-active\": isActive}' ng-click='close()' ng-if='!isHidden'>\n  <a class='flash-close' href='' ng-if='!!options.closeButton' ng-click='close()'>x</a>\n  <h2 class='flash-title' ng-if='!!options.title' compile-html=\"{{options.title}}\"></h2>\n  <p class='flash-msg' ng-if='!!options.message' compile-html=\"{{options.message}}\"></p>\n</div>",link:function(scope){var defaultOptions;return defaultOptions={closeDelay:2200,closeButton:!0,clickToClose:!0,title:null,message:null,htmlClass:""},scope.isHidden=!0,FlashMessage.isShow(function(options){return scope.options=_.extend(scope.options,options),scope.isActive=!0,$timeout(function(){return scope.isHidden=!1})}),FlashMessage.isClear(function(){return scope.isActive=!1}),scope.$watch("isActive",function(isActive){return isActive?$timeout(function(){return scope.isActive=!1},scope.options.closeDelay||3):$timeout(function(){return scope.options=_.clone(defaultOptions),scope.isHidden=!0},1e3)}),scope.isActive=!1,scope.close=function(){return scope.isActive=!1},scope.$on("$destroy",function(){return FlashMessage.isClear(null),FlashMessage.isShow(null)})}}}])}.call(this),function(){angular.module("campus").directive("modal",["OpenModal","$timeout",function(){return{restrict:"E",replace:!0,scope:!1,transclude:!0,controller:["$scope",function(){}],template:'<div class="modal fade {{modalClass}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close modal-close" aria-hidden="true" ng-click="close($event)">&times;</button>\n        <h4 class="modal-title" id="myModalLabel" ng-if=\'!!modalTitle\'>{{modalTitle}}</h4>\n      </div>\n\n      <div class="modal-body" ng-click=\'bodyClose($event)\' ng-transclude></div>\n    </div>\n  </div>\n</div>',link:function(scope,element){return $(element).on("hidden.bs.modal",function(){return scope.$emit("$hidden")}),$(element).on("shown.bs.modal",function(){return scope.$emit("$shown")}),scope.$show=function(){return $(element).modal("show")},scope.$hide=function(){return $(element).modal("hide")},scope.close=function(){scope.$emit("$close",element)},scope.bodyClose=function($event){scope.fullScreen&&$($event.target).hasClass("modal-body")&&scope.$emit("$close",element)}}}}])}.call(this),function(){angular.module("campus").directive("ngError",["$parse",function($parse){return{compile:function($element,attr){var fn;return fn=$parse(attr.ngError),function(scope,element){return element.on("error",function(event){return scope.$apply(function(){return fn(scope,{$event:event})})})}}}}])}.call(this),function(){angular.module("campus").directive("omnibar",["$state",function(){return{restrict:"E",replace:!0,scope:!0,template:"<div class='omnibar'>\n  <div class='omnibar-toggle'>\n    <course-map-button />\n  </div>\n  <split-course-progress></split-course-progress>\n</div>"}}])}.call(this),function(){angular.module("campus").directive("pageClassHooks",["$rootScope","$q","CurrentPage",function($rootScope,$q,CurrentPage){return{restrict:"A",link:function(scope,element){var addClass,classes,clearClasses,currentPageChanged,updateClasses;return classes=[],addClass=function(selector){return classes.push(selector),element.addClass(selector)},clearClasses=function(){return element.removeClass(classes.join(" ")),classes=[]},currentPageChanged=function(){return CurrentPage},updateClasses=function(){var challengeClass,level,levelIndex,page;return clearClasses(),page=CurrentPage.page,level=CurrentPage.level,page&&(element.addClass("page"),page.$isChallenge()?(challengeClass=new S(page.type.replace("_challenge","")).camelize().s,addClass("page--challenge"),addClass("page--challenge--"+challengeClass)):page.$isVideo()?addClass("page--video"):addClass("page--"+page.slug),level)?levelIndex=level.$indexInCourse().then(function(levelIndex){return addClass("page--level"+levelIndex),page&&page.$isChallenge()?(addClass("page--level"+levelIndex+"--"+page.slug),page.$challengeIndex().then(function(challengeIndex){return addClass("page--level"+levelIndex+"--challenge"+challengeIndex)})):void 0}):void 0},scope.$watch(currentPageChanged,updateClasses,!0)}}}])}.call(this),function(){angular.module("campus").directive("session",["$compile","CampusUrl","$q","$rootScope",function($compile,CampusUrl,$q){return{restrict:"E",replace:!0,scope:!0,template:'<div class=\'session\' ng-mouseleave=\'clearActive()\'>\n  <a href=\'http://www.codeschool.com\' class=\'session-logo\'>\n    <svg xmlns="http://www.w3.org/2000/svg" width="166.6" height="30" viewBox="-22.2 -3.9 166.6 30" enable-background="new -22.2 -3.9 166.6 30"><path fill="#4D4F50" class=\'session-logo-text\' d="M24.5 16c-2.5 0-4.1-1.5-4.1-4.7s1.6-4.7 4.1-4.7c.9 0 1.9.3 2.7.8l1.6-3c-1.4-.7-3-1.1-4.6-1.1-4.8 0-8.3 3-8.3 8.1s3.5 8.1 8.3 8.1c1.4 0 2.7-.3 4-.8l-1.6-3c-.7.1-1.4.3-2.1.3zM94.1 10.7c.7 0 1.3.2 1.7.7l.9-2.6c-1-.6-2.1-.9-3.4-.9-3.3 0-6 2.1-6 5.7s2.7 5.7 6 5.7c1.3 0 2.4-.3 3.4-.9l-.9-2.6c-.4.5-1.1.7-1.7.7-1.4 0-2.5-.8-2.5-2.8 0-2.2 1.1-3 2.5-3zM34.7 7.9c-3.3 0-6 2.1-6 5.7s2.7 5.7 6 5.7 6-2.1 6-5.7-2.7-5.7-6-5.7zm0 8.8c-1 0-1.7-1.2-1.7-3.2s.8-3.2 1.7-3.2c1 0 1.7 1.2 1.7 3.2 0 2.1-.7 3.2-1.7 3.2zM117.8 7.9c-3.3 0-6 2.1-6 5.7s2.7 5.7 6 5.7 6-2.1 6-5.7-2.7-5.7-6-5.7zm0 8.8c-1 0-1.7-1.2-1.7-3.2s.8-3.2 1.7-3.2 1.7 1.2 1.7 3.2c.1 2.1-.7 3.2-1.7 3.2zM131.1 7.9c-3.3 0-6 2.1-6 5.7s2.7 5.7 6 5.7 6-2.1 6-5.7c.1-3.6-2.6-5.7-6-5.7zm0 8.8c-1 0-1.7-1.2-1.7-3.2s.8-3.2 1.7-3.2c1 0 1.7 1.2 1.7 3.2.1 2.1-.7 3.2-1.7 3.2zM62.9 16.6c-1 0-1.7-.6-2-1.8 3.6.1 5.8-1.4 5.8-3.5s-1.9-3.4-4.2-3.4c-3.3 0-6 2.1-6 5.7s2.4 5.7 5.7 5.7c3.2 0 5-2.4 5-2.4l-1.1-1.9s-1.6 1.6-3.2 1.6zm-.4-6.2c.6 0 .9.5.9 1.1 0 1-.6 1.5-2.6 1.6.1-1.8.8-2.7 1.7-2.7zM53.9 15v-12.3h-4.1v6.9c-.8-1.1-2-1.8-3.3-1.8-2.4 0-4.4 2.1-4.4 5.7s2 5.7 4.4 5.7c1.5 0 2.8-.8 3.6-2.1.5 1.5 1.8 2.1 3.2 2.1 1.4 0 2.1-.4 2.1-.4l.3-2.9c-.1 0-1.8 1-1.8-.9zm-5.8 1.6c-1 0-1.7-1.1-1.7-3s.8-3 1.7-3c1 0 1.7 1.1 1.7 3s-.8 3-1.7 3zM109.1 15v-4.1c0-1.8-.6-3-2.6-3-1.6 0-3 .8-3.7 2.1v-7.3h-4.1v16.1h4.1v-3.8c0-3.5 1.1-4.5 1.7-4.5.4 0 .7.3.7 1.1v3.8c0 2.8 1.6 3.8 3.4 3.8 1.4 0 2.1-.4 2.1-.4l.3-2.9c-.1 0-1.9.8-1.9-.9zM142.7 15v-12.3h-4.1v12.7c0 2.8 1.6 3.8 3.4 3.8 1.4 0 2.1-.4 2.1-.4l.3-2.9s-1.7 1-1.7-.9zM81.7 9.4c-2.5-.9-3.1-1.2-3.1-2s.5-1.2 1.4-1.2c2 0 4.5 1.4 4.5 1.4l1.1-2.7s-1.9-1.7-5.4-1.7c-3.8 0-5.8 2-5.8 4.7 0 2 1 3.8 4.1 4.8 2.5.8 2.9 1.4 2.9 2.2 0 1-.7 1.4-1.8 1.4-2.3 0-5-1.8-5-1.8l-1.4 2.7s2.7 2.2 6.4 2.2c4 0 6.2-2 6.2-5 .1-2.3-.5-3.7-4.1-5z"/><g fill="#4CADC1"><path d="M-5.6 3.1v3.8l4.4 4.2-4.4 4.1v3.8l8.5-7.9zM-8.9 15.2l-4.3-4.1 4.3-4.2v-3.8l-8.4 8 8.4 7.9z"/></g><path fill="#4CADC1" d="M-7.2-3.9c-8.3 0-15 6.7-15 15s6.7 15 15 15 15-6.7 15-15-6.7-15-15-15zm0 27.3c-6.8 0-12.3-5.5-12.3-12.3s5.5-12.4 12.3-12.4 12.3 5.6 12.3 12.4-5.5 12.3-12.3 12.3z"/></svg>\n  </a>\n\n  <a href=\'\' class=\'session-toggle\' ng-mouseover=\'setActive()\'>\n    <user-avatar class="user-media--session" width="40" height="40"></user-avatar>\n  </a>\n\n  <nav>\n    <ul class=\'dropdown-menu session-menu\'>\n\n    </ul>\n  </nav>\n</div>',link:function(scope,element){var listItems;return scope.authUrl=CampusUrl.authUrl(),scope.getUserName=function(){return scope.userName?scope.userName:"Student"},scope.imageUrl=function(imageName){return CampusUrl.imageUrl(imageName)},scope.setActive=function(){element.addClass("is-active")},scope.clearActive=function(){element.removeClass("is-active")},listItems="",$q.all([scope.$course.$getAllConfig(),scope.$user.$isLoggedIn(),scope.$user.$userName()]).then(function(data){var config,isLoggedIn,userName;return config=data[0],isLoggedIn=data[1],userName=data[2],scope.marketingSiteUrl=config.marketing_site_url,scope.marketingSiteName=config.marketing_site_name,scope.marketingSiteAccountUrl=config.marketing_site_account_url,scope.forumUrl=config.forum_url,scope.supportUrl=config.support_url,scope.userName=scope.$user.user_name,scope.authenticationProvider=config.authentication_provider,scope.clearSession=function(){return analytics.reset()},isLoggedIn?(listItems+='<li class=\'dropdown-item session-item\'>\n  <a class=\'dropdown-link session-link\' data-method="delete" ng-click="clearSession()" href="/session?provider_sign_out={{authenticationProvider}}" rel="nofollow" analytics-on analytics-event="Session Log Out">\n    Log Out\n  </a>\n</li>',listItems+="<li class='dropdown-item session-item'>\n  <user-stats-button class='dropdown-link session-link'>\n    My Stats\n  </user-stats-button>\n</li>",scope.marketingSiteAccountUrl&&(listItems+="<li class='dropdown-item session-item session-item--user'>\n  <a class='dropdown-link session-link' href='{{marketingSiteAccountUrl}}' analytics-on analytics-event=\"Session My Account\">My Account</a>\n</li>")):listItems+="<li class='dropdown-item session-item'>\n  <a class='dropdown-link session-link' href='{{authUrl}}' analytics-on analytics-event=\"Session Sign In\">\n    Sign in to {{marketingSiteName}}\n  </a>\n</li>",scope.supportUrl&&(listItems+="<li class='dropdown-item session-item'>\n  <a class='dropdown-link session-link' href='{{supportUrl}}' analytics-on analytics-event=\"Session Support\">\n    Support\n  </a>\n</li>"),scope.forumUrl&&(listItems+="<li class='dropdown-item session-item'>\n  <a class='dropdown-link session-link' href='{{forumUrl}}' analytics-on analytics-event=\"Session Forum\">\n    Discuss\n  </a>\n</li>"),element.find("ul").html(listItems),$compile(element.contents())(scope)})}}}])}.call(this),function(){angular.module("campus").directive("tooltip",["$state",function(){return{restrict:"A",scope:{},link:function(scope,element,attrs){return $(element).tooltip({animation:attrs.animation,html:attrs.html,placement:attrs.placement,selector:attrs.selector,title:attrs.title,trigger:attrs.trigger,delay:attrs.delay,container:attrs.container||"body"}),scope.$on("$destroy",function(){return $(element).tooltip("destroy")})}}}])}.call(this),function(){angular.module("campus").directive("userStatsButton",["OpenModal",function(OpenModal){return{restrict:"E",replace:!0,transclude:!0,scope:!0,template:"<a href='' ng-click='openUserStatsModal()' ng-transclude analytics-on analytics-event=\"Session My Stats\"></a>",link:function(scope){var showModal;return showModal=null,scope.openUserStatsModal=function(){return showModal||(showModal=OpenModal.show({modalClass:"modal--page modal--user",fullScreen:!0,scope:scope,template:"<user-stats></user-stats>"})),showModal.then(function(modal){return modal.$show()})}}}}])}.call(this),function(){angular.module("campus").config(["$stateProvider","$urlRouterProvider","$locationProvider",function($stateProvider,$urlRouterProvider,$locationProvider){return $locationProvider.html5Mode(!0),$stateProvider.state("root",{url:"/?login&bars","abstract":!0,template:"<course-window></course-window>",resolve:{$course:["$rootScope","Course",function($rootScope,Course){return Course.fromIdentifier($rootScope.courseIdentifier)}],$user:["$rootScope","$analytics","User","UserData",function($rootScope,$analytics,User,UserData){var courseIdentifier;return courseIdentifier=$rootScope.courseIdentifier,new UserData(courseIdentifier).get().then(function(userData){var user;return user=new User(courseIdentifier,userData),$analytics.setUserProperties(user.user_name,{uuid:user.uuid,email:user.email,visitor:user.visitor}),user})}],$preloadCourse:["$course",function($course){return $course.$preload(),null}]},controller:["$rootScope","$scope","$stateParams","$location","$course","$user","CurrentPage",function($rootScope,$scope,$stateParams,$location,$course,$user,CurrentPage){var courseIdentifier;return courseIdentifier=$rootScope.courseIdentifier,$scope.$course=$course,$scope.$user=$user,CurrentPage.course=$course,$stateParams.login?$location.url($location.path(),!0):void 0}]}).state("root.courseContent",{url:"*queryString?template",template:'<course-data template="{{template}}"></course-data>',resolve:{$page:["$course","$stateParams","Page",function($course,$stateParams,Page){return Page.fromQueryString($course.identifier,$stateParams.queryString)}],$level:["$page",function($page){return $page.$level()}],$section:["$page",function($page){return $page.$section()}],$preload:["$page",function($page){return $page.$preload()}],$preloadNextPage:["$page",function($page){return $page.$nextPage().then(function(nextPage){return nextPage?nextPage.$preload():void 0}),null}]},controller:["$location","$rootScope","$scope","$state","$stateParams","CurrentPage","GoogleAnalytics","$course","$level","$section","$page","$user","WebEngage",function($location,$rootScope,$scope,$state,$stateParams,CurrentPage,GoogleAnalytics,$course,$level,$section,$page,$user,WebEngage){return $stateParams.queryString!==$page.$meta.query_string?$state.go("root.courseContent",{queryString:$page.$meta.query_string,location:"replace"}):($rootScope.queryString=$stateParams.queryString||$scope.courseIdentifier,$scope.$level=$level,$scope.$section=$section,$scope.$page=$page,$scope.template=$stateParams.template||$page.template,CurrentPage.level=$level,CurrentPage.section=$section,CurrentPage.page=$page,$page.auto_resume!==!1&&$user.$recordLastPageViewed($rootScope.queryString),GoogleAnalytics.trackCoursePageview($scope.courseIdentifier,$rootScope.queryString),analytics.ready(function(){return WebEngage.exists()?WebEngage.trackCourseCompletion($course).then(function(){return WebEngage.reload()}):void 0}))}],onExit:["$rootScope","$page","FlashMessage","OpenModal","BaseModel","Submitter",function($rootScope,$page,FlashMessage,OpenModal,BaseModel,Submitter){return $page.$destroy(),FlashMessage.clear(),OpenModal.close({clear:!0}),Submitter.cleanUp()}]})}])}.call(this);